<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[Android 9 Activity的加载和显示]]></title>
      <url>http://jasoncool.com/2019/03/29/Android-9-Activity%E7%9A%84%E5%8A%A0%E8%BD%BD%E5%92%8C%E6%98%BE%E7%A4%BA/</url>
      <content type="html"><![CDATA[<h2 id="&#x8D77;&#x56E0;">&#x8D77;&#x56E0;</h2><p>&#x6628;&#x5929;&#x88AB;&#x4EBA;&#x95EE;&#x8D77;Activity&#x7684;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#xFF0C;&#x6211;&#x4E00;&#x9635;&#x5FC3;&#x865A;&#xFF0C;&#x8BF4;&#x5B9E;&#x8BDD;&#xFF0C;N&#x5E74;&#x524D;&#x770B;&#x8FC7;&#x4E00;&#x56DE;&#x522B;&#x4EBA;&#x5199;&#x7684;&#x6587;&#x7AE0;&#xFF0C;&#x4F46;&#x662F;&#x81EA;&#x5DF1;&#x4ECE;&#x6765;&#x6CA1;&#x6709;&#x8DDF;&#x7740;&#x6E90;&#x7801;&#x53BB;&#x7814;&#x7A76;&#x8FC7;Activity&#x7684;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#xFF0C;&#x6240;&#x4EE5;&#x522B;&#x4EBA;&#x95EE;&#x5230;&#x540E;&#xFF0C;&#x6211;&#x53EA;&#x80FD;&#x628A;&#x4ECE;PhoneWindow&#x5230;DecorView&#x5230;SetContentView&#x5230;ViewRootImpl&#x8C03;&#x7528;performTraversals()&#x65B9;&#x6CD5;&#xFF0C;&#x518D;&#x8C03;&#x7528;&#x5176;&#x5185;&#x90E8;&#x7684;performMeasure()&#x3001;performLayout()&#x3001;performDraw()&#xFF0C;&#x4ECE;&#x800C;&#x5C06;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x7ED8;&#x5236;&#x5E76;&#x52A0;&#x8F7D;&#x5230;&#x7236;&#x7C7B;&#x4E3A;FrameLayout&#x7684;DecorView&#x4E0A;&#xFF0C;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x867D;&#x7136;&#x6CA1;&#x4EC0;&#x4E48;&#x6253;&#x9519;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x5176;&#x5B9E;&#x53EA;&#x662F;View&#x7684;&#x7ED8;&#x5236;&#x6D41;&#x7A0B;&#x5206;&#x652F;&#xFF0C;&#x4E0E;Activity&#x7684;&#x754C;&#x9762;&#x52A0;&#x8F7D;&#x6709;&#x90E8;&#x5206;&#x91CD;&#x5408;&#xFF0C;&#x771F;&#x6B63;&#x7684;Activity&#x542F;&#x52A8;&#x540E;&#xFF0C;&#x754C;&#x9762;&#x52A0;&#x8F7D;&#x7684;&#x6D41;&#x7A0B;&#x662F;&#x8981;&#x6BD4;&#x8FD9;&#x4E2A;&#x590D;&#x6742;&#x7684;&#xFF0C;&#x6000;&#x7740;&#x60ED;&#x6127;&#x7684;&#x5FC3;&#x60C5;&#xFF0C;&#x4ECA;&#x5929;&#x8D76;&#x7D27;&#x6253;&#x5F00;AndroidStudio&#xFF0C;&#x4ECE;&#x6E90;&#x7801;&#x5F00;&#x59CB;&#xFF0C;&#x4E00;&#x70B9;&#x4E00;&#x70B9;&#x7684;&#x6263;&#x6574;&#x4E2A;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#x3002;</p>
<p>&#x4E0D;&#x8FC7;&#x8FD9;&#x91CC;&#x5148;&#x8BF4;&#x4E00;&#x4E0B;&#xFF0C;&#x6211;&#x65E0;&#x6CD5;&#x4ECE;Activity&#x7684;StartActivity()&#x65B9;&#x6CD5;&#x5F00;&#x59CB;&#x8BB2;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#x7279;&#x522B;&#x591A;&#xFF0C;&#x800C;&#x4E14;&#x76F8;&#x5F53;&#x590D;&#x6742;&#xFF0C;&#x6211;&#x8FD8;&#x6CA1;&#x6709;&#x5B8C;&#x5168;&#x5403;&#x900F;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x7684;&#x6E90;&#x7801;&#x5206;&#x6790;&#x8FC7;&#x7A0B;&#x662F;&#x4ECE;ActivityThread&#x7684;StartActivityNow&#x5F00;&#x59CB;&#x8BB2;&#x89E3;&#x5E76;&#x5206;&#x6790;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x5F88;&#x719F;&#x6089;&#xFF0C;&#x53EA;&#x662F;&#x4E3A;&#x4E86;&#x770B;&#x524D;&#x534A;&#x90E8;&#x5206;&#x7684;&#x670B;&#x53CB;&#xFF0C;&#x53EF;&#x4EE5;&#x8F6C;&#x6218;&#x5230;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x4E0B;&#xFF1A;</p>
<p><a href="https://blog.csdn.net/lj19851227/article/details/82562115" target="_blank" rel="external">&#xFF08;Android 9.0&#xFF09;Activity&#x542F;&#x52A8;&#x6D41;&#x7A0B;&#x6E90;&#x7801;&#x5206;&#x6790;</a></p>
<a id="more"></a>
<h2 id="&#x8FC7;&#x7A0B;">&#x8FC7;&#x7A0B;</h2><p>&#x73B0;&#x5728;&#x5F00;&#x59CB;&#x5206;&#x6790;&#xFF0C;&#x9996;&#x5148;&#x6253;&#x5F00;android.app.ActivityThread&#x7C7B;,&#x627E;&#x5230;startActivityNow()</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> android.app.<span class="function">ActivityThread</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> Activity <span class="title">startActivityNow</span><span class="params">(Activity parent, String id,</span><br><span class="line">        Intent intent, ActivityInfo activityInfo, IBinder token, Bundle state,</span><br><span class="line">        Activity.NonConfigurationInstances lastNonConfigurationInstances)</span> </span>{</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> performLaunchActivity(r, <span class="keyword">null</span> <span class="comment">/* customIntent */</span>);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4E3B;&#x8981;&#x7684;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E9B;&#x53C2;&#x6570;&#x540E;&#xFF0C;&#x5E76;&#x8C03;&#x7528;&#x540C;&#x7C7B;&#x7684;performLaunchActivity()</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> android.app.<span class="function">ActivityThread</span><br><span class="line"><span class="keyword">private</span> Activity <span class="title">performLaunchActivity</span><span class="params">(ActivityClientRecord r, Intent customIntent)</span> </span>{</span><br><span class="line"> ...</span><br><span class="line">  Activity activity = <span class="keyword">null</span>;</span><br><span class="line">  <span class="keyword">try</span>{</span><br><span class="line">  ...</span><br><span class="line">  activity = mInstrumentation.newActivity(cl, component.getClassName(), r.intent);</span><br><span class="line">  ...</span><br><span class="line">  }</span><br><span class="line">  activity.attach(appContext, <span class="keyword">this</span>, getInstrumentation(), r.token,</span><br><span class="line">                        r.ident, app, r.intent, r.activityInfo, title, r.parent,</span><br><span class="line">                        r.embeddedID, r.lastNonConfigurationInstances, config,</span><br><span class="line">                        r.referrer, r.voiceInteractor, window, r.configCallback);</span><br><span class="line">           </span><br><span class="line"> ...</span><br><span class="line"> <span class="keyword">if</span> (r.isPersistable()) {</span><br><span class="line">   mInstrumentation.callActivityOnCreate(activity, r.state, r.persistentState);</span><br><span class="line"> } <span class="keyword">else</span> {</span><br><span class="line">   mInstrumentation.callActivityOnCreate(activity, r.state);</span><br><span class="line"> }</span><br><span class="line"> ...</span><br><span class="line"> }</span><br></pre></td></tr></table></figure>
<p>&#x9996;&#x5148;&#x7B2C;7&#x884C;&#xFF0C;&#x5148;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;activity&#x7684;&#x5B9E;&#x4F8B;&#xFF1B;</p>
<p>&#x7136;&#x540E;&#x7B2C;10&#x884C;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;activiy&#x5B9E;&#x4F8B;&#x7684;attach&#x65B9;&#x6CD5;&#xFF1B;</p>
<p>&#x7136;&#x540E;&#x7B2C;16&#x884C;&#x5F00;&#x59CB;&#xFF0C;&#x901A;&#x8FC7;&#x5224;&#x65AD;&#x662F;&#x5426;&#x542F;&#x7528;&#x4E86;PersistableBundle&#xFF0C;&#x6765;&#x5224;&#x65AD;<strong>Instrumentation</strong>&#x5BF9;&#x8C61;mInstrumentation&#x8C03;&#x7528;&#x54EA;&#x4E2A;Activity&#x7684;onCreate()&#x65B9;&#x6CD5;&#xFF0C;&#x4E0D;&#x4E86;&#x89E3;PersistableBundle&#x7684;&#x53EF;&#x4EE5;&#x770B;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#xFF1A;</p>
<p><a href="https://www.jianshu.com/p/a044e20fd6e7" target="_blank" rel="external">android-1.0-&#x56DB;&#x5927;&#x7EC4;&#x4EF6;-PersistableBundle</a></p>
<p>&#x8FD9;&#x91CC;&#x4E3B;&#x8981;&#x770B;&#x4E00;&#x4E0B;<strong>attach</strong>&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> android.app.Activity;</span><br><span class="line"><span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">attach</span><span class="params">(Context context, ActivityThread aThread,</span><br><span class="line">            Instrumentation instr, IBinder token, <span class="keyword">int</span> ident,</span><br><span class="line">            Application application, Intent intent, ActivityInfo info,</span><br><span class="line">            CharSequence title, Activity parent, String id,</span><br><span class="line">            NonConfigurationInstances lastNonConfigurationInstances,</span><br><span class="line">            Configuration config, String referrer, IVoiceInteractor voiceInteractor,</span><br><span class="line">            Window window, ActivityConfigCallback activityConfigCallback)</span> </span>{</span><br><span class="line">    ...</span><br><span class="line">     mWindow = <span class="keyword">new</span> PhoneWindow(<span class="keyword">this</span>, window, activityConfigCallback);</span><br><span class="line">     mWindow.setWindowControllerCallback(<span class="keyword">this</span>);</span><br><span class="line">     mWindow.setCallback(<span class="keyword">this</span>);</span><br><span class="line">     mWindow.setOnWindowDismissedCallback(<span class="keyword">this</span>);</span><br><span class="line">    ...</span><br><span class="line">      mWindow.setWindowManager(</span><br><span class="line">                (WindowManager)context.getSystemService(Context.WINDOW_SERVICE),</span><br><span class="line">                mToken, mComponent.flattenToString(),</span><br><span class="line">                (info.flags &amp; ActivityInfo.FLAG_HARDWARE_ACCELERATED) != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (mParent != <span class="keyword">null</span>) {</span><br><span class="line">            mWindow.setContainer(mParent.getWindow());</span><br><span class="line">        }</span><br><span class="line">        mWindowManager = mWindow.getWindowManager();</span><br><span class="line">    ...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x8981;&#x4E86;&#x89E3;&#x8FD9;&#x91CC;&#xFF0C;&#x9996;&#x5148;&#x8981;&#x4E86;&#x89E3;&#x4E00;&#x4E0B;Activity&#x7684;&#x7EC4;&#x6210;&#x7ED3;&#x6784;&#xFF1A;</p>
<p><img src="/2019/03/29/Android-9-Activity&#x7684;&#x52A0;&#x8F7D;&#x548C;&#x663E;&#x793A;/1.png" alt="logo"></p>
<p>&#x4E00;&#x4E2A;Activity&#x7684;&#x5185;&#x90E8;&#x5305;&#x542B;&#x4E00;&#x4E2A;PhoneWindow&#xFF0C;PhoneWindow&#x6709;&#x5305;&#x542B;&#x4E00;&#x4E2A;DecorView,DecorView&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x4E00;&#x4E2A;FrameLayout&#x7684;&#x5B50;&#x7C7B;&#xFF0C;&#x5B83;&#x7684;&#x5185;&#x90E8;&#x53C8;&#x5305;&#x542B;&#x4E86;TitleActionBar&#x548C;ContentView,&#x800C;<strong>attach</strong>&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x76EE;&#x7684;&#x5C31;&#x662F;&#x521D;&#x59CB;&#x5316;PhoneWindow&#x5BF9;&#x8C61;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x56DE;&#x5230;&#x6E90;&#x7801;&#x90E8;&#x5206;&#xFF0C;&#x4E0A;&#x9762;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x6211;&#x7F57;&#x5217;&#x51FA;&#x7684;&#x4EE3;&#x7801;&#x4E3B;&#x8981;&#x505A;&#x4E86;&#x4E09;&#x4EF6;&#x4E8B;&#xFF1A;</p>
<p>1.&#x5C06;Activity.mWindow&#x5BF9;&#x8C61;&#x521D;&#x59CB;&#x5316;</p>
<p>2.&#x7ED9;mWindow&#x8BBE;&#x7F6E;WindowManager</p>
<p>3.&#x7ED9;mWindowManager&#x8D4B;&#x503C;&#x3002;</p>
<p>&#x597D;&#x4E86;&#xFF0C;<strong>attach</strong>&#x65B9;&#x6CD5;&#x770B;&#x5B8C;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x56DE;&#x5230;<strong>performLaunchActivity</strong>&#x65B9;&#x6CD5;&#x91CC;&#xFF0C;&#x73B0;&#x5728;&#x8BE5;mInstrumentation&#x8C03;&#x7528;<strong>callActivityOnCreate</strong>&#x65B9;&#x6CD5;&#x4E86;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.app.Instrumentation;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">callActivityOnCreate</span><span class="params">(Activity activity, Bundle icicle)</span> </span>{</span><br><span class="line">        prePerformCreate(activity);</span><br><span class="line">        activity.performCreate(icicle);</span><br><span class="line">        postPerformCreate(activity);</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4E3B;&#x8981;&#x770B;activity.performCreate(icicle);&#x8FD9;&#x884C;&#x4EE3;&#x7801;&#xFF0C;&#x8FDB;&#x5165;<strong>performCreate</strong>&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.app.Activity; </span><br><span class="line"><span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">performCreate</span><span class="params">(Bundle icicle, PersistableBundle persistentState)</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (persistentState != <span class="keyword">null</span>) {</span><br><span class="line">            onCreate(icicle, persistentState);</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            onCreate(icicle);</span><br><span class="line">        }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x6700;&#x540E;&#x53D1;&#x73B0;&#xFF0C;&#x6267;&#x884C;&#x7684;&#x5C31;&#x662F;<strong>onCreate</strong>&#x65B9;&#x6CD5;&#xFF0C;&#x800C;&#x6211;&#x4EEC;&#x5199;Activity&#x65B9;&#x6CD5;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E00;&#x822C;&#x90FD;&#x4F1A;&#x5199;&#x4E00;&#x4E2A;setContentView(layoutId)&#x6765;&#x8BBE;&#x7F6E;&#x754C;&#x9762;&#x5E03;&#x5C40;&#xFF0C;&#x8FD9;&#x65F6;&#x6211;&#x4EEC;&#x518D;&#x770B;&#x770B;<strong>setContentView</strong>&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.app.Activity; </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContentView</span><span class="params">(@LayoutRes <span class="keyword">int</span> layoutResID)</span> </span>{</span><br><span class="line">    getWindow().setContentView(layoutResID);</span><br><span class="line">    initWindowDecorActionBar();</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x5176;&#x5B9E;&#x505A;&#x4E24;&#x4EF6;&#x4E8B;&#xFF0C;&#x7B2C;&#x4E00;&#x4EF6;&#x4E8B;&#x662F;&#x8C03;&#x7528;getWindow()&#x7684;<strong>setContentView</strong>&#x65B9;&#x6CD5;&#xFF0C;&#x800C;getWindow()&#x8FD4;&#x56DE;&#x7684;&#x662F;&#x4E00;&#x4E2A;android.app.<strong>Window</strong>&#x5BF9;&#x8C61;&#xFF0C;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x5C31;&#x662F;&#x521A;&#x521A;&#x5728;attach()&#x4E2D;&#x8D4B;&#x503C;&#x7684;mWindow&#x6210;&#x5458;&#x53D8;&#x91CF;&#x3002;</p>
<p>&#x540E;&#x9762;&#x7684;<strong>initWindowDecorActionBar</strong>&#x65B9;&#x6CD5;&#x770B;&#x540D;&#x5B57;&#x5C31;&#x662F;&#x521D;&#x59CB;&#x5316;DecorView&#x7684;ActionBar,&#x8FD9;&#x4E5F;&#x5370;&#x8BC1;&#x4E86;&#x524D;&#x9762;&#x6211;&#x4EEC;&#x8BB2;&#x7684;Activity&#x7684;&#x6846;&#x67B6;&#x7ED3;&#x6784;&#xFF0C;&#x8FD9;&#x4E2A;&#x5206;&#x652F;&#x5C31;&#x8D70;&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x8FD8;&#x662F;&#x7EE7;&#x7EED;&#x770B;<strong>getWindow().setContentView</strong>,&#x7531;&#x4E8E;Window&#x662F;&#x4E00;&#x4E2A;&#x62BD;&#x8C61;&#x7C7B;&#xFF0C;&#x800C;Window&#x7684;setContentView&#x65B9;&#x6CD5;&#x5176;&#x5B9E;&#x662F;&#x4E00;&#x4E2A;&#x62BD;&#x8C61;&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x5177;&#x4F53;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8981;&#x770B;&#x7684;&#x662F;window&#x7684;&#x5B50;&#x7C7B;&#xFF1A;<strong>PhoneWindow</strong>&#x7684;<strong>setContentView</strong>&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.android.internal.policy.PhoneWindow;</span><br><span class="line"></span><br><span class="line"><span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContentView</span><span class="params">(<span class="keyword">int</span> layoutResID)</span> </span>{</span><br><span class="line"> <span class="comment">// Note: FEATURE_CONTENT_TRANSITIONS may be set in the process of installing the window</span></span><br><span class="line">        <span class="comment">// decor, when theme attributes and the like are crystalized. Do not check the feature</span></span><br><span class="line">        <span class="comment">// before this happens.</span></span><br><span class="line">        <span class="keyword">if</span> (mContentParent == <span class="keyword">null</span>) {</span><br><span class="line">            installDecor();</span><br><span class="line">        } <span class="keyword">else</span> <span class="keyword">if</span> (!hasFeature(FEATURE_CONTENT_TRANSITIONS)) {</span><br><span class="line">            mContentParent.removeAllViews();</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (hasFeature(FEATURE_CONTENT_TRANSITIONS)) {</span><br><span class="line">            view.setLayoutParams(params);</span><br><span class="line">            <span class="keyword">final</span> Scene newScene = <span class="keyword">new</span> Scene(mContentParent, view);</span><br><span class="line">            transitionTo(newScene);</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">             mLayoutInflater.inflate(layoutResID, mContentParent);</span><br><span class="line">            <span class="comment">//&#x5982;&#x679C;&#x8C03;&#x7528;&#x7684;&#x662F;&#x540C;&#x7C7B;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#xFF1A;setContentView(View view, ViewGroup.LayoutParams params)&#x7684;&#x8BDD;</span></span><br><span class="line">            <span class="comment">//&#x5219;&#x8FD9;&#x91CC;&#x7684;&#x4EE3;&#x7801;&#x662F;&#xFF1A;mContentParent.addView(view, params);</span></span><br><span class="line">        }</span><br><span class="line">         mContentParent.requestApplyInsets();</span><br><span class="line">        <span class="keyword">final</span> Callback cb = getCallback();</span><br><span class="line">        <span class="keyword">if</span> (cb != <span class="keyword">null</span> &amp;&amp; !isDestroyed()) {</span><br><span class="line">            cb.onContentChanged();</span><br><span class="line">        }</span><br><span class="line">        mContentParentExplicitlySet = <span class="keyword">true</span>;</span><br><span class="line">     ...</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>
<p>&#x77E5;&#x8BC6;&#x70B9;&#xFF1A;FEATURE_CONTENT_TRANSITIONS&#x662F;&#x6807;&#x8BB0;&#x5F53;&#x524D;&#x5185;&#x5BB9;&#x52A0;&#x8F7D;&#x6709;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x8FC7;&#x6E21;&#x52A8;&#x753B;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8F6C;&#x573A;&#x52A8;&#x753B;&#x3002;</p>
<p>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x6CE8;&#x610F;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#xFF0C;<strong>mContentParent</strong>&#x662F;&#x4E00;&#x4E2A;ViewGroup&#xFF0C;&#x800C;&#x5B66;&#x8FC7;&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x540C;&#x5B66;&#xFF0C;&#x80AF;&#x5B9A;&#x77E5;&#x9053;ViewGroup&#x5C31;&#x662F;FrameLayout,LinearLayout,RelativeLayout&#x7B49;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x7684;&#x7236;&#x7C7B;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x6709;&#x4E00;&#x4E2A;&#x6267;&#x884C;&#x5224;&#x65AD;&#x5C31;&#x662F;&#xFF0C;&#x5982;&#x679C;mContentParent&#x4E0D;&#x4E3A;&#x7A7A;&#xFF0C;&#x5E76;&#x4E14;&#x6CA1;&#x6709;&#x8FC7;&#x5EA6;&#x52A8;&#x753B;&#x5C31;&#x6267;&#x884C;mContentParent.removeAllViews();&#x6765;&#x6E05;&#x7406;&#x754C;&#x9762;&#xFF0C;&#x4E4B;&#x540E;&#x901A;&#x8FC7;&#x5224;&#x65AD;&#xFF0C;&#x6CA1;&#x6709;&#x8FC7;&#x6E21;&#x52A8;&#x753B;&#x540E;&#xFF0C;&#x7ED9;mContentParent&#x8FD9;&#x4E2A;ViewGroup&#x4E2D;&#x6DFB;&#x52A0;view&#x548C;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x770B;<strong>installDecor</strong>&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.android.internal.policy.PhoneWindow; </span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">installDecor</span><span class="params">()</span> </span>{</span><br><span class="line">    ...</span><br><span class="line">          <span class="keyword">if</span> (mDecor == <span class="keyword">null</span>) {</span><br><span class="line">            mDecor = generateDecor(-<span class="number">1</span>);</span><br><span class="line">            ...</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            mDecor.setWindow(<span class="keyword">this</span>);</span><br><span class="line">        }</span><br><span class="line">       <span class="keyword">if</span> (mContentParent == <span class="keyword">null</span>) {</span><br><span class="line">            mContentParent = generateLayout(mDecor);</span><br><span class="line">           ...</span><br><span class="line">       }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x4E0A;&#x9762;&#x7684;&#x65B9;&#x6CD5;&#x4E3B;&#x8981;&#x505A;&#x7684;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x521D;&#x59CB;&#x5316;DecorView&#xFF0C;&#x5E76;&#x5C06;DecorView&#x548C;PhoneWindow&#x8FDB;&#x884C;&#x5173;&#x8054;&#xFF0C;&#x5E76;&#x521D;&#x59CB;&#x5316;mContentParent.</p>
<p>&#x770B;&#x770B;<strong>generateDecor</strong>&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.android.internal.policy.PhoneWindow;</span><br><span class="line"><span class="function"><span class="keyword">protected</span> DecorView <span class="title">generateDecor</span><span class="params">(<span class="keyword">int</span> featureId)</span> </span>{</span><br><span class="line">        <span class="comment">// System process doesn&apos;t have application context and in that case we need to directly use</span></span><br><span class="line">        <span class="comment">// the context we have. Otherwise we want the application context, so we don&apos;t cling to the</span></span><br><span class="line">        <span class="comment">// activity.</span></span><br><span class="line">        Context context;</span><br><span class="line">        <span class="keyword">if</span> (mUseDecorContext) {</span><br><span class="line">            Context applicationContext = getContext().getApplicationContext();</span><br><span class="line">            <span class="keyword">if</span> (applicationContext == <span class="keyword">null</span>) {</span><br><span class="line">                context = getContext();</span><br><span class="line">            } <span class="keyword">else</span> {</span><br><span class="line">                context = <span class="keyword">new</span> DecorContext(applicationContext, getContext());</span><br><span class="line">                <span class="keyword">if</span> (mTheme != -<span class="number">1</span>) {</span><br><span class="line">                    context.setTheme(mTheme);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            context = getContext();</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DecorView(context, featureId, <span class="keyword">this</span>, getAttributes());</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x91CC;&#x6CE8;&#x610F;&#x4E00;&#x4E0B;&#x6700;&#x540E;new DecorView&#x7684;&#x65F6;&#x5019;&#x4F20;&#x5165;&#x4E86;this,&#x8FD9;&#x5C31;&#x8BF4;&#x660E;DecorView&#x4E0E;PhoneWindow&#x786E;&#x5B9E;&#x5173;&#x8054;&#x4E86;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x4E86;&#x4E00;&#x4E2A;DecorView&#x7684;&#x5B9E;&#x4F8B;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x518D;&#x770B;&#x770B;<strong>generateLayout</strong>&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.android.internal.policy.PhoneWindow;</span><br><span class="line"><span class="function"><span class="keyword">protected</span> ViewGroup <span class="title">generateLayout</span><span class="params">(DecorView decor)</span> </span>{</span><br><span class="line">    ...</span><br><span class="line">    layoutResource = R.layout.screen_title;</span><br><span class="line">    ...</span><br><span class="line">        mDecor.startChanging();</span><br><span class="line">        mDecor.onResourcesLoaded(mLayoutInflater, layoutResource);</span><br><span class="line">        ViewGroup contentParent = (ViewGroup)findViewById(ID_ANDROID_CONTENT);</span><br><span class="line">        <span class="keyword">if</span> (contentParent == <span class="keyword">null</span>) {</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;Window couldn&apos;t find content container view&quot;</span>);</span><br><span class="line">        }</span><br><span class="line">    ...</span><br><span class="line">        mDecor.finishChanging();</span><br><span class="line">        <span class="keyword">return</span> contentParent;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x5F88;&#x957F;&#xFF0C;&#x6CE8;&#x610F;&#x770B;<strong>onResourcesLoaded</strong>&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (mBackdropFrameRenderer != <span class="keyword">null</span>) {</span><br><span class="line">           loadBackgroundDrawablesIfNeeded();</span><br><span class="line">           mBackdropFrameRenderer.onResourcesLoaded(</span><br><span class="line">                   <span class="keyword">this</span>, mResizingBackgroundDrawable, mCaptionBackgroundDrawable,</span><br><span class="line">                   mUserCaptionBackgroundDrawable, getCurrentColor(mStatusColorViewState),</span><br><span class="line">                   getCurrentColor(mNavigationColorViewState));</span><br><span class="line">       }</span><br><span class="line"></span><br><span class="line">       mDecorCaptionView = createDecorCaptionView(inflater);</span><br><span class="line">       <span class="keyword">final</span> View root = inflater.inflate(layoutResource, <span class="keyword">null</span>);</span><br><span class="line">       <span class="keyword">if</span> (mDecorCaptionView != <span class="keyword">null</span>) {</span><br><span class="line">           <span class="keyword">if</span> (mDecorCaptionView.getParent() == <span class="keyword">null</span>) {</span><br><span class="line">               addView(mDecorCaptionView,</span><br><span class="line">                       <span class="keyword">new</span> ViewGroup.LayoutParams(MATCH_PARENT, MATCH_PARENT));</span><br><span class="line">           }</span><br><span class="line">           mDecorCaptionView.addView(root,</span><br><span class="line">                   <span class="keyword">new</span> ViewGroup.MarginLayoutParams(MATCH_PARENT, MATCH_PARENT));</span><br><span class="line">       } <span class="keyword">else</span> {</span><br><span class="line"></span><br><span class="line">           <span class="comment">// Put it below the color views.</span></span><br><span class="line">           addView(root, <span class="number">0</span>, <span class="keyword">new</span> ViewGroup.LayoutParams(MATCH_PARENT, MATCH_PARENT));</span><br><span class="line">       }</span><br><span class="line">       mContentRoot = (ViewGroup) root;</span><br><span class="line">       initializeElevation();</span><br></pre></td></tr></table></figure>
<p>&#x7EC6;&#x8282;&#x592A;&#x591A;&#x5C31;&#x4E0D;&#x7EC6;&#x8BF4;&#x4E86;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4E3B;&#x8981;&#x662F;&#x521B;&#x5EFA;mDecorCaptionView&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x4F20;&#x9012;&#x8FDB;&#x6765;&#x7684;&#x5E03;&#x5C40;&#x6587;&#x4EF6;inflate&#x5230;&#x8FD9;&#x4E2A;DecorView&#x4E2D;&#x53BB;&#x3002;</p>
<p>&#x518D;&#x56DE;&#x5230;<strong>generateLayout</strong>&#x65B9;&#x6CD5;&#xFF0C;ViewGroup contentParent = (ViewGroup)findViewById(ID_ANDROID_CONTENT);<br>&#x800C;ID_ANDROID_CONTENT&#x7684;&#x5E38;&#x91CF;&#x503C;&#x5C31;&#x662F;&#xFF1A;com.android.internal.R.id.content;</p>
<p>&#x7136;&#x540E;&#x6839;&#x636E;&#xFF1A;layoutResource = R.layout.screen_title;&#x6211;&#x4EEC;&#x6253;&#x5F00;&#x6B64;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#xFF1A;</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">LinearLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line">    <span class="attribute">android:orientation</span>=<span class="value">&quot;vertical&quot;</span></span><br><span class="line">    <span class="attribute">android:fitsSystemWindows</span>=<span class="value">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Popout bar for action modes --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">ViewStub</span> <span class="attribute">android:id</span>=<span class="value">&quot;@+id/action_mode_bar_stub&quot;</span></span><br><span class="line">              <span class="attribute">android:inflatedId</span>=<span class="value">&quot;@+id/action_mode_bar&quot;</span></span><br><span class="line">              <span class="attribute">android:layout</span>=<span class="value">&quot;@layout/action_mode_bar&quot;</span></span><br><span class="line">              <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">              <span class="attribute">android:layout_height</span>=<span class="value">&quot;wrap_content&quot;</span></span><br><span class="line">              <span class="attribute">android:theme</span>=<span class="value">&quot;?attr/actionBarTheme&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">FrameLayout</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span> </span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">&quot;?android:attr/windowTitleSize&quot;</span></span><br><span class="line">        <span class="attribute">style</span>=<span class="value">&quot;?android:attr/windowTitleBackgroundStyle&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">TextView</span> <span class="attribute">android:id</span>=<span class="value">&quot;@android:id/title&quot;</span> </span><br><span class="line">            <span class="attribute">style</span>=<span class="value">&quot;?android:attr/windowTitleStyle&quot;</span></span><br><span class="line">            <span class="attribute">android:background</span>=<span class="value">&quot;@null&quot;</span></span><br><span class="line">            <span class="attribute">android:fadingEdge</span>=<span class="value">&quot;horizontal&quot;</span></span><br><span class="line">            <span class="attribute">android:gravity</span>=<span class="value">&quot;center_vertical&quot;</span></span><br><span class="line">            <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">            <span class="attribute">android:layout_height</span>=<span class="value">&quot;match_parent&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">FrameLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">FrameLayout</span> <span class="attribute">android:id</span>=<span class="value">&quot;@android:id/content&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span> </span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">&quot;0dip&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_weight</span>=<span class="value">&quot;1&quot;</span></span><br><span class="line">        <span class="attribute">android:foregroundGravity</span>=<span class="value">&quot;fill_horizontal|top&quot;</span></span><br><span class="line">        <span class="attribute">android:foreground</span>=<span class="value">&quot;?android:attr/windowContentOverlay&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>&#x53D1;&#x73B0;&#x6700;&#x4E0B;&#x9762;&#x7684;FrameLayout&#x7684;id&#x5C5E;&#x6027;&#x5C31;&#x662F;android:id=&#x201D;@android:id/content&#x201D;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x8FD9;&#x4E2A;FrameLayout&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x7684;&#x53D8;&#x91CF;<strong>contentParent</strong>&#x3002;</p>
<p>&#x6700;&#x540E;&#x653E;&#x4E00;&#x4E2A;&#x524D;&#x8F88;&#x5BF9;&#x4E8E;DecorView&#x7684;&#x603B;&#x7ED3;&#xFF1A;</p>
<blockquote>
<p>&#x7EFC;&#x5408;&#x4EE5;&#x4E0A;&#x7684;&#x63A2;&#x7A76;&#xFF0C;&#x52A0;&#x4E0A;&#x81EA;&#x5DF1;&#x7684;&#x4E00;&#x4E9B;&#x601D;&#x8003;&#x548C;&#x731C;&#x6D4B;&#x3002;&#x5BF9;PhoneWindow&#x505A;&#x4E00;&#x4E0B;&#x5C0F;&#x5C0F;&#x7684;&#x603B;&#x7ED3;&#xFF1A;</p>
<p>1.&#x4E00;&#x4E2A;Activity&#x5BF9;&#x5E94;&#x7740;&#x4E00;&#x4E2A;PhoneWindow&#x5BF9;&#x8C61;&#xFF0C;&#x662F;<strong>&#x4E00;&#x5BF9;&#x4E00;</strong>&#x7684;&#x5173;&#x7CFB;&#xFF0C;&#x5982;&#x679C;&#x4ECE;Activity A&#x542F;&#x52A8;&#x5230;Activity B&#xFF0C;&#x90A3;&#x4E48;Activity B&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x81EA;&#x5DF1;&#x7684;PhoneWindow&#x5BF9;&#x8C61;&#x3002;</p>
<p>2.PhoneWindow&#x7BA1;&#x7406;&#x7740;&#x6574;&#x4E2A;&#x5C4F;&#x5E55;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x4E0D;&#x5305;&#x62EC;&#x5C4F;&#x5E55;&#x6700;&#x9876;&#x90E8;&#x7684;&#x7CFB;&#x7EDF;&#x72B6;&#x6001;&#x6761;&#x3002;&#x6240;&#x4EE5;&#xFF0C;PhoneWindow&#x6216;&#x8005;Window&#x662F;&#x4E0E;&#x5E94;&#x7528;&#x7684;&#x4E00;&#x4E2A;&#x9875;&#x9762;&#x6240;&#x76F8;&#x5173;&#x8054;&#x3002;</p>
<p>3.PhoneWindow&#x540C;&#x65F6;&#x7BA1;&#x7406;&#x7740;ActionBar&#x548C;&#x4E0B;&#x9762;&#x7684;&#x5185;&#x5BB9;&#x4E3B;&#x9898;&#xFF0C;setContentView()&#x65B9;&#x6CD5;&#x662F;&#x7528;&#x6765;&#x8BBE;&#x7F6E;&#x5185;&#x5BB9;&#x4E3B;&#x4F53;&#x7684;&#xFF0C;&#x800C;setTitle()&#x7B49;&#x5176;&#x4ED6;&#x65B9;&#x6CD5;&#x5C31;&#x662F;&#x64CD;&#x4F5C;ActionBar&#x7684;&#xFF0C;Window&#x4E2D;&#x5B9A;&#x4E49;&#x7684;requestFeature()&#x7B49;&#x65B9;&#x6CD5;&#xFF0C;&#x6709;&#x5F88;&#x591A;&#x4E0E;ActionBar&#x5C5E;&#x6027;&#x76F8;&#x5173;&#x7684;&#x8BBE;&#x7F6E;&#x3002;&#x53E6;&#x5916;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x90FD;&#x662F;&#x516C;&#x6709;&#x65B9;&#x6CD5;&#xFF0C;&#x663E;&#x7136;&#x662F;&#x4E3A;&#x4E86;&#x7ED9;&#x5BA2;&#x6237;&#x7AEF;&#x7A0B;&#x5E8F;&#x5458;&#x8C03;&#x7528;&#x7684;&#xFF0C;&#x4E5F;&#x8FDB;&#x4E00;&#x6B65;&#x4F50;&#x8BC1;&#x4E86;&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x7684;&#x610F;&#x4E49;&#x4E0E;&#x4F5C;&#x7528;&#x3002;</p>
<p>4.PhoneWindow&#x81EA;&#x5DF1;&#x5E76;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x89C6;&#x56FE;&#xFF08;View&#xFF09;&#xFF0C;&#x5B83;&#x7684;&#x6210;&#x5458;&#x53D8;&#x91CF;mDecor&#x624D;&#x662F;&#x6574;&#x4E2A;&#x754C;&#x9762;&#x7684;&#x89C6;&#x56FE;&#xFF0C;mDecor&#x662F;&#x5728;generateLayout()&#x7684;&#x65F6;&#x5019;&#x88AB;&#x586B;&#x5145;&#x51FA;&#x6765;&#x7684;&#xFF0C;&#x800C;actionBar&#x548C;contentParent&#x4E24;&#x4E2A;&#x89C6;&#x56FE;&#x90FD;&#x662F;&#x901A;&#x8FC7;findViewById()&#x76F4;&#x63A5;&#x4ECE;mDecor&#x4E2D;&#x83B7;&#x53D6;&#x51FA;&#x6765;&#x7684;&#x3002;</p>
</blockquote>
<p>&#x8BB2;&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x7B97;&#x662F;&#x628A;&#x65B9;&#x6CD5;<strong>installDecor</strong>&#x8BB2;&#x5B8C;&#x4E86;&#xFF0C;&#x73B0;&#x5728;&#x7EE7;&#x7EED;&#x56DE;&#x5230;&#x4EE3;&#x7801;&#x5757;&#xFF1A;com.android.internal.policy.PhoneWindow&#x7684;setContentView&#x4E2D;&#x53BB;&#x7EE7;&#x7EED;&#x4ECE;<strong>installDecor</strong>&#x65B9;&#x6CD5;&#x5F80;&#x4E0B;&#x770B;&#xFF0C;<strong>mContentParent.removeAllViews();</strong>&#x7B80;&#x5355;&#x7684;&#x8BF4;&#x8FC7;&#x4E86;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x590D;&#x8FF0;&#x4E86;&#xFF0C;&#x4E4B;&#x540E;PhoneWindow&#x7C7B;&#x7684;setContentView&#x65B9;&#x6CD5;&#x6700;&#x540E;&#x901A;&#x8FC7;&#x8C03;&#x7528;<strong>mLayoutInflater.inflate(layoutResID, mContentParent);</strong>&#x6216;&#x8005;<strong>mContentParent.addView(view, params);</strong>&#x5C06;&#x6211;&#x4EEC;&#x7684;xml&#x6216;&#x8005;java View&#x63D2;&#x5165;&#x5230;&#x4E86;mContentParent&#xFF08;id&#x4E3A;content&#x7684;FrameLayout&#x5BF9;&#x8C61;&#xFF09;ViewGroup&#x4E2D;&#xFF0C;&#x6700;&#x540E;<strong>setContentView</strong>&#x8FD8;&#x4F1A;&#x8C03;&#x7528;&#x4E00;&#x4E2A;Callback&#x63A5;&#x53E3;&#x7684;&#x6210;&#x5458;&#x51FD;&#x6570;<strong>onContentChanged</strong>&#x6765;&#x901A;&#x77E5;&#x5BF9;&#x5E94;&#x7684;Activity&#x7EC4;&#x4EF6;&#x89C6;&#x56FE;&#x5185;&#x5BB9;&#x53D1;&#x751F;&#x4E86;&#x53D8;&#x5316;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x91CD;&#x65B0;&#x653E;&#x4E00;&#x4E0B;<strong>setContentView</strong>&#x8FD9;&#x4E2A;&#x4EE3;&#x7801;&#x6BB5;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.android.internal.policy.PhoneWindow;</span><br><span class="line"></span><br><span class="line"><span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContentView</span><span class="params">(<span class="keyword">int</span> layoutResID)</span> </span>{</span><br><span class="line"> <span class="comment">// Note: FEATURE_CONTENT_TRANSITIONS may be set in the process of installing the window</span></span><br><span class="line">        <span class="comment">// decor, when theme attributes and the like are crystalized. Do not check the feature</span></span><br><span class="line">        <span class="comment">// before this happens.</span></span><br><span class="line">        <span class="keyword">if</span> (mContentParent == <span class="keyword">null</span>) {</span><br><span class="line">            installDecor();</span><br><span class="line">        } <span class="keyword">else</span> <span class="keyword">if</span> (!hasFeature(FEATURE_CONTENT_TRANSITIONS)) {</span><br><span class="line">            mContentParent.removeAllViews();</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (hasFeature(FEATURE_CONTENT_TRANSITIONS)) {</span><br><span class="line">            view.setLayoutParams(params);</span><br><span class="line">            <span class="keyword">final</span> Scene newScene = <span class="keyword">new</span> Scene(mContentParent, view);</span><br><span class="line">            transitionTo(newScene);</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">             mLayoutInflater.inflate(layoutResID, mContentParent);</span><br><span class="line">            <span class="comment">//&#x5982;&#x679C;&#x8C03;&#x7528;&#x7684;&#x662F;&#x540C;&#x7C7B;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#xFF1A;setContentView(View view, ViewGroup.LayoutParams params)&#x7684;&#x8BDD;</span></span><br><span class="line">            <span class="comment">//&#x5219;&#x8FD9;&#x91CC;&#x7684;&#x4EE3;&#x7801;&#x662F;&#xFF1A;mContentParent.addView(view, params);</span></span><br><span class="line">        }</span><br><span class="line">         mContentParent.requestApplyInsets();</span><br><span class="line">        <span class="keyword">final</span> Callback cb = getCallback();</span><br><span class="line">        <span class="keyword">if</span> (cb != <span class="keyword">null</span> &amp;&amp; !isDestroyed()) {</span><br><span class="line">            cb.onContentChanged();</span><br><span class="line">        }</span><br><span class="line">        mContentParentExplicitlySet = <span class="keyword">true</span>;</span><br><span class="line">     ...</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>
<p>&#x6CE8;&#x610F;&#x6700;&#x540E;&#x51E0;&#x884C;&#x4EE3;&#x7801;&#xFF0C;&#x662F;&#x7531;<strong>Callback</strong>&#x7684;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x8C03;&#x7528;&#x7684;<strong>onContentChanged</strong>&#x65B9;&#x6CD5;&#xFF0C;&#x8FDB;&#x5165;Callback&#x7684;&#x6E90;&#x7801;&#x6211;&#x4EEC;&#x5F97;&#x77E5;&#xFF0C;Callback&#x5C31;&#x662F;&#x5B9A;&#x4E49;&#x5728;&#x62BD;&#x8C61;&#x7C7B;Window&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#xFF0C;&#x800C;<strong>getCallback()</strong>&#x4E5F;&#x4EC5;&#x4EC5;&#x662F;&#x83B7;&#x53D6;Callback&#x63A5;&#x53E3;&#x7684;&#x5B9E;&#x4F8B;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E2A;Callback&#x5177;&#x4F53;&#x5728;&#x54EA;&#x91CC;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x8FD8;&#x5F97;&#x7EE7;&#x7EED;&#x67E5;&#xFF0C;&#x8FD9;&#x91CC;&#x5206;&#x4EAB;&#x4E00;&#x4E0B;&#x6211;&#x7684;&#x67E5;&#x8BE2;&#x65B9;&#x5F0F;&#xFF0C;&#x6211;&#x662F;&#x901A;&#x8FC7;&#x5728;&#x5BF9;&#x5E94;&#x63A5;&#x53E3;&#x4E0A;&#x6309;Ctrl+T&#x7684;&#x65B9;&#x5F0F;&#x7F57;&#x5217;&#x51FA;&#x8BE5;&#x63A5;&#x53E3;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#xFF0C;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><img src="/2019/03/29/Android-9-Activity&#x7684;&#x52A0;&#x8F7D;&#x548C;&#x663E;&#x793A;/2.png" alt="logo"></p>
<p>&#x8FD9;&#x65F6;&#x6211;&#x4EEC;&#x5C31;&#x6CE8;&#x610F;&#x5230;&#x4E86;&#xFF0C;&#x4E00;&#x4E2A;&#x4EB2;&#x5207;&#x7684;&#x5BB6;&#x4F19;&#x5C31;&#x51FA;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x9762;&#x524D;&#x4E86;&#xFF0C; Activity&#x5440;&#xFF01;&#x5BF9;&#x5440;&#xFF0C;&#x5982;&#x679C;PhoneWindow&#x6CA1;&#x6709;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x63A5;&#x53E3;&#xFF0C;&#x90A3;&#x4E48;&#x4F5C;&#x4E3A;&#x7EC4;&#x5408;&#x7C7B;&#x7684;Activity&#x5E94;&#x8BE5;&#x5C31;&#x4F1A;&#x5B9E;&#x73B0;&#x5440;&#xFF0C;&#x800C;&#x4E14;&#x6211;&#x4EEC;&#x56DE;&#x5FC6;&#x4E00;&#x4E0B;Activity&#x7684;attach&#x65B9;&#x6CD5;&#xFF0C;&#x5443;&#xFF0C;&#x4E0D;&#x7528;&#x56DE;&#x5FC6;&#x4E86;&#xFF0C;&#x76F4;&#x63A5;&#x8D34;&#x518D;&#x8D34;&#x4E00;&#x6B21;&#x6E90;&#x7801;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">package</span> android.app.Activity;</span><br><span class="line"><span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">attach</span><span class="params">(Context context, ActivityThread aThread,</span><br><span class="line">            Instrumentation instr, IBinder token, <span class="keyword">int</span> ident,</span><br><span class="line">            Application application, Intent intent, ActivityInfo info,</span><br><span class="line">            CharSequence title, Activity parent, String id,</span><br><span class="line">            NonConfigurationInstances lastNonConfigurationInstances,</span><br><span class="line">            Configuration config, String referrer, IVoiceInteractor voiceInteractor,</span><br><span class="line">            Window window, ActivityConfigCallback activityConfigCallback)</span> </span>{</span><br><span class="line">    attachBaseContext(context);</span><br><span class="line">    mFragments.attachHost(<span class="keyword">null</span> <span class="comment">/*parent*/</span>);</span><br><span class="line"></span><br><span class="line">        mWindow = <span class="keyword">new</span> PhoneWindow(<span class="keyword">this</span>, window, activityConfigCallback);</span><br><span class="line">        mWindow.setWindowControllerCallback(<span class="keyword">this</span>);</span><br><span class="line">        mWindow.setCallback(<span class="keyword">this</span>);</span><br><span class="line">        mWindow.setOnWindowDismissedCallback(<span class="keyword">this</span>);</span><br><span class="line">        mWindow.getLayoutInflater().setPrivateFactory(<span class="keyword">this</span>);</span><br><span class="line">    ....</span><br><span class="line">    </span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x6CE8;&#x610F;&#xFF0C;mWindow.setCallback(this);&#x8FD9;&#x884C;&#x4EE3;&#x7801;&#xFF0C;&#x8FD9;&#x4E2A;this&#x4E0D;&#x5C31;&#x4EE3;&#x8868;&#x7684;&#x662F;Activity&#x672C;&#x8EAB;&#x5417;&#xFF1F;&#x90A3;&#x4E48;cb.onContentChanged();&#x65B9;&#x6CD5;&#x4E0D;&#x5C31;&#x662F;Activity&#x7684;onContentChanged()&#x65B9;&#x6CD5;&#x5417;&#xFF1F;&#x6211;&#x4EEC;&#x770B;&#x4E00;&#x4E0B;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> android.app.Activity;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onContentChanged</span><span class="params">()</span> </span>{</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>Activity&#x7684;onContentChanged()&#x662F;&#x4E00;&#x4E2A;&#x7A7A;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;etContentView()&#x6216;&#x8005;addContentView()&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x65F6;&#x5C31;&#x4F1A;&#x8C03;&#x7528;&#x8BE5;&#x65B9;&#x6CD5;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#x8FD9;&#x4E2A;&#x903B;&#x8F91;&#x540E;&#xFF0C;&#x4EE5;&#x540E;&#x6709;&#x4EC0;&#x4E48;&#x5E03;&#x5C40;&#x4E8C;&#x6B21;&#x53D8;&#x5316;&#x7684;&#x9700;&#x6C42;&#x540E;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5C06;&#x7EC4;&#x4EF6;&#x521D;&#x59CB;&#x5316;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x5982;&#xFF1A;findViewById()&#x6216;&#x8005;&#x4E00;&#x4E9B;&#x53C2;&#x6570;&#x7684;&#x521D;&#x59CB;&#x5316;&#x7B49;&#x4E1A;&#x52A1;&#x4EE3;&#x7801;&#x653E;&#x5728;&#x6211;&#x4EEC;App&#x5BF9;&#x5E94;&#x7684;Activity&#x91CD;&#x5199;&#x7684;onContentChanged()&#x65B9;&#x6CD5;&#x4E2D;&#x53BB;&#xFF0C;&#x8BA9;&#x7CFB;&#x7EDF;&#x5E2E;&#x5FD9;&#x56DE;&#x8C03;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x6765;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;setContentView&#x505A;&#x7684;&#x4E8B;&#xFF1A;</p>
<blockquote>
<p>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;DecorView&#x7684;&#x5BF9;&#x8C61;mDecor&#xFF0C;&#x8BE5;mDecor&#x5BF9;&#x8C61;&#x5C06;&#x4F5C;&#x4E3A;&#x6574;&#x4E2A;&#x5E94;&#x7528;&#x7A97;&#x53E3;&#x7684;&#x6839;&#x89C6;&#x56FE;&#x3002;</p>
<p>&#x4F9D;&#x636E;Feature&#x7B49;style theme&#x521B;&#x5EFA;&#x4E0D;&#x540C;&#x7684;&#x7A97;&#x53E3;&#x4FEE;&#x9970;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#xFF0C;&#x5E76;&#x4E14;&#x901A;&#x8FC7;findViewById&#x83B7;&#x53D6;Activity&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x8BE5;&#x5B58;&#x653E;&#x7684;&#x5730;&#x65B9;&#xFF08;&#x7A97;&#x53E3;&#x4FEE;&#x9970;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x4E2D;id&#x4E3A;content&#x7684;FrameLayout&#xFF09;&#x3002;</p>
<p>&#x5C06;Activity&#x7684;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x6DFB;&#x52A0;&#x81F3;id&#x4E3A;content&#x7684;FrameLayout&#x5185;&#x3002;</p>
</blockquote>
<p>&#x9898;&#x76EE;&#x53EB;&#x505A;Activity&#x7684;&#x52A0;&#x8F7D;&#x548C;&#x663E;&#x793A;&#xFF0C;&#x524D;&#x9762;&#x8BB2;&#x7684;&#x90FD;&#x662F;Activity&#x7684;&#x52A0;&#x8F7D;&#xFF0C;&#x73B0;&#x5728;&#x8BB2;&#x8BB2;Activity&#x7684;&#x663E;&#x793A;&#x5427;&#xFF0C;&#x81F3;&#x4E8E;&#x4E3A;&#x4EC0;&#x4E48;&#x4F1A;&#x662F;&#x8FD9;&#x4E2A;&#x8C03;&#x7528;&#x987A;&#x5E8F;&#x6216;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#xFF0C;&#x90A3;&#x4E2A;&#x9700;&#x8981;&#x5355;&#x5F00;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x7EC6;&#x8BF4;&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x5206;&#x6790;&#x5177;&#x4F53;&#x7684;&#x52A0;&#x8F7D;&#x548C;&#x663E;&#x793A;&#x7684;&#x6E90;&#x7801;&#x8FC7;&#x7A0B;&#xFF0C;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x6765;&#x770B;Activity&#x4E2D;&#x7684;<strong>handleResumeActivity</strong>&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> android.app.ActivityThread;</span><br><span class="line"> <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleResumeActivity</span><span class="params">(IBinder token, <span class="keyword">boolean</span> finalStateRequest, <span class="keyword">boolean</span> isForward,</span><br><span class="line">String reason)</span> </span>{</span><br><span class="line">    <span class="keyword">final</span> ActivityClientRecord r = performResumeActivity(token, finalStateRequest, reason);</span><br><span class="line">        <span class="keyword">if</span> (r == <span class="keyword">null</span>) {</span><br><span class="line">            <span class="comment">// We didn&apos;t actually resume the activity, so skipping any follow-up actions.</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        }</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">if</span> (r.window == <span class="keyword">null</span> &amp;&amp; !a.mFinished &amp;&amp; willBeVisible) {</span><br><span class="line">            r.window = r.activity.getWindow();</span><br><span class="line">            View decor = r.window.getDecorView();</span><br><span class="line">            decor.setVisibility(View.INVISIBLE);</span><br><span class="line">            ViewManager wm = a.getWindowManager();</span><br><span class="line">            WindowManager.LayoutParams l = r.window.getAttributes();</span><br><span class="line">            a.mDecor = decor;</span><br><span class="line">            l.type = WindowManager.LayoutParams.TYPE_BASE_APPLICATION;</span><br><span class="line">            l.softInputMode |= forwardBit;</span><br><span class="line">            <span class="keyword">if</span> (r.mPreserveWindow) {</span><br><span class="line">                a.mWindowAdded = <span class="keyword">true</span>;</span><br><span class="line">                r.mPreserveWindow = <span class="keyword">false</span>;</span><br><span class="line">                <span class="comment">// Normally the ViewRoot sets up callbacks with the Activity</span></span><br><span class="line">                <span class="comment">// in addView-&gt;ViewRootImpl#setView. If we are instead reusing</span></span><br><span class="line">                <span class="comment">// the decor view we have to notify the view root that the</span></span><br><span class="line">                <span class="comment">// callbacks may have changed.</span></span><br><span class="line">                ViewRootImpl impl = decor.getViewRootImpl();</span><br><span class="line">                <span class="keyword">if</span> (impl != <span class="keyword">null</span>) {</span><br><span class="line">                    impl.notifyChildRebuilt();</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span> (a.mVisibleFromClient) {</span><br><span class="line">                <span class="keyword">if</span> (!a.mWindowAdded) {</span><br><span class="line">                    a.mWindowAdded = <span class="keyword">true</span>;</span><br><span class="line">                    wm.addView(decor, l);</span><br><span class="line">                } <span class="keyword">else</span> {</span><br><span class="line">                    <span class="comment">// The activity will get a callback for this {@link LayoutParams} change</span></span><br><span class="line">                    <span class="comment">// earlier. However, at that time the decor will not be set (this is set</span></span><br><span class="line">                    <span class="comment">// in this method), so no action will be taken. This call ensures the</span></span><br><span class="line">                    <span class="comment">// callback occurs with the decor set.</span></span><br><span class="line">                    a.onWindowAttributesChanged(l);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        ...</span><br></pre></td></tr></table></figure>
<p>performResumeActivity()&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x8FFD;&#x5230;&#x5E95;&#xFF0C;&#x5176;&#x4E3B;&#x8981;&#x5C31;&#x662F;Instrumentation&#x8C03;&#x7528;&#x4E86;Acitivy&#x7684;onResume()&#x65B9;&#x6CD5;&#xFF0C;&#x6211;&#x4EEC;&#x4E86;&#x89E3;&#x5C31;&#x597D;&#xFF0C;&#x7136;&#x540E;&#x4E3B;&#x8981;&#x8981;&#x770B;&#x7684;&#x662F;wm.addView(decor, l);&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x662F;&#x8981;&#x52A8;&#x771F;&#x683C;&#x7684;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x7EE7;&#x7EED;&#x5F80;&#x4E0B;&#x8FFD;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> android.view;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ViewManager</span></span><br><span class="line"></span>{</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Assign the passed LayoutParams to the passed View and add the view to the window.</span><br><span class="line">     * &lt;p&gt;Throws {<span class="doctag">@link</span> android.view.WindowManager.BadTokenException} for certain programming</span><br><span class="line">     * errors, such as adding a second view to a window without removing the first view.</span><br><span class="line">     * &lt;p&gt;Throws {<span class="doctag">@link</span> android.view.WindowManager.InvalidDisplayException} if the window is on a</span><br><span class="line">     * secondary {<span class="doctag">@link</span> Display} and the specified display can&apos;t be found</span><br><span class="line">     * (see {<span class="doctag">@link</span> android.app.Presentation}).</span><br><span class="line">     * <span class="doctag">@param</span> view The view to be added to this window.</span><br><span class="line">     * <span class="doctag">@param</span> params The LayoutParams to assign to view.</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addView</span><span class="params">(View view, ViewGroup.LayoutParams params)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateViewLayout</span><span class="params">(View view, ViewGroup.LayoutParams params)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeView</span><span class="params">(View view)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>addView&#x662F;&#x63A5;&#x53E3;ViewManager&#x7684;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x5F88;&#x8BE7;&#x5F02;&#x7684;&#x662F;wm&#x6CA1;&#x8BB0;&#x9519;&#x7684;&#x8BDD;&#x5E94;&#x8BE5;&#x662F;windowManager&#x7684;&#x5B9E;&#x4F8B;&#x554A;&#xFF0C;&#x600E;&#x4E48;&#x6210;&#x4E86;ViewManager&#x4E86;&#xFF1F;&#x6211;&#x4EEC;&#x770B;&#x4E00;&#x4E0B;<strong>handleResumeActivity</strong>&#x7684;&#x8FD9;&#x884C;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ViewManager wm = a.getWindowManager();</span><br></pre></td></tr></table></figure>
<p>&#x901A;&#x8FC7;&#x8FFD;&#x8E2A;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x53D1;&#x73B0;&#x5176;&#x5B9E;&#x8FD9;&#x91CC;&#x7684;&#x8BBE;&#x8BA1;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> android.view;</span><br><span class="line"><span class="annotation">@SystemService</span>(Context.WINDOW_SERVICE)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">WindowManager</span> <span class="keyword">extends</span> <span class="title">ViewManager</span> </span>{</span><br><span class="line">    ...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>WindowManager&#x63A5;&#x53E3;&#x7EE7;&#x627F;&#x4E86;ViewManager&#x63A5;&#x53E3;&#xFF0C;&#x4ECE;&#x800C;&#x5728;&#x52A0;&#x8F7D;View&#x65F6;&#x5C31;&#x4F7F;&#x7528;&#x4E86;ViewManager&#x4E2D;&#x7684;addView&#x65B9;&#x6CD5;&#xFF0C;&#x73B0;&#x5728;&#x53EF;&#x4EE5;&#x77E5;&#x9053;&#x7684;&#x662F;addView&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x62BD;&#x8C61;&#x65B9;&#x6CD5;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x627E;&#x5230;WindowManager&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#xFF0C;&#x67E5;&#x770B;addView&#x7684;&#x6E90;&#x7801;&#x800C;<strong>WindowManagerImpl</strong>&#x5C31;&#x662F;WindowManager&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#xFF0C;&#x6211;&#x4EEC;&#x67E5;&#x770B;&#x8FD9;&#x4E2A;&#x7C7B;&#x7684;addView&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> android.view;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">WindowManagerImpl</span> <span class="keyword">implements</span> <span class="title">WindowManager</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> WindowManagerGlobal mGlobal = WindowManagerGlobal.getInstance();</span><br><span class="line">    ...</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addView</span><span class="params">(@NonNull View view, @NonNull ViewGroup.LayoutParams params)</span> </span>{</span><br><span class="line">        applyDefaultToken(params);</span><br><span class="line">        mGlobal.addView(view, params, mContext.getDisplay(), mParentWindow);</span><br><span class="line">    }</span><br><span class="line">    ...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x5176;&#x5B9E;&#x672C;&#x8D28;&#x4E0A;&#x8C03;&#x7528;&#x7684;&#x662F;WindowManagerGlobal&#x7684;addView&#x65B9;&#x6CD5;&#xFF0C;&#x6211;&#x4EEC;&#x8FDB;&#x53BB;&#x770B;&#x4E00;&#x4E0B;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> android.view;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">WindowManagerGlobal</span> </span>{</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addView</span><span class="params">(View view, ViewGroup.LayoutParams params,</span><br><span class="line">            Display display, Window parentWindow)</span> </span>{</span><br><span class="line">    ...</span><br><span class="line">    root = <span class="keyword">new</span> ViewRootImpl(view.getContext(), display);</span><br><span class="line">    ...</span><br><span class="line">    root.setView(view, wparams, panelParentView);</span><br><span class="line">    ...</span><br><span class="line">}</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x4E3B;&#x8981;&#x7684;&#x4E00;&#x4E2A;&#x4F5C;&#x7528;&#x662F;&#x8C03;&#x7528;&#x4E86;ViewRootImpl&#x7684;setView&#x65B9;&#x6CD5;&#xFF0C;&#x6211;&#x4EEC;&#x7EE7;&#x7EED;&#x8FFD;&#x8E2A;:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> android.view.ViewRootImpl;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setView</span><span class="params">(View view, WindowManager.LayoutParams attrs, View panelParentView)</span> </span>{</span><br><span class="line"> <span class="keyword">synchronized</span> (<span class="keyword">this</span>) {</span><br><span class="line">            <span class="keyword">if</span> (mView == <span class="keyword">null</span>) {</span><br><span class="line">                mView = view; </span><br><span class="line">                ...</span><br><span class="line">               requestLayout();</span><br><span class="line">                ...</span><br><span class="line">              view.assignParent(<span class="keyword">this</span>);    </span><br><span class="line">            }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x9996;&#x5148;&#xFF0C;&#x6B64;&#x65B9;&#x6CD5;&#x4F1A;&#x628A;&#x4E4B;&#x524D;&#x4F20;&#x8FDB;&#x6765;&#x7684;&#x53C2;&#x6570;view&#x8D4B;&#x503C;&#x7ED9;mView&#xFF0C;mView&#x5176;&#x5B9E;&#x5C31;&#x662F;<strong>handleResumeActivity</strong>&#x4E2D;&#x7684;wm.addView&#x65F6;&#x4F20;&#x8FDB;&#x6765;&#x7684;DecorView,&#x800C;DecorView&#x53C8;&#x662F;&#x4E00;&#x4E2A;FrameLayout&#xFF0C;&#x8FD9;&#x91CC;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x5C06;setContentView&#x6240;&#x505A;&#x7684;&#x4E00;&#x5207;&#x521D;&#x59CB;&#x5316;&#x64CD;&#x4F5C;&#x7684;DecorView&#x8BBE;&#x7F6E;&#x6210;&#x8FD9;&#x4E2A;Activity&#x7684;&#x6700;&#x57FA;&#x7840;&#x7684;&#x89C6;&#x56FE;&#x6846;&#x67B6;&#xFF0C;&#x5177;&#x4F53;&#x89C1;&#x4EE3;&#x7801;&#xFF1A;</p>
<blockquote>
<p>view.assignParent(this); </p>
</blockquote>
<p>&#x7136;&#x540E;&#x8C03;&#x7528;&#x4E86;<strong>requestLayout()</strong>&#x65B9;&#x6CD5;&#x6765;&#x663E;&#x793A;&#x754C;&#x9762;&#x5185;&#x5BB9;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> android.view.ViewRootImpl;</span><br><span class="line"><span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestLayout</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (!mHandlingLayoutInLayoutRequest) {</span><br><span class="line">            checkThread();</span><br><span class="line">            mLayoutRequested = <span class="keyword">true</span>;</span><br><span class="line">            scheduleTraversals();</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>
<p>&#x5148;&#x5224;&#x65AD;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x662F;&#x4E0D;&#x662F;&#x4E3B;&#x7EBF;&#x7A0B;&#xFF0C;&#x7136;&#x540E;&#x5C31;&#x8C03;&#x7528;&#x4E86;<strong>scheduleTraversals()</strong>&#x65B9;&#x6CD5;&#xFF0C;&#x7EE7;&#x7EED;&#x8DDF;&#x8FDB;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> android.view.ViewRootImpl;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">scheduleTraversals</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (!mTraversalScheduled) {</span><br><span class="line">            mTraversalScheduled = <span class="keyword">true</span>;</span><br><span class="line">            mTraversalBarrier = mHandler.getLooper().getQueue().postSyncBarrier();</span><br><span class="line">            mChoreographer.postCallback(</span><br><span class="line">                    Choreographer.CALLBACK_TRAVERSAL, mTraversalRunnable, <span class="keyword">null</span>);</span><br><span class="line">            <span class="keyword">if</span> (!mUnbufferedInputDispatch) {</span><br><span class="line">                scheduleConsumeBatchedInput();</span><br><span class="line">            }</span><br><span class="line">            notifyRendererOfFramePending();</span><br><span class="line">            pokeDrawLockIfNeeded();</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>
<p> mChoreographer.postCallback(<br>&#x200B;                    Choreographer.CALLBACK_TRAVERSAL, mTraversalRunnable, null);&#x901A;&#x8FC7;&#x8DDF;&#x8FDB;&#x6E90;&#x7801;&#x5F97;&#x77E5;&#x5176;&#x672C;&#x8D28;&#x5C31;&#x662F;&#x901A;&#x8FC7;handler&#x53D1;&#x9001;&#x6D88;&#x606F;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5173;&#x6CE8;&#x7684;&#x91CD;&#x70B9;&#x5C31;&#x5E94;&#x8BE5;&#x662F;<strong>mTraversalRunnable</strong>&#x8FD9;&#x4E2A;Runnable&#x63A5;&#x53E3;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> android.view.ViewRootImpl;</span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">TraversalRunnable</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>{</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</span><br><span class="line">            doTraversal();</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>
<p>&#x8FDB;<strong>doTraversal</strong>&#x65B9;&#x6CD5;&#x770B;&#x770B;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">doTraversal</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (mTraversalScheduled) {</span><br><span class="line">            mTraversalScheduled = <span class="keyword">false</span>;</span><br><span class="line">            mHandler.getLooper().getQueue().removeSyncBarrier(mTraversalBarrier);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (mProfile) {</span><br><span class="line">                Debug.startMethodTracing(<span class="string">&quot;ViewAncestor&quot;</span>);</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            performTraversals();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (mProfile) {</span><br><span class="line">                Debug.stopMethodTracing();</span><br><span class="line">                mProfile = <span class="keyword">false</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>
<p>&#x7EE7;&#x7EED;&#x8DDF;&#x8FDB;<strong>performTraversals</strong>&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">performTraversals</span><span class="params">()</span> </span>{</span><br><span class="line"><span class="keyword">int</span> childWidthMeasureSpec = getRootMeasureSpec(mWidth, lp.width);</span><br><span class="line"><span class="keyword">int</span> childHeightMeasureSpec = getRootMeasureSpec(mHeight, lp.height);</span><br><span class="line">...</span><br><span class="line"> <span class="comment">// Ask host how big it wants to be</span></span><br><span class="line">performMeasure(childWidthMeasureSpec, childHeightMeasureSpec);</span><br><span class="line">...</span><br><span class="line">performLayout(lp, mWidth, mHeight);</span><br><span class="line">...</span><br><span class="line">performDraw();</span><br><span class="line">...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x903B;&#x8F91;&#x975E;&#x5E38;&#x957F;&#xFF0C;&#x53CD;&#x6B63;&#x6211;&#x662F;&#x6CA1;&#x770B;&#x5B8C;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6CE8;&#x610F;&#x5230;&#xFF0C;&#x8FD9;&#x4E09;&#x4E2A;&#x65B9;&#x6CD5;&#x548C;&#x4E24;&#x4E2A;&#x5C5E;&#x6027;&#x7684;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x5176;&#x4E3B;&#x8981;&#x4F5C;&#x7528;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x5BF9;&#x57FA;&#x7840;&#x7684;&#x6839;&#x8282;&#x70B9;View&#x8FDB;&#x884C;View&#x7684;&#x521D;&#x59CB;&#x5316;&#x64CD;&#x4F5C;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x5E38;&#x8BF4;&#x7684;onMeasure(&#x6D4B;&#x91CF;)&#x3001;onLayout(&#x5E03;&#x5C40;)&#x548C;onDraw(&#x7ED8;&#x5236;)&#xFF0C;&#x800C;childWidthMeasureSpec&#x548C;childHeightMeasureSpec&#x4E3B;&#x8981;&#x7684;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x4E3A;&#x6D4B;&#x91CF;&#x63D0;&#x4F9B;&#x6D4B;&#x91CF;&#x89C4;&#x683C;&#xFF0C;&#x8FD9;&#x91CC;&#x5177;&#x4F53;&#x7684;&#x5185;&#x5BB9;&#x53EF;&#x4EE5;&#x770B;&#x6211;&#x7684;&#x53E6;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#xFF1A;<a href="https://jasoncool.github.io/2017/06/15/Android%E8%87%AA%E5%AE%9A%E4%B9%89View%E7%9A%84%E6%B5%8B%E9%87%8F%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3/" target="_blank" rel="external">Android&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x8BE6;&#x89E3;</a></p>
<h2 id="&#x603B;&#x7ED3;">&#x603B;&#x7ED3;</h2><p>&#x5343;&#x8A00;&#x4E07;&#x8BED;&#x7684;&#x603B;&#x7ED3;&#x4E0D;&#x5982;&#x6700;&#x540E;&#x7ED8;&#x6210;&#x4E00;&#x5F20;&#x56FE;&#x6765;&#x7684;&#x6E05;&#x6670;&#x660E;&#x4E86;&#xFF1A;</p>
<p><img src="/2019/03/29/Android-9-Activity&#x7684;&#x52A0;&#x8F7D;&#x548C;&#x663E;&#x793A;/3.png" alt="logo"></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[一次Android动画工具类的封装]]></title>
      <url>http://jasoncool.com/2018/11/21/%E4%B8%80%E6%AC%A1Android%E5%8A%A8%E7%94%BB%E5%B7%A5%E5%85%B7%E7%B1%BB%E7%9A%84%E5%B0%81%E8%A3%85/</url>
      <content type="html"><![CDATA[<h2 id="&#x8D77;&#x56E0;">&#x8D77;&#x56E0;</h2><p>&#x6700;&#x8FD1;&#x5728;&#x505A;&#x4E00;&#x4E2A;&#x7EC4;&#x4EF6;&#x5316;&#x6846;&#x67B6;&#x7684;&#x5C01;&#x88C5;&#xFF0C;&#x73B0;&#x5728;&#x5F00;&#x53D1;&#x5230;&#x4E00;&#x4E9B;&#x5E38;&#x7528;&#x5DE5;&#x5177;&#x7C7B;&#x7684;&#x5C01;&#x88C5;&#x4E86;&#xFF0C;&#x7A81;&#x7136;&#x610F;&#x8BC6;&#x5230;&#x597D;&#x50CF;&#x8FD8;&#x6CA1;&#x6709;&#x505A;&#x52A8;&#x753B;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#xFF0C;&#x4E8E;&#x662F;&#x5F00;&#x59CB;&#x7740;&#x624B;&#x5F00;&#x53D1;&#x4E4B;&#x3002;</p>
<h2 id="&#x601D;&#x8DEF;">&#x601D;&#x8DEF;</h2><p>&#x65E2;&#x7136;&#x8981;&#x505A;&#x52A8;&#x753B;&#xFF0C;&#x80AF;&#x5B9A;&#x662F;&#x8981;&#x505A;&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#x7684;&#x5C01;&#x88C5;&#x4E86;&#xFF0C;&#x7531;&#x4E8E;&#x8865;&#x95F4;&#x52A8;&#x753B;&#x548C;&#x9010;&#x5E27;&#x52A8;&#x753B;&#x5E76;&#x4E0D;&#x80FD;&#x6539;&#x53D8;&#x76EE;&#x6807;&#x52A8;&#x753B;&#x4E3B;&#x9898;&#x7684;&#x5B9E;&#x9645;&#x5C5E;&#x6027;&#xFF0C;&#x5728;Android&#x7684;&#x5F00;&#x53D1;&#x4E2D;&#x5DF2;&#x7ECF;&#x8D8A;&#x6765;&#x8D8A;&#x5C11;&#x4EBA;&#x53BB;&#x7528;&#x8FD9;&#x4E24;&#x4E2A;&#x52A8;&#x753B;&#x6846;&#x67B6;&#x505A;&#x5F00;&#x53D1;&#x4E86;&#xFF0C;&#x800C;&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x5219;&#x76F8;&#x5BF9;&#x7684;&#x8D8A;&#x6765;&#x8D8A;&#x5E7F;&#x6CDB;&#x7684;&#x4F7F;&#x7528;&#x5728;&#x5F00;&#x53D1;&#x8FC7;&#x7A0B;&#x4E2D;&#x4E86;&#xFF0C;&#x4E8E;&#x662F;&#x8FD9;&#x6B21;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#x7684;&#x5C01;&#x88C5;&#xFF0C;&#x53EA;&#x9488;&#x5BF9;&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x6765;&#x5C01;&#x88C5;&#x3002;</p>
<p>&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x5BF9;&#x5E94;&#x7684;&#x7C7B;&#x53EB;&#x505A;ObjectAnimator,&#x4E3B;&#x8981;&#x5C31;&#x662F;&#x7528;&#x8FD9;&#x4E2A;&#x7C7B;&#x6765;&#x5B9E;&#x73B0;&#x52A8;&#x753B;&#x7684;&#x4E00;&#x4E9B;&#x57FA;&#x7840;&#x8BBE;&#x7F6E;&#xFF0C;&#x5176;&#x5177;&#x4F53;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x6211;&#x5C31;&#x4E0D;&#x5199;&#x4E86;&#xFF0C;&#x6709;&#x5174;&#x8DA3;&#x7684;&#x670B;&#x53CB;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x5B66;&#x4E60;&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x7684;&#x76F8;&#x5173;&#x77E5;&#x8BC6;&#x3002;</p>
<a id="more"></a>
<p>&#x5C01;&#x88C5;&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x5DE5;&#x5177;&#x7C7B;&#x4E0D;&#x53EF;&#x907F;&#x514D;&#x7684;&#x8FD8;&#x8981;&#x8003;&#x8651;&#x5230;&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x7684;&#x7EC4;&#x5408;&#x64AD;&#x653E;&#x52A8;&#x753B;&#x7684;&#x9700;&#x6C42;&#xFF0C;&#x800C;&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x7684;&#x7EC4;&#x5408;&#x64AD;&#x653E;&#x6709;&#x5927;&#x7EA6;&#x4E09;&#x79CD;&#x65B9;&#x5F0F;&#xFF1A;</p>
<p>1.&#x4F7F;&#x7528;AnimatorSet&#x7684;Builder&#x6765;&#x7EC4;&#x5408;&#x64AD;&#x653E;<br>&#x200B;    AnimatorSet.Builder&#x662F;&#x4E00;&#x4E2A;&#x4F7F;&#x7528;&#x7684;&#x52A8;&#x753B;&#x5DE5;&#x5177;&#x7C7B;&#xFF0C;&#x7528;&#x4E8E;&#x65B9;&#x4FBF;&#x5411;AnimatorSet&#x6DFB;&#x52A0;&#x52A8;&#x753B;&#x4EE5;&#x53CA;&#x8BBE;&#x7F6E;&#x5404;&#x79CD;&#x52A8;&#x753B;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x3002;&#x5728;    AnimatorSet.Builder&#x4E2D;&#xFF0C;&#x5171;&#x58F0;&#x660E;&#x4E86;after(long)&#x3001;after(Animator)&#x3001;before(Animator)&#x3001;with(Animator)&#x7B49;&#x56DB;&#x4E2A;&#x65B9;&#x6CD5;&#x3002;</p>
<ul>
<li>after(delay) &#x8BBE;&#x7F6E;&#x52A8;&#x753B;&#x5EF6;&#x8FDF;delay&#x65F6;&#x95F4;&#x540E;&#x64AD;&#x653E;</li>
<li>after(anim) &#x8BBE;&#x7F6E;&#x5728;anim&#x52A8;&#x753B;&#x7ED3;&#x675F;&#x540E;&#x64AD;&#x653E;&#x6B64;&#x52A8;&#x753B;</li>
<li>before(anim) &#x8BBE;&#x7F6E;&#x6B64;&#x52A8;&#x753B;&#x65E9;&#x4E8E;anim&#x64AD;&#x653E;</li>
<li>with(anim) &#x8BBE;&#x7F6E;&#x6B64;&#x52A8;&#x753B;&#x4E0E;anim&#x4E00;&#x8D77;&#x64AD;&#x653E;</li>
</ul>
<p>&#x7136;&#x540E;&#x518D;&#x8C03;&#x7528;paly(anim)&#x65B9;&#x6CD5;&#x6765;&#x94FE;&#x5F0F;&#x8C03;&#x7528;&#x52A8;&#x753B;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AnimatorSet set=<span class="keyword">new</span> AnimatorSet();</span><br><span class="line">set.play(anim1).before(anim2).with(anim3).after(anim4);</span><br></pre></td></tr></table></figure>
<p>&#x6211;&#x4EEC;&#x6CE8;&#x610F;&#x5230;&#x4ED6;&#x662F;&#x5148;&#x6267;&#x884C;&#x7684;after&#xFF0C;&#x7136;&#x540E;&#x662F;play&#x548C;with&#x540C;&#x65F6;&#x6267;&#x884C;&#xFF0C;&#x6700;&#x540E;&#x6267;&#x884C;&#x7684;before&#x3002;&#x6240;&#x4EE5;&#x5927;&#x5BB6;&#x8BB0;&#x4F4F;&#x8FD9;&#x4E2A;&#x987A;&#x5E8F;&#xFF0C;&#x65E0;&#x8BBA;&#x600E;&#x4E48;&#x5199;&#xFF0C;&#x90FD;&#x662F;&#x8FD9;&#x4E2A;&#x6267;&#x884C;&#x987A;&#x5E8F;&#x3002;</p>
<p>2.&#x4F7F;&#x7528;AnimatorSet&#x7684;playSequentially</p>
<h3 id="API">API</h3><p>playSequentially(List items)&#xFF1A;&#x6DFB;&#x52A0;&#x4E00;&#x7EC4;&#x52A8;&#x753B;&#xFF0C;&#x64AD;&#x653E;&#x987A;&#x5E8F;&#x4E3A;&#x9010;&#x4E00;&#x64AD;&#x653E;<br>playSequentially(Animator&#x2026; items)&#xFF1A;&#x6DFB;&#x52A0;&#x4E00;&#x7EC4;&#x52A8;&#x753B;&#xFF0C;&#x64AD;&#x653E;&#x987A;&#x5E8F;&#x4E3A;&#x9010;&#x4E00;&#x64AD;&#x653E; </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">AnimatorSet bouncer = <span class="keyword">new</span> AnimatorSet();</span><br><span class="line">ObjectAnimator objectAnimatorA = ObjectAnimator.ofFloat(btnProperty, PropertyConstant.PROPERTY_TRANSLATION_X, <span class="number">0f</span>, <span class="number">300f</span>);</span><br><span class="line">ObjectAnimator objectAnimatorB = ObjectAnimator.ofFloat(btnProperty, PropertyConstant.PROPERTY_TRANSLATION_Y, <span class="number">0f</span>, <span class="number">300f</span>);</span><br><span class="line">ObjectAnimator objectAnimatorC = ObjectAnimator.ofFloat(btnProperty, PropertyConstant.PROPERTY_ROTATION, <span class="number">0f</span>, <span class="number">360f</span>);</span><br><span class="line"></span><br><span class="line">bouncer.playSequentially(objectAnimatorA, objectAnimatorB, objectAnimatorC);</span><br><span class="line"></span><br><span class="line">bouncer.setDuration(<span class="number">6000</span>);</span><br><span class="line">bouncer.start();</span><br></pre></td></tr></table></figure>
<p>3.&#x4F7F;&#x7528;AnimatorSet&#x7684;palyTogether</p>
<h3 id="API-1">API</h3><p>playTogether(Collection items)&#xFF1A;&#x6DFB;&#x52A0;&#x4E00;&#x7EC4;&#x52A8;&#x753B;&#xFF0C;&#x64AD;&#x653E;&#x987A;&#x5E8F;&#x4E3A;&#x4E00;&#x8D77;&#x64AD;&#x653E;<br>playTogether(Animator&#x2026; items)&#xFF1A;&#x6DFB;&#x52A0;&#x4E00;&#x7EC4;&#x52A8;&#x753B;&#xFF0C;&#x64AD;&#x653E;&#x987A;&#x5E8F;&#x4E3A;&#x4E00;&#x8D77;&#x64AD;&#x653E;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">AnimatorSet bouncer = <span class="keyword">new</span> AnimatorSet();</span><br><span class="line">ObjectAnimator objectAnimatorA = ObjectAnimator.ofFloat(btnProperty, PropertyConstant.PROPERTY_TRANSLATION_X, <span class="number">0f</span>, <span class="number">300f</span>);</span><br><span class="line">ObjectAnimator objectAnimatorB = ObjectAnimator.ofFloat(btnProperty, PropertyConstant.PROPERTY_TRANSLATION_Y, <span class="number">0f</span>, <span class="number">300f</span>);</span><br><span class="line">ObjectAnimator objectAnimatorC = ObjectAnimator.ofFloat(btnProperty, PropertyConstant.PROPERTY_ROTATION, <span class="number">0f</span>, <span class="number">360f</span>);</span><br><span class="line"></span><br><span class="line">bouncer.playSequentially(objectAnimatorA, objectAnimatorB, objectAnimatorC);</span><br><span class="line"></span><br><span class="line">bouncer.setDuration(<span class="number">6000</span>);</span><br><span class="line">bouncer.start();</span><br></pre></td></tr></table></figure>
<p>&#x638C;&#x63E1;&#x4EE5;&#x4E0A;&#x7684;&#x77E5;&#x8BC6;&#x70B9;&#x540E;&#xFF0C;&#x6211;&#x7684;&#x601D;&#x8DEF;&#x662F;&#xFF0C;&#x5176;&#x5B9E;&#x6700;&#x540E;&#x5C31;&#x662F;&#x5BF9;&#x6267;&#x884C;&#x65B9;&#x5F0F;&#x7684;&#x5C01;&#x88C5;&#xFF0C;&#x6240;&#x8C13;&#x7684;&#x6267;&#x884C;&#x65B9;&#x5F0F;&#x5C31;&#x662F;&#x5982;&#x4F55;&#x6B63;&#x5E38;&#x7684;&#x8C03;&#x7528;play,playSequentially&#x548C;playTogether&#x4E09;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x5408;&#x7406;&#x7684;&#x5C01;&#x88C5;&#x3002;</p>
<p>&#x8FD8;&#x6709;&#x5C31;&#x662F;&#x5BF9;&#x4E8E;&#x76D1;&#x542C;&#x63A5;&#x53E3;&#x7684;&#x5C01;&#x88C5;&#xFF0C;&#x6BCF;&#x4E2A;ObjectAnimator&#x90FD;&#x6709;&#x4E09;&#x4E2A;&#x63A5;&#x53E3;&#xFF1A;</p>
<ul>
<li><p>Animator.AnimatorListener  &#x5BF9;&#x6574;&#x4E2A;&#x52A8;&#x753B;&#x751F;&#x547D;&#x5468;&#x671F;&#x7684;&#x76D1;&#x542C;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">anim.addListener(<span class="keyword">new</span> Animator.AnimatorListener() {</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationStart</span><span class="params">(Animator animator)</span> </span>{</span><br><span class="line">            Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">&quot;start&quot;</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationEnd</span><span class="params">(Animator animator)</span> </span>{</span><br><span class="line">            Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">&quot;End&quot;</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationCancel</span><span class="params">(Animator animator)</span> </span>{</span><br><span class="line">            Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">&quot;Cancel&quot;</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationRepeat</span><span class="params">(Animator animator)</span> </span>{</span><br><span class="line">            Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">&quot;rapeat&quot;</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">        }</span><br><span class="line">    });</span><br><span class="line">    anim.start();</span><br></pre></td></tr></table></figure>
</li>
<li><p>ValueAnimator.AnimatorUpdateListener &#x5BF9;&#x4E8E;&#x8BE5;&#x52A8;&#x753B;&#x9010;&#x5E27;&#x7684;&#x76D1;&#x542C;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ValueAnimator vanim = ValueAnimator.ofInt(<span class="number">0</span>,<span class="number">10</span>,<span class="number">20</span>);</span><br><span class="line">    vanim.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() {</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator valueAnimator)</span> </span>{</span><br><span class="line"></span><br><span class="line">   <span class="comment">//&#x5982;&#x679C;&#x4E4B;&#x524D;&#x7684;ValueAnimtor&#x6307;&#x5B9A;&#x7684;&#x662F;Int&#x7684;i&#x8BDD;&#xFF0C;&#x90A3;&#x4E48;&#x8FD4;&#x56DE;&#x7684;Value&#x5C31;&#x662F;int&#x7C7B;&#x578B;&#xFF0C;</span></span><br><span class="line">   &#x4E5F;&#x5C31;&#x662F;&#x8FD4;&#x56DE;&#x503C;&#x7C7B;&#x578B;&#x4E0E;&#x4F60;&#x521B;&#x5EFA;&#x7684;&#x7C7B;&#x578B;&#x4E00;&#x81F4;</span><br><span class="line">            <span class="keyword">int</span> value = (<span class="keyword">int</span>) valueAnimator.getAnimatedValue();</span><br><span class="line">        }</span><br><span class="line">    });</span><br></pre></td></tr></table></figure>
</li>
<li><p>Animator.AnimatorPauseListener &#x5BF9;&#x4E8E;&#x8BE5;&#x52A8;&#x753B;&#x7684;&#x6682;&#x505C;&#x548C;&#x64AD;&#x653E;&#x7684;&#x76D1;&#x542C;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Animator.AnimatorPauseListener() {</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationPause</span><span class="params">(Animator animator)</span> </span>{</span><br><span class="line">                </span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationResume</span><span class="params">(Animator animator)</span> </span>{</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line">        }</span><br></pre></td></tr></table></figure>
<p>&#x7531;&#x4E8E;&#x6211;&#x7684;&#x521D;&#x6B65;&#x6784;&#x60F3;&#x662F;&#x4F7F;&#x7528;&#x5EFA;&#x9020;&#x8005;&#x6A21;&#x5F0F;&#x7684;&#x94FE;&#x5F0F;&#x8C03;&#x7528;&#x6A21;&#x5F0F;&#x6765;&#x8BBE;&#x8BA1;&#x6211;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#xFF0C;&#x5982;&#x679C;&#x6309;&#x7167;&#x666E;&#x901A;&#x7684;&#x5199;&#x6CD5;&#xFF0C;&#x90A3;&#x4E48;&#x6574;&#x4E2A;&#x76D1;&#x542C;&#x63A5;&#x53E3;&#x7684;&#x8BBE;&#x7F6E;&#x5C06;&#x4F1A;&#x662F;&#x707E;&#x96BE;&#x6027;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x6240;&#x6709;&#x7684;&#x76D1;&#x542C;&#x63A5;&#x53E3;&#x7684;&#x8BBE;&#x7F6E;&#x90FD;&#x662F;&#x6DF7;&#x4E71;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x5FC5;&#x987B;&#x5904;&#x7406;&#xFF0C;&#x6211;&#x7684;&#x601D;&#x8DEF;&#x662F;&#xFF0C;&#x5B66;&#x4E60;SpringSecurity&#x7684;&#x94FE;&#x5F0F;&#x8C03;&#x7528;&#x8BBE;&#x8BA1;&#xFF0C;&#x4E3A;&#x6BCF;&#x4E2A;&#x7C7B;&#x578B;&#x7684;&#x76D1;&#x542C;&#x8BBE;&#x7F6E;&#x81EA;&#x5DF1;&#x7684;&#x7C7B;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x8BA9;&#x5DE5;&#x5177;&#x4E3B;&#x7C7B;&#x8C03;&#x7528;&#x8BE5;&#x7C7B;&#x578B;&#x7684;&#x76D1;&#x542C;&#x63A5;&#x53E3;&#xFF0C;&#x7136;&#x540E;&#x8BBE;&#x7F6E;&#x5B8C;&#x6BD5;&#x540E;&#xFF0C;&#x5728;&#x901A;&#x8FC7;&#x8BE5;&#x76D1;&#x542C;&#x63A5;&#x53E3;&#x7C7B;&#x7684;and&#xFF08;&#xFF09;&#x65B9;&#x6CD5;&#x56DE;&#x5230;&#x5DE5;&#x5177;&#x7C7B;&#x7684;&#x4E3B;&#x7C7B;&#x578B;&#x6765;&#xFF0C;&#x8FD9;&#x6837;&#x5728;&#x94FE;&#x5F0F;&#x8C03;&#x7528;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x6709;&#x4E00;&#x4E2A;&#x8D77;&#x6B62;&#x987A;&#x5E8F;&#xFF0C;&#x4E0D;&#x4F1A;&#x6DF7;&#x4E71;&#x6267;&#x884C;&#x4E86;&#xFF0C;&#x800C;&#x4E14;&#x5982;&#x679C;&#x4E0D;&#x7528;&#x8BBE;&#x7F6E;&#x76D1;&#x542C;&#xFF0C;&#x4E0D;&#x8C03;&#x7528;&#x76D1;&#x542C;&#x7C7B;&#x8BBE;&#x7F6E;&#x4E5F;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x4E3B;&#x7C7B;&#x7684;&#x6267;&#x884C;&#x3002;</p>
<p>&#x622A;&#x53D6;&#x5173;&#x952E;&#x4EE3;&#x7801;,&#x4EE5;Play&#x65B9;&#x6CD5;&#x7684;&#x76D1;&#x542C;&#x63A5;&#x53E3;&#x8BBE;&#x7F6E;&#x4E3A;&#x4F8B;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">*&#x5DE5;&#x5177;&#x7C7B;&#x7684;&#x4E3B;&#x7C7B;</span><br><span class="line">**/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AnimatorSetWrap</span></span>{</span><br><span class="line">     PlayAnimationListener playListener;</span><br><span class="line">     <span class="function"><span class="keyword">public</span> PlayAnimationListener <span class="title">toAddPlayListener</span><span class="params">()</span></span>{</span><br><span class="line">            playListener=<span class="keyword">new</span> PlayAnimationListener(<span class="keyword">this</span>);</span><br><span class="line">            <span class="keyword">return</span> playListener;</span><br><span class="line">        }</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line">     * Play&#x65B9;&#x6CD5;&#x5BF9;&#x5E94;&#x7684;ObjectAnimator&#x7684;&#x76D1;&#x542C;&#x5B9E;&#x4F8B;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">PlayAnimationListener</span> <span class="keyword">implements</span> <span class="title">IAnimatorListener</span>&lt;<span class="title">PlayAnimationListener</span>&gt;</span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span>  Animator.AnimatorListener animatorListener;</span><br><span class="line">        <span class="keyword">private</span> ValueAnimator.AnimatorUpdateListener updateListener;</span><br><span class="line">        <span class="keyword">private</span> Animator.AnimatorPauseListener pauseListener;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> AnimatorSetWrap animatorSetWrap;</span><br><span class="line">        <span class="function"><span class="keyword">public</span>  <span class="title">PlayAnimationListener</span><span class="params">(AnimatorSetWrap animatorSetWrap)</span></span>{</span><br><span class="line">                <span class="keyword">this</span>.animatorSetWrap=animatorSetWrap;</span><br><span class="line">        }</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> PlayAnimationListener <span class="title">setAnimatorListener</span><span class="params">(Animator.AnimatorListener animatorListener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.animatorListener=animatorListener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> PlayAnimationListener <span class="title">setUpdateListener</span><span class="params">(ValueAnimator.AnimatorUpdateListener animatorListener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.updateListener=animatorListener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> PlayAnimationListener <span class="title">setPauseListener</span><span class="params">(Animator.AnimatorPauseListener animatorListener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.pauseListener=animatorListener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">and</span><span class="params">()</span></span>{</span><br><span class="line">            <span class="keyword">return</span> animatorSetWrap;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line">     * &#x52A8;&#x753B;&#x76D1;&#x542C;&#x7684;&#x516C;&#x7528;&#x6A21;&#x677F;&#x63A5;&#x53E3;</span><br><span class="line">     * <span class="doctag">@param</span> &lt;T&gt;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">IAnimatorListener</span>&lt;<span class="title">T</span>&gt;</span>{</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x8BBE;&#x7F6E;AnimatorListener&#x7684;&#x65B9;&#x6CD5;</span><br><span class="line">         * <span class="doctag">@param</span> listener</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function">T <span class="title">setAnimatorListener</span><span class="params">(Animator.AnimatorListener listener)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x8BBE;&#x7F6E;AnimatorUpdateListener&#x7684;&#x65B9;&#x6CD5;</span><br><span class="line">         * <span class="doctag">@param</span> listener</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function">T <span class="title">setUpdateListener</span><span class="params">(ValueAnimator.AnimatorUpdateListener listener)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x8BBE;&#x7F6E;AnimatorPauseListener&#x7684;&#x65B9;&#x6CD5;</span><br><span class="line">         * <span class="doctag">@param</span> listener</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function">T <span class="title">setPauseListener</span><span class="params">(Animator.AnimatorPauseListener listener)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x6865;&#x63A5;&#x52A8;&#x753B;&#x76D1;&#x542C;&#x4E0E;&#x52A8;&#x753B;&#x5DE5;&#x5177;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function">AnimatorSetWrap <span class="title">and</span><span class="params">()</span></span>;</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>
<p>&#x5177;&#x4F53;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">AnimatorUtil.AnimatorSetWrap  animatorSetWrapDemo=<span class="keyword">new</span> AnimatorSetWrap().toAddPlayListener().setUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() {</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator valueAnimator)</span> </span>{</span><br><span class="line">                LogUtils.e(<span class="string">&quot;&#x6570;&#x503C;:&quot;</span>+valueAnimator.getAnimatedValue());</span><br><span class="line">            }</span><br><span class="line">        }).and();</span><br></pre></td></tr></table></figure>
<p>&#x901A;&#x8FC7;&#x8FD9;&#x79CD;&#x94FE;&#x5F0F;&#x8C03;&#x7528;&#xFF0C;&#x53EA;&#x8981;&#x8C03;&#x7528;&#x5230;and()&#x65B9;&#x6CD5;&#x5C31;&#x53C8;&#x56DE;&#x5230;&#x4E86;AnimatorSetWrap&#x5DE5;&#x5177;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#xFF0C;&#x5269;&#x4E0B;&#x5C31;&#x53EF;&#x4EE5;&#x7EE7;&#x7EED;&#x8C03;&#x7528;&#x5176;&#x4ED6;&#x52A8;&#x753B;&#x7684;&#x65B9;&#x6CD5;&#x5E76;&#x64AD;&#x653E;&#x52A8;&#x753B;&#x4E86;&#x3002;</p>
<h2 id="&#x4EE3;&#x7801;">&#x4EE3;&#x7801;</h2><p>&#x8BF4;&#x4E86;&#x8FD9;&#x4E48;&#x591A;&#xFF0C;&#x5C31;&#x628A;&#x6211;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#x4EE3;&#x7801;&#x5206;&#x4EAB;&#x7ED9;&#x5927;&#x5BB6;&#x5427;&#xFF0C;&#x53EF;&#x80FD;&#x8FD8;&#x4E0D;&#x5B8C;&#x5584;&#xFF0C;&#x6709;&#x4EC0;&#x4E48;&#x95EE;&#x9898;&#x5927;&#x5BB6;&#x4E00;&#x8D77;&#x63A2;&#x8BA8;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> android.animation.Animator;</span><br><span class="line"><span class="keyword">import</span> android.animation.AnimatorSet;</span><br><span class="line"><span class="keyword">import</span> android.animation.ObjectAnimator;</span><br><span class="line"><span class="keyword">import</span> android.animation.TimeInterpolator;</span><br><span class="line"><span class="keyword">import</span> android.animation.ValueAnimator;</span><br><span class="line"><span class="keyword">import</span> android.os.Build;</span><br><span class="line"><span class="keyword">import</span> android.support.annotation.Nullable;</span><br><span class="line"><span class="keyword">import</span> android.support.annotation.Size;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.animation.LinearInterpolator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * &#x52A8;&#x753B;&#x5DE5;&#x5177;&#x7C7B;</span><br><span class="line"> *<span class="doctag">@package</span> com.dhcc.commonutils</span><br><span class="line"> *<span class="doctag">@author</span> jasoncool</span><br><span class="line"> *<span class="doctag">@createDate</span> 2018/11/20 16:16</span><br><span class="line"> *<span class="doctag">@description</span></span><br><span class="line"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnimatorUtils</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String ALPHA=<span class="string">&quot;Alpha&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TRANSX=<span class="string">&quot;TranslationX&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TRANSY=<span class="string">&quot;TranslationY&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String SCALEX=<span class="string">&quot;ScaleX&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String SCALEY=<span class="string">&quot;ScaleY&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String ROTATION=<span class="string">&quot;Rotation&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String ROTATIONX=<span class="string">&quot;RotationX&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String ROTATIONY=<span class="string">&quot;RotationY&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x9ED8;&#x8BA4;&#x7684;TimeInterpolator,&#x524D;&#x540E;&#x51CF;&#x901F;&#xFF0C;&#x4E2D;&#x95F4;&#x52A0;&#x901F;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> TimeInterpolator sDefaultInterpolator =</span><br><span class="line">            <span class="keyword">new</span> LinearInterpolator();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> AnimatorSetWrap <span class="title">createAnimator</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AnimatorSetWrap();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * <span class="doctag">@param</span> interpolator &#x9ED8;&#x8BA4;&#x7684;TimeInterpolator</span><br><span class="line">     * <span class="doctag">@return</span></span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> AnimatorSetWrap <span class="title">createAnimator</span><span class="params">(TimeInterpolator interpolator)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AnimatorSetWrap(interpolator);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x5C5E;&#x6027;&#x52A8;&#x753B;&#x7EC4;&#x5408;</span><br><span class="line">     * &#x5C5E;&#x6027;&#x52A8;&#x753B;&#x7EC4;&#x5408;&#x5BF9;&#x5E94;&#x7684;&#x662F;AnimatorSet&#x7C7B;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;new&#x4ED6;&#x5C31;&#x597D;&#x3002;</span><br><span class="line">     *</span><br><span class="line">     * &#x5B83;&#x5BF9;&#x5E94;&#x7684;&#x4E3B;&#x8981;&#x6709;&#x8FD9;&#x56DB;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;play&#xFF0C;before&#xFF0C;with&#xFF0C;after&#x3002;</span><br><span class="line">     * &#x8FD9;&#x56DB;&#x4E2A;&#x65B9;&#x6CD5;&#x91CC;&#x9762;&#x5168;&#x90FD;&#x662F;&#x586B;&#x5165;&#x5F80;&#x540E;&#x513F;&#x4EEC;&#x7684;animator&#x7C7B;&#xFF0C;</span><br><span class="line">     * &#x4F46;&#x662F;&#x5148;&#x540E;&#x6267;&#x884C;&#x987A;&#x5E8F;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x5206;&#x522B;&#x5BF9;&#x5E94;&#x7740;&#x5F00;&#x542F;&#xFF0C;&#x6700;&#x540E;&#xFF0C;&#x540C;&#x6B65;&#xFF0C;&#x6700;&#x5F00;&#x59CB;&#x6267;&#x884C;&#x3002;</span><br><span class="line">     * &#x6211;&#x4EEC;&#x6CE8;&#x610F;&#x5230;&#x4ED6;&#x662F;&#x5148;&#x6267;&#x884C;&#x7684;after&#xFF0C;&#x7136;&#x540E;&#x662F;play&#x548C;with&#x540C;&#x65F6;&#x6267;&#x884C;&#xFF0C;&#x6700;&#x540E;&#x6267;&#x884C;&#x7684;before&#x3002;</span><br><span class="line">     * &#x6240;&#x4EE5;&#x5927;&#x5BB6;&#x8BB0;&#x4F4F;&#x8FD9;&#x4E2A;&#x987A;&#x5E8F;&#xFF0C;&#x65E0;&#x8BBA;&#x600E;&#x4E48;&#x5199;&#xFF0C;&#x90FD;&#x662F;&#x8FD9;&#x4E2A;&#x6267;&#x884C;&#x987A;&#x5E8F;&#x3002;</span><br><span class="line">     *</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AnimatorSetWrap</span></span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> View mView;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x4E0D;&#x8BBE;&#x7F6E;&#x9ED8;&#x8BA4;&#x63D2;&#x503C;&#x5668;&#x65F6;&#xFF0C;&#x5DE5;&#x5177;&#x7C7B;&#x81EA;&#x5E26;&#x7684;&#x9ED8;&#x8BA4;&#x63D2;&#x503C;&#x5668;</span><br><span class="line">         */</span></span><br><span class="line">        <span class="keyword">private</span> TimeInterpolator mTimeInterpolator;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x5224;&#x65AD;play&#x65B9;&#x6CD5;&#x53EA;&#x5141;&#x8BB8;&#x6267;&#x884C;&#x4E00;&#x6B21;&#x7684;&#x5E03;&#x5C14;&#x503C;</span><br><span class="line">         */</span></span><br><span class="line">        <span class="keyword">boolean</span> mIsPlaying=<span class="keyword">false</span>;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x8054;&#x5408;&#x52A8;&#x753B;&#x7684;&#x52A8;&#x753B;&#x5BB9;&#x5668;</span><br><span class="line">         */</span></span><br><span class="line">        <span class="keyword">private</span> AnimatorSet mAnimatorSet;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x8054;&#x5408;&#x52A8;&#x753B;&#x7684;&#x52A8;&#x753B;&#x6784;&#x9020;&#x5668;</span><br><span class="line">         */</span></span><br><span class="line">        <span class="keyword">private</span> AnimatorSet.Builder mAnimatorBuilder;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x9ED8;&#x8BA4;&#x6267;&#x884C;&#x65F6;&#x95F4;</span><br><span class="line">         */</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> mDuration=<span class="number">1000</span>;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * play&#x7684;&#x76D1;&#x542C;&#x5668;&#x7C7B;</span><br><span class="line">         */</span></span><br><span class="line">        PlayAnimationListener playListener;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * before&#x7684;&#x76D1;&#x542C;&#x5668;&#x7C7B;</span><br><span class="line">         */</span></span><br><span class="line">        BeforeAnimationListener beforeListener;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * with&#x7684;&#x76D1;&#x542C;&#x5668;&#x7C7B;</span><br><span class="line">         */</span></span><br><span class="line">        WithAnimationListener withListener;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * after&#x7684;&#x76D1;&#x542C;&#x5668;&#x7C7B;</span><br><span class="line">         */</span></span><br><span class="line">        AfterAnimationListener afterListener;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * then&#x7684;&#x76D1;&#x542C;&#x5668;&#x7C7B;</span><br><span class="line">         */</span></span><br><span class="line">        ThenAnimationListener thenListener;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x987A;&#x5E8F;&#x64AD;&#x653E;&#x6216;&#x8005;&#x540C;&#x65F6;&#x64AD;&#x653E;&#x65F6;&#x5B58;&#x50A8;&#x52A8;&#x753B;&#x7684;&#x5217;&#x8868;&#x5BB9;&#x5668;</span><br><span class="line">         */</span></span><br><span class="line">        List&lt;Animator&gt; mAnimatorList;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x521D;&#x59CB;&#x5316;then&#x52A8;&#x753B;</span><br><span class="line">         */</span></span><br><span class="line">        <span class="keyword">boolean</span> mHasInitThenAnim=<span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="title">AnimatorSetWrap</span><span class="params">()</span></span>{</span><br><span class="line">          <span class="keyword">this</span>(sDefaultInterpolator);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x6784;&#x9020;&#x65B9;&#x6CD5;</span><br><span class="line">         * &#x4E3B;&#x8981;&#x662F;&#x8D1F;&#x8D23;</span><br><span class="line">         * 1.&#x521D;&#x59CB;&#x5316;&#x9ED8;&#x8BA4;&#x7684;&#x63D2;&#x503C;&#x5668; mTimeInterpolator</span><br><span class="line">         * 2.&#x521D;&#x59CB;&#x5316;&#x8054;&#x5408;&#x52A8;&#x753B;Set mAnimatorSet</span><br><span class="line">         * 3.&#x521D;&#x59CB;&#x5316;&#x987A;&#x5E8F;&#x6216;&#x540C;&#x65F6;&#x64AD;&#x653E;&#x52A8;&#x753B;&#x5BB9;&#x5668; mAnimatorList</span><br><span class="line">         * <span class="doctag">@param</span> interpolator</span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="title">AnimatorSetWrap</span><span class="params">(TimeInterpolator interpolator)</span> </span>{</span><br><span class="line">            mTimeInterpolator = interpolator;</span><br><span class="line">            mAnimatorSet = <span class="keyword">new</span> AnimatorSet();</span><br><span class="line">            mAnimatorList=<span class="keyword">new</span> ArrayList&lt;&gt;(<span class="number">16</span>);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * Play&#x52A8;&#x753B;&#x7684;&#x76D1;&#x542C;&#x542F;&#x52A8;&#x65B9;&#x6CD5;</span><br><span class="line">         * &#x5982;&#x679C;&#x8981;&#x76D1;&#x542C;play&#x52A8;&#x753B;&#x5148;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> PlayAnimationListener <span class="title">toAddPlayListener</span><span class="params">()</span></span>{</span><br><span class="line">            playListener=<span class="keyword">new</span> PlayAnimationListener(<span class="keyword">this</span>);</span><br><span class="line">            <span class="keyword">return</span> playListener;</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * Before&#x52A8;&#x753B;&#x7684;&#x76D1;&#x542C;&#x542F;&#x52A8;&#x65B9;&#x6CD5;</span><br><span class="line">         * &#x5982;&#x679C;&#x8981;&#x76D1;&#x542C;Before&#x52A8;&#x753B;&#x5148;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> BeforeAnimationListener <span class="title">toAddBeforeListener</span><span class="params">()</span></span>{</span><br><span class="line">            beforeListener=<span class="keyword">new</span> BeforeAnimationListener(<span class="keyword">this</span>);</span><br><span class="line">            <span class="keyword">return</span> beforeListener;</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * With&#x52A8;&#x753B;&#x7684;&#x76D1;&#x542C;&#x542F;&#x52A8;&#x65B9;&#x6CD5;</span><br><span class="line">         * &#x5982;&#x679C;&#x8981;&#x76D1;&#x542C;With&#x52A8;&#x753B;&#x5148;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> WithAnimationListener <span class="title">toAddWithListener</span><span class="params">()</span></span>{</span><br><span class="line">            withListener=<span class="keyword">new</span> WithAnimationListener(<span class="keyword">this</span>);</span><br><span class="line">            <span class="keyword">return</span> withListener;</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * After&#x52A8;&#x753B;&#x7684;&#x76D1;&#x542C;&#x542F;&#x52A8;&#x65B9;&#x6CD5;</span><br><span class="line">         * &#x5982;&#x679C;&#x8981;&#x76D1;&#x542C;After&#x52A8;&#x753B;&#x5148;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AfterAnimationListener <span class="title">toAddAfterListener</span><span class="params">()</span></span>{</span><br><span class="line">            afterListener=<span class="keyword">new</span> AfterAnimationListener(<span class="keyword">this</span>);</span><br><span class="line">            <span class="keyword">return</span> afterListener;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x987A;&#x5E8F;&#x6216;&#x540C;&#x65F6;&#x64AD;&#x653E;&#x52A8;&#x753B;&#x6267;&#x884C;&#x65F6;&#x7684;&#x76D1;&#x542C;&#x65B9;&#x6CD5;</span><br><span class="line">         * &#x8981;&#x5148;&#x4E8E;Then&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x8C03;&#x7528;</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> ThenAnimationListener <span class="title">toAddThenListener</span><span class="params">()</span></span>{</span><br><span class="line">            thenListener=<span class="keyword">new</span> ThenAnimationListener(<span class="keyword">this</span>);</span><br><span class="line">            <span class="keyword">return</span> thenListener;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         *  &#x987A;&#x5E8F;&#x6216;&#x8005;&#x540C;&#x65F6;&#x64AD;&#x653E;&#x52A8;&#x753B;&#x65F6;&#x7684;&#x8C03;&#x7528;&#x65B9;&#x6CD5;</span><br><span class="line">         *  &#x5728;&#x5176;&#x5185;&#x90E8;&#x751F;&#x6210;&#x4E00;&#x4E2A;Animator&#x5E76;&#x5C06;&#x8BE5;Animator&#x52A0;&#x5165;&#x5230;mAnimatorList&#x4E2D;&#x5907;&#x7528;</span><br><span class="line">         * <span class="doctag">@param</span> view &#x52A8;&#x753B;&#x6267;&#x884C;&#x7684;&#x4E3B;&#x4F53;View</span><br><span class="line">         * <span class="doctag">@param</span> animName &#x52A8;&#x753B;&#x7C7B;&#x578B;</span><br><span class="line">         * <span class="doctag">@param</span> interpolator &#x52A8;&#x753B;&#x63D2;&#x503C;&#x5668; &#x5982;&#x679C;&#x4E0D;&#x8BBE;&#x7F6E;&#x5C31;&#x7528;&#x9ED8;&#x8BA4;&#x7684;</span><br><span class="line">         * <span class="doctag">@param</span> repeatCount &#x91CD;&#x590D;&#x6B21;&#x6570;</span><br><span class="line">         * <span class="doctag">@param</span> duration &#x6267;&#x884C;&#x65F6;&#x95F4;</span><br><span class="line">         * <span class="doctag">@param</span> values &#x52A8;&#x753B;&#x6267;&#x884C;&#x7684;&#x503C;</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">then</span><span class="params">(View view, String animName, @Nullable TimeInterpolator interpolator, @Size(min = <span class="number">0</span>,max=Integer.MAX_VALUE)</span> <span class="keyword">int</span> repeatCount, @<span class="title">Size</span><span class="params">(min = <span class="number">0</span>,max=Integer.MAX_VALUE)</span> <span class="keyword">int</span> duration, <span class="keyword">float</span>... values)</span>{</span><br><span class="line">            LogUtils.e(<span class="string">&quot;addThen&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(view==<span class="keyword">null</span>){</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;view &#x4E0D;&#x80FD;&#x4E3A;&#x7A7A;&quot;</span>);</span><br><span class="line">            }</span><br><span class="line">            mIsPlaying = <span class="keyword">true</span>;</span><br><span class="line">            mView = view;</span><br><span class="line">            ObjectAnimator thenAnimator = ObjectAnimator.ofFloat(view,animName,values);</span><br><span class="line">            thenAnimator.setInterpolator(interpolator==<span class="keyword">null</span>?mTimeInterpolator:interpolator);</span><br><span class="line">            thenAnimator.setRepeatCount(repeatCount&lt;<span class="number">0</span>?<span class="number">0</span>:repeatCount);</span><br><span class="line">            thenAnimator.setDuration(duration&lt;<span class="number">0</span>?mDuration:duration);</span><br><span class="line">            <span class="keyword">if</span> (thenListener!=<span class="keyword">null</span>&amp;&amp;thenListener.animatorListener != <span class="keyword">null</span>) {</span><br><span class="line">                thenAnimator.addListener(thenListener.animatorListener);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(thenListener!=<span class="keyword">null</span>&amp;&amp;thenListener.updateListener!=<span class="keyword">null</span>){</span><br><span class="line">                thenAnimator.addUpdateListener(thenListener.updateListener);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(thenListener!=<span class="keyword">null</span>&amp;&amp;thenListener.pauseListener!=<span class="keyword">null</span>){</span><br><span class="line">                <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {</span><br><span class="line">                    thenAnimator.addPauseListener(thenListener.pauseListener);</span><br><span class="line">                }<span class="keyword">else</span>{</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;SDK&#x6700;&#x5C0F;&#x8981;&#x6C42;19&quot;</span>);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            mAnimatorList.add(thenAnimator);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">then</span><span class="params">(Animator animator)</span> </span>{</span><br><span class="line">            mAnimatorList.add(animator);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">then</span><span class="params">(AnimatorSetWrap animator)</span> </span>{</span><br><span class="line">            mAnimatorList.add(animator.getAnimatorSet());</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * AnimatorSet&#x7684;Play&#x65B9;&#x6CD5;&#xFF0C;&#x6574;&#x4E2A;&#x52A8;&#x753B;&#x8FC7;&#x7A0B;&#x53EA;&#x80FD;&#x8C03;&#x7528;&#x4E00;&#x6B21;</span><br><span class="line">         * &#x5E76;&#x4E14;&#x4E00;&#x65E6;&#x6267;&#x884C;play&#x65B9;&#x6CD5;&#x5C06;&#x4F1A;&#x6E05;&#x9664;&#x6389;mAnimatorList&#x4E2D;&#x5B58;&#x50A8;&#x7684;&#x987A;&#x5E8F;&#x6216;&#x540C;&#x65F6;&#x6267;&#x884C;&#x7684;&#x65B9;&#x6CD5;&#x5B9E;&#x4F8B;</span><br><span class="line">         * <span class="doctag">@param</span> view &#x65B9;&#x6CD5;&#x4E3B;&#x4F53;</span><br><span class="line">         * <span class="doctag">@param</span> animName &#x52A8;&#x753B;&#x7C7B;&#x578B;</span><br><span class="line">         * <span class="doctag">@param</span> interpolator &#x63D2;&#x503C;&#x5668;</span><br><span class="line">         * <span class="doctag">@param</span> repeatCount &#x91CD;&#x590D;&#x6B21;&#x6570;</span><br><span class="line">         * <span class="doctag">@param</span> duration &#x52A8;&#x753B;&#x65F6;&#x957F;</span><br><span class="line">         * <span class="doctag">@param</span> values &#x52A8;&#x753B;&#x6267;&#x884C;&#x503C;</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">play</span><span class="params">(View view, String animName, @Nullable TimeInterpolator interpolator, @Size(min = <span class="number">0</span>,max=Integer.MAX_VALUE)</span> <span class="keyword">int</span> repeatCount, @<span class="title">Size</span><span class="params">(min = <span class="number">0</span>,max=Integer.MAX_VALUE)</span> <span class="keyword">int</span> duration, <span class="keyword">float</span>... values)</span>{</span><br><span class="line">            LogUtils.e(<span class="string">&quot;play&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(mIsPlaying){</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;AnimatorSetWrap.play()&#x65B9;&#x6CD5;&#x53EA;&#x80FD;&#x8C03;&#x7528;&#x4E00;&#x6B21;&quot;</span>);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(view==<span class="keyword">null</span>){</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;view &#x4E0D;&#x80FD;&#x4E3A;&#x7A7A;&quot;</span>);</span><br><span class="line">            }</span><br><span class="line">            mIsPlaying = <span class="keyword">true</span>;</span><br><span class="line">            mView = view;</span><br><span class="line">            ObjectAnimator playAnimator = ObjectAnimator.ofFloat(view,animName,values);</span><br><span class="line">            playAnimator.setInterpolator(interpolator==<span class="keyword">null</span>?mTimeInterpolator:interpolator);</span><br><span class="line">            playAnimator.setRepeatCount(repeatCount&lt;<span class="number">0</span>?<span class="number">0</span>:repeatCount);</span><br><span class="line">            playAnimator.setDuration(duration&lt;<span class="number">0</span>?mDuration:duration);</span><br><span class="line">            <span class="keyword">if</span> (playListener!=<span class="keyword">null</span>&amp;&amp;playListener.animatorListener != <span class="keyword">null</span>) {</span><br><span class="line">                playAnimator.addListener(playListener.animatorListener);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(playListener!=<span class="keyword">null</span>&amp;&amp;playListener.updateListener!=<span class="keyword">null</span>){</span><br><span class="line">                playAnimator.addUpdateListener(playListener.updateListener);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(playListener!=<span class="keyword">null</span>&amp;&amp;playListener.pauseListener!=<span class="keyword">null</span>){</span><br><span class="line">                <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {</span><br><span class="line">                    playAnimator.addPauseListener(playListener.pauseListener);</span><br><span class="line">                }<span class="keyword">else</span>{</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;SDK&#x6700;&#x5C0F;&#x8981;&#x6C42;19&quot;</span>);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            mAnimatorList.clear();</span><br><span class="line">            mAnimatorBuilder=mAnimatorSet.play(playAnimator);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">play</span><span class="params">(Animator animator)</span> </span>{</span><br><span class="line">            mAnimatorList.clear();</span><br><span class="line">            mAnimatorBuilder = mAnimatorSet.play(animator);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">play</span><span class="params">(AnimatorSetWrap animator)</span> </span>{</span><br><span class="line">            mAnimatorList.clear();</span><br><span class="line">            mAnimatorBuilder = mAnimatorSet.play(animator.getAnimatorSet());</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * AnimatorSet&#x7684;Before&#x65B9;&#x6CD5;</span><br><span class="line">         * <span class="doctag">@param</span> view &#x52A8;&#x753B;&#x6267;&#x884C;&#x7684;&#x4E3B;&#x4F53;View</span><br><span class="line">         * <span class="doctag">@param</span> animName &#x52A8;&#x753B;&#x7C7B;&#x578B;</span><br><span class="line">         * <span class="doctag">@param</span> interpolator &#x63D2;&#x503C;&#x5668;</span><br><span class="line">         * <span class="doctag">@param</span> repeatCount &#x91CD;&#x590D;&#x6B21;&#x6570;</span><br><span class="line">         * <span class="doctag">@param</span> duration &#x52A8;&#x753B;&#x6267;&#x884C;&#x65F6;&#x957F;</span><br><span class="line">         * <span class="doctag">@param</span> values &#x52A8;&#x753B;&#x6267;&#x884C;&#x6570;&#x503C;</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">before</span><span class="params">(View view, String animName,@Nullable TimeInterpolator interpolator, @Size(min = <span class="number">0</span>,max=Integer.MAX_VALUE)</span>  <span class="keyword">int</span> repeatCount,@<span class="title">Size</span><span class="params">(min = <span class="number">0</span>,max=Integer.MAX_VALUE)</span><span class="keyword">int</span> duration, <span class="keyword">float</span>... values)</span>{</span><br><span class="line">            LogUtils.e(<span class="string">&quot;before&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(view==<span class="keyword">null</span>){</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;view &#x4E0D;&#x80FD;&#x4E3A;&#x7A7A;&quot;</span>);</span><br><span class="line">            }</span><br><span class="line">            ObjectAnimator beforeAnimator = ObjectAnimator.ofFloat(view,</span><br><span class="line">                    animName, values).setDuration(duration);</span><br><span class="line">            beforeAnimator.setInterpolator(interpolator==<span class="keyword">null</span>?mTimeInterpolator:interpolator);</span><br><span class="line">            beforeAnimator.setRepeatCount(repeatCount&lt;<span class="number">0</span>?<span class="number">0</span>:repeatCount);</span><br><span class="line">            beforeAnimator.setDuration(duration&lt;<span class="number">0</span>?mDuration:duration);</span><br><span class="line">            <span class="keyword">if</span> (beforeListener!=<span class="keyword">null</span>&amp;&amp;beforeListener.animatorListener != <span class="keyword">null</span>) {</span><br><span class="line">                beforeAnimator.addListener(beforeListener.animatorListener);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(beforeListener!=<span class="keyword">null</span>&amp;&amp;beforeListener.updateListener!=<span class="keyword">null</span>){</span><br><span class="line">                beforeAnimator.addUpdateListener(beforeListener.updateListener);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(beforeListener!=<span class="keyword">null</span>&amp;&amp;beforeListener.pauseListener!=<span class="keyword">null</span>){</span><br><span class="line">                <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {</span><br><span class="line">                    beforeAnimator.addPauseListener(beforeListener.pauseListener);</span><br><span class="line">                }<span class="keyword">else</span>{</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;SDK&#x6700;&#x5C0F;&#x8981;&#x6C42;19&quot;</span>);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            mAnimatorBuilder = mAnimatorBuilder.before(beforeAnimator);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">before</span><span class="params">(Animator animator)</span> </span>{</span><br><span class="line">            mAnimatorBuilder = mAnimatorBuilder.before(animator);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">before</span><span class="params">(AnimatorSetWrap animator)</span> </span>{</span><br><span class="line">            mAnimatorBuilder = mAnimatorBuilder.before(animator.getAnimatorSet());</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">with</span><span class="params">(View view, String animName,@Nullable TimeInterpolator interpolator,@Size(min = <span class="number">0</span>,max=Integer.MAX_VALUE)</span> <span class="keyword">int</span> repeatCount,@<span class="title">Size</span><span class="params">(min = <span class="number">0</span>,max=Integer.MAX_VALUE)</span><span class="keyword">int</span> duration, <span class="keyword">float</span>... values)</span>{</span><br><span class="line">            LogUtils.e(<span class="string">&quot;with&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(view==<span class="keyword">null</span>){</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;view &#x4E0D;&#x80FD;&#x4E3A;&#x7A7A;&quot;</span>);</span><br><span class="line">            }</span><br><span class="line">            ObjectAnimator withAnimator = ObjectAnimator.ofFloat(view,</span><br><span class="line">                    animName, values).setDuration(duration);</span><br><span class="line">            withAnimator.setInterpolator(interpolator==<span class="keyword">null</span>?mTimeInterpolator:interpolator);</span><br><span class="line">            withAnimator.setRepeatCount(repeatCount&lt;<span class="number">0</span>?<span class="number">0</span>:repeatCount);</span><br><span class="line">            withAnimator.setDuration(duration&lt;<span class="number">0</span>?mDuration:duration);</span><br><span class="line">            <span class="keyword">if</span> (withListener!=<span class="keyword">null</span>&amp;&amp;withListener.animatorListener != <span class="keyword">null</span>) {</span><br><span class="line">                withAnimator.addListener(withListener.animatorListener);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(withListener!=<span class="keyword">null</span>&amp;&amp;withListener.updateListener!=<span class="keyword">null</span>){</span><br><span class="line">                withAnimator.addUpdateListener(withListener.updateListener);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(withListener!=<span class="keyword">null</span>&amp;&amp;withListener.pauseListener!=<span class="keyword">null</span>){</span><br><span class="line">                <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {</span><br><span class="line">                    withAnimator.addPauseListener(withListener.pauseListener);</span><br><span class="line">                }<span class="keyword">else</span>{</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;SDK&#x6700;&#x5C0F;&#x8981;&#x6C42;19&quot;</span>);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            mAnimatorBuilder = mAnimatorBuilder.with(withAnimator);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">with</span><span class="params">(Animator animator)</span> </span>{</span><br><span class="line">            mAnimatorBuilder = mAnimatorBuilder.with(animator);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">with</span><span class="params">(AnimatorSetWrap animator)</span> </span>{</span><br><span class="line">            mAnimatorBuilder = mAnimatorBuilder.with(animator.getAnimatorSet());</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">after</span><span class="params">(View view, String animName,@Nullable TimeInterpolator interpolator,@Size(min = <span class="number">0</span>,max=Integer.MAX_VALUE)</span> <span class="keyword">int</span> repeatCount,@<span class="title">Size</span><span class="params">(min = <span class="number">0</span>,max=Integer.MAX_VALUE)</span> <span class="keyword">int</span> duration, <span class="keyword">float</span>... values)</span>{</span><br><span class="line">            LogUtils.e(<span class="string">&quot;after&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(view==<span class="keyword">null</span>){</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;view &#x4E0D;&#x80FD;&#x4E3A;&#x7A7A;&quot;</span>);</span><br><span class="line">            }</span><br><span class="line">            ObjectAnimator afterAnimator = ObjectAnimator.ofFloat(view,</span><br><span class="line">                    animName, values).setDuration(duration);</span><br><span class="line">            afterAnimator.setInterpolator(interpolator==<span class="keyword">null</span>?mTimeInterpolator:interpolator);</span><br><span class="line">            afterAnimator.setRepeatCount(repeatCount&lt;<span class="number">0</span>?<span class="number">0</span>:repeatCount);</span><br><span class="line">            afterAnimator.setDuration(duration&lt;<span class="number">0</span>?mDuration:duration);</span><br><span class="line">            <span class="keyword">if</span> (afterListener!=<span class="keyword">null</span>&amp;&amp;afterListener.animatorListener != <span class="keyword">null</span>) {</span><br><span class="line">                afterAnimator.addListener(afterListener.animatorListener);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(afterListener!=<span class="keyword">null</span>&amp;&amp;afterListener.updateListener!=<span class="keyword">null</span>){</span><br><span class="line">                afterAnimator.addUpdateListener(afterListener.updateListener);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(afterListener!=<span class="keyword">null</span>&amp;&amp;afterListener.pauseListener!=<span class="keyword">null</span>){</span><br><span class="line">                <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {</span><br><span class="line">                    afterAnimator.addPauseListener(afterListener.pauseListener);</span><br><span class="line">                }<span class="keyword">else</span>{</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;SDK&#x6700;&#x5C0F;&#x8981;&#x6C42;19&quot;</span>);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            mAnimatorBuilder = mAnimatorBuilder.after(afterAnimator);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">after</span><span class="params">(Animator animator)</span> </span>{</span><br><span class="line">            mAnimatorBuilder = mAnimatorBuilder.after(animator);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">after</span><span class="params">(AnimatorSetWrap animator)</span> </span>{</span><br><span class="line">            mAnimatorBuilder = mAnimatorBuilder.after(animator.getAnimatorSet());</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">after</span><span class="params">(<span class="keyword">long</span> delay)</span> </span>{</span><br><span class="line">            mAnimatorBuilder.after(delay);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x76F4;&#x63A5;&#x6267;&#x884C;&#x52A8;&#x753B;&#xFF0C;&#x8BE5;&#x52A8;&#x753B;&#x64CD;&#x4F5C;&#x4E3B;&#x8981;&#x7528;&#x4F5C;&#x6267;&#x884C;AnimatorSet&#x7684;&#x7EC4;&#x5408;&#x52A8;&#x753B;</span><br><span class="line">         * &#x5982;&#x679C;mAnimatorList&#x4E0D;&#x4E3A;0 &#x5219;&#x6267;&#x884C;&#x9010;&#x4E00;&#x64AD;&#x653E;&#x52A8;&#x753B;</span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">playAnim</span><span class="params">()</span> </span>{</span><br><span class="line">            <span class="keyword">if</span>(mAnimatorList.size()&gt;<span class="number">0</span>){</span><br><span class="line">                readyThen(<span class="keyword">true</span>);</span><br><span class="line">            }</span><br><span class="line">            mAnimatorSet.start();</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x5728;&#x4E00;&#x5B9A;&#x65F6;&#x957F;&#x5185;&#x8FD0;&#x884C;&#x5B8C;&#x8BE5;&#x7EC4;&#x5408;&#x52A8;&#x753B;</span><br><span class="line">         * &#x5982;&#x679C;mAnimatorList&#x4E0D;&#x4E3A;0 &#x5219;&#x6267;&#x884C;&#x9010;&#x4E00;&#x64AD;&#x653E;&#x52A8;&#x753B;</span><br><span class="line">         * <span class="doctag">@param</span> duration &#x52A8;&#x753B;&#x65F6;&#x957F;</span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">playAnim</span><span class="params">(<span class="keyword">long</span> duration)</span> </span>{</span><br><span class="line">            <span class="keyword">if</span>(mAnimatorList.size()&gt;<span class="number">0</span>){</span><br><span class="line">                readyThen(<span class="keyword">true</span>);</span><br><span class="line">            }</span><br><span class="line">            mAnimatorSet.setDuration(duration);</span><br><span class="line">            mAnimatorSet.start();</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         *  &#x5EF6;&#x8FDF;&#x4E00;&#x5B9A;&#x65F6;&#x957F;&#x64AD;&#x653E;&#x52A8;&#x753B;</span><br><span class="line">         *  &#x5982;&#x679C;mAnimatorList&#x4E0D;&#x4E3A;0 &#x5219;&#x6267;&#x884C;&#x9010;&#x4E00;&#x64AD;&#x653E;&#x52A8;&#x753B;</span><br><span class="line">         * <span class="doctag">@param</span> delay &#x5EF6;&#x8FDF;&#x65F6;&#x957F;</span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">playAnimDelay</span><span class="params">(<span class="keyword">long</span> delay)</span> </span>{</span><br><span class="line">            <span class="keyword">if</span>(mAnimatorList.size()&gt;<span class="number">0</span>){</span><br><span class="line">                readyThen(<span class="keyword">true</span>);</span><br><span class="line">            }</span><br><span class="line">            mAnimatorSet.setStartDelay(delay);</span><br><span class="line">            mAnimatorSet.start();</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x76F4;&#x63A5;&#x6267;&#x884C;&#x52A8;&#x753B;&#xFF0C;&#x8BE5;&#x52A8;&#x753B;&#x64CD;&#x4F5C;&#x4E3B;&#x8981;&#x7528;&#x4F5C;&#x6267;&#x884C;AnimatorSet&#x7684;&#x7EC4;&#x5408;&#x52A8;&#x753B;</span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">playAnim</span><span class="params">(<span class="keyword">boolean</span> isSequentially)</span> </span>{</span><br><span class="line">            readyThen(isSequentially);</span><br><span class="line">            mAnimatorSet.start();</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x5728;&#x4E00;&#x5B9A;&#x65F6;&#x957F;&#x5185;&#x8FD0;&#x884C;&#x5B8C;&#x8BE5;&#x7EC4;&#x5408;&#x52A8;&#x753B;</span><br><span class="line">         * <span class="doctag">@param</span> duration &#x52A8;&#x753B;&#x65F6;&#x957F;</span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">playAnim</span><span class="params">(<span class="keyword">boolean</span> isSequentially,<span class="keyword">long</span> duration)</span> </span>{</span><br><span class="line">            readyThen(isSequentially);</span><br><span class="line">            mAnimatorSet.setDuration(duration);</span><br><span class="line">            mAnimatorSet.start();</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         *  &#x5EF6;&#x8FDF;&#x4E00;&#x5B9A;&#x65F6;&#x957F;&#x64AD;&#x653E;&#x52A8;&#x753B;</span><br><span class="line">         * <span class="doctag">@param</span> delay &#x5EF6;&#x8FDF;&#x65F6;&#x957F;</span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">playAnimDelay</span><span class="params">(<span class="keyword">boolean</span> isSequentially,<span class="keyword">long</span> delay)</span> </span>{</span><br><span class="line">            readyThen(isSequentially);</span><br><span class="line">            mAnimatorSet.setStartDelay(delay);</span><br><span class="line">            mAnimatorSet.start();</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         *  &#x987A;&#x5E8F;&#x64AD;&#x653E;&#x52A8;&#x753B;</span><br><span class="line">         * <span class="doctag">@param</span> isSequentially  &#x662F;&#x9010;&#x4E00;&#x64AD;&#x653E;&#x8FD8;&#x662F;&#x540C;&#x65F6;&#x64AD;&#x653E;</span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readyThen</span><span class="params">(<span class="keyword">boolean</span> isSequentially)</span></span>{</span><br><span class="line">            <span class="comment">// &#x53EA;&#x5728;&#x7B2C;&#x4E00;&#x6B21;&#x542F;&#x52A8;&#x65F6;&#x521D;&#x59CB;&#x5316;</span></span><br><span class="line">            <span class="keyword">if</span> (mHasInitThenAnim) {</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            }</span><br><span class="line">            mHasInitThenAnim = <span class="keyword">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (mAnimatorList.size() &gt; <span class="number">0</span>) {</span><br><span class="line">                AnimatorSet set = <span class="keyword">new</span> AnimatorSet();</span><br><span class="line">                <span class="keyword">if</span>(isSequentially){</span><br><span class="line">                    set.playSequentially(mAnimatorList);</span><br><span class="line">                }<span class="keyword">else</span>{</span><br><span class="line">                    set.playTogether(mAnimatorList);</span><br><span class="line">                }</span><br><span class="line">                mAnimatorBuilder.before(set);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x53D6;&#x6D88;&#x52A8;&#x753B;</span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cancel</span><span class="params">()</span> </span>{</span><br><span class="line">            mAnimatorSet.cancel();</span><br><span class="line">            mAnimatorList.clear();</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x83B7;&#x53D6;AnimatorSet&#x7684;&#x5B9E;&#x4F8B;</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> AnimatorSet <span class="title">getAnimatorSet</span><span class="params">()</span> </span>{</span><br><span class="line">            <span class="keyword">return</span> mAnimatorSet;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x4E3A;AnimatorSet&#x8BBE;&#x7F6E;&#x76D1;&#x542C;</span><br><span class="line">         * <span class="doctag">@param</span> listener</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">setAnimatorSetListener</span><span class="params">(Animator.AnimatorListener listener)</span> </span>{</span><br><span class="line">            mAnimatorSet.addListener(listener);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x53D6;&#x6D88;AnimatorSet&#x7684;&#x76D1;&#x542C;</span><br><span class="line">         * <span class="doctag">@param</span> listener</span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeSetListner</span><span class="params">(Animator.AnimatorListener listener)</span> </span>{</span><br><span class="line">            mAnimatorSet.removeListener(listener);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x53D6;&#x6D88;&#x5168;&#x90E8;AnimatorSet&#x7684;&#x76D1;&#x542C;</span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeAllLSetisteners</span><span class="params">()</span> </span>{</span><br><span class="line">            mAnimatorSet.removeAllListeners();</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x5224;&#x65AD;&#x4E00;&#x4E2A;View&#x662F;&#x5426;&#x5728;&#x5F53;&#x524D;&#x7684;&#x5C4F;&#x5E55;&#x4E2D;&#x53EF;&#x89C1;&#xFF08;&#x8089;&#x773C;&#x771F;&#x5B9E;&#x53EF;&#x89C1;&#xFF09;</span><br><span class="line">         * <span class="doctag">@param</span> mView</span><br><span class="line">         * <span class="doctag">@return</span> &#x8FD4;&#x56DE;true&#x5219;&#x53EF;&#x89C1;</span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isVisibleOnScreen</span><span class="params">(View mView)</span> </span>{</span><br><span class="line">            <span class="keyword">if</span> (mView == <span class="keyword">null</span>) {</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">return</span> mView.getWindowVisibility() == View.VISIBLE</span><br><span class="line">                    &amp;&amp; mView.getVisibility() == View.VISIBLE &amp;&amp; mView.isShown();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Play&#x65B9;&#x6CD5;&#x5BF9;&#x5E94;&#x7684;ObjectAnimator&#x7684;&#x76D1;&#x542C;&#x5B9E;&#x4F8B;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">PlayAnimationListener</span> <span class="keyword">implements</span> <span class="title">IAnimatorListener</span>&lt;<span class="title">PlayAnimationListener</span>&gt;</span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span>  Animator.AnimatorListener animatorListener;</span><br><span class="line">        <span class="keyword">private</span> ValueAnimator.AnimatorUpdateListener updateListener;</span><br><span class="line">        <span class="keyword">private</span> Animator.AnimatorPauseListener pauseListener;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> AnimatorSetWrap animatorSetWrap;</span><br><span class="line">        <span class="function"><span class="keyword">public</span>  <span class="title">PlayAnimationListener</span><span class="params">(AnimatorSetWrap animatorSetWrap)</span></span>{</span><br><span class="line">                <span class="keyword">this</span>.animatorSetWrap=animatorSetWrap;</span><br><span class="line">        }</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> PlayAnimationListener <span class="title">setAnimatorListener</span><span class="params">(Animator.AnimatorListener animatorListener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.animatorListener=animatorListener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> PlayAnimationListener <span class="title">setUpdateListener</span><span class="params">(ValueAnimator.AnimatorUpdateListener animatorListener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.updateListener=animatorListener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> PlayAnimationListener <span class="title">setPauseListener</span><span class="params">(Animator.AnimatorPauseListener animatorListener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.pauseListener=animatorListener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">and</span><span class="params">()</span></span>{</span><br><span class="line">            <span class="keyword">return</span> animatorSetWrap;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">BeforeAnimationListener</span> <span class="keyword">implements</span> <span class="title">IAnimatorListener</span>&lt;<span class="title">BeforeAnimationListener</span>&gt;</span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span>  Animator.AnimatorListener animatorListener;</span><br><span class="line">        <span class="keyword">private</span> ValueAnimator.AnimatorUpdateListener updateListener;</span><br><span class="line">        <span class="keyword">private</span> Animator.AnimatorPauseListener pauseListener;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> AnimatorSetWrap animatorSetWrap;</span><br><span class="line">        <span class="function"><span class="keyword">public</span>  <span class="title">BeforeAnimationListener</span><span class="params">(AnimatorSetWrap animatorSetWrap)</span></span>{</span><br><span class="line">            <span class="keyword">this</span>.animatorSetWrap=animatorSetWrap;</span><br><span class="line">        }</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">and</span><span class="params">()</span> </span>{</span><br><span class="line">            <span class="keyword">return</span> animatorSetWrap;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> BeforeAnimationListener <span class="title">setAnimatorListener</span><span class="params">(Animator.AnimatorListener listener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.animatorListener=listener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> BeforeAnimationListener <span class="title">setUpdateListener</span><span class="params">(ValueAnimator.AnimatorUpdateListener listener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.updateListener=listener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> BeforeAnimationListener <span class="title">setPauseListener</span><span class="params">(Animator.AnimatorPauseListener listener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.pauseListener=listener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">WithAnimationListener</span> <span class="keyword">implements</span> <span class="title">IAnimatorListener</span>&lt;<span class="title">WithAnimationListener</span>&gt;</span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span>  Animator.AnimatorListener animatorListener;</span><br><span class="line">        <span class="keyword">private</span> ValueAnimator.AnimatorUpdateListener updateListener;</span><br><span class="line">        <span class="keyword">private</span> Animator.AnimatorPauseListener pauseListener;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> AnimatorSetWrap animatorSetWrap;</span><br><span class="line">        <span class="function"><span class="keyword">public</span>  <span class="title">WithAnimationListener</span><span class="params">(AnimatorSetWrap animatorSetWrap)</span></span>{</span><br><span class="line">            <span class="keyword">this</span>.animatorSetWrap=animatorSetWrap;</span><br><span class="line">        }</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">and</span><span class="params">()</span> </span>{</span><br><span class="line">            <span class="keyword">return</span> animatorSetWrap;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> WithAnimationListener <span class="title">setAnimatorListener</span><span class="params">(Animator.AnimatorListener listener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.animatorListener=listener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> WithAnimationListener <span class="title">setUpdateListener</span><span class="params">(ValueAnimator.AnimatorUpdateListener listener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.updateListener=listener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> WithAnimationListener <span class="title">setPauseListener</span><span class="params">(Animator.AnimatorPauseListener listener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.pauseListener=listener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AfterAnimationListener</span> <span class="keyword">implements</span> <span class="title">IAnimatorListener</span>&lt;<span class="title">AfterAnimationListener</span>&gt;</span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span>  Animator.AnimatorListener animatorListener;</span><br><span class="line">        <span class="keyword">private</span> ValueAnimator.AnimatorUpdateListener updateListener;</span><br><span class="line">        <span class="keyword">private</span> Animator.AnimatorPauseListener pauseListener;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> AnimatorSetWrap animatorSetWrap;</span><br><span class="line">        <span class="function"><span class="keyword">public</span>  <span class="title">AfterAnimationListener</span><span class="params">(AnimatorSetWrap animatorSetWrap)</span></span>{</span><br><span class="line">            <span class="keyword">this</span>.animatorSetWrap=animatorSetWrap;</span><br><span class="line">        }</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">and</span><span class="params">()</span> </span>{</span><br><span class="line">            <span class="keyword">return</span> animatorSetWrap;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AfterAnimationListener <span class="title">setAnimatorListener</span><span class="params">(Animator.AnimatorListener listener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.animatorListener=listener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AfterAnimationListener <span class="title">setUpdateListener</span><span class="params">(ValueAnimator.AnimatorUpdateListener listener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.updateListener=listener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AfterAnimationListener <span class="title">setPauseListener</span><span class="params">(Animator.AnimatorPauseListener listener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.pauseListener=listener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ThenAnimationListener</span> <span class="keyword">implements</span> <span class="title">IAnimatorListener</span>&lt;<span class="title">ThenAnimationListener</span>&gt;</span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span>  Animator.AnimatorListener animatorListener;</span><br><span class="line">        <span class="keyword">private</span> ValueAnimator.AnimatorUpdateListener updateListener;</span><br><span class="line">        <span class="keyword">private</span> Animator.AnimatorPauseListener pauseListener;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> AnimatorSetWrap animatorSetWrap;</span><br><span class="line">        <span class="function"><span class="keyword">public</span>  <span class="title">ThenAnimationListener</span><span class="params">(AnimatorSetWrap animatorSetWrap)</span></span>{</span><br><span class="line">            <span class="keyword">this</span>.animatorSetWrap=animatorSetWrap;</span><br><span class="line">        }</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> AnimatorSetWrap <span class="title">and</span><span class="params">()</span> </span>{</span><br><span class="line">            <span class="keyword">return</span> animatorSetWrap;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> ThenAnimationListener <span class="title">setAnimatorListener</span><span class="params">(Animator.AnimatorListener listener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.animatorListener=listener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> ThenAnimationListener <span class="title">setUpdateListener</span><span class="params">(ValueAnimator.AnimatorUpdateListener listener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.updateListener=listener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> ThenAnimationListener <span class="title">setPauseListener</span><span class="params">(Animator.AnimatorPauseListener listener)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.pauseListener=listener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x52A8;&#x753B;&#x76D1;&#x542C;&#x7684;&#x516C;&#x7528;&#x6A21;&#x677F;&#x63A5;&#x53E3;</span><br><span class="line">     * <span class="doctag">@param</span> &lt;T&gt;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">IAnimatorListener</span>&lt;<span class="title">T</span>&gt;</span>{</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x8BBE;&#x7F6E;AnimatorListener&#x7684;&#x65B9;&#x6CD5;</span><br><span class="line">         * <span class="doctag">@param</span> listener</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function">T <span class="title">setAnimatorListener</span><span class="params">(Animator.AnimatorListener listener)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x8BBE;&#x7F6E;AnimatorUpdateListener&#x7684;&#x65B9;&#x6CD5;</span><br><span class="line">         * <span class="doctag">@param</span> listener</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function">T <span class="title">setUpdateListener</span><span class="params">(ValueAnimator.AnimatorUpdateListener listener)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x8BBE;&#x7F6E;AnimatorPauseListener&#x7684;&#x65B9;&#x6CD5;</span><br><span class="line">         * <span class="doctag">@param</span> listener</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function">T <span class="title">setPauseListener</span><span class="params">(Animator.AnimatorPauseListener listener)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x6865;&#x63A5;&#x52A8;&#x753B;&#x76D1;&#x542C;&#x4E0E;&#x52A8;&#x753B;&#x5DE5;&#x5177;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;</span><br><span class="line">         * <span class="doctag">@return</span></span><br><span class="line">         */</span></span><br><span class="line">        <span class="function">AnimatorSetWrap <span class="title">and</span><span class="params">()</span></span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">AnimatorUtils.createAnimator().play(viewAnimator,AnimatorUtils.ROTATIONY,<span class="keyword">null</span>,<span class="number">0</span>,<span class="number">1000</span>,<span class="number">0</span>,<span class="number">360</span>).toAddThenListener().setUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() {</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator valueAnimator)</span> </span>{</span><br><span class="line">                LogUtils.e(<span class="string">&quot;then1:&quot;</span>+valueAnimator.getAnimatedValue());</span><br><span class="line">            }</span><br><span class="line">        }).and().then(viewAnimator, AnimatorUtils.TRANSY, <span class="keyword">null</span>, -<span class="number">1</span>, -<span class="number">2</span>, <span class="number">0</span>, <span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>, <span class="number">200</span>, <span class="number">100</span>, <span class="number">0</span>).toAddThenListener().setUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() {</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator valueAnimator)</span> </span>{</span><br><span class="line">                LogUtils.e(<span class="string">&quot;then2:&quot;</span>+valueAnimator.getAnimatedValue());</span><br><span class="line">            }</span><br><span class="line">        }).and().then(viewAnimator, AnimatorUtils.SCALEX, <span class="keyword">new</span> LinearInterpolator(), <span class="number">0</span>, <span class="number">1000</span>,  <span class="number">0</span>, <span class="number">10</span>).toAddWithListener().setUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() {</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator valueAnimator)</span> </span>{</span><br><span class="line">                LogUtils.e(<span class="string">&quot;with1:&quot;</span>+valueAnimator.getAnimatedValue());</span><br><span class="line">            }</span><br><span class="line">        }).and().with(viewAnimator, AnimatorUtils.SCALEY, <span class="keyword">new</span> LinearInterpolator(), <span class="number">0</span>, <span class="number">1000</span>,  <span class="number">0</span>, <span class="number">10</span>).toAddWithListener().setAnimatorListener(<span class="keyword">new</span> Animator.AnimatorListener() {</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationStart</span><span class="params">(Animator animator)</span> </span>{</span><br><span class="line">                LogUtils.e(<span class="string">&quot;with2:onAnimationStart&quot;</span>);</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationEnd</span><span class="params">(Animator animator)</span> </span>{</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationCancel</span><span class="params">(Animator animator)</span> </span>{</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationRepeat</span><span class="params">(Animator animator)</span> </span>{</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line">        }).and().with(viewAnimator, AnimatorUtils.ALPHA, <span class="keyword">new</span> LinearInterpolator(), <span class="number">0</span>, <span class="number">1000</span>,  <span class="number">1</span>, <span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">        <span class="comment">//.playSequentially(2000);</span></span><br><span class="line">        .playAnim();</span><br></pre></td></tr></table></figure>
<p>&#x4E0A;&#x9762;&#x7684;&#x52A8;&#x753B;&#x8C03;&#x7528;&#x65B9;&#x6CD5;&#x662F;&#x6211;&#x4E71;&#x5199;&#x7684;&#xFF0C;&#x5177;&#x4F53;&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x6F14;&#x793A;&#x5DE5;&#x5177;&#x7C7B;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x6539;&#x6210;&#x81EA;&#x5DF1;&#x7684;&#x8C03;&#x7528;&#x65B9;&#x6CD5;&#x3002;</p>
</li>
</ul>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Android组件化过程中ButterKnife在Library中的使用]]></title>
      <url>http://jasoncool.com/2018/10/26/Android%E7%BB%84%E4%BB%B6%E5%8C%96%E8%BF%87%E7%A8%8B%E4%B8%ADButterKnife%E5%9C%A8Library%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<h2 id="&#x8D77;&#x56E0;">&#x8D77;&#x56E0;</h2><p>&#x200B;       &#x6700;&#x8FD1;&#x4E00;&#x76F4;&#x5728;&#x505A;Android&#x6846;&#x67B6;&#x65B9;&#x9762;&#x7684;&#x5DE5;&#x4F5C;&#xFF0C;&#x5148;&#x662F;&#x628A;&#x539F;&#x6765;&#x7684;&#x7F51;&#x7EDC;&#x6846;&#x67B6;&#x7531;Netroid&#x6539;&#x4E3A;&#x4E86;Retrofit+Rxjava&#xFF0C;&#x7136;&#x540E;&#x5728;&#x8FD9;&#x6B21;&#x4FEE;&#x6539;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#xFF0C;&#x6709;&#x505A;&#x4E86;&#x5927;&#x91CF;&#x7684;&#x57FA;&#x7840;&#x7684;Activity&#x548C;Fragment&#x7684;&#x5C01;&#x88C5;&#xFF0C;&#x4EE5;&#x53CA;&#x5BF9;&#x5E94;&#x7684;MVP&#x7684;&#x67B6;&#x6784;&#x5C01;&#x88C5;&#xFF0C;&#x4E5F;&#x662F;&#x7ECF;&#x8FC7;&#x591A;&#x6B21;&#x4FEE;&#x6539;&#x8C03;&#x6574;&#x540E;&#xFF0C;&#x57FA;&#x672C;&#x6210;&#x578B;&#x4E86;&#xFF0C;&#x968F;&#x540E;&#x5355;&#x5F00;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x4ECB;&#x7ECD;&#x8FD9;&#x4E2A;Android&#x67B6;&#x6784;&#xFF0C;&#x8FD9;&#x4E2A;&#x67B6;&#x6784;&#x9002;&#x5408;&#x5C0F;&#x9879;&#x76EE;&#xFF0C;&#x5C0F;&#x56E2;&#x961F;&#x4F7F;&#x7528;&#xFF0C;&#x4E5F;&#x662F;&#x6839;&#x636E;&#x7F51;&#x4E0A;&#x7684;&#x5927;&#x725B;&#x63D0;&#x4F9B;&#x7684;&#x601D;&#x8DEF;&#xFF0C;&#x81EA;&#x5DF1;&#x5B9E;&#x8DF5;&#x6765;&#x7684;&#xFF0C;&#x7ECF;&#x8FC7;&#x51E0;&#x6B21;&#x8FDB;&#x5316;&#x540E;&#xFF0C;&#x5E94;&#x4ED8;&#x4E2D;&#x5C0F;&#x9879;&#x76EE;&#x5E94;&#x8BE5;&#x662F;&#x7EF0;&#x7EF0;&#x6709;&#x4F59;&#x4E86;&#x3002;</p>
<p>&#x200B;      &#x4E2D;&#x5C0F;&#x578B;&#x9879;&#x76EE;&#x6846;&#x67B6;&#x6DB5;&#x76D6;&#x7684;&#x5173;&#x952E;&#x5B57;&#xFF1A;MVP&#x3001;Retrofit&#x3001;RXAndroid&#x3001;RxAndroidLifeCycle&#x3001;EventBus&#x3001;LitePal&#x3001;CommonUtils&#xFF08;&#x6DB5;&#x76D6;&#x975E;&#x5E38;&#x5168;&#x9762;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#x5E93;&#xFF09;&#x7B49;&#x3002;</p>
<blockquote>
<p>&#x6709;&#x53E5;&#x8BDD;&#x8BF4;&#x7684;&#x597D;&#xFF1A;&#x65E2;&#x5F97;&#x9647;&#xFF0C;&#x590D;&#x671B;&#x8700;&#x3002;</p>
</blockquote>
<p>&#x200B;    <a id="more"></a></p>
<p>&#x200B;    &#x5728;&#x4E2D;&#x5C0F;&#x578B;&#x9879;&#x76EE;&#x7684;&#x6846;&#x67B6;&#x6210;&#x529F;&#x540E;&#xFF0C;&#x6211;&#x89C9;&#x5F97;&#x4E0D;&#x5982;&#x5C31;&#x6B64;&#x673A;&#x4F1A;&#x628A;&#x7EC4;&#x4EF6;&#x5316;&#x7684;&#x67B6;&#x6784;&#x4E00;&#x5E76;&#x5B9E;&#x73B0;&#xFF0C;&#x4E8E;&#x662F;&#x5C31;&#x5F00;&#x59CB;&#x5B66;&#x4E60;&#x7EC4;&#x4EF6;&#x5316;&#x7684;&#x67B6;&#x6784;&#x7EC4;&#x7EC7;&#xFF0C;&#x4E00;&#x6B65;&#x4E00;&#x6B65;&#x7684;&#x628A;&#x81EA;&#x5DF1;&#x7684;&#x9879;&#x76EE;&#x67B6;&#x6784;&#x6162;&#x6162;&#x7684;&#x8F6C;&#x6210;&#x4E86;&#x7EC4;&#x4EF6;&#x5316;&#x7684;&#x5F00;&#x53D1;&#xFF0C;&#x4E0D;&#x8FC7;&#x76EE;&#x524D;&#x8FD8;&#x6CA1;&#x6709;&#x5B8C;&#x6210;&#xFF0C;&#x6709;&#x51E0;&#x4E2A;&#x95EE;&#x9898;&#x9700;&#x8981;&#x5904;&#x7406;&#xFF1A;</p>
<ol>
<li>&#x5F15;&#x5165;&#x8DEF;&#x7531;&#x7EC4;&#x4EF6;</li>
<li>&#x5C01;&#x88C5;&#x5E38;&#x7528;&#x7684;&#x81EA;&#x5B9A;&#x4E49;View </li>
<li>&#x5C01;&#x88C5;&#x4E1A;&#x52A1;&#x7EC4;&#x4EF6;&#xFF1A;&#x901A;&#x7528;Dialog,&#x901A;&#x7528;RecycleView&#x3001;&#x901A;&#x7528;&#x8FDB;&#x5EA6;&#x6761;&#x7B49;&#xFF0C;&#x8FD9;&#x4E2A;&#x5C31;&#x5F88;&#x968F;&#x610F;&#x4E86;&#xFF0C;&#x4E3B;&#x8981;&#x8FD8;&#x662F;&#x770B;&#x5F00;&#x53D1;&#x8005;&#x81EA;&#x5DF1;&#x7684;&#x4E3B;&#x89C2;&#x610F;&#x613F;&#x3002;</li>
</ol>
<p>&#x200B;     &#x5728;&#x521D;&#x6B65;&#x7684;&#x5B8C;&#x6210;&#x4E86;&#x5C01;&#x88C5;&#x540E;&#xFF0C;&#x53D1;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x5C31;&#x662F;&#x6211;&#x628A;&#x539F;&#x6765;&#x5728;&#x5355;&#x4E00;&#x9879;&#x76EE;&#x6846;&#x67B6;&#x4E0B;&#x7684;&#x6E90;&#x7801;&#x8F6C;&#x79FB;&#x5230;&#x4E86;&#x7EC4;&#x4EF6;&#x5316;&#x6846;&#x67B6;&#x4E0B;&#x7684;&#x5B50;&#x4E1A;&#x52A1;&#x6846;&#x67B6;&#x4E0B;&#xFF0C;&#x8BF4;&#x767D;&#x4E86;&#x5C31;&#x662F;&#x5728;&#x7EC4;&#x4EF6;&#x5316;&#x5F00;&#x542F;&#x7684;&#x524D;&#x63D0;&#x4E0B;&#xFF0C;&#x628A;&#x6E90;&#x7801;&#x4ECE;App&#x8F6C;&#x79FB;&#x5230;&#x4E86;Library&#x4E0B;&#xFF0C;&#x4ECE;&#x7406;&#x8BBA;&#x4E0A;&#x6765;&#x8BF4;&#xFF0C;&#x5E94;&#x8BE5;&#x4E0D;&#x4F1A;&#x6709;&#x4EC0;&#x4E48;&#x95EE;&#x9898;&#xFF0C;&#x4F46;&#x662F;&#x5386;&#x53F2;&#x5B9E;&#x8DF5;&#x544A;&#x8BC9;&#x6211;&#x4EEC;&#xFF0C;&#x7406;&#x8BBA;&#x5F80;&#x5F80;&#x662F;&#x9760;&#x4E0D;&#x4F4F;&#x7684;&#xFF0C;&#x5728;&#x8F6C;&#x79FB;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x6211;&#x5C31;&#x9047;&#x5230;&#x4E86;ButterKnife&#x9020;&#x6210;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<h2 id="&#x95EE;&#x9898;">&#x95EE;&#x9898;</h2><p>&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x5177;&#x4F53;&#x7684;&#x95EE;&#x9898;&#xFF1A;</p>
<p><img src="/2018/10/26/Android&#x7EC4;&#x4EF6;&#x5316;&#x8FC7;&#x7A0B;&#x4E2D;ButterKnife&#x5728;Library&#x4E2D;&#x7684;&#x4F7F;&#x7528;/1.png" alt="logo"></p>
<p>&#x5982;&#x679C;&#x4F60;&#x5F3A;&#x5236;&#x7F16;&#x8BD1;&#xFF0C;Build&#x63A7;&#x5236;&#x53F0;&#x5C31;&#x4F1A;&#x5F88;&#x8D34;&#x5FC3;&#x7684;&#x7528;&#x4E2D;&#x6587;&#x518D;&#x544A;&#x8BC9;&#x4F60;&#x4E00;&#x6B21;&#xFF1A;</p>
<p><img src="/2018/10/26/Android&#x7EC4;&#x4EF6;&#x5316;&#x8FC7;&#x7A0B;&#x4E2D;ButterKnife&#x5728;Library&#x4E2D;&#x7684;&#x4F7F;&#x7528;/2.png" alt="logo"></p>
<p>&#x5143;&#x7D20;&#x503C;&#x5FC5;&#x987B;&#x4E3A;&#x5E38;&#x91CF;&#x8868;&#x8FBE;&#x5F0F;&#xFF1F;&#x600E;&#x4E48;&#x5C31;&#x4E0D;&#x662F;&#x5E38;&#x91CF;&#x4E86;&#xFF1F;&#xFF01;&#x6211;&#x4EEC;&#x77E5;&#x9053;R.id.XX&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x5F15;&#x5165;&#x4E86;R&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x5E38;&#x91CF;&#xFF0C;&#x6240;&#x8C13;&#x7684;&#x9759;&#x6001;&#x5E38;&#x91CF;&#x5176;&#x5B9E;&#x5C31;&#x662F;static final&#x7684;&#x4E2D;&#x6587;&#x8BF4;&#x6CD5;&#xFF0C;&#x4E8E;&#x662F;&#x6211;&#x70B9;&#x5F00;&#x4E86;R&#x6587;&#x4EF6;&#xFF1A;</p>
<p><img src="/2018/10/26/Android&#x7EC4;&#x4EF6;&#x5316;&#x8FC7;&#x7A0B;&#x4E2D;ButterKnife&#x5728;Library&#x4E2D;&#x7684;&#x4F7F;&#x7528;/4.png" alt="logo"></p>
<p>&#x597D;&#x5427;&#xFF0C;&#x6CA1;&#x6709;final&#x2026;&#x2026;.&#x6B63;&#x5E38;&#x7684;Application&#x4E2D;&#x7684;R&#x6587;&#x4EF6;&#x5E94;&#x8BE5;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;</p>
<p><img src="/2018/10/26/Android&#x7EC4;&#x4EF6;&#x5316;&#x8FC7;&#x7A0B;&#x4E2D;ButterKnife&#x5728;Library&#x4E2D;&#x7684;&#x4F7F;&#x7528;/3.png" alt="logo"></p>
<p>&#x4E3A;&#x4EC0;&#x4E48;&#x7F3A;&#x5C11;&#x4E86;final&#x5173;&#x952E;&#x5B57;&#x5462;&#xFF1F;&#x539F;&#x56E0;&#x5176;&#x5B9E;&#x8C37;&#x6B4C;&#x5DF2;&#x7ECF;&#x7ED9;&#x51FA;&#x4E86;&#xFF1A;</p>
<blockquote>
<p>&#x4ECE;ADT14&#x5F00;&#x59CB;Library&#x4E2D;&#x7684;R&#x6587;&#x4EF6;&#x624D;&#x4ECE;&#x9759;&#x6001;&#x5E38;&#x91CF;&#x53D8;&#x4E3A;&#x975E;&#x5E38;&#x91CF;.&#x56E0;&#x4E3A;&#x5982;&#x679C;&#x5728;&#x591A;&#x4E2A;Library&#x4E2D;&#x53EF;&#x80FD;&#x51FA;&#x73B0;id&#x51B2;&#x7A81;&#x7684;&#x95EE;&#x9898;.&#x5728;ADT14&#x4EE5;&#x524D;&#x5219;&#x91C7;&#x7528;&#x7684;&#x662F;&#x5C06;&#x6240;&#x6709;&#x7684;&#x8D44;&#x6E90;&#x6587;&#x4EF6;&#x548C;&#x76F8;&#x5173;&#x7684;&#x4EE3;&#x7801;&#x91CD;&#x65B0;&#x968F;&#x7740;&#x4E3B;&#x9879;&#x76EE;&#x4E00;&#x8D77;&#x7F16;&#x8BD1;,&#x5BFC;&#x81F4;&#x7F16;&#x8BD1;&#x901F;&#x5EA6;&#x8FC7;&#x6162;.&#x56E0;&#x6B64;,&#x4ECE;ADT14&#x5F00;&#x59CB;&#x5C31;&#x53D8;&#x6210;&#x4E86;&#x975E;&#x5E38;&#x91CF;&#x7684;id&#x4E86;&#x3002;</p>
</blockquote>
<p>&#x867D;&#x7136;&#x8FD9;&#x4E2A;&#x6539;&#x52A8;&#x7684;&#x51FA;&#x53D1;&#x70B9;&#x662F;&#x597D;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x968F;&#x7740;&#x7EC4;&#x4EF6;&#x5316;&#x8D8A;&#x6765;&#x8D8A;&#x666E;&#x53CA;&#xFF0C;&#x4E1A;&#x52A1;&#x7EC4;&#x4EF6;&#x653E;&#x5728;library&#x7684;&#x60C5;&#x51B5;&#x4F1A;&#x8D8A;&#x6765;&#x8D8A;&#x591A;&#xFF0C;ButterKnife&#x9700;&#x8981;&#x5728;Library&#x4E2D;&#x4F7F;&#x7528;&#x7684;&#x60C5;&#x51B5;&#x4E5F;&#x8D8A;&#x6765;&#x8D8A;&#x591A;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;JakeWharton&#x5927;&#x795E;&#x7EC8;&#x4E8E;&#x5728;&#x5927;&#x5BB6;&#x7684;&#x547C;&#x5524;&#x4E0B;&#xFF0C;&#x8BA9;ButterKnife&#x652F;&#x6301;Library&#x4E86;&#x3002;</p>
<h2 id="&#x89E3;&#x51B3;">&#x89E3;&#x51B3;</h2><p>&#x5B98;&#x65B9;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF1A;</p>
<p><img src="/2018/10/26/Android&#x7EC4;&#x4EF6;&#x5316;&#x8FC7;&#x7A0B;&#x4E2D;ButterKnife&#x5728;Library&#x4E2D;&#x7684;&#x4F7F;&#x7528;/5.png" alt="logo"></p>
<h3 id="&#x7B2C;&#x4E00;&#x6B65;">&#x7B2C;&#x4E00;&#x6B65;</h3><p>&#x5728;&#x9879;&#x76EE;&#x7684;build.gradle&#x4E2D;&#x7684;dependencies&#x4E2D;&#x52A0;&#x5165;&#xFF1A;classpath &#x2018;com.jakewharton:butterknife-gradle-plugin:9.0.0-rc1&#x2019;</p>
<h3 id="&#x7B2C;&#x4E8C;&#x6B65;">&#x7B2C;&#x4E8C;&#x6B65;</h3><p>&#x5728;&#x4E1A;&#x52A1;&#x5B50;Library&#x7684;Build.gradle&#x4E2D;&#x52A0;&#x5165;&#xFF1A;apply plugin: &#x2018;com.jakewharton.butterknife&#x2019;</p>
<p>&#x8FD9;&#x91CC;&#x8981;&#x6CE8;&#x610F;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (isModule.toBoolean()) {</span><br><span class="line">    apply plugin: <span class="string">&apos;com.android.application&apos;</span></span><br><span class="line">} <span class="keyword">else</span> {</span><br><span class="line">    apply plugin: <span class="string">&apos;com.android.library&apos;</span></span><br><span class="line">}</span><br><span class="line">apply plugin: <span class="string">&apos;com.jakewharton.butterknife&apos;</span></span><br></pre></td></tr></table></figure>
<p>&#x4E0D;&#x8BBA;&#x4F60;&#x662F;&#x5426;&#x5F00;&#x542F;&#x7EC4;&#x4EF6;&#x5316;&#xFF0C;&#x90FD;&#x8981;&#x628A;&#x8FD9;&#x4E2A;&#x63D2;&#x4EF6;&#x52A0;&#x5165;&#x8FDB;&#x53BB;&#x3002;</p>
<h3 id="&#x7B2C;&#x4E09;&#x6B65;">&#x7B2C;&#x4E09;&#x6B65;</h3><p>&#x8FD9;&#x91CC;&#x8981;&#x6CE8;&#x610F;&#x4E86;&#xFF0C;&#x6572;&#x9ED1;&#x677F;&#xFF01;</p>
<p>&#x5982;&#x679C;&#x4F60;&#x7684;ButterKnife&#x7684;&#x4F9D;&#x8D56;&#x662F;&#x96C6;&#x6210;&#x5728;&#x672C;&#x4E1A;&#x52A1;Library&#x4E2D;&#x7684;&#xFF0C;&#x90A3;&#x4F60;&#x5C31;&#x4E0D;&#x7528;&#x7BA1;&#x6211;&#x4E0B;&#x9762;&#x8BF4;&#x7684;&#x8BDD;&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x662F;&#xFF0C;&#x4E00;&#x5B9A;&#x8981;&#x770B;&#x4ED4;&#x7EC6;&#xFF01;</p>
<p>&#x6211;&#x7684;ButterKnife&#x5C31;&#x4E0D;&#x662F;&#x5C01;&#x88C5;&#x5728;&#x672C;&#x4E1A;&#x52A1;&#x7684;Library&#x4E2D;&#x7684;&#xFF0C;&#x800C;&#x662F;&#x5728;&#x5176;&#x5E95;&#x5C42;&#x7684;&#x4E00;&#x4E2A;&#x540D;&#x4E3A;BaseLib&#x7684;Library&#x4E2D;&#x5F15;&#x5165;&#x7684;&#xFF0C;&#x8BE5;Library&#x4E3B;&#x8981;&#x662F;&#x63D0;&#x4F9B;BaseActivity&#x548C;BaseFragment&#x7B49;&#x57FA;&#x7840;&#x7EC4;&#x4EF6;&#x7684;&#xFF0C;&#x5728;&#x8BE5;Library&#x4E2D;&#x5F15;&#x5165;&#x4E5F;&#x662F;&#x4E3A;&#x4E86;&#x5408;&#x7406;&#x7684;&#x5904;&#x7406;&#x6240;&#x6709;ButterKnife&#x7684;&#x89E3;&#x7ED1;&#x64CD;&#x4F5C;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x8981;&#x5728;&#x4F60;&#x7684;&#x4E1A;&#x52A1;Library&#x4E2D;&#x4F7F;&#x7528;ButterKnife&#xFF0C;&#x4F60;&#x4E0D;&#x5FC5;&#x91CD;&#x590D;&#x5F15;&#x5165;ButterKnife&#x7684;&#x4F9D;&#x8D56;&#xFF0C;&#x800C;&#x662F;&#x5728;&#x4E1A;&#x52A1;Library&#x4E2D;&#x52A0;&#x5165;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dependencies {</span><br><span class="line">     <span class="function">api <span class="title">project</span><span class="params">(<span class="string">&apos;:BaseLib&apos;</span>)</span></span><br><span class="line">    <span class="comment">//&#x8FD9;&#x91CC;&#x8981;&#x5C06;ButterKnife&#x7684;&#x6CE8;&#x89E3;&#x52A0;&#x5165;&#x4E3B;&#x9879;&#x76EE;&#x4E2D;&#x53BB;&#xFF0C;&#x56E0;&#x4E3A;&#x5B50;&#x9879;&#x76EE;&#x65E0;&#x6CD5;&#x901A;&#x8FC7;api&#x5F15;&#x5165;</span></span><br><span class="line">    annotationProcessor &quot;com.jakewharton:butterknife-compiler:$butterknife_version&quot;</span><br><span class="line">}</span></span><br></pre></td></tr></table></figure>
<p>&#x5426;&#x5219;&#x5C31;&#x4F1A;&#x51FA;&#x73B0;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x4F60;&#x7684;&#x9879;&#x76EE;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x4E0D;&#x4F1A;&#x62A5;&#x9519;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x5C31;&#x4F1A;&#x62A5;&#x7A7A;&#x6307;&#x9488;&#x7684;&#x9519;&#x8BEF;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2018</span>-<span class="number">10</span>-<span class="number">26</span> <span class="number">16</span>:<span class="number">33</span>:<span class="number">50.166</span> <span class="number">15872</span>-<span class="number">15872</span>/? W/System.err: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.xxx.read/com.xxx.read.ReadActivityMainActivity}: java.lang.NullPointerException: Attempt to invoke virtual method <span class="string">&apos;void android.view.View.setVisibility(int)&apos;</span> on a <span class="keyword">null</span> object reference</span><br><span class="line"><span class="number">2018</span>-<span class="number">10</span>-<span class="number">26</span> <span class="number">16</span>:<span class="number">33</span>:<span class="number">50.167</span> <span class="number">15872</span>-<span class="number">15872</span>/? W/System.err:     at com.dhcc.commonutils.BarUtils.setStatusBarAlpha(BarUtils.java:<span class="number">294</span>)</span><br><span class="line"><span class="number">2018</span>-<span class="number">10</span>-<span class="number">26</span> <span class="number">16</span>:<span class="number">33</span>:<span class="number">50.167</span> <span class="number">15872</span>-<span class="number">15872</span>/? W/System.err:     at com.dhcc.commonutils.BarUtils.setStatusBarAlpha4Drawer(BarUtils.java:<span class="number">385</span>)</span><br><span class="line"><span class="number">2018</span>-<span class="number">10</span>-<span class="number">26</span> <span class="number">16</span>:<span class="number">33</span>:<span class="number">50.167</span> <span class="number">15872</span>-<span class="number">15872</span>/? W/System.err:     at com.dhcc.read.ReadActivityMainActivity.initView(ReadActivityMainActivity.java:<span class="number">95</span>)</span><br><span class="line"><span class="number">2018</span>-<span class="number">10</span>-<span class="number">26</span> <span class="number">16</span>:<span class="number">33</span>:<span class="number">50.167</span> <span class="number">15872</span>-<span class="number">15872</span>/? W/System.err:     at com.dhcc.baseLib.base.activity.BaseActivity.onCreate(BaseActivity.java:<span class="number">51</span>)</span><br><span class="line"><span class="number">2018</span>-<span class="number">10</span>-<span class="number">26</span> <span class="number">16</span>:<span class="number">33</span>:<span class="number">50.167</span> <span class="number">15872</span>-<span class="number">15872</span>/? W/System.err:     at com.dhcc.read.ReadActivityMainActivity.onCreate(ReadActivityMainActivity.java:<span class="number">228</span>)</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x6BD4;&#x8F83;&#x7279;&#x6B8A;&#xFF0C;&#x5E76;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x4EBA;&#x90FD;&#x4F1A;&#x9047;&#x5230;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x9047;&#x5230;&#x4E86;&#xFF0C;&#x8BB0;&#x5F97;&#x6309;&#x7167;&#x6211;&#x8FD9;&#x6837;&#x5904;&#x7406;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;</p>
<h3 id="&#x7B2C;&#x56DB;&#x6B65;">&#x7B2C;&#x56DB;&#x6B65;</h3><p>&#x628A;&#x4E1A;&#x52A1;Library&#x9879;&#x76EE;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5173;&#x4E8E;ButterKnife&#x7684;R&#x5F15;&#x7528;&#xFF0C;&#x6539;&#x4E3A;R2&#x5F15;&#x7528;&#x5373;&#x53EF;&#x3002;<br>&#x5982;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@BindView</span>(R2.id.toolbar)</span><br><span class="line">Toolbar toolbar;</span><br><span class="line"><span class="annotation">@BindView</span>(R2.id.fake_status_bar)</span><br><span class="line">View fakeStatusBar;</span><br><span class="line"><span class="annotation">@BindView</span>(R2.id.textView)</span><br><span class="line">TextView textView;</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x91CC;&#x6CE8;&#x610F;&#x4E00;&#x4E0B;&#xFF0C;&#x5E76;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x7684;R&#x6587;&#x4EF6;&#x90FD;&#x6539;&#x6210;R2,&#x5982;&#x679C;&#x662F;R.layout&#x8FD9;&#x7C7B;R&#x5F15;&#x7528;&#x5C31;&#x4E0D;&#x8981;&#x66F4;&#x6539;&#xFF0C;&#x4FDD;&#x6301;&#x539F;&#x72B6;&#x5373;&#x53EF;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x62A5;&#x51FA;&#x627E;&#x4E0D;&#x5230;View&#x7684;&#x6307;&#x5B9A;ID&#x7684;&#x9519;&#x8BEF;&#x3002;</p>
<p>&#x5982;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * &#x7ED1;&#x5B9A;&#x5E03;&#x5C40;</span><br><span class="line"> *</span><br><span class="line"> * <span class="doctag">@return</span> &#x5E03;&#x5C40; Id</span><br><span class="line"> */</span></span><br><span class="line"><span class="annotation">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">bindLayout</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> R.layout.read_activity_main;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="&#x603B;&#x7ED3;">&#x603B;&#x7ED3;</h2><p>&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x67B6;&#x6784;&#x7684;&#x5F62;&#x6210;&#x90FD;&#x6709;&#x95E8;&#x69DB;&#xFF0C;&#x6709;&#x5751;&#xFF0C;&#x6709;&#x77E5;&#x8BC6;&#xFF0C;&#x6709;&#x8DA3;&#xFF0C;&#x6211;&#x4E0D;&#x613F;&#x610F;&#x505A;&#x90A3;&#x79CD;&#x88AB;&#x5B89;&#x6392;&#x7684;&#x7A0B;&#x5E8F;&#x5458;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x8FD9;&#x4E9B;&#x5751;&#x5176;&#x5B9E;&#x90FD;&#x662F;&#x6211;&#x7684;&#x4E50;&#x8DA3;&#x6240;&#x5728;&#xFF0C;&#x4ECA;&#x5929;&#x62FF;&#x51FA;&#x6211;&#x7684;&#x8D9F;&#x5751;&#x7ECF;&#x9A8C;&#x5206;&#x4EAB;&#x7ED9;&#x5927;&#x5BB6;&#xFF0C;&#x662F;&#x5E0C;&#x671B;&#x770B;&#x5230;&#x7684;&#x670B;&#x53CB;&#x53EF;&#x4EE5;&#x8D70;&#x7684;&#x6BD4;&#x6211;&#x66F4;&#x8FDC;&#x3002;</p>
<p>&#x8C22;&#x8C22;&#x4F60;&#x7684;&#x9605;&#x8BFB;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[记一次重复依赖的解决]]></title>
      <url>http://jasoncool.com/2018/10/12/%E8%AE%B0%E4%B8%80%E6%AC%A1%E9%87%8D%E5%A4%8D%E4%BE%9D%E8%B5%96%E7%9A%84%E8%A7%A3%E5%86%B3/</url>
      <content type="html"><![CDATA[<h2 id="&#x4E00;&#x6B21;&#x88AB;&#x8FEB;&#x7684;&#x5347;&#x7EA7;">&#x4E00;&#x6B21;&#x88AB;&#x8FEB;&#x7684;&#x5347;&#x7EA7;</h2><p>&#x6700;&#x8FD1;&#x62BD;&#x65F6;&#x95F4;&#x7EF4;&#x62A4;&#x6211;&#x7684;&#x5E94;&#x7528;&#x300A;&#x77E5;&#x8C46;&#x4E86;2&#x300B;,&#x8FDB;&#x884C;&#x4E86;&#x4E00;&#x4E9B;Bug&#x7684;&#x4FEE;&#x590D;&#xFF0C;&#x6846;&#x67B6;&#x7684;&#x5347;&#x7EA7;&#x4EE5;&#x53CA;&#x65B0;&#x52A0;&#x4E86;&#x55B7;&#x568F;&#x56FE;&#x5366;&#x8FD9;&#x4E2A;&#x680F;&#x76EE;&#xFF0C;&#x529F;&#x80FD;&#x66F4;&#x65B0;&#x7684;&#x5DEE;&#x4E0D;&#x591A;&#x4E86;&#xFF0C;&#x60F3;&#x63D0;&#x4EA4;&#x5230;&#x5E94;&#x7528;&#x5E02;&#x573A;&#x4E0A;&#x66F4;&#x65B0;&#x4EE5;&#x4E0B;&#x7248;&#x672C;&#xFF0C;&#x7ED3;&#x679C;&#x63D0;&#x4EA4;&#x7ED9;&#x5C0F;&#x7C73;&#x540E;&#xFF0C;&#x51FA;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x5C31;&#x662F;&#xFF0C;&#x6211;&#x7684;&#x5E94;&#x7528;&#x88AB;&#x5B89;&#x5929;&#x6740;&#x6BD2;&#x5F15;&#x64CE;&#x67E5;&#x51FA;&#x6709;&#x75C5;&#x6BD2;&#x2026;..</p>
<p><img src="/2018/10/12/&#x8BB0;&#x4E00;&#x6B21;&#x91CD;&#x590D;&#x4F9D;&#x8D56;&#x7684;&#x89E3;&#x51B3;/1.png" alt="logo"></p>
<p>&#x7B2C;&#x4E00;&#x53CD;&#x5E94;&#x5C31;&#x662F;&#xFF0C;&#x80AF;&#x5B9A;&#x662F;&#x5F15;&#x5165;&#x7684;&#x7B2C;&#x4E09;&#x65B9;&#x5305;&#x6709;&#x95EE;&#x9898;&#x4E86;&#xFF0C;&#x4E8E;&#x662F;&#x60F3;&#x4E86;&#x60F3;&#x9879;&#x76EE;&#x4E2D;&#x4E3B;&#x8981;&#x7528;&#x5230;&#x4E86;&#x4E24;&#x4E2A;&#x7B2C;&#x4E09;&#x65B9;&#x529F;&#x80FD;&#x5305;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x662F;ShareSDK&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x662F;Bmob,&#x76F4;&#x89C9;&#x544A;&#x8BC9;&#x6211;&#xFF0C;&#x5E94;&#x8BE5;&#x662F;Bmob&#x51FA;&#x4E86;&#x95EE;&#x9898;&#xFF0C;&#x7136;&#x540E;&#x767E;&#x5EA6;&#x4E4B;&#xFF0C;&#x679C;&#x7136;&#xFF1A;</p>
<p><img src="/2018/10/12/&#x8BB0;&#x4E00;&#x6B21;&#x91CD;&#x590D;&#x4F9D;&#x8D56;&#x7684;&#x89E3;&#x51B3;/2.png" alt="logo"></p>
<a id="more"></a>
<p>&#x6211;&#x7684;Bmob&#x662F;&#x5F88;&#x8001;&#x7684;&#x7248;&#x672C;&#x4E86;&#xFF0C;&#x56E0;&#x4E3A;&#x4E00;&#x76F4;&#x80FD;&#x7528;&#xFF0C;&#x4E5F;&#x6CA1;&#x60F3;&#x8FC7;&#x8981;&#x5347;&#x7EA7;&#xFF0C;&#x8C01;&#x77E5;&#x4ECA;&#x5929;&#x88AB;&#x5B83;&#x5751;&#x4E86;&#xFF0C;&#x8D76;&#x7D27;&#x7740;&#x624B;&#x5347;&#x7EA7;&#x5427;&#xFF0C;&#x770B;&#x4E86;&#x4E0B;&#x5347;&#x7EA7;&#x6587;&#x6863;&#xFF0C;Bmob&#x73B0;&#x5728;&#x9AD8;&#x5927;&#x4E0A;&#x4E86;&#xFF0C;&#x4E4B;&#x524D;&#x53EA;&#x80FD;&#x901A;&#x8FC7;&#x5F15;&#x5165;Jar&#x5305;&#x548C;SO&#x5E93;&#x7684;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x96C6;&#x6210;&#xFF0C;&#x73B0;&#x5728;&#x4E5F;&#x5347;&#x7EA7;&#x5230;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528;Gradle&#x4F9D;&#x8D56;&#x8FDB;&#x884C;&#x96C6;&#x6210;&#x4E86;&#xFF0C;&#x65B9;&#x4FBF;&#x4E86;&#x5F88;&#x591A;&#x554A;&#xFF0C;&#x4E8E;&#x662F;&#x7ACB;&#x5373;&#x51B3;&#x5B9A;&#x4F7F;&#x7528;&#x65B0;&#x7684;&#x96C6;&#x6210;&#x65B9;&#x5F0F;&#xFF0C;&#x628A;&#x9879;&#x76EE;&#x4E2D;&#x4E4B;&#x524D;&#x5F15;&#x5165;&#x7684;Jar&#x5305;&#x548C;SO&#x5E93;&#x9010;&#x4E2A;&#x5220;&#x9664;&#x540E;&#xFF0C;&#x90D1;&#x91CD;&#x7684;&#x5728;&#x6211;&#x7684;&#x4E3B;&#x4E1A;&#x52A1;Moudle&#x91CC;&#x52A0;&#x5165;&#x4E86;&#x8FD9;&#x6761;&#x4F9D;&#x8D56;&#xFF1A;</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">api &apos;cn.bmob.android:bmob-sdk:3.6.6&apos;</span><br></pre></td></tr></table></figure>
<p>&#x8C01;&#x77E5;&#x8FD9;&#x624D;&#x662F;&#x95EE;&#x9898;&#x7684;&#x5F00;&#x59CB;&#x2026;&#x2026;.</p>
<h2 id="&#x521D;&#x89C1;Unable_to_merge_dex">&#x521D;&#x89C1;Unable to merge dex</h2><p>&#x6539;&#x4E86;Gradle&#x5FC5;&#x7136;&#x8981;&#x7F16;&#x8BD1;&#xFF0C;&#x4E8E;&#x662F;&#x968F;&#x624B;&#x70B9;&#x4E86;Sync&#x540E;&#x5C31;&#x53BB;&#x6253;&#x6C34;&#x4E0A;&#x5395;&#x6240;&#x4E86;&#xFF0C;&#x7F8E;&#x6ECB;&#x6ECB;&#x7684;&#x56DE;&#x6765;&#x540E;&#x53D1;&#x73B0;&#xFF0C;&#x7EB3;&#x5C3C;&#xFF1F;&#x4E00;&#x7247;&#x8840;&#x7EA2;&#x8272;&#x5728;&#x6211;&#x7684;Build&#x680F;&#x76EE;&#x4E0B;&#xFF0C;&#x4ED4;&#x7EC6;&#x4E00;&#x770B;&#xFF1A;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Caused by: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.RuntimeException: com.android.builder.dexing.DexArchiveMergerException: Unable to <span class="operator"><span class="keyword">merge</span> dex</span><br><span class="line">	<span class="keyword">at</span> sun.reflect.GeneratedConstructorAccessor415.newInstance(<span class="keyword">Unknown</span> <span class="keyword">Source</span>)</span><br><span class="line">	<span class="keyword">at</span> sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.<span class="keyword">java</span>:<span class="number">45</span>)</span><br><span class="line">	<span class="keyword">at</span> <span class="keyword">java</span>.lang.reflect.<span class="keyword">Constructor</span>.newInstance(<span class="keyword">Constructor</span>.<span class="keyword">java</span>:<span class="number">423</span>)</span><br><span class="line">	<span class="keyword">at</span> <span class="keyword">java</span>.util.<span class="keyword">concurrent</span>.ForkJoinTask.getThrowableException(ForkJoinTask.<span class="keyword">java</span>:<span class="number">593</span>)</span><br><span class="line">	<span class="keyword">at</span> <span class="keyword">java</span>.util.<span class="keyword">concurrent</span>.ForkJoinTask.reportException(ForkJoinTask.<span class="keyword">java</span>:<span class="number">677</span>)</span><br><span class="line">	<span class="keyword">at</span> <span class="keyword">java</span>.util.<span class="keyword">concurrent</span>.ForkJoinTask.<span class="keyword">join</span>(ForkJoinTask.<span class="keyword">java</span>:<span class="number">720</span>)</span><br><span class="line">	<span class="keyword">at</span> <span class="keyword">java</span>.util.ArrayList.forEach(ArrayList.<span class="keyword">java</span>:<span class="number">1251</span>)</span><br><span class="line">	<span class="keyword">at</span> com.android.builder.dexing.DxDexArchiveMerger.mergeMonoDex(DxDexArchiveMerger.<span class="keyword">java</span>:<span class="number">177</span>)</span><br><span class="line">	<span class="keyword">at</span> com.android.builder.dexing.DxDexArchiveMerger.mergeDexArchives(DxDexArchiveMerger.<span class="keyword">java</span>:<span class="number">118</span>)</span><br><span class="line">	<span class="keyword">at</span> com.android.<span class="keyword">build</span>.gradle.internal.transforms.DexMergerTransformCallable.<span class="keyword">call</span>(DexMergerTransformCallable.<span class="keyword">java</span>:<span class="number">97</span>)</span><br><span class="line">	<span class="keyword">at</span> com.android.<span class="keyword">build</span>.gradle.internal.transforms.ExternalLibsMergerTransform.transform(ExternalLibsMergerTransform.kt:<span class="number">121</span>)</span><br><span class="line">	<span class="keyword">at</span> com.android.<span class="keyword">build</span>.gradle.internal.pipeline.TransformTask$<span class="number">2.</span><span class="keyword">call</span>(TransformTask.<span class="keyword">java</span>:<span class="number">222</span>)</span><br><span class="line">	<span class="keyword">at</span> com.android.<span class="keyword">build</span>.gradle.internal.pipeline.TransformTask$<span class="number">2.</span><span class="keyword">call</span>(TransformTask.<span class="keyword">java</span>:<span class="number">218</span>)</span><br><span class="line">	<span class="keyword">at</span> com.android.builder.profile.ThreadRecorder.<span class="built_in">record</span>(ThreadRecorder.<span class="keyword">java</span>:<span class="number">102</span>)</span><br><span class="line">	<span class="keyword">at</span> com.android.<span class="keyword">build</span>.gradle.internal.pipeline.TransformTask.transform(TransformTask.<span class="keyword">java</span>:<span class="number">213</span>)</span><br><span class="line">	<span class="keyword">at</span> sun.reflect.GeneratedMethodAccessor777.invoke(<span class="keyword">Unknown</span> <span class="keyword">Source</span>)</span><br><span class="line">	<span class="keyword">at</span> sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.<span class="keyword">java</span>:<span class="number">43</span>)</span><br><span class="line">	<span class="keyword">at</span> <span class="keyword">java</span>.lang.reflect.Method.invoke(Method.<span class="keyword">java</span>:<span class="number">498</span>)</span><br><span class="line">	<span class="keyword">at</span> org.gradle.internal.reflect.JavaMethod.invoke(JavaMethod.<span class="keyword">java</span>:<span class="number">73</span>)</span><br><span class="line">	<span class="keyword">at</span> org.gradle.api.internal.<span class="keyword">project</span>.taskfactory.IncrementalTaskAction.doExecute(IncrementalTaskAction.<span class="keyword">java</span>:<span class="number">46</span>)</span><br><span class="line">	<span class="keyword">at</span> org.gradle.api.internal.<span class="keyword">project</span>.taskfactory.StandardTaskAction.<span class="keyword">execute</span>(StandardTaskAction.<span class="keyword">java</span>:<span class="number">39</span>)</span><br><span class="line">	<span class="keyword">at</span> org.gradle.api.internal.<span class="keyword">project</span>.taskfactory.StandardTaskAction.<span class="keyword">execute</span>(StandardTaskAction.<span class="keyword">java</span>:<span class="number">26</span>)</span><br><span class="line">	<span class="keyword">at</span> org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter$<span class="number">1.</span>run(ExecuteActionsTaskExecuter.<span class="keyword">java</span>:<span class="number">121</span>)</span><br><span class="line">	<span class="keyword">at</span> org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.<span class="keyword">execute</span>(DefaultBuildOperationExecutor.<span class="keyword">java</span>:<span class="number">336</span>)</span><br><span class="line">	<span class="keyword">at</span> org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.<span class="keyword">execute</span>(DefaultBuildOperationExecutor.<span class="keyword">java</span>:<span class="number">328</span>)</span><br><span class="line">	<span class="keyword">at</span> org.gradle.internal.progress.DefaultBuildOperationExecutor.<span class="keyword">execute</span>(DefaultBuildOperationExecutor.<span class="keyword">java</span>:<span class="number">199</span>)</span><br><span class="line">	<span class="keyword">at</span> org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.<span class="keyword">java</span>:<span class="number">110</span>)</span><br><span class="line">	<span class="keyword">at</span> org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeAction(ExecuteActionsTaskExecuter.<span class="keyword">java</span>:<span class="number">110</span>)</span><br><span class="line">	<span class="keyword">at</span> org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.<span class="keyword">java</span>:<span class="number">92</span>)</span><br><span class="line">	... <span class="number">32</span> more</span></span><br></pre></td></tr></table></figure>
<p>&#x5176;&#x5B9E;&#x505A;&#x4E86;&#x8FD9;&#x4E48;&#x4E45;Android&#x5F00;&#x53D1;&#xFF0C;&#x80AF;&#x5B9A;&#x662F;&#x5904;&#x7406;&#x8FC7;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#xFF0C;&#x7B2C;&#x4E00;&#x53CD;&#x5E94;&#x662F;&#x91CD;&#x590D;&#x4F9D;&#x8D56;&#x7684;&#x95EE;&#x9898;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x4E0A;&#x9762;&#x8FD9;&#x4E2A;&#x9519;&#x8BEF;&#x4FE1;&#x606F;&#x5E76;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x4EFB;&#x4F55;&#x4FE1;&#x606F;&#x544A;&#x8BC9;&#x6211;&#x90A3;&#x4E2A;&#x4F9D;&#x8D56;&#x91CD;&#x590D;&#x4E86;&#xFF0C;&#x8FD9;&#x662F;&#x8981;&#x505A;&#x7684;&#x5C31;&#x662F;&#x5728;AndroidStudio&#x7684;Terminal&#x4E0B;&#x6267;&#x884C;&#x4E0B;&#x9762;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gradlew app:transformDexArchiveWithExternalLibsDexMergerForDebug <span class="comment">--stacktrace</span></span><br></pre></td></tr></table></figure>
<p>&#x5176;&#x5B9E;&#x8FD9;&#x91CC;&#x5C31;&#x662F;&#x6839;&#x636E; &#x2013;stacktrace &#x6765;&#x67E5;&#x770B;&#x8FD9;&#x4E2A;&#x9519;&#x8BEF;&#x7684;&#x5173;&#x952E;&#x6027;&#x5806;&#x6808;&#x4FE1;&#x606F;&#xFF0C;&#x5177;&#x4F53;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#xFF1A;</p>
<p><a href="https://www.jianshu.com/p/50ad1c4be2de" target="_blank" rel="external">Gradle &#x65E5;&#x5FD7;</a></p>
<p>&#x7136;&#x540E;&#x5C31;&#x4F1A;&#x5728;&#x8BE5;&#x754C;&#x9762;&#x770B;&#x5230;&#x5982;&#x4E0B;&#x62A5;&#x9519;&#x4FE1;&#x606F;&#xFF1A;</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br></pre></td><td class="code"><pre><span class="line">tarting a Gradle Daemon, 1 incompatible Daemon could not be reused, use --status for details</span><br><span class="line"></span><br><span class="line">&gt; Configure project :app </span><br><span class="line">Configuration &apos;compile&apos; in project &apos;:app&apos; is deprecated. Use &apos;implementation&apos; instead.</span><br><span class="line">Observed package id &apos;build-tools;19.0.3&apos; in inconsistent location &apos;E:\AndroidSDK\adt-bundle-windows-x86_64-20140321\sdk\build-tools\android-4.4.2&apos; (Expected &apos;E:\And</span><br><span class="line">roidSDK\adt-bundle-windows-x86_64-20140321\sdk\build-tools\19.0.3&apos;)</span><br><span class="line">Observed package id &apos;system-images;android-19;default;armeabi-v7a&apos; in inconsistent location &apos;E:\AndroidSDK\adt-bundle-windows-x86_64-20140321\sdk\system-images\andr</span><br><span class="line">oid-19\armeabi-v7a&apos; (Expected &apos;E:\AndroidSDK\adt-bundle-windows-x86_64-20140321\sdk\system-images\android-19\default\armeabi-v7a&apos;)</span><br><span class="line">Observed package id &apos;build-tools;19.0.3&apos; in inconsistent location &apos;E:\AndroidSDK\adt-bundle-windows-x86_64-20140321\sdk\build-tools\android-4.4.2&apos; (Expected &apos;E:\And</span><br><span class="line">roidSDK\adt-bundle-windows-x86_64-20140321\sdk\build-tools\19.0.3&apos;)</span><br><span class="line">Observed package id &apos;system-images;android-19;default;armeabi-v7a&apos; in inconsistent location &apos;E:\AndroidSDK\adt-bundle-windows-x86_64-20140321\sdk\system-images\andr</span><br><span class="line">oid-19\armeabi-v7a&apos; (Expected &apos;E:\AndroidSDK\adt-bundle-windows-x86_64-20140321\sdk\system-images\android-19\default\armeabi-v7a&apos;)</span><br><span class="line">The CompileOptions.bootClasspath property has been deprecated and is scheduled to be removed in Gradle 5.0. Please use the CompileOptions.bootstrapClasspath propert</span><br><span class="line">y instead.</span><br><span class="line">        at org.gradle.api.tasks.compile.CompileOptions.setBootClasspath(CompileOptions.java:273)</span><br><span class="line">        at org.gradle.api.tasks.compile.CompileOptions_Decorated.setBootClasspath(Unknown Source)</span><br><span class="line">        at com.android.build.gradle.tasks.factory.JavaCompileConfigAction.execute(JavaCompileConfigAction.java:77)</span><br><span class="line">        at com.android.build.gradle.tasks.factory.JavaCompileConfigAction.execute(JavaCompileConfigAction.java:31)</span><br><span class="line">        at org.gradle.api.internal.tasks.DefaultTaskContainer.create(DefaultTaskContainer.java:148)</span><br><span class="line">        at com.android.build.gradle.internal.TaskContainerAdaptor.create(TaskContainerAdaptor.java:58)</span><br><span class="line">        at com.android.build.gradle.internal.scope.AndroidTaskRegistry.create(AndroidTaskRegistry.java:45)</span><br><span class="line">        at com.android.build.gradle.internal.scope.AndroidTaskRegistry.create(AndroidTaskRegistry.java:87)</span><br><span class="line">        at com.android.build.gradle.internal.TaskManager.createJavacTask(TaskManager.java:1510)</span><br><span class="line">        at com.android.build.gradle.internal.ApplicationTaskManager.addCompileTask(ApplicationTaskManager.java:263)</span><br><span class="line">        at com.android.build.gradle.internal.ApplicationTaskManager.lambda$createTasksForVariantScope$12(ApplicationTaskManager.java:224)</span><br><span class="line">        at com.android.builder.profile.ThreadRecorder.record(ThreadRecorder.java:81)</span><br><span class="line">        at com.android.build.gradle.internal.ApplicationTaskManager.createTasksForVariantScope(ApplicationTaskManager.java:220)</span><br><span class="line">        at com.android.build.gradle.internal.VariantManager.createTasksForVariantData(VariantManager.java:545)</span><br><span class="line">        at com.android.build.gradle.internal.VariantManager.lambda$createAndroidTasks$1(VariantManager.java:355)</span><br><span class="line">        at com.android.builder.profile.ThreadRecorder.record(ThreadRecorder.java:81)</span><br><span class="line">        at com.android.build.gradle.internal.VariantManager.createAndroidTasks(VariantManager.java:351)</span><br><span class="line">        at com.android.build.gradle.BasePlugin.lambda$createAndroidTasks$5(BasePlugin.java:641)</span><br><span class="line">        at com.android.builder.profile.ThreadRecorder.record(ThreadRecorder.java:81)</span><br><span class="line">        at com.android.build.gradle.BasePlugin.createAndroidTasks(BasePlugin.java:636)</span><br><span class="line">        at com.android.build.gradle.BasePlugin.lambda$null$3(BasePlugin.java:555)</span><br><span class="line">        at com.android.builder.profile.ThreadRecorder.record(ThreadRecorder.java:81)</span><br><span class="line">        at com.android.build.gradle.BasePlugin.lambda$createTasks$4(BasePlugin.java:551)</span><br><span class="line">        at org.gradle.internal.event.BroadcastDispatch$ActionInvocationHandler.dispatch(BroadcastDispatch.java:91)</span><br><span class="line">        at org.gradle.internal.event.BroadcastDispatch$ActionInvocationHandler.dispatch(BroadcastDispatch.java:80)</span><br><span class="line">        at org.gradle.internal.event.AbstractBroadcastDispatch.dispatch(AbstractBroadcastDispatch.java:42)</span><br><span class="line">        at org.gradle.internal.event.BroadcastDispatch$SingletonDispatch.dispatch(BroadcastDispatch.java:230)</span><br><span class="line">        at org.gradle.internal.event.BroadcastDispatch$SingletonDispatch.dispatch(BroadcastDispatch.java:149)</span><br><span class="line">        at org.gradle.internal.event.AbstractBroadcastDispatch.dispatch(AbstractBroadcastDispatch.java:58)</span><br><span class="line">        at org.gradle.internal.event.BroadcastDispatch$CompositeDispatch.dispatch(BroadcastDispatch.java:324)</span><br><span class="line">        at org.gradle.internal.event.BroadcastDispatch$CompositeDispatch.dispatch(BroadcastDispatch.java:234)</span><br><span class="line">        at org.gradle.internal.event.ListenerBroadcast.dispatch(ListenerBroadcast.java:140)</span><br><span class="line">        at org.gradle.internal.event.ListenerBroadcast.dispatch(ListenerBroadcast.java:37)</span><br><span class="line">        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)</span><br><span class="line">        at com.sun.proxy.$Proxy25.afterEvaluate(Unknown Source)</span><br><span class="line">        at org.gradle.configuration.project.LifecycleProjectEvaluator.notifyAfterEvaluate(LifecycleProjectEvaluator.java:76)</span><br><span class="line">        at org.gradle.configuration.project.LifecycleProjectEvaluator.doConfigure(LifecycleProjectEvaluator.java:70)</span><br><span class="line">        at org.gradle.configuration.project.LifecycleProjectEvaluator.access$100(LifecycleProjectEvaluator.java:34)</span><br><span class="line">        at org.gradle.configuration.project.LifecycleProjectEvaluator$ConfigureProject.run(LifecycleProjectEvaluator.java:110)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:336)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:328)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.execute(DefaultBuildOperationExecutor.java:199)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:110)</span><br><span class="line">        at org.gradle.configuration.project.LifecycleProjectEvaluator.evaluate(LifecycleProjectEvaluator.java:50)</span><br><span class="line">        at org.gradle.api.internal.project.DefaultProject.evaluate(DefaultProject.java:666)</span><br><span class="line">        at org.gradle.api.internal.project.DefaultProject.evaluate(DefaultProject.java:135)</span><br><span class="line">        at org.gradle.execution.TaskPathProjectEvaluator.configure(TaskPathProjectEvaluator.java:35)</span><br><span class="line">        at org.gradle.execution.TaskPathProjectEvaluator.configureHierarchy(TaskPathProjectEvaluator.java:62)</span><br><span class="line">        at org.gradle.configuration.DefaultBuildConfigurer.configure(DefaultBuildConfigurer.java:38)</span><br><span class="line">        at org.gradle.initialization.DefaultGradleLauncher$ConfigureBuild.run(DefaultGradleLauncher.java:249)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:336)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:328)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.execute(DefaultBuildOperationExecutor.java:199)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:110)</span><br><span class="line">        at org.gradle.initialization.DefaultGradleLauncher.configureBuild(DefaultGradleLauncher.java:167)</span><br><span class="line">        at org.gradle.initialization.DefaultGradleLauncher.doBuildStages(DefaultGradleLauncher.java:126)</span><br><span class="line">        at org.gradle.initialization.DefaultGradleLauncher.executeTasks(DefaultGradleLauncher.java:109)</span><br><span class="line">        at org.gradle.internal.invocation.GradleBuildController$1.call(GradleBuildController.java:78)</span><br><span class="line">        at org.gradle.internal.invocation.GradleBuildController$1.call(GradleBuildController.java:75)</span><br><span class="line">        at org.gradle.internal.work.DefaultWorkerLeaseService.withLocks(DefaultWorkerLeaseService.java:152)</span><br><span class="line">        at org.gradle.internal.invocation.GradleBuildController.doBuild(GradleBuildController.java:100)</span><br><span class="line">        at org.gradle.internal.invocation.GradleBuildController.run(GradleBuildController.java:75)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ExecuteBuildActionRunner.run(ExecuteBuildActionRunner.java:28)</span><br><span class="line">        at org.gradle.launcher.exec.ChainingBuildActionRunner.run(ChainingBuildActionRunner.java:35)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ValidatingBuildActionRunner.run(ValidatingBuildActionRunner.java:32)</span><br><span class="line">        at org.gradle.launcher.exec.RunAsBuildOperationBuildActionRunner$1.run(RunAsBuildOperationBuildActionRunner.java:43)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:336)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:328)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.execute(DefaultBuildOperationExecutor.java:199)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:110)</span><br><span class="line">        at org.gradle.launcher.exec.RunAsBuildOperationBuildActionRunner.run(RunAsBuildOperationBuildActionRunner.java:40)</span><br><span class="line">        at org.gradle.tooling.internal.provider.SubscribableBuildActionRunner.run(SubscribableBuildActionRunner.java:51)</span><br><span class="line">        at org.gradle.launcher.exec.InProcessBuildActionExecuter.execute(InProcessBuildActionExecuter.java:47)</span><br><span class="line">        at org.gradle.launcher.exec.InProcessBuildActionExecuter.execute(InProcessBuildActionExecuter.java:30)</span><br><span class="line">        at org.gradle.launcher.exec.BuildTreeScopeBuildActionExecuter.execute(BuildTreeScopeBuildActionExecuter.java:39)</span><br><span class="line">        at org.gradle.launcher.exec.BuildTreeScopeBuildActionExecuter.execute(BuildTreeScopeBuildActionExecuter.java:25)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ContinuousBuildActionExecuter.execute(ContinuousBuildActionExecuter.java:80)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ContinuousBuildActionExecuter.execute(ContinuousBuildActionExecuter.java:53)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ServicesSetupBuildActionExecuter.execute(ServicesSetupBuildActionExecuter.java:57)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ServicesSetupBuildActionExecuter.execute(ServicesSetupBuildActionExecuter.java:32)</span><br><span class="line">        at org.gradle.tooling.internal.provider.GradleThreadBuildActionExecuter.execute(GradleThreadBuildActionExecuter.java:36)</span><br><span class="line">        at org.gradle.tooling.internal.provider.GradleThreadBuildActionExecuter.execute(GradleThreadBuildActionExecuter.java:25)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ParallelismConfigurationBuildActionExecuter.execute(ParallelismConfigurationBuildActionExecuter.java:43)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ParallelismConfigurationBuildActionExecuter.execute(ParallelismConfigurationBuildActionExecuter.java:29)</span><br><span class="line">        at org.gradle.tooling.internal.provider.StartParamsValidatingActionExecuter.execute(StartParamsValidatingActionExecuter.java:69)</span><br><span class="line">        at org.gradle.tooling.internal.provider.StartParamsValidatingActionExecuter.execute(StartParamsValidatingActionExecuter.java:30)</span><br><span class="line">        at org.gradle.tooling.internal.provider.SessionFailureReportingActionExecuter.execute(SessionFailureReportingActionExecuter.java:59)</span><br><span class="line">        at org.gradle.tooling.internal.provider.SessionFailureReportingActionExecuter.execute(SessionFailureReportingActionExecuter.java:44)</span><br><span class="line">        at org.gradle.tooling.internal.provider.SetupLoggingActionExecuter.execute(SetupLoggingActionExecuter.java:45)</span><br><span class="line">        at org.gradle.tooling.internal.provider.SetupLoggingActionExecuter.execute(SetupLoggingActionExecuter.java:30)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.ExecuteBuild.doBuild(ExecuteBuild.java:67)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:36)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.WatchForDisconnection.execute(WatchForDisconnection.java:37)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.ResetDeprecationLogger.execute(ResetDeprecationLogger.java:26)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.RequestStopIfSingleUsedDaemon.execute(RequestStopIfSingleUsedDaemon.java:34)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.ForwardClientInput$2.call(ForwardClientInput.java:74)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.ForwardClientInput$2.call(ForwardClientInput.java:72)</span><br><span class="line">        at org.gradle.util.Swapper.swap(Swapper.java:38)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.ForwardClientInput.execute(ForwardClientInput.java:72)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.LogAndCheckHealth.execute(LogAndCheckHealth.java:55)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.LogToClient.doBuild(LogToClient.java:62)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:36)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.EstablishBuildEnvironment.doBuild(EstablishBuildEnvironment.java:82)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:36)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.StartBuildOrRespondWithBusy$1.run(StartBuildOrRespondWithBusy.java:50)</span><br><span class="line">        at org.gradle.launcher.daemon.server.DaemonStateCoordinator$1.run(DaemonStateCoordinator.java:295)</span><br><span class="line">        at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:63)</span><br><span class="line">        at org.gradle.internal.concurrent.ManagedExecutorImpl$1.run(ManagedExecutorImpl.java:46)</span><br><span class="line">        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)</span><br><span class="line">        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)</span><br><span class="line">        at org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:55)</span><br><span class="line">        at java.lang.Thread.run(Thread.java:748)</span><br><span class="line"></span><br><span class="line">&gt; Configure project :coolrouterlibrary </span><br><span class="line">Configuration &apos;compile&apos; in project &apos;:coolrouterlibrary&apos; is deprecated. Use &apos;implementation&apos; instead.</span><br><span class="line"></span><br><span class="line">&gt; Configure project :oa_core </span><br><span class="line">Configuration &apos;compile&apos; in project &apos;:oa_core&apos; is deprecated. Use &apos;implementation&apos; instead.</span><br><span class="line"></span><br><span class="line">&gt; Task :app:processDebugManifest </span><br><span class="line">D:\AndroidDhccWorkSpace\zhidoule2\app\src\main\AndroidManifest.xml:162:5-81 Warning:</span><br><span class="line">        Element uses-permission#android.permission.WRITE_EXTERNAL_STORAGE at AndroidManifest.xml:162:5-81 duplicated with element declared at AndroidManifest.xml:15</span><br><span class="line">3:5-81</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">FAILURE: Build failed with an exception.</span><br><span class="line"></span><br><span class="line">* What went wrong:</span><br><span class="line">Execution failed for task &apos;:app:transformDexArchiveWithExternalLibsDexMergerForDebug&apos;.</span><br><span class="line">&gt; java.lang.RuntimeException: java.lang.RuntimeException: com.android.builder.dexing.DexArchiveMergerException: Unable to merge dex</span><br><span class="line"></span><br><span class="line">* Try:</span><br><span class="line">Run with --info or --debug option to get more log output. Run with --scan to get full insights.</span><br><span class="line"></span><br><span class="line">* Exception is:</span><br><span class="line">org.gradle.api.tasks.TaskExecutionException: Execution failed for task &apos;:app:transformDexArchiveWithExternalLibsDexMergerForDebug&apos;.</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:100)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.execute(ExecuteActionsTaskExecuter.java:70)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.OutputDirectoryCreatingTaskExecuter.execute(OutputDirectoryCreatingTaskExecuter.java:51)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.SkipUpToDateTaskExecuter.execute(SkipUpToDateTaskExecuter.java:62)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ResolveTaskOutputCachingStateExecuter.execute(ResolveTaskOutputCachingStateExecuter.java:54)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ValidatingTaskExecuter.execute(ValidatingTaskExecuter.java:60)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.SkipEmptySourceFilesTaskExecuter.execute(SkipEmptySourceFilesTaskExecuter.java:97)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.CleanupStaleOutputsExecuter.execute(CleanupStaleOutputsExecuter.java:87)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ResolveTaskArtifactStateTaskExecuter.execute(ResolveTaskArtifactStateTaskExecuter.java:52)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.SkipTaskWithNoActionsExecuter.execute(SkipTaskWithNoActionsExecuter.java:52)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.SkipOnlyIfTaskExecuter.execute(SkipOnlyIfTaskExecuter.java:54)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ExecuteAtMostOnceTaskExecuter.execute(ExecuteAtMostOnceTaskExecuter.java:43)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.CatchExceptionTaskExecuter.execute(CatchExceptionTaskExecuter.java:34)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter$EventFiringTaskWorker$1.run(DefaultTaskGraphExecuter.java:248)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:336)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:328)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.execute(DefaultBuildOperationExecutor.java:199)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:110)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter$EventFiringTaskWorker.execute(DefaultTaskGraphExecuter.java:241)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter$EventFiringTaskWorker.execute(DefaultTaskGraphExecuter.java:230)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskPlanExecutor$TaskExecutorWorker.processTask(DefaultTaskPlanExecutor.java:123)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskPlanExecutor$TaskExecutorWorker.access$200(DefaultTaskPlanExecutor.java:79)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskPlanExecutor$TaskExecutorWorker$1.execute(DefaultTaskPlanExecutor.java:104)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskPlanExecutor$TaskExecutorWorker$1.execute(DefaultTaskPlanExecutor.java:98)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskExecutionPlan.execute(DefaultTaskExecutionPlan.java:626)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskExecutionPlan.executeWithTask(DefaultTaskExecutionPlan.java:581)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskPlanExecutor$TaskExecutorWorker.run(DefaultTaskPlanExecutor.java:98)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskPlanExecutor.process(DefaultTaskPlanExecutor.java:59)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter.execute(DefaultTaskGraphExecuter.java:128)</span><br><span class="line">        at org.gradle.execution.SelectedTaskExecutionAction.execute(SelectedTaskExecutionAction.java:37)</span><br><span class="line">        at org.gradle.execution.DefaultBuildExecuter.execute(DefaultBuildExecuter.java:37)</span><br><span class="line">        at org.gradle.execution.DefaultBuildExecuter.access$000(DefaultBuildExecuter.java:23)</span><br><span class="line">        at org.gradle.execution.DefaultBuildExecuter$1.proceed(DefaultBuildExecuter.java:43)</span><br><span class="line">        at org.gradle.execution.DryRunBuildExecutionAction.execute(DryRunBuildExecutionAction.java:46)</span><br><span class="line">        at org.gradle.execution.DefaultBuildExecuter.execute(DefaultBuildExecuter.java:37)</span><br><span class="line">        at org.gradle.execution.DefaultBuildExecuter.execute(DefaultBuildExecuter.java:30)</span><br><span class="line">        at org.gradle.initialization.DefaultGradleLauncher$ExecuteTasks.run(DefaultGradleLauncher.java:314)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:336)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:328)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.execute(DefaultBuildOperationExecutor.java:199)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:110)</span><br><span class="line">        at org.gradle.initialization.DefaultGradleLauncher.runTasks(DefaultGradleLauncher.java:204)</span><br><span class="line">        at org.gradle.initialization.DefaultGradleLauncher.doBuildStages(DefaultGradleLauncher.java:134)</span><br><span class="line">        at org.gradle.initialization.DefaultGradleLauncher.executeTasks(DefaultGradleLauncher.java:109)</span><br><span class="line">        at org.gradle.internal.invocation.GradleBuildController$1.call(GradleBuildController.java:78)</span><br><span class="line">        at org.gradle.internal.invocation.GradleBuildController$1.call(GradleBuildController.java:75)</span><br><span class="line">        at org.gradle.internal.work.DefaultWorkerLeaseService.withLocks(DefaultWorkerLeaseService.java:152)</span><br><span class="line">        at org.gradle.internal.invocation.GradleBuildController.doBuild(GradleBuildController.java:100)</span><br><span class="line">        at org.gradle.internal.invocation.GradleBuildController.run(GradleBuildController.java:75)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ExecuteBuildActionRunner.run(ExecuteBuildActionRunner.java:28)</span><br><span class="line">        at org.gradle.launcher.exec.ChainingBuildActionRunner.run(ChainingBuildActionRunner.java:35)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ValidatingBuildActionRunner.run(ValidatingBuildActionRunner.java:32)</span><br><span class="line">        at org.gradle.launcher.exec.RunAsBuildOperationBuildActionRunner$1.run(RunAsBuildOperationBuildActionRunner.java:43)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:336)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:328)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.execute(DefaultBuildOperationExecutor.java:199)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:110)</span><br><span class="line">        at org.gradle.launcher.exec.RunAsBuildOperationBuildActionRunner.run(RunAsBuildOperationBuildActionRunner.java:40)</span><br><span class="line">        at org.gradle.tooling.internal.provider.SubscribableBuildActionRunner.run(SubscribableBuildActionRunner.java:51)</span><br><span class="line">        at org.gradle.launcher.exec.InProcessBuildActionExecuter.execute(InProcessBuildActionExecuter.java:47)</span><br><span class="line">        at org.gradle.launcher.exec.InProcessBuildActionExecuter.execute(InProcessBuildActionExecuter.java:30)</span><br><span class="line">        at org.gradle.launcher.exec.BuildTreeScopeBuildActionExecuter.execute(BuildTreeScopeBuildActionExecuter.java:39)</span><br><span class="line">        at org.gradle.launcher.exec.BuildTreeScopeBuildActionExecuter.execute(BuildTreeScopeBuildActionExecuter.java:25)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ContinuousBuildActionExecuter.execute(ContinuousBuildActionExecuter.java:80)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ContinuousBuildActionExecuter.execute(ContinuousBuildActionExecuter.java:53)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ServicesSetupBuildActionExecuter.execute(ServicesSetupBuildActionExecuter.java:57)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ServicesSetupBuildActionExecuter.execute(ServicesSetupBuildActionExecuter.java:32)</span><br><span class="line">        at org.gradle.tooling.internal.provider.GradleThreadBuildActionExecuter.execute(GradleThreadBuildActionExecuter.java:36)</span><br><span class="line">        at org.gradle.tooling.internal.provider.GradleThreadBuildActionExecuter.execute(GradleThreadBuildActionExecuter.java:25)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ParallelismConfigurationBuildActionExecuter.execute(ParallelismConfigurationBuildActionExecuter.java:43)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ParallelismConfigurationBuildActionExecuter.execute(ParallelismConfigurationBuildActionExecuter.java:29)</span><br><span class="line">        at org.gradle.tooling.internal.provider.StartParamsValidatingActionExecuter.execute(StartParamsValidatingActionExecuter.java:69)</span><br><span class="line">        at org.gradle.tooling.internal.provider.StartParamsValidatingActionExecuter.execute(StartParamsValidatingActionExecuter.java:30)</span><br><span class="line">        at org.gradle.tooling.internal.provider.SessionFailureReportingActionExecuter.execute(SessionFailureReportingActionExecuter.java:59)</span><br><span class="line">        at org.gradle.tooling.internal.provider.SessionFailureReportingActionExecuter.execute(SessionFailureReportingActionExecuter.java:44)</span><br><span class="line">        at org.gradle.tooling.internal.provider.SetupLoggingActionExecuter.execute(SetupLoggingActionExecuter.java:45)</span><br><span class="line">        at org.gradle.tooling.internal.provider.SetupLoggingActionExecuter.execute(SetupLoggingActionExecuter.java:30)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.ExecuteBuild.doBuild(ExecuteBuild.java:67)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:36)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.WatchForDisconnection.execute(WatchForDisconnection.java:37)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.ResetDeprecationLogger.execute(ResetDeprecationLogger.java:26)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.RequestStopIfSingleUsedDaemon.execute(RequestStopIfSingleUsedDaemon.java:34)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.ForwardClientInput$2.call(ForwardClientInput.java:74)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.ForwardClientInput$2.call(ForwardClientInput.java:72)</span><br><span class="line">        at org.gradle.util.Swapper.swap(Swapper.java:38)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.ForwardClientInput.execute(ForwardClientInput.java:72)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.LogAndCheckHealth.execute(LogAndCheckHealth.java:55)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.LogToClient.doBuild(LogToClient.java:62)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:36)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.EstablishBuildEnvironment.doBuild(EstablishBuildEnvironment.java:82)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:36)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.StartBuildOrRespondWithBusy$1.run(StartBuildOrRespondWithBusy.java:50)</span><br><span class="line">        at org.gradle.launcher.daemon.server.DaemonStateCoordinator$1.run(DaemonStateCoordinator.java:295)</span><br><span class="line">        at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:63)</span><br><span class="line">        at org.gradle.internal.concurrent.ManagedExecutorImpl$1.run(ManagedExecutorImpl.java:46)</span><br><span class="line">        at org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:55)</span><br><span class="line">Caused by: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.RuntimeException: com.android.builder.dexing.DexArchiveMergerException: Unable to merge</span><br><span class="line"> dex</span><br><span class="line">        at com.android.builder.dexing.DxDexArchiveMerger.mergeMonoDex(DxDexArchiveMerger.java:177)</span><br><span class="line">        at com.android.builder.dexing.DxDexArchiveMerger.mergeDexArchives(DxDexArchiveMerger.java:118)</span><br><span class="line">        at com.android.build.gradle.internal.transforms.DexMergerTransformCallable.call(DexMergerTransformCallable.java:97)</span><br><span class="line">        at com.android.build.gradle.internal.transforms.ExternalLibsMergerTransform.transform(ExternalLibsMergerTransform.kt:121)</span><br><span class="line">        at com.android.build.gradle.internal.pipeline.TransformTask$2.call(TransformTask.java:222)</span><br><span class="line">        at com.android.build.gradle.internal.pipeline.TransformTask$2.call(TransformTask.java:218)</span><br><span class="line">        at com.android.builder.profile.ThreadRecorder.record(ThreadRecorder.java:102)</span><br><span class="line">        at com.android.build.gradle.internal.pipeline.TransformTask.transform(TransformTask.java:213)</span><br><span class="line">        at org.gradle.internal.reflect.JavaMethod.invoke(JavaMethod.java:73)</span><br><span class="line">        at org.gradle.api.internal.project.taskfactory.IncrementalTaskAction.doExecute(IncrementalTaskAction.java:46)</span><br><span class="line">        at org.gradle.api.internal.project.taskfactory.StandardTaskAction.execute(StandardTaskAction.java:39)</span><br><span class="line">        at org.gradle.api.internal.project.taskfactory.StandardTaskAction.execute(StandardTaskAction.java:26)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter$1.run(ExecuteActionsTaskExecuter.java:121)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:336)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:328)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.execute(DefaultBuildOperationExecutor.java:199)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:110)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeAction(ExecuteActionsTaskExecuter.java:110)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:92)</span><br><span class="line">        ... 103 more</span><br><span class="line">Caused by: java.lang.RuntimeException: java.lang.RuntimeException: com.android.builder.dexing.DexArchiveMergerException: Unable to merge dex</span><br><span class="line">        at com.android.builder.dexing.DxDexArchiveMerger.lambda$mergeMonoDex$0(DxDexArchiveMerger.java:171)</span><br><span class="line">Caused by: java.lang.RuntimeException: com.android.builder.dexing.DexArchiveMergerException: Unable to merge dex</span><br><span class="line">Caused by: com.android.builder.dexing.DexArchiveMergerException: Unable to merge dex</span><br><span class="line">        at com.android.builder.dexing.DexArchiveMergerCallable.call(DexArchiveMergerCallable.java:72)</span><br><span class="line">        at com.android.builder.dexing.DexArchiveMergerCallable.call(DexArchiveMergerCallable.java:36)</span><br><span class="line">Caused by: com.android.dex.DexException: Multiple dex files define Lrx/internal/operators/OperatorReplay$3;</span><br><span class="line">        at com.android.dx.merge.DexMerger.readSortableTypes(DexMerger.java:661)</span><br><span class="line">        at com.android.dx.merge.DexMerger.getSortedTypes(DexMerger.java:616)</span><br><span class="line">        at com.android.dx.merge.DexMerger.mergeClassDefs(DexMerger.java:598)</span><br><span class="line">        at com.android.dx.merge.DexMerger.mergeDexes(DexMerger.java:171)</span><br><span class="line">        at com.android.dx.merge.DexMerger.merge(DexMerger.java:198)</span><br><span class="line">        at com.android.builder.dexing.DexArchiveMergerCallable.call(DexArchiveMergerCallable.java:61)</span><br><span class="line">        ... 1 more</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* Get more help at https://help.gradle.org</span><br><span class="line"></span><br><span class="line">BUILD FAILED in 29s</span><br><span class="line">81 actionable tasks: 8 executed, 73 up-to-date</span><br><span class="line"></span><br><span class="line">D:\AndroidDhccWorkSpace\zhidoule2&gt;gradlew app:transformDexArchiveWithExternalLibsDexMergerForDebug --stacktrace</span><br><span class="line"></span><br><span class="line">&gt; Configure project :app </span><br><span class="line">Configuration &apos;compile&apos; in project &apos;:app&apos; is deprecated. Use &apos;implementation&apos; instead.</span><br><span class="line">Observed package id &apos;build-tools;19.0.3&apos; in inconsistent location &apos;E:\AndroidSDK\adt-bundle-windows-x86_64-20140321\sdk\build-tools\android-4.4.2&apos; (Expected &apos;E:\And</span><br><span class="line">roidSDK\adt-bundle-windows-x86_64-20140321\sdk\build-tools\19.0.3&apos;)</span><br><span class="line">Observed package id &apos;system-images;android-19;default;armeabi-v7a&apos; in inconsistent location &apos;E:\AndroidSDK\adt-bundle-windows-x86_64-20140321\sdk\system-images\andr</span><br><span class="line">oid-19\armeabi-v7a&apos; (Expected &apos;E:\AndroidSDK\adt-bundle-windows-x86_64-20140321\sdk\system-images\android-19\default\armeabi-v7a&apos;)</span><br><span class="line">The CompileOptions.bootClasspath property has been deprecated and is scheduled to be removed in Gradle 5.0. Please use the CompileOptions.bootstrapClasspath propert</span><br><span class="line">y instead.</span><br><span class="line">        at org.gradle.api.tasks.compile.CompileOptions.setBootClasspath(CompileOptions.java:273)</span><br><span class="line">        at org.gradle.api.tasks.compile.CompileOptions_Decorated.setBootClasspath(Unknown Source)</span><br><span class="line">        at com.android.build.gradle.tasks.factory.JavaCompileConfigAction.execute(JavaCompileConfigAction.java:77)</span><br><span class="line">        at com.android.build.gradle.tasks.factory.JavaCompileConfigAction.execute(JavaCompileConfigAction.java:31)</span><br><span class="line">        at org.gradle.api.internal.tasks.DefaultTaskContainer.create(DefaultTaskContainer.java:148)</span><br><span class="line">        at com.android.build.gradle.internal.TaskContainerAdaptor.create(TaskContainerAdaptor.java:58)</span><br><span class="line">        at com.android.build.gradle.internal.scope.AndroidTaskRegistry.create(AndroidTaskRegistry.java:45)</span><br><span class="line">        at com.android.build.gradle.internal.scope.AndroidTaskRegistry.create(AndroidTaskRegistry.java:87)</span><br><span class="line">        at com.android.build.gradle.internal.TaskManager.createJavacTask(TaskManager.java:1510)</span><br><span class="line">        at com.android.build.gradle.internal.ApplicationTaskManager.addCompileTask(ApplicationTaskManager.java:263)</span><br><span class="line">        at com.android.build.gradle.internal.ApplicationTaskManager.lambda$createTasksForVariantScope$12(ApplicationTaskManager.java:224)</span><br><span class="line">        at com.android.builder.profile.ThreadRecorder.record(ThreadRecorder.java:81)</span><br><span class="line">        at com.android.build.gradle.internal.ApplicationTaskManager.createTasksForVariantScope(ApplicationTaskManager.java:220)</span><br><span class="line">        at com.android.build.gradle.internal.VariantManager.createTasksForVariantData(VariantManager.java:545)</span><br><span class="line">        at com.android.build.gradle.internal.VariantManager.lambda$createAndroidTasks$1(VariantManager.java:355)</span><br><span class="line">        at com.android.builder.profile.ThreadRecorder.record(ThreadRecorder.java:81)</span><br><span class="line">        at com.android.build.gradle.internal.VariantManager.createAndroidTasks(VariantManager.java:351)</span><br><span class="line">        at com.android.build.gradle.BasePlugin.lambda$createAndroidTasks$5(BasePlugin.java:641)</span><br><span class="line">        at com.android.builder.profile.ThreadRecorder.record(ThreadRecorder.java:81)</span><br><span class="line">        at com.android.build.gradle.BasePlugin.createAndroidTasks(BasePlugin.java:636)</span><br><span class="line">        at com.android.build.gradle.BasePlugin.lambda$null$3(BasePlugin.java:555)</span><br><span class="line">        at com.android.builder.profile.ThreadRecorder.record(ThreadRecorder.java:81)</span><br><span class="line">        at com.android.build.gradle.BasePlugin.lambda$createTasks$4(BasePlugin.java:551)</span><br><span class="line">        at org.gradle.internal.event.BroadcastDispatch$ActionInvocationHandler.dispatch(BroadcastDispatch.java:91)</span><br><span class="line">        at org.gradle.internal.event.BroadcastDispatch$ActionInvocationHandler.dispatch(BroadcastDispatch.java:80)</span><br><span class="line">        at org.gradle.internal.event.AbstractBroadcastDispatch.dispatch(AbstractBroadcastDispatch.java:42)</span><br><span class="line">        at org.gradle.internal.event.BroadcastDispatch$SingletonDispatch.dispatch(BroadcastDispatch.java:230)</span><br><span class="line">        at org.gradle.internal.event.BroadcastDispatch$SingletonDispatch.dispatch(BroadcastDispatch.java:149)</span><br><span class="line">        at org.gradle.internal.event.AbstractBroadcastDispatch.dispatch(AbstractBroadcastDispatch.java:58)</span><br><span class="line">        at org.gradle.internal.event.BroadcastDispatch$CompositeDispatch.dispatch(BroadcastDispatch.java:324)</span><br><span class="line">        at org.gradle.internal.event.BroadcastDispatch$CompositeDispatch.dispatch(BroadcastDispatch.java:234)</span><br><span class="line">        at org.gradle.internal.event.ListenerBroadcast.dispatch(ListenerBroadcast.java:140)</span><br><span class="line">        at org.gradle.internal.event.ListenerBroadcast.dispatch(ListenerBroadcast.java:37)</span><br><span class="line">        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)</span><br><span class="line">        at com.sun.proxy.$Proxy25.afterEvaluate(Unknown Source)</span><br><span class="line">        at org.gradle.configuration.project.LifecycleProjectEvaluator.notifyAfterEvaluate(LifecycleProjectEvaluator.java:76)</span><br><span class="line">        at org.gradle.configuration.project.LifecycleProjectEvaluator.doConfigure(LifecycleProjectEvaluator.java:70)</span><br><span class="line">        at org.gradle.configuration.project.LifecycleProjectEvaluator.access$100(LifecycleProjectEvaluator.java:34)</span><br><span class="line">        at org.gradle.configuration.project.LifecycleProjectEvaluator$ConfigureProject.run(LifecycleProjectEvaluator.java:110)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:336)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:328)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.execute(DefaultBuildOperationExecutor.java:199)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:110)</span><br><span class="line">        at org.gradle.configuration.project.LifecycleProjectEvaluator.evaluate(LifecycleProjectEvaluator.java:50)</span><br><span class="line">        at org.gradle.api.internal.project.DefaultProject.evaluate(DefaultProject.java:666)</span><br><span class="line">        at org.gradle.api.internal.project.DefaultProject.evaluate(DefaultProject.java:135)</span><br><span class="line">        at org.gradle.execution.TaskPathProjectEvaluator.configure(TaskPathProjectEvaluator.java:35)</span><br><span class="line">        at org.gradle.execution.TaskPathProjectEvaluator.configureHierarchy(TaskPathProjectEvaluator.java:62)</span><br><span class="line">        at org.gradle.configuration.DefaultBuildConfigurer.configure(DefaultBuildConfigurer.java:38)</span><br><span class="line">        at org.gradle.initialization.DefaultGradleLauncher$ConfigureBuild.run(DefaultGradleLauncher.java:249)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:336)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:328)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.execute(DefaultBuildOperationExecutor.java:199)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:110)</span><br><span class="line">        at org.gradle.initialization.DefaultGradleLauncher.configureBuild(DefaultGradleLauncher.java:167)</span><br><span class="line">        at org.gradle.initialization.DefaultGradleLauncher.doBuildStages(DefaultGradleLauncher.java:126)</span><br><span class="line">        at org.gradle.initialization.DefaultGradleLauncher.executeTasks(DefaultGradleLauncher.java:109)</span><br><span class="line">        at org.gradle.internal.invocation.GradleBuildController$1.call(GradleBuildController.java:78)</span><br><span class="line">        at org.gradle.internal.invocation.GradleBuildController$1.call(GradleBuildController.java:75)</span><br><span class="line">        at org.gradle.internal.work.DefaultWorkerLeaseService.withLocks(DefaultWorkerLeaseService.java:152)</span><br><span class="line">        at org.gradle.internal.invocation.GradleBuildController.doBuild(GradleBuildController.java:100)</span><br><span class="line">        at org.gradle.internal.invocation.GradleBuildController.run(GradleBuildController.java:75)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ExecuteBuildActionRunner.run(ExecuteBuildActionRunner.java:28)</span><br><span class="line">        at org.gradle.launcher.exec.ChainingBuildActionRunner.run(ChainingBuildActionRunner.java:35)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ValidatingBuildActionRunner.run(ValidatingBuildActionRunner.java:32)</span><br><span class="line">        at org.gradle.launcher.exec.RunAsBuildOperationBuildActionRunner$1.run(RunAsBuildOperationBuildActionRunner.java:43)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:336)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:328)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.execute(DefaultBuildOperationExecutor.java:199)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:110)</span><br><span class="line">        at org.gradle.launcher.exec.RunAsBuildOperationBuildActionRunner.run(RunAsBuildOperationBuildActionRunner.java:40)</span><br><span class="line">        at org.gradle.tooling.internal.provider.SubscribableBuildActionRunner.run(SubscribableBuildActionRunner.java:51)</span><br><span class="line">        at org.gradle.launcher.exec.InProcessBuildActionExecuter.execute(InProcessBuildActionExecuter.java:47)</span><br><span class="line">        at org.gradle.launcher.exec.InProcessBuildActionExecuter.execute(InProcessBuildActionExecuter.java:30)</span><br><span class="line">        at org.gradle.launcher.exec.BuildTreeScopeBuildActionExecuter.execute(BuildTreeScopeBuildActionExecuter.java:39)</span><br><span class="line">        at org.gradle.launcher.exec.BuildTreeScopeBuildActionExecuter.execute(BuildTreeScopeBuildActionExecuter.java:25)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ContinuousBuildActionExecuter.execute(ContinuousBuildActionExecuter.java:80)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ContinuousBuildActionExecuter.execute(ContinuousBuildActionExecuter.java:53)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ServicesSetupBuildActionExecuter.execute(ServicesSetupBuildActionExecuter.java:57)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ServicesSetupBuildActionExecuter.execute(ServicesSetupBuildActionExecuter.java:32)</span><br><span class="line">        at org.gradle.tooling.internal.provider.GradleThreadBuildActionExecuter.execute(GradleThreadBuildActionExecuter.java:36)</span><br><span class="line">        at org.gradle.tooling.internal.provider.GradleThreadBuildActionExecuter.execute(GradleThreadBuildActionExecuter.java:25)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ParallelismConfigurationBuildActionExecuter.execute(ParallelismConfigurationBuildActionExecuter.java:43)</span><br><span class="line">        at org.gradle.tooling.internal.provider.ParallelismConfigurationBuildActionExecuter.execute(ParallelismConfigurationBuildActionExecuter.java:29)</span><br><span class="line">        at org.gradle.tooling.internal.provider.StartParamsValidatingActionExecuter.execute(StartParamsValidatingActionExecuter.java:69)</span><br><span class="line">        at org.gradle.tooling.internal.provider.StartParamsValidatingActionExecuter.execute(StartParamsValidatingActionExecuter.java:30)</span><br><span class="line">        at org.gradle.tooling.internal.provider.SessionFailureReportingActionExecuter.execute(SessionFailureReportingActionExecuter.java:59)</span><br><span class="line">        at org.gradle.tooling.internal.provider.SessionFailureReportingActionExecuter.execute(SessionFailureReportingActionExecuter.java:44)</span><br><span class="line">        at org.gradle.tooling.internal.provider.SetupLoggingActionExecuter.execute(SetupLoggingActionExecuter.java:45)</span><br><span class="line">        at org.gradle.tooling.internal.provider.SetupLoggingActionExecuter.execute(SetupLoggingActionExecuter.java:30)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.ExecuteBuild.doBuild(ExecuteBuild.java:67)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:36)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.WatchForDisconnection.execute(WatchForDisconnection.java:37)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.ResetDeprecationLogger.execute(ResetDeprecationLogger.java:26)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.RequestStopIfSingleUsedDaemon.execute(RequestStopIfSingleUsedDaemon.java:34)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.ForwardClientInput$2.call(ForwardClientInput.java:74)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.ForwardClientInput$2.call(ForwardClientInput.java:72)</span><br><span class="line">        at org.gradle.util.Swapper.swap(Swapper.java:38)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.ForwardClientInput.execute(ForwardClientInput.java:72)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.LogAndCheckHealth.execute(LogAndCheckHealth.java:55)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.LogToClient.doBuild(LogToClient.java:62)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:36)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.EstablishBuildEnvironment.doBuild(EstablishBuildEnvironment.java:82)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:36)</span><br><span class="line">        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)</span><br><span class="line">        at org.gradle.launcher.daemon.server.exec.StartBuildOrRespondWithBusy$1.run(StartBuildOrRespondWithBusy.java:50)</span><br><span class="line">        at org.gradle.launcher.daemon.server.DaemonStateCoordinator$1.run(DaemonStateCoordinator.java:295)</span><br><span class="line">        at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:63)</span><br><span class="line">        at org.gradle.internal.concurrent.ManagedExecutorImpl$1.run(ManagedExecutorImpl.java:46)</span><br><span class="line">        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)</span><br><span class="line">        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)</span><br><span class="line">        at org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:55)</span><br><span class="line">        at java.lang.Thread.run(Thread.java:748)</span><br><span class="line"></span><br><span class="line">&gt; Configure project :coolrouterlibrary </span><br><span class="line">Configuration &apos;compile&apos; in project &apos;:coolrouterlibrary&apos; is deprecated. Use &apos;implementation&apos; instead.</span><br><span class="line"></span><br><span class="line">&gt; Configure project :oa_core </span><br><span class="line">Configuration &apos;compile&apos; in project &apos;:oa_core&apos; is deprecated. Use &apos;implementation&apos; instead.</span><br><span class="line"></span><br><span class="line">&gt; Task :app:processDebugManifest </span><br><span class="line">D:\AndroidDhccWorkSpace\zhidoule2\app\src\main\AndroidManifest.xml:162:5-81 Warning:</span><br><span class="line">        Element uses-permission#android.permission.WRITE_EXTERNAL_STORAGE at AndroidManifest.xml:162:5-81 duplicated with element declared at AndroidManifest.xml:15</span><br><span class="line">3:5-81</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">FAILURE: Build failed with an exception.</span><br><span class="line"></span><br><span class="line">* What went wrong:</span><br><span class="line">Execution failed for task &apos;:app:transformDexArchiveWithExternalLibsDexMergerForDebug&apos;.</span><br><span class="line">&gt; java.lang.RuntimeException: java.lang.RuntimeException: com.android.builder.dexing.DexArchiveMergerException: Unable to merge dex</span><br><span class="line"></span><br><span class="line">* Try:</span><br><span class="line">Run with --info or --debug option to get more log output. Run with --scan to get full insights.</span><br><span class="line"></span><br><span class="line">* Exception is:</span><br><span class="line">org.gradle.api.tasks.TaskExecutionException: Execution failed for task &apos;:app:transformDexArchiveWithExternalLibsDexMergerForDebug&apos;.</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:100)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.execute(ExecuteActionsTaskExecuter.java:70)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.OutputDirectoryCreatingTaskExecuter.execute(OutputDirectoryCreatingTaskExecuter.java:51)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.SkipUpToDateTaskExecuter.execute(SkipUpToDateTaskExecuter.java:62)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ResolveTaskOutputCachingStateExecuter.execute(ResolveTaskOutputCachingStateExecuter.java:54)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ValidatingTaskExecuter.execute(ValidatingTaskExecuter.java:60)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.SkipEmptySourceFilesTaskExecuter.execute(SkipEmptySourceFilesTaskExecuter.java:97)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.CleanupStaleOutputsExecuter.execute(CleanupStaleOutputsExecuter.java:87)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ResolveTaskArtifactStateTaskExecuter.execute(ResolveTaskArtifactStateTaskExecuter.java:52)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.SkipTaskWithNoActionsExecuter.execute(SkipTaskWithNoActionsExecuter.java:52)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.SkipOnlyIfTaskExecuter.execute(SkipOnlyIfTaskExecuter.java:54)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ExecuteAtMostOnceTaskExecuter.execute(ExecuteAtMostOnceTaskExecuter.java:43)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.CatchExceptionTaskExecuter.execute(CatchExceptionTaskExecuter.java:34)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter$EventFiringTaskWorker$1.run(DefaultTaskGraphExecuter.java:248)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:336)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:328)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.execute(DefaultBuildOperationExecutor.java:199)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:110)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter$EventFiringTaskWorker.execute(DefaultTaskGraphExecuter.java:241)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter$EventFiringTaskWorker.execute(DefaultTaskGraphExecuter.java:230)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskPlanExecutor$TaskExecutorWorker.processTask(DefaultTaskPlanExecutor.java:123)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskPlanExecutor$TaskExecutorWorker.access$200(DefaultTaskPlanExecutor.java:79)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskPlanExecutor$TaskExecutorWorker$1.execute(DefaultTaskPlanExecutor.java:104)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskPlanExecutor$TaskExecutorWorker$1.execute(DefaultTaskPlanExecutor.java:98)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskExecutionPlan.execute(DefaultTaskExecutionPlan.java:626)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskExecutionPlan.executeWithTask(DefaultTaskExecutionPlan.java:581)</span><br><span class="line">        at org.gradle.execution.taskgraph.DefaultTaskPlanExecutor$TaskExecutorWorker.run(DefaultTaskPlanExecutor.java:98)</span><br><span class="line">        at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:63)</span><br><span class="line">        at org.gradle.internal.concurrent.ManagedExecutorImpl$1.run(ManagedExecutorImpl.java:46)</span><br><span class="line">        at org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:55)</span><br><span class="line">Caused by: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.RuntimeException: com.android.builder.dexing.DexArchiveMergerException: Unable to merge</span><br><span class="line"> dex</span><br><span class="line">        at com.android.builder.dexing.DxDexArchiveMerger.mergeMonoDex(DxDexArchiveMerger.java:177)</span><br><span class="line">        at com.android.builder.dexing.DxDexArchiveMerger.mergeDexArchives(DxDexArchiveMerger.java:118)</span><br><span class="line">        at com.android.build.gradle.internal.transforms.DexMergerTransformCallable.call(DexMergerTransformCallable.java:97)</span><br><span class="line">        at com.android.build.gradle.internal.transforms.ExternalLibsMergerTransform.transform(ExternalLibsMergerTransform.kt:121)</span><br><span class="line">        at com.android.build.gradle.internal.pipeline.TransformTask$2.call(TransformTask.java:222)</span><br><span class="line">        at com.android.build.gradle.internal.pipeline.TransformTask$2.call(TransformTask.java:218)</span><br><span class="line">        at com.android.builder.profile.ThreadRecorder.record(ThreadRecorder.java:102)</span><br><span class="line">        at com.android.build.gradle.internal.pipeline.TransformTask.transform(TransformTask.java:213)</span><br><span class="line">        at org.gradle.internal.reflect.JavaMethod.invoke(JavaMethod.java:73)</span><br><span class="line">        at org.gradle.api.internal.project.taskfactory.IncrementalTaskAction.doExecute(IncrementalTaskAction.java:46)</span><br><span class="line">        at org.gradle.api.internal.project.taskfactory.StandardTaskAction.execute(StandardTaskAction.java:39)</span><br><span class="line">        at org.gradle.api.internal.project.taskfactory.StandardTaskAction.execute(StandardTaskAction.java:26)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter$1.run(ExecuteActionsTaskExecuter.java:121)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:336)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:328)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.execute(DefaultBuildOperationExecutor.java:199)</span><br><span class="line">        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:110)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeAction(ExecuteActionsTaskExecuter.java:110)</span><br><span class="line">        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:92)</span><br><span class="line">        ... 29 more</span><br><span class="line">Caused by: java.lang.RuntimeException: java.lang.RuntimeException: com.android.builder.dexing.DexArchiveMergerException: Unable to merge dex</span><br><span class="line">        at com.android.builder.dexing.DxDexArchiveMerger.lambda$mergeMonoDex$0(DxDexArchiveMerger.java:171)</span><br><span class="line">Caused by: java.lang.RuntimeException: com.android.builder.dexing.DexArchiveMergerException: Unable to merge dex</span><br><span class="line">Caused by: com.android.builder.dexing.DexArchiveMergerException: Unable to merge dex</span><br><span class="line">        at com.android.builder.dexing.DexArchiveMergerCallable.call(DexArchiveMergerCallable.java:72)</span><br><span class="line">        at com.android.builder.dexing.DexArchiveMergerCallable.call(DexArchiveMergerCallable.java:36)</span><br><span class="line">Caused by: com.android.dex.DexException: Multiple dex files define Lcom/google/gson/internal/bind/TypeAdapters;</span><br><span class="line">        at com.android.dx.merge.DexMerger.readSortableTypes(DexMerger.java:661)</span><br><span class="line">        at com.android.dx.merge.DexMerger.getSortedTypes(DexMerger.java:616)</span><br><span class="line">        at com.android.dx.merge.DexMerger.mergeClassDefs(DexMerger.java:598)</span><br><span class="line">        at com.android.dx.merge.DexMerger.mergeDexes(DexMerger.java:171)</span><br><span class="line">        at com.android.dx.merge.DexMerger.merge(DexMerger.java:198)</span><br><span class="line">        at com.android.builder.dexing.DexArchiveMergerCallable.call(DexArchiveMergerCallable.java:61)</span><br><span class="line">        ... 1 more</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* Get more help at https://help.gradle.org</span><br><span class="line"></span><br><span class="line">BUILD FAILED in 10s</span><br><span class="line">81 actionable tasks: 8 executed, 73 up-to-date</span><br></pre></td></tr></table></figure>
<p>&#x62A5;&#x9519;&#x4FE1;&#x606F;&#x8D85;&#x7EA7;&#x957F;&#xFF0C;&#x5176;&#x5B9E;&#x5173;&#x952E;&#x7684;&#x8282;&#x70B9;&#x5728;&#x6700;&#x540E;&#x9762;&#xFF0C;&#x6211;&#x8FD9;&#x8FB9;&#x4E3A;&#x4E86;&#x7BC7;&#x5E45;&#x8D77;&#x89C1;&#xFF0C;&#x5EFA;&#x8BAE;&#x60A8;&#x76F4;&#x63A5;&#x770B;519&#x884C;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#xFF1A;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Caused by: com.android.dex.DexException: Multiple dex files define Lcom/google/gson/internal/bind/TypeAdapters;</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x91CC;&#x7684;&#x610F;&#x601D;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x91CD;&#x590D;&#x7684;dex&#x6587;&#x4EF6;&#x51FA;&#x73B0;&#x5728;&#x4E86;TypeAdapters&#x8FD9;&#x4E2A;&#x7C7B;&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x5C31;&#x5229;&#x7528;AndroidStudio&#x7684;&#x5F3A;&#x5927;&#x7684;&#x67E5;&#x8BE2;&#x529F;&#x80FD;&#xFF0C;&#x53CC;&#x51FB;Shift&#x6765;&#x641C;&#x7D22;TypeAdapters&#x8FD9;&#x4E2A;&#x5173;&#x952E;&#x5B57;&#xFF0C;&#x5982;&#x56FE;(&#x6211;&#x628A;&#x81EA;&#x5DF1;&#x7684;&#x56FE;&#x5F04;&#x4E22;&#x4E86;&#xFF0C;&#x5927;&#x6982;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;&#x610F;&#x601D;    )&#xFF1A;</p>
<p><img src="/2018/10/12/&#x8BB0;&#x4E00;&#x6B21;&#x91CD;&#x590D;&#x4F9D;&#x8D56;&#x7684;&#x89E3;&#x51B3;/3.png" alt="logo"></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x8FD9;&#x4E2A;&#x7C7B;&#x5728;com.google.code.gson&#x548C;cn.bmob.android&#x8FD9;&#x4E24;&#x4E2A;Gradle&#x7684;&#x4F9D;&#x8D56;&#x91CC;&#x90FD;&#x51FA;&#x73B0;&#x4E86;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x6240;&#x8C13;&#x7684;&#x91CD;&#x590D;&#x4F9D;&#x8D56;&#x6216;&#x8005;&#x4F9D;&#x8D56;&#x51B2;&#x7A81;&#x6216;&#x8005;Jar&#x5305;&#x51B2;&#x7A81;&#x4E86;&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x662F;Bmob&#x7684;SDK&#x91CC;&#x5DF2;&#x7ECF;&#x81EA;&#x5DF1;&#x96C6;&#x6210;&#x4E86;gson&#x548C;okio&#x8FD9;&#x4E24;&#x4E2A;jar&#x4E86;&#xFF0C;&#x800C;&#x6211;&#x81EA;&#x5DF1;&#x5728;&#x9879;&#x76EE;&#x4E2D;&#x4E5F;&#x7528;&#x5230;&#x4E86;&#x8FD9;&#x4E24;&#x4E2A;jar&#x5305;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x4E86;&#x4F9D;&#x8D56;&#x51B2;&#x7A81;&#x3002;</p>
<h2 id="&#x89E3;&#x51B3;&#x65B9;&#x6848;">&#x89E3;&#x51B3;&#x65B9;&#x6848;</h2><p>&#x65E2;&#x7136;&#x627E;&#x5230;&#x51B2;&#x7A81;&#x4E86;&#xFF0C;&#x90A3;&#x5C31;&#x8BF4;&#x4E00;&#x4E0B;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x5427;&#xFF1A;</p>
<p>&#x9664;&#x4E86;&#x5220;&#x9664;&#x51B2;&#x7A81;&#x5305;&#x5916;&#xFF0C;&#x6211;&#x4EEC;&#x8FD8;&#x53EF;&#x4EE5;&#x7528;Gradle&#x7684; exclude group &#x5C06;&#x6307;&#x5B9A;&#x7684;&#x5305;&#x540D;&#x6392;&#x9664;&#x5230;&#x7F16;&#x8BD1;&#x8303;&#x56F4;&#x5916;&#xFF1A;</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> //bmob-sdk&#xFF1A;Bmob&#x7684;android sdk&#x5305;&#xFF0C;&#x5305;&#x542B;&#x4E86;Bmob&#x7684;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x3001;&#x6587;&#x4EF6;&#x7B49;&#x670D;&#x52A1;&#xFF0C;&#x4EE5;&#x4E0B;&#x662F;&#x6700;&#x65B0;&#x7684;bmob-sdk:</span><br><span class="line">   implementation (&apos;cn.bmob.android:bmob-sdk:3.5.5&apos;){ // gson-2.6.2</span><br><span class="line">        exclude group: &apos;com.squareup.okhttp3&apos;</span><br><span class="line">        exclude group: &apos;com.squareup.okio&apos;</span><br><span class="line">        exclude group: &apos;com.google.code.gson&apos;</span><br><span class="line">//        exclude(module: &apos;gson&apos;)     // &#x9632;&#x6B62;&#x7248;&#x672C;&#x51B2;&#x7A81;</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>
<p>&#x81F3;&#x6B64;&#xFF0C;&#x51B2;&#x7A81;&#x89E3;&#x51B3;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[一次项目中的反射机制的使用]]></title>
      <url>http://jasoncool.com/2018/09/28/%E4%B8%80%E6%AC%A1%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<hr>
<h2 id="&#x4EC0;&#x4E48;&#x662F;Java&#x7684;&#x53CD;&#x5C04;&#x673A;&#x5236;">&#x4EC0;&#x4E48;&#x662F;Java&#x7684;&#x53CD;&#x5C04;&#x673A;&#x5236;</h2><p>JAVA&#x53CD;&#x5C04;&#x673A;&#x5236;&#x662F;&#x5728;&#x8FD0;&#x884C;&#x72B6;&#x6001;&#x4E2D;, &#x5BF9;&#x4E8E;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x7C7B;, &#x90FD;&#x80FD;&#x591F;&#x77E5;&#x9053;&#x8FD9;&#x4E2A;&#x7C7B;&#x7684;&#x6240;&#x6709;&#x5C5E;&#x6027;&#x548C;&#x65B9;&#x6CD5;; &#x5BF9;&#x4E8E;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;, &#x90FD;&#x80FD;&#x591F;&#x8C03;&#x7528;&#x5B83;&#x7684;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x548C;&#x5C5E;&#x6027;; &#x8FD9;&#x79CD;&#x52A8;&#x6001;&#x83B7;&#x53D6;&#x7684;&#x4FE1;&#x606F;&#x4EE5;&#x53CA;&#x52A8;&#x6001;&#x8C03;&#x7528;&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x6CD5;&#x7684;&#x529F;&#x80FD;&#x79F0;&#x4E3A;java&#x8BED;&#x8A00;&#x7684;&#x53CD;&#x5C04;&#x673A;&#x5236;.</p>
<p>&#x4E3B;&#x8981;&#x4F5C;&#x7528;&#x6709;&#x4E09;&#xFF1A;</p>
<ol>
<li><p>&#x8FD0;&#x884C;&#x65F6;&#x53D6;&#x5F97;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;&#x548C;&#x5B57;&#x6BB5;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#x3002;</p>
</li>
<li><p>&#x521B;&#x5EFA;&#x67D0;&#x4E2A;&#x7C7B;&#x7684;&#x65B0;&#x5B9E;&#x4F8B;(.newInstance())</p>
</li>
<li><p>&#x53D6;&#x5F97;&#x5B57;&#x6BB5;&#x5F15;&#x7528;&#x76F4;&#x63A5;&#x83B7;&#x53D6;&#x548C;&#x8BBE;&#x7F6E;&#x5BF9;&#x8C61;&#x5B57;&#x6BB5;&#xFF0C;&#x65E0;&#x8BBA;&#x8BBF;&#x95EE;&#x4FEE;&#x9970;&#x7B26;&#x662F;&#x4EC0;&#x4E48;&#x3002;</p>
<a id="more"></a>
</li>
</ol>
<p>&#x7528;&#x5904;&#x5982;&#x4E0B;&#xFF1A;</p>
<ol>
<li>&#x89C2;&#x5BDF;&#x6216;&#x64CD;&#x4F5C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x884C;&#x4E3A;&#x3002;</li>
<li>&#x8C03;&#x8BD5;&#x6216;&#x6D4B;&#x8BD5;&#x7A0B;&#x5E8F;&#xFF0C;&#x56E0;&#x4E3A;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#x65B9;&#x6CD5;&#x3001;&#x6784;&#x9020;&#x51FD;&#x6570;&#x548C;&#x6210;&#x5458;&#x5B57;&#x6BB5;&#x3002;</li>
<li>&#x901A;&#x8FC7;&#x540D;&#x5B57;&#x8C03;&#x7528;&#x4E0D;&#x77E5;&#x9053;&#x7684;&#x65B9;&#x6CD5;&#x5E76;&#x4F7F;&#x7528;&#x8BE5;&#x4FE1;&#x606F;&#x6765;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x548C;&#x8C03;&#x7528;&#x65B9;&#x6CD5;</li>
</ol>
<h2 id="&#x53CD;&#x5C04;&#x7684;&#x5E94;&#x7528;&#x573A;&#x666F;">&#x53CD;&#x5C04;&#x7684;&#x5E94;&#x7528;&#x573A;&#x666F;</h2><p>&#x6211;&#x5728;&#x8F66;&#x7BA1;&#x9879;&#x76EE;&#x4E2D;&#x9047;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x573A;&#x666F;&#xFF0C;&#x8BF7;&#x5148;&#x770B;&#x754C;&#x9762;&#xFF1A;</p>
<p><img src="/2018/09/28/&#x4E00;&#x6B21;&#x9879;&#x76EE;&#x4E2D;&#x7684;&#x53CD;&#x5C04;&#x673A;&#x5236;&#x7684;&#x4F7F;&#x7528;/1.gif" alt="logo"></p>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x754C;&#x9762;&#x4E2D;&#xFF0C;&#x6211;&#x8981;&#x901A;&#x8FC7;&#x8F93;&#x5165;&#x5173;&#x952E;&#x5B57;&#x6765;&#x68C0;&#x7D22;&#x5DF2;&#x7ECF;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x52A0;&#x8F7D;&#x597D;&#x7684;&#x5217;&#x8868;&#x6570;&#x636E;&#x4E2D;&#xFF0C;&#x6709;&#x54EA;&#x4E9B;&#x6570;&#x636E;&#x9879;&#x662F;&#x7B26;&#x5408;&#x6211;&#x7684;&#x8FC7;&#x6EE4;&#x6761;&#x4EF6;&#x7684;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x9700;&#x6C42;&#x611F;&#x89C9;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x53EA;&#x8981;&#x904D;&#x5386;&#x5B58;&#x653E;&#x6570;&#x636E;&#x7684;List<t>,&#x7136;&#x540E;&#x6BCF;&#x9879;&#x90FD;&#x5BF9;&#x6BD4;&#x5173;&#x952E;&#x5B57;&#x5373;&#x53EF;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x5C06;&#x8FC7;&#x6EE4;&#x540E;&#x7684;&#x6570;&#x636E;&#x5B58;&#x5165;&#x4E00;&#x4E2A;&#x65B0;&#x7684;List<t>&#x4E2D;&#xFF0C;&#x8FD4;&#x56DE;&#x7ED9;RecyclerView&#x7684;Adapter&#x8FDB;&#x884C;&#x6570;&#x636E;&#x5237;&#x65B0;&#x5373;&#x53EF;&#x3002;</t></t></p>
<p>&#x4F46;&#x662F;&#x5728;&#x505A;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x6211;&#x53D1;&#x73B0;&#x4E86;&#x4E24;&#x4E2A;&#x95EE;&#x9898;&#xFF1A;</p>
<p>1.&#x7B2C;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x662F;&#x6211;&#x4EEC;&#x7684;List<t>&#x83B7;&#x53D6;&#x7684;&#x6570;&#x636E;&#x7531;&#x4E8E;&#x4E1A;&#x52A1;&#x7684;&#x4E0D;&#x540C;&#xFF0C;&#x5176;&#x6CDB;&#x578B;&#x4E5F;&#x662F;&#x4E0D;&#x540C;&#x7684;,&#x4E14;&#x6CDB;&#x578B;&#x4E4B;&#x95F4;&#x6CA1;&#x6709;&#x5173;&#x8054;&#x6027;&#xFF1B;<br>2.&#x6BCF;&#x4E2A;&#x6CDB;&#x578B;&#x90FD;&#x662F;&#x4E00;&#x4E2A;Bean,&#x6211;&#x4EEC;&#x8981;&#x8FC7;&#x6EE4;&#x7684;&#x662F;Bean&#x4E2D;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x8FD9;&#x4E2A;&#x4E5F;&#x662F;&#x4E0D;&#x786E;&#x5B9A;&#x7684;;</t></p>
<p>&#x4F46;&#x662F;&#x9879;&#x76EE;&#x4E2D;&#x5927;&#x91CF;&#x7684;&#x7528;&#x5230;&#x4E86;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#xFF0C;&#x51E0;&#x4E4E;&#x6BCF;&#x4E2A;&#x5217;&#x8868;&#x9879;&#x90FD;&#x4F1A;&#x6709;&#x672C;&#x5730;&#x8FC7;&#x6EE4;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x5C06;&#x529F;&#x80FD;&#x8FDB;&#x884C;&#x5C01;&#x88C5;&#xFF0C;&#x6BCF;&#x6B21;&#x90FD;&#x5199;&#x786C;&#x7F16;&#x7801;&#xFF0C;&#x9879;&#x76EE;&#x7684;&#x590D;&#x7528;&#x6027;&#x592A;&#x4F4E;&#x4E86;&#xFF0C;&#x4E14;&#x6574;&#x4F53;&#x9879;&#x76EE;&#x4E0D;&#x6613;&#x7EF4;&#x62A4;&#x3002;</p>
<p>&#x4E00;&#x5F00;&#x59CB;&#x6211;&#x60F3;&#x901A;&#x8FC7;&#x6CDB;&#x578B;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x4F46;&#x662F;&#x9274;&#x4E8E;&#x4E0A;&#x8FB9;&#x4E24;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x6CDB;&#x578B;&#x662F;&#x6CA1;&#x529E;&#x6CD5;&#x7075;&#x6D3B;&#x5904;&#x7406;&#x7684;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x7B2C;&#x4E8C;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x6CDB;&#x578B;&#x6CA1;&#x6709;&#x529E;&#x6CD5;&#x5904;&#x7406;&#xFF0C;&#x4E8E;&#x662F;&#x60F3;&#x6765;&#x60F3;&#x53BB;&#xFF0C;&#x60F3;&#x5230;&#x4E86;&#x53CD;&#x5C04;&#x673A;&#x5236;&#x3002;</p>
<p>&#x95F2;&#x8BDD;&#x5C11;&#x8BF4;&#xFF0C;&#x5148;&#x770B;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListFilter</span>&lt;<span class="title">T</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x8FC7;&#x6EE4;ArrayList&#x4E2D;&#x7684;&#x5173;&#x952E;&#x5B57;&#x6570;&#x636E;</span><br><span class="line">     * <span class="doctag">@param</span> models &#x7F51;&#x7EDC;&#x83B7;&#x53D6;&#x5230;&#x7684;&#x6570;&#x636E;&#x5217;&#x8868;</span><br><span class="line">     * <span class="doctag">@param</span> query &#x8FC7;&#x6EE4;&#x5173;&#x952E;&#x5B57;</span><br><span class="line">     * <span class="doctag">@param</span> propertyName &#x6CDB;&#x578B;&#x7684;&#x6570;&#x636E;&#x8FC7;&#x6EE4;&#x9879;</span><br><span class="line">     * <span class="doctag">@return</span> &#x8FD4;&#x56DE;&#x8FC7;&#x6EE4;&#x540E;&#x7684;&#x6570;&#x636E;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ArrayList&lt;T&gt; <span class="title">filter</span><span class="params">(ArrayList&lt;T&gt; models, String query, String propertyName)</span> </span>{</span><br><span class="line"></span><br><span class="line">        ArrayList&lt;T&gt; filteredModelList = <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">//&#x5B9E;&#x4F8B;&#x5316;&#x8FD9;&#x4E2A;&#x7C7B;&#x8D4B;&#x7ED9;o</span></span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            query = query.toLowerCase();</span><br><span class="line">            filteredModelList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span> (T model : models) {</span><br><span class="line">                <span class="keyword">final</span> String text = getClassInfo(model,model.getClass().getName(),propertyName).toLowerCase();</span><br><span class="line">                <span class="keyword">if</span> (text.contains(query)) {</span><br><span class="line">                    filteredModelList.add(model);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        } <span class="keyword">catch</span> (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> filteredModelList;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  &#x83B7;&#x53D6;&#x7C7B;&#x7684;&#x5C5E;&#x6027;&#x503C;</span><br><span class="line">     * <span class="doctag">@param</span> obj &#x7C7B;&#x5B9E;&#x4F8B;</span><br><span class="line">     * <span class="doctag">@param</span> classNameString &#x7C7B;&#x540D;</span><br><span class="line">     * <span class="doctag">@param</span> propertyNameString &#x83B7;&#x53D6;&#x7684;&#x5C5E;&#x6027;&#x540D;</span><br><span class="line">     * <span class="doctag">@return</span>  &#x5C5E;&#x6027;&#x503C;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span>  String <span class="title">getClassInfo</span><span class="params">(Object obj,String classNameString,String propertyNameString)</span> </span>{</span><br><span class="line">        String returnString=<span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span>{</span><br><span class="line">            Class classInfo = Class.forName(classNameString);</span><br><span class="line">            <span class="keyword">if</span>(!(classInfo.isInstance(obj))){</span><br><span class="line">                L.e(<span class="string">&quot;&#x4F20;&#x5165;&#x7684;java&#x5B9E;&#x4F8B;&#x4E0E;&#x914D;&#x7F6E;&#x7684;java&#x5BF9;&#x8C61;&#x7C7B;&#x578B;&#x4E0D;&#x7B26;&#xFF01;&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> returnString;</span><br><span class="line">            }</span><br><span class="line">            Field field = classInfo.getDeclaredField(propertyNameString);</span><br><span class="line">            field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">            returnString=field.get(obj).toString();</span><br><span class="line">        }<span class="keyword">catch</span>(Exception e){</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> returnString;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x5176;&#x5B9E;&#x5C31;&#x662F;getClassInfo&#x65B9;&#x6CD5;&#x4E3A;&#x6838;&#x5FC3;&#x7684;&#x83B7;&#x53D6;&#x67D0;&#x4E2A;&#x7C7B;&#x7684;&#x67D0;&#x4E2A;&#x5B57;&#x6BB5;&#x7684;&#x5B57;&#x6BB5;&#x503C;&#xFF0C;&#x8FD9;&#x91CC;&#x6D89;&#x53CA;&#x51E0;&#x4E2A;&#x77E5;&#x8BC6;&#x70B9;&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x767E;&#x5EA6;&#x5B66;&#x4E60;&#x4E00;&#x4E0B;&#xFF1A;</p>
<p>1.getCanonicalName(), getName(), getSimpleName()&#x4E09;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x4E0D;&#x540C;&#xFF1F;<br>&#x7B80;&#x7B54;&#xFF1A;<br>1&#x3001;getCanonicalName() &#x662F;&#x83B7;&#x53D6;&#x6240;&#x4F20;&#x7C7B;&#x4ECE;java&#x8BED;&#x8A00;&#x89C4;&#x8303;&#x5B9A;&#x4E49;&#x7684;&#x683C;&#x5F0F;&#x8F93;&#x51FA;&#x3002;<br>2&#x3001;getName() &#x662F;&#x8FD4;&#x56DE;&#x5B9E;&#x4F53;&#x7C7B;&#x578B;&#x540D;&#x79F0;<br>3&#x3001;getSimpleName() &#x8FD4;&#x56DE;&#x4ECE;&#x6E90;&#x4EE3;&#x7801;&#x4E2D;&#x8FD4;&#x56DE;&#x5B9E;&#x4F8B;&#x7684;&#x540D;&#x79F0;&#x3002;</p>
<p>2.&#x53CD;&#x5C04;&#x4E2D;&#x83B7;&#x53D6;&#x7C7B;&#x4E2D;&#x7684;&#x79C1;&#x6709;&#x5C5E;&#x6027;&#x8BE5;&#x5982;&#x4F55;&#x64CD;&#x4F5C;&#xFF1F;<br>&#x7B80;&#x7B54;&#xFF1A;<br>field.setAccessible(true);<br>public void setAccessible(boolean flag)  throws SecurityException<br>&#x5C06;&#x6B64;&#x5BF9;&#x8C61;&#x7684; accessible &#x6807;&#x5FD7;&#x8BBE;&#x7F6E;&#x4E3A;&#x6307;&#x793A;&#x7684;&#x5E03;&#x5C14;&#x503C;&#x3002;&#x503C;&#x4E3A; true &#x5219;&#x6307;&#x793A;&#x53CD;&#x5C04;&#x7684;&#x5BF9;&#x8C61;&#x5728;&#x4F7F;&#x7528;&#x65F6;&#x5E94;&#x8BE5;&#x53D6;&#x6D88; Java &#x8BED;&#x8A00;&#x8BBF;&#x95EE;&#x68C0;&#x67E5;&#x3002;&#x503C;&#x4E3A; false &#x5219;&#x6307;&#x793A;&#x53CD;&#x5C04;&#x7684;&#x5BF9;&#x8C61;&#x5E94;&#x8BE5;&#x5B9E;&#x65BD; Java &#x8BED;&#x8A00;&#x8BBF;&#x95EE;&#x68C0;&#x67E5;&#x3002;<br>&#x5B9E;&#x9645;&#x4E0A;setAccessible&#x662F;&#x542F;&#x7528;&#x548C;&#x7981;&#x7528;&#x8BBF;&#x95EE;&#x5B89;&#x5168;&#x68C0;&#x67E5;&#x7684;&#x5F00;&#x5173;,&#x5E76;&#x4E0D;&#x662F;&#x4E3A;true&#x5C31;&#x80FD;&#x8BBF;&#x95EE;&#x4E3A;false&#x5C31;&#x4E0D;&#x80FD;&#x8BBF;&#x95EE;&#xFF1B;</p>
<h2 id="&#x53CD;&#x5C04;&#x7ECF;&#x5178;&#x5E94;&#x7528;&#x573A;&#x666F;">&#x53CD;&#x5C04;&#x7ECF;&#x5178;&#x5E94;&#x7528;&#x573A;&#x666F;</h2><p>&#x4EE5;&#x4E0A;&#x5C31;&#x662F;&#x6211;&#x7684;&#x9879;&#x76EE;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528;&#x53CD;&#x5C04;&#x7684;&#x4E00;&#x4E2A;&#x5177;&#x4F53;&#x7684;&#x5B9E;&#x4F8B;&#x4E86;&#xFF0C;&#x5176;&#x5B9E;&#x5728;Java&#x4E2D;&#x8FD8;&#x6709;&#x5F88;&#x591A;&#x5730;&#x65B9;&#x90FD;&#x7528;&#x5230;&#x4E86;&#x53CD;&#x5C04;&#xFF0C;&#x8FD9;&#x91CC;&#x4E3E;&#x4E24;&#x4E2A;&#x6BD4;&#x8F83;&#x5E38;&#x89C1;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;</p>
<ul>
<li>JDBC &#x7684;&#x6570;&#x636E;&#x5E93;&#x7684;&#x8FDE;&#x63A5;</li>
</ul>
<p>&#x5728;JDBC &#x7684;&#x64CD;&#x4F5C;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x8981;&#x60F3;&#x8FDB;&#x884C;&#x6570;&#x636E;&#x5E93;&#x7684;&#x8FDE;&#x63A5;&#xFF0C;&#x5219;&#x5FC5;&#x987B;&#x6309;&#x7167;&#x4EE5;&#x4E0A;&#x7684;&#x51E0;&#x6B65;&#x5B8C;&#x6210;</p>
<ol>
<li>&#x901A;&#x8FC7;Class.forName()&#x52A0;&#x8F7D;&#x6570;&#x636E;&#x5E93;&#x7684;&#x9A71;&#x52A8;&#x7A0B;&#x5E8F; &#xFF08;&#x901A;&#x8FC7;&#x53CD;&#x5C04;&#x52A0;&#x8F7D;&#xFF0C;&#x524D;&#x63D0;&#x662F;&#x5F15;&#x5165;&#x76F8;&#x5173;&#x4E86;Jar&#x5305;&#xFF09;</li>
<li>&#x901A;&#x8FC7; DriverManager &#x7C7B;&#x8FDB;&#x884C;&#x6570;&#x636E;&#x5E93;&#x7684;&#x8FDE;&#x63A5;&#xFF0C;&#x8FDE;&#x63A5;&#x7684;&#x65F6;&#x5019;&#x8981;&#x8F93;&#x5165;&#x6570;&#x636E;&#x5E93;&#x7684;&#x8FDE;&#x63A5;&#x5730;&#x5740;&#x3001;&#x7528;&#x6237;&#x540D;&#x3001;&#x5BC6;&#x7801;</li>
<li>&#x901A;&#x8FC7;Connection &#x63A5;&#x53E3;&#x63A5;&#x6536;&#x8FDE;&#x63A5;</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConnectionJDBC</span> </span>{  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * <span class="doctag">@param</span> args </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="comment">//&#x9A71;&#x52A8;&#x7A0B;&#x5E8F;&#x5C31;&#x662F;&#x4E4B;&#x524D;&#x5728;classpath&#x4E2D;&#x914D;&#x7F6E;&#x7684;JDBC&#x7684;&#x9A71;&#x52A8;&#x7A0B;&#x5E8F;&#x7684;JAR &#x5305;&#x4E2D;  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DBDRIVER = <span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>;  </span><br><span class="line">    <span class="comment">//&#x8FDE;&#x63A5;&#x5730;&#x5740;&#x662F;&#x7531;&#x5404;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x751F;&#x4EA7;&#x5546;&#x5355;&#x72EC;&#x63D0;&#x4F9B;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x5355;&#x72EC;&#x8BB0;&#x4F4F;  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DBURL = <span class="string">&quot;jdbc:mysql://localhost:3306/test&quot;</span>;  </span><br><span class="line">    <span class="comment">//&#x8FDE;&#x63A5;&#x6570;&#x636E;&#x5E93;&#x7684;&#x7528;&#x6237;&#x540D;  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DBUSER = <span class="string">&quot;root&quot;</span>;  </span><br><span class="line">    <span class="comment">//&#x8FDE;&#x63A5;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5BC6;&#x7801;  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DBPASS = <span class="string">&quot;&quot;</span>;  </span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>{  </span><br><span class="line">        Connection con = <span class="keyword">null</span>; <span class="comment">//&#x8868;&#x793A;&#x6570;&#x636E;&#x5E93;&#x7684;&#x8FDE;&#x63A5;&#x5BF9;&#x8C61;  </span></span><br><span class="line">        Class.forName(DBDRIVER); <span class="comment">//1&#x3001;&#x4F7F;&#x7528;CLASS &#x7C7B;&#x52A0;&#x8F7D;&#x9A71;&#x52A8;&#x7A0B;&#x5E8F; ,&#x53CD;&#x5C04;&#x673A;&#x5236;&#x7684;&#x4F53;&#x73B0; </span></span><br><span class="line">        con = DriverManager.getConnection(DBURL,DBUSER,DBPASS); <span class="comment">//2&#x3001;&#x8FDE;&#x63A5;&#x6570;&#x636E;&#x5E93;  </span></span><br><span class="line">        System.out.println(con);  </span><br><span class="line">        con.close(); <span class="comment">// 3&#x3001;&#x5173;&#x95ED;&#x6570;&#x636E;&#x5E93;  </span></span><br><span class="line">    }</span><br></pre></td></tr></table></figure>
<ul>
<li>Spring &#x6846;&#x67B6;&#x7684;&#x4F7F;&#x7528;</li>
</ul>
<p>&#x2003;&#x2003;&#x5728; Java&#x7684;&#x53CD;&#x5C04;&#x673A;&#x5236;&#x5728;&#x505A;&#x57FA;&#x7840;&#x6846;&#x67B6;&#x7684;&#x65F6;&#x5019;&#x975E;&#x5E38;&#x6709;&#x7528;&#xFF0C;&#x884C;&#x5185;&#x6709;&#x4E00;&#x53E5;&#x8FD9;&#x6837;&#x7684;&#x8001;&#x8BDD;&#xFF1A;&#x53CD;&#x5C04;&#x673A;&#x5236;&#x662F;Java&#x6846;&#x67B6;&#x7684;&#x57FA;&#x77F3;&#x3002;&#x4E00;&#x822C;&#x5E94;&#x7528;&#x5C42;&#x9762;&#x5F88;&#x5C11;&#x7528;&#xFF0C;&#x4E0D;&#x8FC7;&#x8FD9;&#x79CD;&#x4E1C;&#x897F;&#xFF0C;&#x73B0;&#x5728;&#x5F88;&#x591A;&#x5F00;&#x6E90;&#x6846;&#x67B6;&#x57FA;&#x672C;&#x90FD;&#x5DF2;&#x7ECF;&#x5C01;&#x88C5;&#x597D;&#x4E86;&#xFF0C;&#x81EA;&#x5DF1;&#x57FA;&#x672C;&#x7528;&#x4E0D;&#x7740;&#x5199;&#x3002;&#x5178;&#x578B;&#x7684;&#x9664;&#x4E86;hibernate&#x4E4B;&#x5916;&#xFF0C;&#x8FD8;&#x6709;spring&#x4E5F;&#x7528;&#x5230;&#x5F88;&#x591A;&#x53CD;&#x5C04;&#x673A;&#x5236;&#x3002;&#x6700;&#x7ECF;&#x5178;&#x7684;&#x5C31;&#x662F;xml&#x7684;&#x914D;&#x7F6E;&#x6A21;&#x5F0F;&#x3002;</p>
<p>Spring &#x901A;&#x8FC7; XML &#x914D;&#x7F6E;&#x6A21;&#x5F0F;&#x88C5;&#x8F7D; Bean &#x7684;&#x8FC7;&#x7A0B;&#xFF1A;</p>
<ol>
<li>&#x5C06;&#x7A0B;&#x5E8F;&#x5185;&#x6240;&#x6709; XML &#x6216; Properties &#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x52A0;&#x8F7D;&#x5165;&#x5185;&#x5B58;&#x4E2D;</li>
<li>Java&#x7C7B;&#x91CC;&#x9762;&#x89E3;&#x6790;xml&#x6216;properties&#x91CC;&#x9762;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x5F97;&#x5230;&#x5BF9;&#x5E94;&#x5B9E;&#x4F53;&#x7C7B;&#x7684;&#x5B57;&#x8282;&#x7801;&#x5B57;&#x7B26;&#x4E32;&#x4EE5;&#x53CA;&#x76F8;&#x5173;&#x7684;&#x5C5E;&#x6027;&#x4FE1;&#x606F;</li>
<li>&#x4F7F;&#x7528;&#x53CD;&#x5C04;&#x673A;&#x5236;&#xFF0C;&#x6839;&#x636E;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x83B7;&#x5F97;&#x67D0;&#x4E2A;&#x7C7B;&#x7684;Class&#x5B9E;&#x4F8B;</li>
<li>&#x52A8;&#x6001;&#x914D;&#x7F6E;&#x5B9E;&#x4F8B;&#x7684;&#x5C5E;&#x6027;</li>
</ol>
<p>Spring&#x8FD9;&#x6837;&#x505A;&#x7684;&#x597D;&#x5904;&#x662F;&#xFF1A;</p>
<ul>
<li>&#x4E0D;&#x7528;&#x6BCF;&#x4E00;&#x6B21;&#x90FD;&#x8981;&#x5728;&#x4EE3;&#x7801;&#x91CC;&#x9762;&#x53BB;new&#x6216;&#x8005;&#x505A;&#x5176;&#x4ED6;&#x7684;&#x4E8B;&#x60C5;</li>
<li>&#x4EE5;&#x540E;&#x8981;&#x6539;&#x7684;&#x8BDD;&#x76F4;&#x63A5;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x4EE3;&#x7801;&#x7EF4;&#x62A4;&#x8D77;&#x6765;&#x5C31;&#x5F88;&#x65B9;&#x4FBF;&#x4E86;</li>
<li>&#x6709;&#x65F6;&#x4E3A;&#x4E86;&#x9002;&#x5E94;&#x67D0;&#x4E9B;&#x9700;&#x6C42;&#xFF0C;Java&#x7C7B;&#x91CC;&#x9762;&#x4E0D;&#x4E00;&#x5B9A;&#x80FD;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x53E6;&#x5916;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x53CD;&#x5C04;&#x673A;&#x5236;&#x6765;&#x5B9E;&#x73B0;</li>
</ul>
<p>&#x6A21;&#x62DF; Spring &#x52A0;&#x8F7D; XML &#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanFactory</span> </span>{</span><br><span class="line">       <span class="keyword">private</span> Map&lt;String, Object&gt; beanMap = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">       <span class="comment">/**</span><br><span class="line">       * bean&#x5DE5;&#x5382;&#x7684;&#x521D;&#x59CB;&#x5316;.</span><br><span class="line">       * <span class="doctag">@param</span> xml xml&#x914D;&#x7F6E;&#x6587;&#x4EF6;</span><br><span class="line">       */</span></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(String xml)</span> </span>{</span><br><span class="line">              <span class="keyword">try</span> {</span><br><span class="line">                     <span class="comment">//&#x8BFB;&#x53D6;&#x6307;&#x5B9A;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</span></span><br><span class="line">                     SAXReader reader = <span class="keyword">new</span> SAXReader();</span><br><span class="line">                     ClassLoader classLoader = Thread.currentThread().getContextClassLoader();</span><br><span class="line">                     <span class="comment">//&#x4ECE;class&#x76EE;&#x5F55;&#x4E0B;&#x83B7;&#x53D6;&#x6307;&#x5B9A;&#x7684;xml&#x6587;&#x4EF6;</span></span><br><span class="line">                     InputStream ins = classLoader.getResourceAsStream(xml);</span><br><span class="line">                     Document doc = reader.read(ins);</span><br><span class="line">                     Element root = doc.getRootElement();  </span><br><span class="line">                     Element foo;</span><br><span class="line">                    </span><br><span class="line">                     <span class="comment">//&#x904D;&#x5386;bean</span></span><br><span class="line">                     <span class="keyword">for</span> (Iterator i = root.elementIterator(<span class="string">&quot;bean&quot;</span>); i.hasNext();) {  </span><br><span class="line">                            foo = (Element) i.next();</span><br><span class="line">                            <span class="comment">//&#x83B7;&#x53D6;bean&#x7684;&#x5C5E;&#x6027;id&#x548C;class</span></span><br><span class="line">                            Attribute id = foo.attribute(<span class="string">&quot;id&quot;</span>);  </span><br><span class="line">                            Attribute cls = foo.attribute(<span class="string">&quot;class&quot;</span>);</span><br><span class="line">                           </span><br><span class="line">                            <span class="comment">//&#x5229;&#x7528;Java&#x53CD;&#x5C04;&#x673A;&#x5236;&#xFF0C;&#x901A;&#x8FC7;class&#x7684;&#x540D;&#x79F0;&#x83B7;&#x53D6;Class&#x5BF9;&#x8C61;</span></span><br><span class="line">                            Class bean = Class.forName(cls.getText());</span><br><span class="line">                           </span><br><span class="line">                            <span class="comment">//&#x83B7;&#x53D6;&#x5BF9;&#x5E94;class&#x7684;&#x4FE1;&#x606F;</span></span><br><span class="line">                            java.beans.BeanInfo info = java.beans.Introspector.getBeanInfo(bean);</span><br><span class="line">                            <span class="comment">//&#x83B7;&#x53D6;&#x5176;&#x5C5E;&#x6027;&#x63CF;&#x8FF0;</span></span><br><span class="line">                            java.beans.PropertyDescriptor pd[] = info.getPropertyDescriptors();</span><br><span class="line">                            <span class="comment">//&#x8BBE;&#x7F6E;&#x503C;&#x7684;&#x65B9;&#x6CD5;</span></span><br><span class="line">                            Method mSet = <span class="keyword">null</span>;</span><br><span class="line">                            <span class="comment">//&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;</span></span><br><span class="line">                            Object obj = bean.newInstance();</span><br><span class="line">                           </span><br><span class="line">                            <span class="comment">//&#x904D;&#x5386;&#x8BE5;bean&#x7684;property&#x5C5E;&#x6027;</span></span><br><span class="line">                            <span class="keyword">for</span> (Iterator ite = foo.elementIterator(<span class="string">&quot;property&quot;</span>); ite.hasNext();) {  </span><br><span class="line">                                   Element foo2 = (Element) ite.next();</span><br><span class="line">                                   <span class="comment">//&#x83B7;&#x53D6;&#x8BE5;property&#x7684;name&#x5C5E;&#x6027;</span></span><br><span class="line">                                   Attribute name = foo2.attribute(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">                                   String value = <span class="keyword">null</span>;</span><br><span class="line">                                  </span><br><span class="line">                                   <span class="comment">//&#x83B7;&#x53D6;&#x8BE5;property&#x7684;&#x5B50;&#x5143;&#x7D20;value&#x7684;&#x503C;</span></span><br><span class="line">                                   <span class="keyword">for</span>(Iterator ite1 = foo2.elementIterator(<span class="string">&quot;value&quot;</span>); ite1.hasNext();) {</span><br><span class="line">                                          Element node = (Element) ite1.next();</span><br><span class="line">                                          value = node.getText();</span><br><span class="line">                                          <span class="keyword">break</span>;</span><br><span class="line">                                   }</span><br><span class="line">                                  </span><br><span class="line">                                   <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; pd.length; k++) {</span><br><span class="line">                                          <span class="keyword">if</span> (pd[k].getName().equalsIgnoreCase(name.getText())) {</span><br><span class="line">                                                 mSet = pd[k].getWriteMethod();</span><br><span class="line">                                                 <span class="comment">//&#x5229;&#x7528;Java&#x7684;&#x53CD;&#x5C04;&#x6781;&#x81F4;&#x8C03;&#x7528;&#x5BF9;&#x8C61;&#x7684;&#x67D0;&#x4E2A;set&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x5C06;&#x503C;&#x8BBE;&#x7F6E;&#x8FDB;&#x53BB;</span></span><br><span class="line">                                                 mSet.invoke(obj, value);</span><br><span class="line">                                          }</span><br><span class="line">                                   }</span><br><span class="line">                            }</span><br><span class="line">                           </span><br><span class="line">                            <span class="comment">//&#x5C06;&#x5BF9;&#x8C61;&#x653E;&#x5165;beanMap&#x4E2D;&#xFF0C;&#x5176;&#x4E2D;key&#x4E3A;id&#x503C;&#xFF0C;value&#x4E3A;&#x5BF9;&#x8C61;</span></span><br><span class="line">                            beanMap.put(id.getText(), obj);</span><br><span class="line">                     }</span><br><span class="line">              } <span class="keyword">catch</span> (Exception e) {</span><br><span class="line">                     System.out.println(e.toString());</span><br><span class="line">              }</span><br><span class="line">       }</span><br><span class="line">      </span><br><span class="line">       <span class="comment">//other codes</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure>]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Android自定义View实例之横向进度轴]]></title>
      <url>http://jasoncool.com/2018/09/10/Android%E8%87%AA%E5%AE%9A%E4%B9%89View%E5%AE%9E%E4%BE%8B%E4%B9%8B%E6%A8%AA%E5%90%91%E8%BF%9B%E5%BA%A6%E8%BD%B4/</url>
      <content type="html"><![CDATA[<h2 id="&#x4E00;&#x4E9B;&#x5FC3;&#x91CC;&#x8BDD;">&#x4E00;&#x4E9B;&#x5FC3;&#x91CC;&#x8BDD;</h2><p>&#x81EA;&#x5B9A;&#x4E49;View&#x4F5C;&#x4E3A;Android&#x7A0B;&#x5E8F;&#x5F00;&#x53D1;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x521D;&#x9636;&#x5230;&#x4E2D;&#x9636;&#x664B;&#x7EA7;&#x7684;&#x5173;&#x952E;&#x6027;&#x6807;&#x5FD7;&#xFF0C;&#x4E00;&#x76F4;&#x662F;&#x5F88;&#x591A;Android&#x7A0B;&#x5E8F;&#x5458;&#x5B66;&#x4E60;&#x7684;&#x5FC5;&#x7ECF;&#x4E4B;&#x8DEF;&#xFF0C;&#x6709;&#x5F88;&#x591A;&#x540C;&#x884C;&#x5728;&#x9047;&#x5230;&#x81EA;&#x5B9A;&#x4E49;View&#x540E;&#x9009;&#x62E9;&#x4E86;&#x77E5;&#x96BE;&#x800C;&#x9000;&#xFF0C;&#x8FD9;&#x5C31;&#x9020;&#x6210;&#x4E86;&#x4E00;&#x4E2A;&#x73B0;&#x8C61;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x8FD9;&#x4E9B;&#x7A0B;&#x5E8F;&#x5458;&#x53EA;&#x4F1A;&#x62FF;&#x522B;&#x4EBA;&#x9020;&#x597D;&#x7684;&#x8F6E;&#x5B50;&#x4FEE;&#x4FEE;&#x8865;&#x8865;&#xFF0C;&#x800C;&#x4ECE;&#x4E0D;&#x77E5;&#x9053;&#x4E00;&#x4E2A;&#x8F6E;&#x5B50;&#x8BE5;&#x5982;&#x4F55;&#x9020;&#x51FA;&#x6765;&#xFF0C;&#x8FD9;&#x6837;&#x4E0D;&#x597D;&#x3002;</p>
<p>&#x867D;&#x7136;&#x6211;&#x4E5F;&#x4E0D;&#x5EFA;&#x8BAE;&#x5927;&#x5BB6;&#x90FD;&#x91CD;&#x590D;&#x7684;&#x9020;&#x8F6E;&#x5B50;&#xFF0C;&#x6BD5;&#x7ADF;&#x4F60;&#x9020;&#x51FA;&#x6765;&#x7684;&#x672A;&#x5FC5;&#x6BD4;&#x522B;&#x4EBA;&#x597D;&#xFF0C;&#x9020;&#x597D;&#x4E86;&#x4E5F;&#x82B1;&#x8D39;&#x5927;&#x91CF;&#x65F6;&#x95F4;&#xFF0C;&#x62D6;&#x5EF6;&#x4E86;&#x9879;&#x76EE;&#x8FDB;&#x5EA6;&#xFF0C;&#x4F46;&#x662F;&#x77E5;&#x9053;&#x5982;&#x4F55;&#x9020;&#x8F6E;&#x5B50;&#x8FD9;&#x4EF6;&#x4E8B;&#x80AF;&#x5B9A;&#x662F;&#x5F88;&#x91CD;&#x8981;&#x7684;&#xFF0C;&#x4E0D;&#x80FD;&#x56E0;&#x564E;&#x5E9F;&#x98DF;&#xFF0C;&#x6BD5;&#x7ADF;&#x81EA;&#x5B9A;&#x4E49;View&#x6D89;&#x53CA;&#x7684;&#x77E5;&#x8BC6;&#x70B9;&#x975E;&#x5E38;&#x591A;&#x4E14;&#x590D;&#x6742;&#xFF0C;&#x53EA;&#x6709;&#x638C;&#x63E1;&#x4E86;&#x96BE;&#x5EA6;&#x8F83;&#x9AD8;&#x7684;&#x6280;&#x80FD;&#xFF0C;&#x4F60;&#x624D;&#x80FD;&#x5728;&#x7EA2;&#x5229;&#x671F;&#x5DF2;&#x8FC7;&#x7684;&#x79FB;&#x52A8;&#x5F00;&#x53D1;&#x4E2D;&#x8D70;&#x7684;&#x66F4;&#x8FDC;&#xFF0C;&#x722C;&#x7684;&#x66F4;&#x9AD8;&#xFF0C;&#x6BD5;&#x7ADF;&#x8FD9;&#x4E2A;&#x884C;&#x4E1A;&#x867D;&#x7B97;&#x4E0D;&#x4E0A;&#x5F31;&#x8089;&#x5F3A;&#x98DF;&#xFF0C;&#x4F46;&#x662F;&#x4F18;&#x80DC;&#x7565;&#x6C70;&#x7684;&#x81EA;&#x7136;&#x6CD5;&#x5219;&#x8FD8;&#x662F;&#x6709;&#x7684;&#x3002;</p>
<p>&#x597D;&#x4E86;&#xFF0C;&#x53ED;&#x53ED;&#x4E86;&#x8FD9;&#x4E48;&#x591A;&#xFF0C;&#x76EE;&#x7684;&#x4E0D;&#x662F;&#x8BF4;&#x6559;&#xFF0C;&#x800C;&#x662F;&#x5E0C;&#x671B;&#x6BCF;&#x4E2A;&#x4EBA;&#x90FD;&#x80FD;&#x770B;&#x6E05;&#x81EA;&#x5DF1;&#x672A;&#x6765;&#x7684;&#x8DEF;&#xFF0C;&#x6709;&#x6240;&#x8FFD;&#x6C42;&#x4E5F;&#x5B66;&#x4F1A;&#x53D6;&#x820D;&#x3002;</p>
<a id="more"></a>
<h2 id="&#x8BF4;&#x8BF4;&#x8FD9;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;View">&#x8BF4;&#x8BF4;&#x8FD9;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;View</h2><p>  &#x81EA;&#x5B9A;&#x4E49;View&#x5176;&#x5B9E;&#x6CA1;&#x5565;&#x597D;&#x8BF4;&#x7684;&#xFF0C;&#x76F4;&#x63A5;&#x770B;&#x6548;&#x679C;&#x56FE;&#x5373;&#x53EF;&#xFF1A;<br><img src="/2018/09/10/Android&#x81EA;&#x5B9A;&#x4E49;View&#x5B9E;&#x4F8B;&#x4E4B;&#x6A2A;&#x5411;&#x8FDB;&#x5EA6;&#x8F74;/1.gif" alt="logo"><br>&#x5927;&#x6982;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;&#x6837;&#x5B50;&#x4E86;&#xFF0C;&#x6709;&#x51E0;&#x5904;&#x9700;&#x8981;&#x7B80;&#x5355;&#x8BF4;&#x660E;&#x4E00;&#x4E0B;&#xFF1A;</p>
<p>1.&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x5706;&#x5F62;&#x7684;&#x5927;&#x5C0F;<br>2.&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x8FDE;&#x63A5;&#x7EBF;&#x7684;&#x7C97;&#x7EC6;<br>3.&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x5B8C;&#x6210;&#x548C;&#x672A;&#x5B8C;&#x6210;&#x7684;&#x989C;&#x8272;<br>4.&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x9636;&#x6BB5;&#x6587;&#x5B57;&#x7684;&#x5927;&#x5C0F;<br>5.&#x53EF;&#x4EE5;&#x6DFB;&#x52A0;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;<br>6.&#x652F;&#x6301;&#x8BBE;&#x7F6E;&#x8FDB;&#x5EA6;&#x7EBF;&#x5728;&#x4E24;&#x4E2A;&#x5706;&#x5F62;&#x4E4B;&#x95F4;<br>(&#x6BD4;&#x5982;&#xFF1A;&#x8BBE;&#x7F6E;&#x6B65;&#x6570;&#x4E3A;2.3&#xFF0C;&#x4ECE;0&#x5F00;&#x59CB;&#x753B;&#x70B9;&#x5219;&#x4F1A;&#x5728;&#x70B9;2&#x548C;&#x70B9;3&#x4E4B;&#x95F4;&#x6709;&#x4E00;&#x4E2A;&#x5B8C;&#x6210;&#x5EA6;&#x4E3A;&#x767E;&#x5206;&#x4E4B;30&#x7684;&#x5B8C;&#x6210;&#x7EBF;)</p>
<p>&#x57FA;&#x672C;&#x4E0A;&#x81EA;&#x5B9A;&#x4E49;View&#x5C31;&#x662F;&#x8FD9;&#x4E2A;&#x6837;&#x5B50;&#x4E86;&#xFF0C;&#x9002;&#x5408;&#x4E00;&#x4E9B;&#x8FDB;&#x5EA6;&#x5468;&#x671F;&#x8F83;&#x77ED;&#x7684;&#x4E1A;&#x52A1;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;&#x5468;&#x671F;&#x8F83;&#x77ED;&#x7684;&#x552E;&#x540E;&#x4E1A;&#x52A1;&#x6216;&#x8005;&#x5F00;&#x53D1;&#x6D41;&#x7A0B;&#x7B49;&#x8FDB;&#x5EA6;&#x8F74;&#x3002;</p>
<h2 id="&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x7ED8;&#x5236;&#x601D;&#x8DEF;">&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x7ED8;&#x5236;&#x601D;&#x8DEF;</h2><p>&#x6BCF;&#x505A;&#x4E00;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;View&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x517B;&#x6210;&#x4E00;&#x4E2A;&#x4E60;&#x60EF;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x5148;&#x8003;&#x8651;&#x7ED8;&#x5236;&#x601D;&#x8DEF;&#xFF0C;&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x8FC7;&#x7A0B;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x5229;&#x7528;Android&#x7ED9;&#x7684;&#x753B;&#x7B14;(Paint)&#x548C;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x5C5E;&#x6027;&#x503C;(attrs.xml)&#x518D;&#x6839;&#x636E;&#x4E00;&#x5B9A;&#x7684;&#x6D4B;&#x91CF;&#x89C4;&#x5219;&#xFF08;onMeasure&#xFF09;&#x4EE5;&#x53CA;&#x7ED8;&#x5236;&#x6D41;&#x7A0B;(onDraw)&#x5229;&#x7528;&#x4E00;&#x4E9B;&#x7B97;&#x6CD5;(&#x8D1D;&#x585E;&#x5C14;&#x66F2;&#x7EBF;&#x7B49;)&#x5728;&#x753B;&#x5E03;(Canvas)&#x4E0A;&#x7ED8;&#x5236;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x4F60;&#x4E0D;&#x9700;&#x8981;&#x5B66;&#x4E60;&#x4E00;&#x4E9B;&#x753B;&#x753B;&#x7684;&#x57FA;&#x672C;&#x529F;&#x7684;&#x524D;&#x63D0;&#x4E0B;&#xFF08;Paint&#x548C;Canvas&#x90FD;&#x5E2E;&#x4F60;&#x505A;&#x4E86;&#xFF09;&#xFF0C;&#x5982;&#x4F55;&#x6784;&#x56FE;&#x5C31;&#x6210;&#x4E86;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x5458;&#x7ED8;&#x5236;&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x5173;&#x952E;&#x3002;</p>
<p>&#x6784;&#x56FE;&#xFF0C;&#x770B;&#x4F3C;&#x89E6;&#x624B;&#x53EF;&#x53CA;&#x4F46;&#x5B9E;&#x9645;&#x4E0A;&#x865A;&#x65E0;&#x7F25;&#x7F08;&#xFF0C;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x521B;&#x4F5C;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x521B;&#x4F5C;&#x5C31;&#x662F;&#x75DB;&#x82E6;&#x7684;&#x8FC7;&#x7A0B;(&#x5929;&#x624D;&#x9664;&#x5916;)&#x3002;</p>
<p>&#x73B0;&#x5728;&#x56DE;&#x5230;&#x6211;&#x4EEC;&#x7684;&#x81EA;&#x5B9A;&#x4E49;View&#x5427;&#xFF0C;&#x8981;&#x7ED8;&#x5236;&#x4E00;&#x4E2A;&#x6A2A;&#x5411;&#x7684;&#x8FDB;&#x5EA6;&#x8F74;&#xFF0C;&#x6700;&#x5173;&#x952E;&#x7684;&#x51E0;&#x4E2A;&#x95EE;&#x9898;&#xFF1A;</p>
<p>1.&#x5982;&#x4F55;&#x7ED8;&#x5236;&#x70B9;?<br>2.&#x5982;&#x4F55;&#x7ED8;&#x5236;&#x7EBF;&#xFF1F;<br>3.&#x7B2C;&#x4E00;&#x4E2A;&#x70B9;&#x5DE6;&#x8FB9;&#x7559;&#x767D;&#x591A;&#x5C11;&#xFF1F;<br>4.&#x7B2C;&#x4E8C;&#x4E2A;&#x70B9;&#x53F3;&#x8FB9;&#x7559;&#x767D;&#x591A;&#x5C11;&#xFF1F;<br>5.&#x81EA;&#x5B9A;&#x4E49;&#x6D4B;&#x91CF;&#x7684;&#x5BBD;&#x5EA6;&#x548C;&#x9AD8;&#x5EA6;&#x5E94;&#x8BE5;&#x600E;&#x4E48;&#x8BA1;&#x7B97;&#xFF1F;</p>
<p>&#x95EE;&#x9898;&#x5176;&#x5B9E;&#x4E0D;&#x591A;&#xFF0C;&#x7ED8;&#x5236;&#x70B9;&#x548C;&#x7EBF;Canvas&#x90FD;&#x6709;&#x73B0;&#x6210;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4E0D;&#x7528;&#x64CD;&#x5FC3;&#xFF0C;&#x5173;&#x952E;&#x662F;&#x7B2C;&#x4E00;&#x4E2A;&#x70B9;&#x7684;&#x5DE6;&#x8FB9;&#x7559;&#x767D;&#x548C;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x70B9;&#x7684;&#x53F3;&#x8FB9;&#x7559;&#x767D;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x5F00;&#x59CB;&#x753B;&#x7684;&#x65F6;&#x5019;&#x7B80;&#x5355;&#x7684;&#x8BA4;&#x4E3A;&#x53EA;&#x8981;&#x7559;&#x51FA;&#x5706;&#x5F62;&#x7684;&#x534A;&#x5F84;&#x5C31;&#x884C;&#x4E86;&#xFF0C;&#x7ED3;&#x679C;&#x53D1;&#x73B0;&#x4E0B;&#x9762;&#x7684;&#x5B57;&#x6BD4;&#x5706;&#x5F62;&#x5BBD;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5B57;&#x5C31;&#x8D85;&#x51FA;&#x754C;&#x9762;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x5F97;&#x8003;&#x8651;&#x5B57;&#x548C;&#x534A;&#x5F84;&#x7684;&#x5BBD;&#x5EA6;&#xFF0C;&#x53D6;&#x6BD4;&#x8F83;&#x5BBD;&#x7684;&#x90A3;&#x4E2A;&#x503C;&#x8FDB;&#x884C;&#x7559;&#x767D;&#xFF0C;&#x81EA;&#x5B9A;&#x4E49;&#x6D4B;&#x91CF;&#x7684;&#x5BBD;&#x5EA6;&#x548C;&#x9AD8;&#x5EA6;&#x6211;&#x662F;&#x8FD9;&#x4E48;&#x8BBE;&#x8BA1;&#x7684;&#xFF1A;&#x5BBD;&#x5EA6;&#x4E3A;&#x624B;&#x673A;&#x5BBD;&#x5EA6;&#xFF0C;&#x9664;&#x975E;&#x4F60;&#x5199;&#x4E86;&#x5177;&#x4F53;&#x503C;&#xFF0C;&#x9AD8;&#x5EA6;&#x4E3A;&#x5706;&#x7684;&#x76F4;&#x5F84;&#x52A0;&#x4E0A;&#x4E24;&#x4E2A;&#x5B57;&#x7684;&#x9AD8;&#x5EA6;&#x518D;&#x52A0;&#x4E0A;padding&#x3002;</p>
<p>&#x8FD9;&#x6837;&#x5C31;&#x628A;&#x8FD9;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x6846;&#x67B6;&#x642D;&#x5EFA;&#x597D;&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x8003;&#x8651;&#x7684;&#x5C31;&#x662F;&#x5982;&#x4F55;&#x8FDE;&#x7EBF;&#x4EE5;&#x53CA;&#x5982;&#x4F55;&#x753B;&#x672A;&#x5B8C;&#x6210;&#x7684;&#x5EF6;&#x957F;&#x7EBF;&#x4E86;&#xFF1A;</p>
<p>1.&#x8FDE;&#x7EBF;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x53EA;&#x8981;&#x786E;&#x5B9A;&#x6B65;&#x6570;&#x5927;&#x4E8E;1&#xFF0C;&#x7136;&#x540E;&#x8BA9;&#x603B;&#x5BBD;&#x5EA6;&#x51CF;&#x53BB;&#x5DE6;&#x53F3;&#x7559;&#x767D;&#x7684;&#x5BBD;&#x5EA6;&#x548C;&#x8D77;&#x59CB;&#x53CA;&#x7ED3;&#x675F;&#x4E24;&#x4E2A;&#x5706;&#x7684;&#x76F4;&#x5F84;&#xFF0C;&#x5269;&#x4E0B;&#x7684;&#x5BBD;&#x5EA6;&#x5728;&#x9664;&#x4EE5;&#x70B9;&#x6570;-1&#x6765;&#x7B97;&#x51FA;&#x6BCF;&#x6761;&#x8FDE;&#x63A5;&#x7EBF;&#x7684;&#x957F;&#x5EA6;&#xFF0C;&#x518D;&#x5C06;&#x7EBF;&#x8FDE;&#x63A5;&#x8D77;&#x6765;&#x5373;&#x53EF;&#x3002;</p>
<p>2.&#x672A;&#x5B8C;&#x6210;&#x8FDB;&#x5EA6;&#x7684;&#x5EF6;&#x957F;&#x7EBF;&#x7684;&#x601D;&#x8DEF;&#x5C31;&#x662F;&#xFF0C;&#x5F97;&#x5230;&#x8FD9;&#x4E2A;&#x6B65;&#x6570;&#x6700;&#x5927;&#x7684;&#x6B65;&#x6570;&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x6B65;&#x6570;&#x5BF9;&#x5E94;&#x7684;&#x5706;&#x5F62;&#x4E4B;&#x540E;&#x7ED8;&#x5236;&#x4E00;&#x6761;&#x8FDE;&#x63A5;&#x7EBF;&#x957F;&#x5EA6;&#x767E;&#x5206;&#x6BD4;&#x957F;&#x5EA6;&#x7684;&#x5B8C;&#x6210;&#x7EBF;&#x8986;&#x76D6;&#x5373;&#x53EF;&#x3002;</p>
<p>&#x5F53;&#x7136;&#x8FD8;&#x8981;&#x8003;&#x8651;&#x81EA;&#x5B9A;&#x4E49;View&#x8BBE;&#x7F6E;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#x5E76;&#x5BF9;&#x5916;&#x63D0;&#x4F9B;&#x63A5;&#x53E3;&#x4EE5;&#x53CA;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#x5224;&#x65AD;&#x70B9;&#x51FB;&#x70B9;&#x662F;&#x5426;&#x5728;&#x65F6;&#x95F4;&#x8F74;&#x7684;&#x5706;&#x5F62;&#x4E0A;&#x5E76;&#x91CD;&#x65B0;&#x7ED8;&#x5236;&#x5B8C;&#x6210;&#x548C;&#x672A;&#x5B8C;&#x6210;&#x7684;&#x754C;&#x9762;&#x7B49;&#x7B49;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x601D;&#x8DEF;&#x5199;&#x51FA;&#x6765;&#x53EF;&#x80FD;&#x5F88;&#x96BE;&#x63CF;&#x8FF0;&#x6E05;&#x695A;&#xFF0C;&#x5982;&#x679C;&#x770B;&#x4E0D;&#x61C2;&#x6216;&#x8005;&#x770B;&#x8FF7;&#x7CCA;&#x4E86;&#x90A3;&#x80AF;&#x5B9A;&#x662F;&#x6211;&#x8868;&#x8FBE;&#x4E0D;&#x597D;&#xFF0C;&#x4E0D;&#x7528;&#x62C5;&#x5FC3;&#xFF0C;&#x7EE7;&#x7EED;&#x5F80;&#x4E0B;&#x770B;&#xFF0C;&#x4EE3;&#x7801;&#x4F1A;&#x544A;&#x8BC9;&#x4F60;&#x4E00;&#x5207;&#xFF0C;Talking  Is Cheap!</p>
<h2 id="&#x4EE3;&#x7801;&#x5982;&#x4F55;&#x5B9E;&#x73B0;">&#x4EE3;&#x7801;&#x5982;&#x4F55;&#x5B9E;&#x73B0;</h2><p>&#x7B2C;&#x4E00;&#x6B65;&#xFF1A;&#x5728;values&#x6587;&#x4EF6;&#x5939;&#x91CC;&#x52A0;&#x5165;attrs.xml&#x6587;&#x4EF6;&#xFF0C;&#x7528;&#x6765;&#x5B58;&#x653E;&#x81EA;&#x5B9A;&#x4E49;View&#x7528;&#x5230;&#x7684;&#x81EA;&#x5B9A;&#x4E49;&#x5C5E;&#x6027;&#xFF0C;&#x4E3B;&#x8981;&#x76EE;&#x7684;&#x662F;&#x5728;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x4E2D;&#x5C31;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x81EA;&#x5B9A;&#x4E49;&#x5C5E;&#x6027;&#x7684;&#x503C;&#xFF0C;&#x65B9;&#x4FBF;&#x5F00;&#x53D1;&#x8005;&#x8BBE;&#x7F6E;&#x3002;</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">declare-styleable</span> <span class="attribute">name</span>=<span class="value">&quot;TimeLineView&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">&quot;textSize&quot;</span> <span class="attribute">format</span>=<span class="value">&quot;dimension&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">&quot;tlradius&quot;</span> <span class="attribute">format</span>=<span class="value">&quot;dimension&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">&quot;lineWidth&quot;</span> <span class="attribute">format</span>=<span class="value">&quot;dimension&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">&quot;CompleteColor&quot;</span> <span class="attribute">format</span>=<span class="value">&quot;color&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">&quot;NoCompleteColor&quot;</span> <span class="attribute">format</span>=<span class="value">&quot;color&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">declare-styleable</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x4E2A;&#x64CD;&#x4F5C;&#x5982;&#x679C;&#x770B;&#x4E0D;&#x61C2;&#xFF0C;&#x5C31;&#x5F97;&#x81EA;&#x5DF1;&#x53BB;&#x5B66;&#x4E86;&#xFF0C;&#x4E3B;&#x8981;&#x5B66;&#x4E60;&#x81EA;&#x5B9A;&#x4E49;&#x5C5E;&#x6027;&#x65B9;&#x9762;&#x7684;&#x77E5;&#x8BC6;&#x3002;</p>
<p>&#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;&#x5F00;&#x59CB;&#x7F16;&#x5199;&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x878D;&#x5165;&#x521A;&#x624D;&#x7684;&#x601D;&#x8DEF;&#xFF0C;&#x6CE8;&#x91CA;&#x6211;&#x5DF2;&#x7ECF;&#x5199;&#x7684;&#x975E;&#x5E38;&#x597D;&#x4E86;(&#x4E2A;&#x4EBA;&#x8BA4;&#x4E3A;),&#x8BF7;&#x8BA4;&#x771F;&#x9605;&#x8BFB;&#xFF0C;&#x5E26;&#x7740;&#x521A;&#x624D;&#x6211;&#x63CF;&#x8FF0;&#x7684;&#x7A00;&#x91CC;&#x7CCA;&#x6D82;&#x7684;&#x601D;&#x8DEF;&#x4E5F;&#x53EF;&#x4EE5;&#x3002;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@author</span> &#x8D3E;&#x771F;</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TimeLineView</span> <span class="keyword">extends</span> <span class="title">View</span> </span>{</span><br><span class="line">    <span class="comment">/*</span><br><span class="line">    &#x5B9A;&#x4E49;&#x753B;&#x7B14;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> Paint mPaint;</span><br><span class="line">    <span class="comment">/*</span><br><span class="line">    &#x5EF6;&#x957F;&#x7EBF;&#x4E13;&#x7528;&#x753B;&#x7B14;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> Paint exPaint;</span><br><span class="line">    <span class="comment">/*</span><br><span class="line">    &#x5B57;&#x4F53;&#x5927;&#x5C0F;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mTextSize;</span><br><span class="line">    <span class="comment">/*</span><br><span class="line">    &#x5706;&#x5F62;&#x534A;&#x5F84;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mRadius;</span><br><span class="line">    <span class="comment">/*</span><br><span class="line">    &#x7EBF;&#x7684;&#x7C97;&#x5EA6;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mLineWidth;</span><br><span class="line">    <span class="comment">/*</span><br><span class="line">    &#x5B8C;&#x6210;&#x7684;&#x989C;&#x8272;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mCompleteColor;</span><br><span class="line">    <span class="comment">/*</span><br><span class="line">    &#x672A;&#x5B8C;&#x6210;&#x7684;&#x989C;&#x8272;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mNoCompleteColor;</span><br><span class="line">    <span class="comment">/*</span><br><span class="line">    &#x5F53;&#x524D;&#x6267;&#x884C;&#x5230;&#x7684;&#x6B65;&#x6570; &#x4ECE;0&#x5F00;&#x59CB;&#x8BA1;&#x7B97;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mStep=<span class="number">0</span>;</span><br><span class="line">    <span class="comment">/*</span><br><span class="line">     * &#x4F20;&#x5165;&#x7684;&#x6587;&#x5B57;&#x7684;list</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; pointStringList;</span><br><span class="line">    <span class="comment">/*</span><br><span class="line">     * &#x6BCF;&#x4E2A;&#x70B9;&#x7684;X&#x5750;&#x6807;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> Float[] pointXArray;</span><br><span class="line">    <span class="comment">/*</span><br><span class="line">     * &#x6587;&#x5B57;&#x9AD8;&#x5EA6;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mTextHeight;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span><br><span class="line">    &#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x8282;&#x70B9;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;</span><br><span class="line">     */</span></span><br><span class="line">    OnTimeLineStepClickListener onTimeLineStepClickListener;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span><br><span class="line">    &#x5B58;&#x653E;&#x5706;&#x5FC3;&#x7684;&#x5217;&#x8868;</span><br><span class="line">     */</span></span><br><span class="line">    List&lt;CircleCenter&gt; circleCenterList;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span><br><span class="line">     *  &#x70B9;&#x4E0E;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x9636;&#x6BB5;&#x957F;&#x5EA6;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">float</span> sectionLength;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span><br><span class="line">    &#x8BA1;&#x7B97;&#x4FDD;&#x7559;&#x4E24;&#x4F4D;&#x5C0F;&#x6570;&#x7528;&#x7684;&#x5DE5;&#x5177;&#x7C7B;</span><br><span class="line">     */</span></span><br><span class="line">    BigDecimal bigDecimal;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TimeLineView</span><span class="params">(Context context)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>(context,<span class="keyword">null</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TimeLineView</span><span class="params">(Context context, @Nullable AttributeSet attrs)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>(context, attrs,<span class="number">0</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TimeLineView</span><span class="params">(Context context, @Nullable AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(context, attrs, defStyleAttr);</span><br><span class="line">        initAttr(attrs);</span><br><span class="line">        init();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x521D;&#x59CB;&#x5316;&#x81EA;&#x5B9A;&#x4E49;&#x5C5E;&#x6027;&#x7684;</span><br><span class="line">     * <span class="doctag">@param</span> attrs attrs.xml&#x91CC;&#x5B9A;&#x4E49;&#x7684;&#x5C5E;&#x6027;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span>  <span class="title">initAttr</span><span class="params">(AttributeSet attrs)</span></span>{</span><br><span class="line">        <span class="keyword">if</span> (attrs != <span class="keyword">null</span>) {</span><br><span class="line">            TypedArray typedArray = getContext().obtainStyledAttributes(attrs, R.styleable.TimeLineView);</span><br><span class="line">            mTextSize = typedArray.getDimension(R.styleable.TimeLineView_textSize, <span class="number">20</span>);</span><br><span class="line">            mRadius = typedArray.getDimension(R.styleable.TimeLineView_tlradius,<span class="number">20</span>);</span><br><span class="line">            mLineWidth=typedArray.getDimension(R.styleable.TimeLineView_tlradius,<span class="number">5</span>);</span><br><span class="line">            mCompleteColor=typedArray.getColor(R.styleable.TimeLineView_CompleteColor,Color.GREEN);</span><br><span class="line">            mNoCompleteColor=typedArray.getColor(R.styleable.TimeLineView_NoCompleteColor,Color.GRAY);</span><br><span class="line">            <span class="comment">//&#x5207;&#x8BB0;&#x56DE;&#x6536;&#x9632;&#x6B62;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;</span></span><br><span class="line">            typedArray.recycle();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x521D;&#x59CB;&#x5316;&#x753B;&#x7B14;&#x3001;&#x5B57;&#x4F53;&#x9AD8;&#x5EA6;&#x3001;&#x4F20;&#x5165;&#x6B65;&#x6570;&#x6587;&#x5B57;&#x5185;&#x5BB9;&#x7684;&#x5217;&#x8868;&#x4EE5;&#x53CA;&#x5706;&#x5FC3;&#x7684;&#x5217;&#x8868;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>{</span><br><span class="line">        mPaint=<span class="keyword">new</span> Paint();</span><br><span class="line">        mPaint.setAntiAlias(<span class="keyword">true</span>);</span><br><span class="line">        mPaint.setTextSize(mTextSize);</span><br><span class="line">        mPaint.setStrokeWidth(mLineWidth);</span><br><span class="line">         exPaint=<span class="keyword">new</span> Paint();</span><br><span class="line">        mTextHeight=mPaint.descent() -mPaint.ascent();</span><br><span class="line">        pointStringList=<span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        pointStringList.add(<span class="string">&quot;&#x7B2C;&#x4E00;&#x6B65;&quot;</span>);</span><br><span class="line">        pointStringList.add(<span class="string">&quot;&#x7B2C;&#x4E8C;&#x6B65;&quot;</span>);</span><br><span class="line">        pointStringList.add(<span class="string">&quot;&#x7B2C;&#x4E09;&#x6B65;&quot;</span>);</span><br><span class="line">        circleCenterList=<span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x6D4B;&#x91CF;&#x65B9;&#x5F0F; &#x4E3B;&#x8981;&#x5904;&#x7406;&#x7684;&#x662F;wrap_content&#x6A21;&#x5F0F;&#x4E0B;&#x7684;&#x4E00;&#x4E9B;&#x9ED8;&#x8BA4;&#x503C;</span><br><span class="line">     * &#x5BBD;&#x5EA6;&#x662F;&#x4E0D;&#x7BA1;&#x5982;&#x4F55;&#x8BBE;&#x7F6E;&#x90FD;&#x662F;&#x5360;&#x7528;&#x7684;&#x6574;&#x4E2A;&#x5C4F;&#x5E55;&#x7684;&#x5BBD;&#x5EA6;&#xFF0C;&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x8C03;&#x6574;</span><br><span class="line">     * &#x9AD8;&#x5EA6;&#x662F;&#x4E24;&#x500D;&#x5B57;&#x4F53;&#x7684;&#x9AD8;&#x5EA6;&#x52A0;&#x4E0A;&#x5706;&#x7684;&#x76F4;&#x5F84; &#x4F5C;&#x4E3A;&#x9ED8;&#x8BA4;&#x9AD8;&#x5EA6;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x9700;&#x6C42;&#x4E5F;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x8C03;&#x6574;</span><br><span class="line">     * <span class="doctag">@param</span> widthMeasureSpec &#x5BBD;&#x5EA6;&#x5C3A;</span><br><span class="line">     * <span class="doctag">@param</span> heightMeasureSpec &#x9AD8;&#x5EA6;&#x5C3A;</span><br><span class="line">     */</span></span><br><span class="line">   <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onMeasure</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec, <span class="keyword">int</span> heightMeasureSpec)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onMeasure(widthMeasureSpec, heightMeasureSpec);</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> minimumWidth = getSuggestedMinimumWidth();</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> minimumHeight = getSuggestedMinimumHeight();</span><br><span class="line">        <span class="keyword">int</span> width = measureWidth(minimumWidth, widthMeasureSpec);</span><br><span class="line">        <span class="keyword">int</span> height = measureHeight(minimumHeight, heightMeasureSpec);</span><br><span class="line">        setMeasuredDimension(width, height);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6D4B;&#x91CF;&#x5BBD;&#x5EA6;</span><br><span class="line">     * <span class="doctag">@param</span> defaultWidth &#x9ED8;&#x8BA4;&#x5BBD;&#x5EA6;</span><br><span class="line">     * <span class="doctag">@param</span> measureSpec &#x5BBD;&#x5EA6;&#x5C3A;</span><br><span class="line">     * <span class="doctag">@return</span> &#x8BA1;&#x7B97;&#x540E;&#x7684;&#x5BBD;&#x5EA6;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">measureWidth</span><span class="params">(<span class="keyword">int</span> defaultWidth, <span class="keyword">int</span> measureSpec)</span> </span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> specMode = MeasureSpec.getMode(measureSpec);</span><br><span class="line">        <span class="keyword">int</span> specSize = MeasureSpec.getSize(measureSpec);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (specMode) {</span><br><span class="line">            <span class="keyword">case</span> MeasureSpec.AT_MOST:</span><br><span class="line">                defaultWidth = getWidth();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MeasureSpec.EXACTLY:</span><br><span class="line">                defaultWidth = specSize;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MeasureSpec.UNSPECIFIED:</span><br><span class="line">                defaultWidth = Math.max(defaultWidth, specSize);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> defaultWidth;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x9AD8;&#x5EA6;&#x6D4B;&#x91CF;</span><br><span class="line">     * <span class="doctag">@param</span> defaultHeight &#x9ED8;&#x8BA4;&#x9AD8;&#x5EA6;</span><br><span class="line">     * <span class="doctag">@param</span> measureSpec &#x9AD8;&#x5EA6;&#x5C3A;</span><br><span class="line">     * <span class="doctag">@return</span> &#x8BA1;&#x7B97;&#x540E;&#x7684;&#x9AD8;&#x5EA6;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">measureHeight</span><span class="params">(<span class="keyword">int</span> defaultHeight, <span class="keyword">int</span> measureSpec)</span> </span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> specMode = MeasureSpec.getMode(measureSpec);</span><br><span class="line">        <span class="keyword">int</span> specSize = MeasureSpec.getSize(measureSpec);</span><br><span class="line">        <span class="keyword">switch</span> (specMode) {</span><br><span class="line">            <span class="keyword">case</span> MeasureSpec.AT_MOST:</span><br><span class="line">                defaultHeight = (<span class="keyword">int</span>) (<span class="number">2</span>*mTextHeight+(mRadius*<span class="number">2</span>)) + getPaddingTop() + getPaddingBottom();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MeasureSpec.EXACTLY:</span><br><span class="line">                defaultHeight = specSize;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MeasureSpec.UNSPECIFIED:</span><br><span class="line">                defaultHeight = Math.max(defaultHeight, specSize);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> defaultHeight;</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x7ED8;&#x5236;&#x601D;&#x8DEF;&#xFF1A;</span><br><span class="line">     * 1.&#x786E;&#x5B9A;&#x7B2C;&#x4E00;&#x6B65;&#x9AA4;&#x7684;&#x5706;&#x5F62;&#x548C;&#x6587;&#x5B57;&#x7684;&#x5BBD;&#x5EA6;&#xFF0C;&#x54EA;&#x4E2A;&#x5BBD;&#x5C31;&#x7528;&#x54EA;&#x4E2A;&#x4F5C;&#x4E3A;&#x7B2C;&#x4E00;&#x6B65;&#x7ED8;&#x5236;&#x7684;&#x5DE6;&#x8FB9;&#x8DDD;&#x79BB;</span><br><span class="line">     * 2.&#x786E;&#x5B9A;&#x6700;&#x540E;&#x6B65;&#x9AA4;&#x7684;&#x5706;&#x5F62;&#x548C;&#x6587;&#x5B57;&#x7684;&#x5BBD;&#x5EA6;&#xFF0C;&#x90A3;&#x4E2A;&#x5BBD;&#x5C31;&#x7528;&#x54EA;&#x4E2A;&#x6700;&#x4E3A;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x6B65;&#x9AA4;&#x7ED8;&#x5236;&#x7684;&#x53F3;&#x8FB9;&#x8DDD;&#x79BB;</span><br><span class="line">     * 3.&#x7528;&#x81EA;&#x5B9A;&#x4E49;&#x7EC4;&#x4EF6;&#x6574;&#x4F53;&#x7684;&#x5BBD;&#x5EA6;&#x51CF;&#x53BB;&#x5DE6;&#x8FB9;&#x8DDD;&#x548C;&#x53F3;&#x8FB9;&#x8DDD;&#x518D;&#x52A0;&#x4E0A;&#x4E24;&#x4E2A;&#x534A;&#x5F84;&#x7684;&#x8DDD;&#x79BB;&#xFF0C;&#x5269;&#x4E0B;&#x7684;&#x5C31;&#x662F;&#x8981;&#x5E73;&#x5206;&#x5269;&#x4E0B;&#x70B9;&#x7684;&#x8DDD;&#x79BB;</span><br><span class="line">     * 4.&#x5E73;&#x5206;&#x5269;&#x4E0B;&#x7684;&#x8DDD;&#x79BB;&#xFF0C;&#x753B;&#x5706;&#x540E;&#x8FDE;&#x7EBF;&#x3002;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onDraw(canvas);</span><br><span class="line">        <span class="comment">//&#x5148;&#x5224;&#x65AD;&#x4F20;&#x5165;&#x7684;&#x6B65;&#x6570;&#x662F;&#x4E0D;&#x662F;&#x5927;&#x4E8E;0&#xFF0C;&#x5982;&#x679C;&#x4F20;&#x5165;&#x4E00;&#x4E2A;&#x7A7A;&#x6570;&#x636E;&#x7684;List&#x5219;&#x4E0D;&#x8C03;&#x7528;&#x663E;&#x793A;&#x6B65;&#x6570;&#x7684;&#x65B9;&#x6CD5;</span></span><br><span class="line">        <span class="keyword">if</span>(pointStringList.size()&gt;<span class="number">0</span>){</span><br><span class="line">            <span class="comment">//&#x5148;&#x8BBE;&#x7F6E;&#x6210;&#x5B8C;&#x6210;&#x540E;&#x7684;&#x989C;&#x8272;&#xFF0C;&#x56E0;&#x4E3A;&#x7ED8;&#x5236;&#x8FC7;&#x7A0B;&#x80AF;&#x5B9A;&#x662F;&#x5148;&#x7ED8;&#x5236;&#x5B8C;&#x6210;&#x540E;&#x7684;&#x989C;&#x8272;&#x4E14;&#x4F20;&#x5165;&#x7684;&#x6B65;&#x6570;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x6B65;&#x662F;&#x5B8C;&#x6210;&#x7684;</span></span><br><span class="line">            mPaint.setColor(mCompleteColor);</span><br><span class="line">            initViewsPos();</span><br><span class="line">            <span class="comment">//&#x5F53;&#x524D;&#x7ED8;&#x5236;&#x5230;&#x90A3;&#x4E00;&#x6B65;</span></span><br><span class="line">            <span class="keyword">int</span> currentStep;</span><br><span class="line">            <span class="comment">//&#x662F;&#x5426;&#x7ED8;&#x5236;&#x534A;&#x622A;&#x8FDB;&#x7A0B;&#x7684;&#x7EBF; &#x5982;2.3&#x5C31;&#x7ED8;&#x5236;&#x7B2C;&#x4E09;&#x6B65;&#x5230;&#x7B2C;&#x56DB;&#x6B65;&#x7684;&#x767E;&#x5206;&#x4E4B;30&#x7684;&#x5B8C;&#x6210;&#x7EBF;</span></span><br><span class="line">            <span class="keyword">boolean</span> isDrawExtrasLine=<span class="keyword">false</span>;</span><br><span class="line">            <span class="comment">//&#x5FAA;&#x73AF;X&#x8F74;&#x7684;&#x70B9;&#x8FDB;&#x884C;&#x7ED8;&#x5236;</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;pointXArray.length;i++){</span><br><span class="line">                currentStep= i;</span><br><span class="line">                <span class="comment">//&#x5F53;&#x524D;&#x7684;&#x6B65;&#x9AA4;&#x5927;&#x4E8E;&#x8BBE;&#x7F6E;&#x7684;&#x6B65;&#x9AA4;&#x4E86;&#x5C31;&#x9700;&#x8981;&#x5C06;&#x7EBF;&#x548C;&#x5706;&#x6539;&#x6210;&#x672A;&#x5B8C;&#x6210;&#x8272;,&#x5982;&#x679C;&#x8981;&#x7ED8;&#x5236;&#x672A;&#x5B8C;&#x6210;&#x8272;&#x5C31;&#x8BF4;&#x660E;&#x53EF;&#x80FD;&#x8981;&#x7ED8;&#x5236;&#x5EF6;&#x957F;&#x7EBF;&#xFF0C;&#x90A3;&#x5C31;&#x5C06;&#x7ED8;&#x5236;&#x5EF6;&#x957F;&#x7EBF;&#x7684;&#x5F00;&#x5173;&#x6253;&#x5F00;&#x3002;</span></span><br><span class="line">                <span class="keyword">if</span>(currentStep &gt;mStep){</span><br><span class="line">                    mPaint.setColor(mNoCompleteColor);</span><br><span class="line">                    isDrawExtrasLine=<span class="keyword">true</span>;</span><br><span class="line">                }</span><br><span class="line">                drawCirlceAndText(canvas,pointStringList.get(i),pointXArray[i]);</span><br><span class="line">                <span class="comment">//&#x5F53;i&#x5927;&#x4E8E;1&#x8BF4;&#x660E;&#x6709;&#x8D77;&#x7801;&#x4E24;&#x4E2A;&#x70B9;&#x65F6;&#x624D;&#x6709;&#x5FC5;&#x8981;&#x753B;&#x7EBF;</span></span><br><span class="line">                <span class="keyword">if</span>(i&gt;=<span class="number">1</span>){</span><br><span class="line">                drawLine(canvas,pointXArray[i-<span class="number">1</span>],pointXArray[i]);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            <span class="comment">//&#x7ED8;&#x5236;&#x5EF6;&#x957F;&#x7EBF;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x5904;&#x7406;&#x6B65;&#x6570;&#x4E3A;&#x7C7B;&#x4F3C;2.3&#x65F6;&#xFF0C;&#x8FD9;&#x767E;&#x5206;&#x4E4B;30&#x7684;&#x7B2C;&#x4E09;&#x4E2A;&#x5706;&#x5230;&#x7B2C;&#x56DB;&#x4E2A;&#x5706;&#x4E4B;&#x95F4;&#x7684;&#x5B8C;&#x6210;&#x989C;&#x8272;&#x7684;&#x7EBF;</span></span><br><span class="line">            <span class="keyword">if</span>(isDrawExtrasLine){</span><br><span class="line">                bigDecimal  =<span class="keyword">new</span>  BigDecimal(mStep);</span><br><span class="line">               <span class="keyword">float</span> mStepTwoPoint =bigDecimal.setScale(<span class="number">2</span>,  BigDecimal.ROUND_HALF_UP).floatValue();</span><br><span class="line">               <span class="comment">//&#x53D6;&#x5C0F;&#x6570;&#x70B9;&#x540E;&#x7684;&#x6570;&#x5B57;</span></span><br><span class="line">               <span class="keyword">float</span> littleCountFloat=mStepTwoPoint-(<span class="keyword">int</span>)mStepTwoPoint;</span><br><span class="line">               drawExtrasLine(canvas,littleCountFloat);</span><br><span class="line">            }</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            mPaint.setColor(Color.RED);</span><br><span class="line">            String noStepsWarnText=<span class="string">&quot;&#x4F20;&#x5165;&#x6B65;&#x6570;&#x4E3A;0&#xFF0C;&#x8BF7;&#x91CD;&#x65B0;&#x4F20;&#x5165;&#x6570;&#x636E;&quot;</span>;</span><br><span class="line">            canvas.drawText(noStepsWarnText,(getWidth()/<span class="number">2</span>)-mPaint.measureText(noStepsWarnText)/<span class="number">2</span>,getHeight() - <span class="keyword">this</span>.mRadius - <span class="number">1</span>,mPaint);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x521D;&#x59CB;&#x5316;&#x7EC4;&#x4EF6;&#x7684;&#x4F4D;&#x7F6E;</span><br><span class="line">     * &#x4E3B;&#x8981;&#x662F;&#x8BA1;&#x7B97;&#x5404;&#x4E2A;&#x5706;&#x5F62;&#x7684;&#x4F4D;&#x7F6E;</span><br><span class="line">     * &#x5E76;&#x5C06;&#x5176;&#x5706;&#x5FC3;&#x4F4D;&#x7F6E;&#x8BB0;&#x5F55;&#x5230;&#x6570;&#x7EC4;&#x4E2D;&#x53BB;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initViewsPos</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="comment">//&#x4F20;&#x5165;&#x7684;&#x6B65;&#x6570;</span></span><br><span class="line">        <span class="keyword">int</span> pointCount= pointStringList.size();</span><br><span class="line">        pointXArray=<span class="keyword">new</span> Float[pointCount];</span><br><span class="line">        <span class="comment">//&#x5982;&#x679C;&#x6587;&#x5B57;&#x7684;&#x957F;&#x5EA6;&#x5927;&#x4E8E;&#x534A;&#x5F84; &#x5C31;&#x7528;&#x6587;&#x5B57;&#x7684;&#x957F;&#x5EA6;&#x6765;&#x8BA1;&#x7B97; &#x5F00;&#x59CB;&#x7684;&#x70B9;&#x548C;&#x7ED3;&#x675F;&#x7684;&#x70B9;&#x540C;&#x7406;</span></span><br><span class="line">        <span class="keyword">float</span> startDistance=Math.max(mRadius,mPaint.measureText(pointStringList.get(<span class="number">0</span>))/<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">float</span> endDistance=Math.max(mRadius,mPaint.measureText(pointStringList.get(pointStringList.size()-<span class="number">1</span>))/<span class="number">2</span>);</span><br><span class="line">        <span class="comment">//&#x6BCF;&#x6BB5;&#x7EBF;&#x7684;&#x8DDD;&#x79BB; &#x5BBD;&#x5EA6;&#x51CF;&#x53BB;&#x5DE6;&#x7559;&#x767D;&#x548C;&#x53F3;&#x7559;&#x767D;&#x540E;&#x9664;&#x4EE5;&#x70B9;&#x6570;&#x51CF;&#x4E00;&#x5373;&#x53EF; &#x5E2E;&#x52A9;&#x601D;&#x8003;&#x7684;&#x56FE;&#x4F8B;&#xFF1A;*---*---*---*</span></span><br><span class="line">         sectionLength=(getWidth()-startDistance-endDistance)/(pointCount-<span class="number">1</span>);</span><br><span class="line">         <span class="comment">//&#x5FAA;&#x73AF;&#x5C06;&#x8D77;&#x59CB;&#x70B9;&#x3001;&#x7ED3;&#x675F;&#x70B9;&#x548C;&#x4E2D;&#x95F4;&#x7684;&#x70B9;&#x7684;X&#x7684;&#x503C;&#x653E;&#x5165;&#x6570;&#x7EC4;&#x4E2D;</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;pointCount;i++){</span><br><span class="line">                <span class="keyword">if</span>(i==<span class="number">0</span>){</span><br><span class="line">                    pointXArray[i]=startDistance;</span><br><span class="line">                }<span class="keyword">else</span> <span class="keyword">if</span>(i==pointCount-<span class="number">1</span>){</span><br><span class="line">                    pointXArray[i]=getWidth()-endDistance;</span><br><span class="line">                }<span class="keyword">else</span>{</span><br><span class="line">                    pointXArray[i]=startDistance+sectionLength*i;</span><br><span class="line">                }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x7ED8;&#x5236;&#x5706;&#x5F62;&#x548C;&#x4E0B;&#x9762;&#x7684;&#x6587;&#x5B57;</span><br><span class="line">     * <span class="doctag">@param</span> canvas &#x753B;&#x5E03;</span><br><span class="line">     * <span class="doctag">@param</span> text &#x6587;&#x5B57;&#x5185;&#x5BB9;</span><br><span class="line">     * <span class="doctag">@param</span> x x&#x8F74;&#x7684;&#x503C;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drawCirlceAndText</span><span class="params">(Canvas canvas,String text,<span class="keyword">float</span> x)</span></span>{</span><br><span class="line">        canvas.drawCircle(x,getHeight()- <span class="keyword">this</span>.mRadius * <span class="number">2</span> - <span class="number">30</span>,mRadius,mPaint);</span><br><span class="line">        <span class="comment">//&#x5C06;&#x6BCF;&#x4E2A;&#x5706;&#x7684;&#x5706;&#x5FC3;&#x52A0;&#x5165;&#x5230;&#x5217;&#x8868;&#x4E2D;&#x53BB;</span></span><br><span class="line">        circleCenterList.add(<span class="keyword">new</span> CircleCenter(x,getHeight()- <span class="keyword">this</span>.mRadius * <span class="number">2</span> - <span class="number">30</span>));</span><br><span class="line">        Log.e(<span class="string">&quot;mTextHeight:&quot;</span>,mTextHeight+<span class="string">&quot;&quot;</span>);</span><br><span class="line">        canvas.drawText(text,x-mPaint.measureText(text)/<span class="number">2</span>,getHeight() - <span class="keyword">this</span>.mRadius - <span class="number">1</span>,mPaint);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  &#x7ED8;&#x5236;&#x4E24;&#x5706;&#x4E4B;&#x95F4;&#x7684;&#x8FDE;&#x63A5;&#x7EBF; &#x603B;&#x6570;&#x4E3A;&#x70B9;&#x6570;-1</span><br><span class="line">     * <span class="doctag">@param</span> canvas &#x753B;&#x5E03;</span><br><span class="line">     * <span class="doctag">@param</span> startX &#x7EBF;&#x5F00;&#x59CB;&#x7684;X&#x8F74;&#x7684;&#x503C;</span><br><span class="line">     * <span class="doctag">@param</span> endX &#x7EBF;&#x7ED3;&#x675F;&#x7684;X&#x8F74;&#x7684;&#x503C;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drawLine</span><span class="params">(Canvas canvas,<span class="keyword">float</span> startX,<span class="keyword">float</span> endX)</span></span>{</span><br><span class="line">        canvas.drawLine(startX+mRadius,getHeight()- <span class="keyword">this</span>.mRadius * <span class="number">2</span> - <span class="number">30</span>,endX-mRadius,getHeight()- <span class="keyword">this</span>.mRadius * <span class="number">2</span> - <span class="number">30</span>,mPaint);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x7ED8;&#x5236;&#x591A;&#x4F59;&#x7684;&#x5C0F;&#x6570;&#x7EBF;&#x6BB5;</span><br><span class="line">     * &#x8FD9;&#x91CC;&#x7684;&#x7ED8;&#x5236;&#x539F;&#x7406;&#x662F; &#x8BA1;&#x7B97;&#x767E;&#x5206;&#x6BD4;&#x5E76;&#x627E;&#x5230;&#x5B8C;&#x6210;&#x6B65;&#x6570;&#x7684;&#x503C; &#x5E76;&#x5728;&#x5176;&#x4E4B;&#x540E; &#x7ED8;&#x5236;&#x4E00;&#x6761;&#x5B8C;&#x6210;&#x989C;&#x8272;&#x7684;&#x7EBF; &#x8BE5;&#x7EBF;&#x7684;&#x957F;&#x5EA6;&#x662F;&#x4E00;&#x4E2A;&#x7EBF;&#x6BB5;&#x4E58;&#x4EE5;&#x5B8C;&#x6210;&#x7684;&#x767E;&#x5206;&#x6BD4;</span><br><span class="line">     * <span class="doctag">@param</span> canvas &#x753B;&#x5E03;</span><br><span class="line">     * <span class="doctag">@param</span> percent &#x5B8C;&#x6210;&#x7684;&#x767E;&#x5206;&#x6BD4;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drawExtrasLine</span><span class="params">(Canvas canvas,<span class="keyword">float</span> percent)</span></span>{</span><br><span class="line">        <span class="comment">//&#x627E;&#x5230;&#x6700;&#x5927;&#x6B65;&#x6570;&#x7684;&#x5706;&#x5F62;&#x7684;X&#x8F74;</span></span><br><span class="line">       <span class="keyword">float</span> maxGreenPointX= pointXArray[(<span class="keyword">int</span>)mStep];</span><br><span class="line">       <span class="comment">//&#x8BBE;&#x7F6E;&#x5EF6;&#x957F;&#x7EBF;&#x4E13;&#x7528;Paint&#x7684;&#x989C;&#x8272;&#x548C;&#x5BBD;&#x5EA6;</span></span><br><span class="line">       exPaint.setColor(mCompleteColor);</span><br><span class="line">       exPaint.setStrokeWidth(mLineWidth);</span><br><span class="line">       canvas.drawLine(maxGreenPointX+mRadius,getHeight()- <span class="keyword">this</span>.mRadius * <span class="number">2</span> - <span class="number">30</span>,maxGreenPointX+mRadius+sectionLength*percent,getHeight()- <span class="keyword">this</span>.mRadius * <span class="number">2</span> - <span class="number">30</span>,exPaint);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  &#x4F20;&#x53C2;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5BF9;&#x5916;&#x5F00;&#x653E;</span><br><span class="line">     * <span class="doctag">@param</span> mpointStringArray &#x4F20;&#x5165;&#x7684;&#x6B65;&#x9AA4;&#x7684;&#x6570;&#x7EC4;(&#x8FD9;&#x91CC;&#x4E4B;&#x6240;&#x4EE5;&#x7528;&#x6570;&#x7EC4;&#x662F;&#x56E0;&#x4E3A;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<span class="doctag">@Size</span>&#x6CE8;&#x89E3;)</span><br><span class="line">     * <span class="doctag">@param</span> step &#x4F20;&#x5165;&#x7684;&#x5B8C;&#x6210;&#x6B65;&#x9AA4;&#x6570;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPointStrings</span><span class="params">(@Size(min = <span class="number">2</span>)</span> String[] mpointStringArray, @<span class="title">FloatRange</span><span class="params">(from = <span class="number">1.0</span>)</span> <span class="keyword">float</span> step) </span>{</span><br><span class="line">        <span class="keyword">if</span> (mpointStringArray.length==<span class="number">0</span>) {</span><br><span class="line">            pointStringList.clear();</span><br><span class="line">            circleCenterList.clear();</span><br><span class="line">            mStep = <span class="number">0</span>;</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            pointStringList =  Arrays.asList(mpointStringArray);</span><br><span class="line">            mStep = Math.min(step, pointStringList.size());</span><br><span class="line">            invalidate();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x52A8;&#x6001;&#x8BBE;&#x7F6E;&#x6B65;&#x6570;&#x7684;&#x65B9;&#x6CD5;</span><br><span class="line">     * <span class="doctag">@param</span> step &#x6B65;&#x6570;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStep</span><span class="params">(@FloatRange(from = <span class="number">1.0</span>)</span> <span class="keyword">float</span> step)</span>{</span><br><span class="line">        mStep = Math.min(step, pointStringList.size());</span><br><span class="line">        invalidate();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x624B;&#x52BF;&#x65B9;&#x6CD5;&#x91CD;&#x5199; &#x8FD4;&#x56DE;true&#x6765;&#x6D88;&#x8D39;&#x6B64;&#x65B9;&#x6CD5;</span><br><span class="line">     * &#x539F;&#x7406;&#x662F;&#x5F53;&#x624B;&#x6307;&#x62AC;&#x8D77;&#x65F6; &#x8BA1;&#x7B97;&#x70B9;&#x51FB;&#x7684;&#x70B9;&#x662F;&#x4E0D;&#x662F;&#x5728;&#x6B65;&#x9AA4;&#x5706;&#x5F62;&#x4E2D;&#x7684;&#x67D0;&#x4E00;&#x4E2A;&#x8303;&#x56F4;&#x5185;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x5C31;&#x89E6;&#x53D1;&#x81EA;&#x5B9A;&#x4E49;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;</span><br><span class="line">     * <span class="doctag">@param</span> event &#x70B9;&#x51FB;&#x4E8B;&#x4EF6;</span><br><span class="line">     * <span class="doctag">@return</span> true &#x6D88;&#x8D39;&#x4E8B;&#x4EF6;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@SuppressLint</span>(<span class="string">&quot;ClickableViewAccessibility&quot;</span>)</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>{</span><br><span class="line">        <span class="keyword">float</span> x =  event.getX();</span><br><span class="line">        <span class="keyword">float</span> y =  event.getY();</span><br><span class="line">        <span class="keyword">int</span> action = event.getAction();</span><br><span class="line">        <span class="keyword">switch</span> (action) {</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</span><br><span class="line">                <span class="keyword">if</span> (x + getLeft() &lt; getRight() &amp;&amp; y + getTop() &lt; getBottom()) {</span><br><span class="line">                    <span class="keyword">int</span> clickStep=isInTheCircles(x,y);</span><br><span class="line">                    <span class="keyword">if</span>(clickStep&gt;=<span class="number">0</span>&amp;&amp;onTimeLineStepClickListener!=<span class="keyword">null</span>)</span><br><span class="line">                    onTimeLineStepClickListener.onStepClick(clickStep);</span><br><span class="line">                }</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">      &#x5224;&#x65AD;&#x70B9;&#x51FB;&#x4F4D;&#x7F6E;&#x662F;&#x5426;&#x5728;&#x591A;&#x4E2A;&#x5706;&#x4E2D;&#x7684;&#x67D0;&#x4E00;&#x4E2A;&#x5185;</span><br><span class="line">     * <span class="doctag">@param</span> x &#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#x7684;x&#x8F74;</span><br><span class="line">     * <span class="doctag">@param</span> y &#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#x7684;y&#x8F74;</span><br><span class="line">     * <span class="doctag">@return</span> boolean&#x662F;&#x5426;&#x5728;&#x67D0;&#x5706;&#x5185;:&#x662F; true,&#x5426; false</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">isInTheCircles</span><span class="params">(<span class="keyword">float</span> x,<span class="keyword">float</span> y)</span></span>{</span><br><span class="line">        <span class="keyword">int</span> clickStep=-<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;circleCenterList.size();i++){</span><br><span class="line">            CircleCenter circleCenter=circleCenterList.get(i);</span><br><span class="line">            <span class="comment">//&#x70B9;&#x51FB;&#x4F4D;&#x7F6E;x&#x5750;&#x6807;&#x4E0E;&#x5706;&#x5FC3;&#x7684;x&#x5750;&#x6807;&#x7684;&#x8DDD;&#x79BB;</span></span><br><span class="line">            <span class="keyword">float</span> distanceX = Math.abs(circleCenter.getX()-x);</span><br><span class="line">            <span class="comment">//&#x70B9;&#x51FB;&#x4F4D;&#x7F6E;y&#x5750;&#x6807;&#x4E0E;&#x5706;&#x5FC3;&#x7684;y&#x5750;&#x6807;&#x7684;&#x8DDD;&#x79BB;</span></span><br><span class="line">            <span class="keyword">float</span> distanceY = Math.abs(circleCenter.getY()-y);</span><br><span class="line">            <span class="comment">//&#x70B9;&#x51FB;&#x4F4D;&#x7F6E;&#x4E0E;&#x5706;&#x5FC3;&#x7684;&#x76F4;&#x7EBF;&#x8DDD;&#x79BB;</span></span><br><span class="line">            <span class="keyword">int</span> distanceZ = (<span class="keyword">int</span>) Math.sqrt(Math.pow(distanceX,<span class="number">2</span>)+Math.pow(distanceY,<span class="number">2</span>));</span><br><span class="line">            <span class="comment">//&#x5982;&#x679C;&#x70B9;&#x51FB;&#x4F4D;&#x7F6E;&#x4E0E;&#x5706;&#x5FC3;&#x7684;&#x8DDD;&#x79BB;&#x5C0F;&#x4E8E;&#x7B49;&#x4E8E;&#x5706;&#x7684;&#x534A;&#x5F84;&#xFF0C;&#x8BC1;&#x660E;&#x70B9;&#x51FB;&#x4F4D;&#x7F6E;&#x6709;&#x5728;&#x5706;&#x5185;</span></span><br><span class="line">            <span class="keyword">if</span>(distanceZ &lt;= mRadius){</span><br><span class="line">                 clickStep=i;</span><br><span class="line">                 <span class="keyword">break</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> clickStep;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span><br><span class="line">    &#x8BBE;&#x7F6E;&#x63A5;&#x53E3;&#x7684;&#x65B9;&#x6CD5; &#x5BF9;&#x5916;&#x63D0;&#x4F9B;&#x8C03;&#x7528;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnTimeLineStepChangeListener</span><span class="params">(OnTimeLineStepClickListener onTimeLineStepClickListener)</span></span>{</span><br><span class="line">        <span class="keyword">this</span>.onTimeLineStepClickListener=onTimeLineStepClickListener;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#x7684;&#x63A5;&#x53E3;&#x5B9A;&#x4E49;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnTimeLineStepClickListener</span> </span>{</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">onStepClick</span><span class="params">(<span class="keyword">float</span> step)</span></span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x5706;&#x5FC3;&#x7684;&#x5185;&#x90E8;&#x5B9E;&#x4F53;&#x7C7B;</span><br><span class="line">     * &#x4E3B;&#x8981;&#x4E3A;&#x662F;&#x5224;&#x65AD;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#x662F;&#x5426;&#x5728;&#x5706;&#x4E0A;&#x63D0;&#x4F9B;&#x7684;Bean</span><br><span class="line">     */</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">CircleCenter</span></span>{</span><br><span class="line">        <span class="keyword">float</span> x;</span><br><span class="line">        <span class="keyword">float</span> y;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="title">CircleCenter</span><span class="params">(<span class="keyword">float</span> x,<span class="keyword">float</span> y)</span></span>{</span><br><span class="line">            <span class="keyword">this</span>.x=x;</span><br><span class="line">            <span class="keyword">this</span>.y=y;</span><br><span class="line">        }</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">float</span> <span class="title">getX</span><span class="params">()</span> </span>{</span><br><span class="line">            <span class="keyword">return</span> x;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setX</span><span class="params">(<span class="keyword">float</span> x)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.x = x;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">float</span> <span class="title">getY</span><span class="params">()</span> </span>{</span><br><span class="line">            <span class="keyword">return</span> y;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setY</span><span class="params">(<span class="keyword">float</span> y)</span> </span>{</span><br><span class="line">            <span class="keyword">this</span>.y = y;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x7B2C;&#x4E09;&#x6B65;&#xFF1A;&#x5E03;&#x5C40;&#x6587;&#x4EF6; &#x6CA1;&#x5565;&#x53EF;&#x8BF4;&#x7684;</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">LinearLayout</span></span><br><span class="line">    <span class="attribute">xmlns:android</span>=<span class="value">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line">    <span class="attribute">xmlns:app</span>=<span class="value">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">    <span class="attribute">android:orientation</span>=<span class="value">&quot;vertical&quot;</span></span><br><span class="line">    &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">com.jasoncool.study.view.TimeLineView</span></span><br><span class="line">        <span class="attribute">android:id</span>=<span class="value">&quot;@+id/timeline1&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">&quot;wrap_content&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_margin</span>=<span class="value">&quot;20dp&quot;</span></span><br><span class="line">        <span class="attribute">app:textSize</span>=<span class="value">&quot;20sp&quot;</span></span><br><span class="line">        <span class="attribute">app:tlradius</span>=<span class="value">&quot;7dp&quot;</span></span><br><span class="line">        <span class="attribute">app:CompleteColor</span>=<span class="value">&quot;@color/colorAccent&quot;</span></span><br><span class="line">        <span class="attribute">app:NoCompleteColor</span>=<span class="value">&quot;@color/colorPrimaryDark&quot;</span></span><br><span class="line">        /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">com.jasoncool.study.view.TimeLineView</span></span><br><span class="line">        <span class="attribute">android:id</span>=<span class="value">&quot;@+id/timeline2&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">&quot;50dp&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_margin</span>=<span class="value">&quot;20dp&quot;</span></span><br><span class="line">        <span class="attribute">app:textSize</span>=<span class="value">&quot;12sp&quot;</span></span><br><span class="line">        <span class="attribute">app:tlradius</span>=<span class="value">&quot;5dp&quot;</span></span><br><span class="line">        /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>&#x7B2C;&#x56DB;&#x6B65;&#xFF1A;&#x5982;&#x4F55;&#x4F7F;&#x7528; &#x4E5F;&#x6CA1;&#x5565;&#x597D;&#x8BF4;&#x7684; &#x7EC4;&#x4EF6;&#x5F15;&#x5165;&#x4E86;ButterKnife&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x6CA1;&#x7528;&#xFF0C;&#x81EA;&#x5DF1;&#x4FEE;&#x6539;&#x4E00;&#x4E0B;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TimeLineViewActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@BindView</span>(R.id.timeline1)</span><br><span class="line">    TimeLineView timeline1;</span><br><span class="line">    <span class="annotation">@BindView</span>(R.id.timeline2)</span><br><span class="line">    TimeLineView timeline2;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">goTimeLineViewActivity</span><span class="params">(Context context)</span> </span>{</span><br><span class="line">        Intent intent = <span class="keyword">new</span> Intent(context, TimeLineViewActivity.class);</span><br><span class="line">        context.startActivity(intent);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(@Nullable Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_time_line_layout);</span><br><span class="line">        ButterKnife.bind(<span class="keyword">this</span>);</span><br><span class="line">        String[] steps = <span class="keyword">new</span> String[]{<span class="string">&quot;&#x53D1;&#x8D77;&#x552E;&#x540E;&quot;</span>,<span class="string">&quot;&#x5546;&#x5BB6;&#x6536;&#x8D27;&quot;</span>,<span class="string">&quot;&#x5546;&#x5BB6;&#x7EF4;&#x4FEE;&quot;</span>,<span class="string">&quot;&#x53D1;&#x56DE;&#x5BA2;&#x6237;&quot;</span>};</span><br><span class="line">        timeline1.setPointStrings(steps, <span class="number">1.535f</span>);</span><br><span class="line">        timeline1.setOnTimeLineStepChangeListener(<span class="keyword">new</span> TimeLineView.OnTimeLineStepClickListener() {</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStepClick</span><span class="params">(<span class="keyword">float</span> step)</span> </span>{</span><br><span class="line">                Toast.makeText(TimeLineViewActivity.<span class="keyword">this</span>, <span class="string">&quot;&#x70B9;&#x51FB;&#x7684;&#x662F;&#x7B2C;&quot;</span> + (<span class="keyword">int</span>) (step + <span class="number">1</span>) + <span class="string">&quot;&#x6B65;&quot;</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                timeline1.setStep(step);</span><br><span class="line">            }</span><br><span class="line">        });</span><br><span class="line">        String[] steps2 = <span class="keyword">new</span> String[]{<span class="string">&quot;&#x7B2C;&#x4E00;&#x6B65;&#x54DF;&#x7B2C;&#x4E00;&#x6B65;&quot;</span>,<span class="string">&quot;&#x7B2C;&#x4E8C;&#x6B65;&quot;</span>,<span class="string">&quot;&#x7B2C;&#x4E09;&#x90E8;&#x54DF;&#x7B2C;&#x4E09;&#x6B65;&quot;</span>,<span class="string">&quot;&#x7B2C;&#x56DB;&#x6B65;&quot;</span>};</span><br><span class="line">        timeline2.setPointStrings(steps2,<span class="number">1.423f</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="&#x7ED3;&#x8BED;">&#x7ED3;&#x8BED;</h2><p>&#x4EE3;&#x7801;&#x4E0D;&#x96BE;&#xFF0C;&#x6211;&#x7528;&#x4E86;&#x4E00;&#x4E0A;&#x5348;&#x65F6;&#x95F4;&#x6765;&#x5199;&#x51FA;&#x4E86;&#x4E00;&#x4E2A;&#x6700;&#x7B80;&#x964B;&#x7684;DEMO,&#x4ED6;&#x53EF;&#x4EE5;&#x5B8C;&#x6210;&#x57FA;&#x672C;&#x9700;&#x6C42;&#x5373;&#x53EF;&#xFF0C;&#x7136;&#x540E;&#x53C8;&#x7528;&#x4E86;&#x4E00;&#x4E0B;&#x5348;&#x7684;&#x65F6;&#x95F4;&#x6765;&#x4F18;&#x5316;&#x8FD9;&#x4E9B;&#x4EE3;&#x7801;&#xFF0C;&#x5B8C;&#x5584;&#x4E00;&#x4E9B;&#x601D;&#x8DEF;&#x548C;&#x6D4B;&#x8BD5;&#x4E00;&#x4E9B;&#x6781;&#x7AEF;&#x60C5;&#x51B5;&#xFF0C;&#x8FD9;&#x671F;&#x95F4;&#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x6742;&#x4E8B;&#x53BB;&#x5904;&#x7406;&#x3002;</p>
<p>&#x4E4B;&#x6240;&#x4EE5;&#x5199;&#x8FD9;&#x4E2A;&#x5176;&#x5B9E;&#x662F;&#x60F3;&#x544A;&#x8BC9;&#x5927;&#x5BB6;&#xFF0C;&#x4E0D;&#x8981;&#x4E00;&#x53E3;&#x5403;&#x4E2A;&#x80D6;&#x5B50;&#xFF0C;&#x81EA;&#x5B9A;&#x4E49;View&#x4E00;&#x5B9A;&#x8981;&#x5148;&#x6839;&#x636E;&#x601D;&#x8DEF;&#x5199;&#x51FA;&#x57FA;&#x672C;&#x4EE3;&#x7801;&#x6765;&#xFF0C;&#x7136;&#x540E;&#x4E00;&#x6B65;&#x6B65;&#x7684;&#x4F18;&#x5316;&#xFF0C;&#x5F53;&#x7136;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x5F88;&#x719F;&#x6089;&#x4E86;&#x53E6;&#x5F53;&#x522B;&#x8BBA;&#xFF0C;&#x8FD9;&#x4E5F;&#x53EA;&#x662F;&#x6211;&#x7684;&#x5F00;&#x53D1;&#x98CE;&#x683C;&#x800C;&#x5DF2;&#x3002;</p>
<p>&#x8C22;&#x8C22;&#x4F60;&#x770B;&#x5B8C;&#xFF01;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Android 内存优化不完全手册]]></title>
      <url>http://jasoncool.com/2018/08/29/Android-%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96%E4%B8%8D%E5%AE%8C%E5%85%A8%E6%89%8B%E5%86%8C/</url>
      <content type="html"><![CDATA[<h2 id="&#x4EC0;&#x4E48;&#x662F;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;">&#x4EC0;&#x4E48;&#x662F;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;</h2><p>&#x53EA;&#x8981;&#x662F;&#x73B0;&#x4EE3;&#x667A;&#x80FD;&#x7535;&#x5B50;&#x8BBE;&#x5907;&#xFF0C;&#x4E0D;&#x7BA1;&#x6216;&#x5927;&#x6216;&#x5C0F;&#xFF0C;&#x90FD;&#x4F1A;&#x6709;&#x4E00;&#x4E2A;&#x53EB;&#x505A;&#x5185;&#x5B58;&#x7684;&#x786C;&#x4EF6;&#xFF0C;&#x5728;&#x624B;&#x673A;&#x4E2D;&#x8FD9;&#x4E2A;&#x786C;&#x4EF6;&#x7684;&#x53C2;&#x6570;&#x5C24;&#x4E3A;&#x91CD;&#x8981;&#xFF0C;&#x662F;&#x6211;&#x4EEC;&#x8BC4;&#x4EF7;&#x4E00;&#x4E2A;&#x624B;&#x673A;&#x597D;&#x574F;&#x7684;&#x6807;&#x51C6;&#x4E4B;&#x4E00;&#x3002;</p>
<p>&#x4EE5;Android&#x624B;&#x673A;&#x4E3A;&#x4F8B;&#xFF0C;&#x6211;&#x4EEC;&#x5F00;&#x53D1;&#x7684;&#x7A0B;&#x5E8F;&#x5982;&#x679C;&#x60F3;&#x8981;&#x8FD0;&#x884C;&#x8D77;&#x6765;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x5F00;&#x542F;&#x4E00;&#x4E2A;&#x72EC;&#x7ACB;&#x7684;&#x8FDB;&#x7A0B;&#xFF0C;&#x800C;&#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;&#x5982;&#x679C;&#x60F3;&#x8981;&#x8FD0;&#x884C;&#x8D77;&#x6765;&#xFF0C;&#x5C31;&#x5FC5;&#x987B;&#x5360;&#x7528;&#x4E00;&#x90E8;&#x5206;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x7684;&#x5E94;&#x7528;&#x548C;&#x624B;&#x673A;&#x5185;&#x5B58;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x4E86;&#x3002;<br>&#x8BF4;&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x804A;&#x804A;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x4E86;&#xFF08;&#x4EE5;&#x4E0B;&#x5185;&#x5BB9;&#x6765;&#x81EA;&#x767E;&#x5EA6;&#x767E;&#x79D1;&#xFF09;&#x3002;</p>
<blockquote>
<p>&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#xFF08;Memory Leak&#xFF09;&#x662F;&#x6307;&#x7A0B;&#x5E8F;&#x4E2D;&#x5DF1;&#x52A8;&#x6001;&#x5206;&#x914D;&#x7684;&#x5806;&#x5185;&#x5B58;&#x7531;&#x4E8E;&#x67D0;&#x79CD;&#x539F;&#x56E0;&#x7A0B;&#x5E8F;&#x672A;&#x91CA;&#x653E;&#x6216;&#x65E0;&#x6CD5;&#x91CA;&#x653E;&#xFF0C;&#x9020;&#x6210;&#x7CFB;&#x7EDF;&#x5185;&#x5B58;&#x7684;&#x6D6A;&#x8D39;&#xFF0C;&#x5BFC;&#x81F4;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x901F;&#x5EA6;&#x51CF;&#x6162;&#x751A;&#x81F3;&#x7CFB;&#x7EDF;&#x5D29;&#x6E83;&#x7B49;&#x4E25;&#x91CD;&#x540E;&#x679C;&#x3002;</p>
<p>&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x7F3A;&#x9677;&#x5177;&#x6709;&#x9690;&#x853D;&#x6027;&#x3001;&#x79EF;&#x7D2F;&#x6027;&#x7684;&#x7279;&#x5F81;&#xFF0C;&#x6BD4;&#x5176;&#x4ED6;&#x5185;&#x5B58;&#x975E;&#x6CD5;&#x8BBF;&#x95EE;&#x9519;&#x8BEF;&#x66F4;&#x96BE;&#x68C0;&#x6D4B;&#x3002;&#x56E0;&#x4E3A;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x7684;&#x4EA7;&#x751F;&#x539F;&#x56E0;&#x662F;&#x5185;&#x5B58;&#x5757;&#x672A;&#x88AB;&#x91CA;&#x653E;&#xFF0C;&#x5C5E;&#x4E8E;&#x9057;&#x6F0F;&#x578B;&#x7F3A;&#x9677;&#x800C;&#x4E0D;&#x662F;&#x8FC7;&#x9519;&#x578B;&#x7F3A;&#x9677;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x901A;&#x5E38;&#x4E0D;&#x4F1A;&#x76F4;&#x63A5;&#x4EA7;&#x751F;&#x53EF;&#x89C2;&#x5BDF;&#x7684;&#x9519;&#x8BEF;&#x75C7;&#x72B6;&#xFF0C;&#x800C;&#x662F;&#x9010;&#x6E10;&#x79EF;&#x7D2F;&#xFF0C;&#x964D;&#x4F4E;&#x7CFB;&#x7EDF;&#x6574;&#x4F53;&#x6027;&#x80FD;&#xFF0C;&#x6781;&#x7AEF;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x53EF;&#x80FD;&#x4F7F;&#x7CFB;&#x7EDF;&#x5D29;&#x6E83;&#x3002;</p>
</blockquote>
<p>&#x767E;&#x5EA6;&#x767E;&#x79D1;&#x7684;&#x89E3;&#x91CA;&#x5DF2;&#x7ECF;&#x5F88;&#x660E;&#x767D;&#x4E86;&#xFF0C;&#x5177;&#x4F53;&#x5230;&#x7A0B;&#x5E8F;&#x65B9;&#x9762;&#x6765;&#x8BF4;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x5C31;&#x662F;&#x8BE5;&#x56DE;&#x6536;&#x7684;&#x5BF9;&#x8C61;&#x7531;&#x4E8E;&#x4E00;&#x4E9B;&#x539F;&#x56E0;&#x65E0;&#x6CD5;&#x6B63;&#x5E38;&#x56DE;&#x6536;&#xFF0C;&#x8FD9;&#x6837;&#x7684;&#x5BF9;&#x8C61;&#x8D8A;&#x6765;&#x8D8A;&#x591A;&#x5BFC;&#x81F4;&#x624B;&#x673A;&#x7684;&#x5185;&#x5B58;&#x5360;&#x7528;&#x7387;&#x5C45;&#x9AD8;&#x4E0D;&#x4E0B;&#xFF0C;&#x53EF;&#x7528;&#x7684;&#x7A7A;&#x95F2;&#x5185;&#x5B58;&#x8D8A;&#x6765;&#x8D8A;&#x5C11;&#xFF0C;&#x4ECE;&#x800C;&#x9891;&#x7E41;&#x7684;&#x89E6;&#x53D1;&#x5783;&#x573E;&#x56DE;&#x6536;&#x673A;&#x5236;&#xFF0C;&#x4EE5;&#x81F3;&#x4E8E;&#x964D;&#x4F4E;&#x4E86;&#x5E94;&#x7528;&#x7684;&#x6D41;&#x7545;&#x5EA6;&#xFF0C;&#x4E25;&#x91CD;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x5BFC;&#x81F4;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#xFF08;OOM Out Of Memory&#xFF09;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5BFC;&#x81F4;&#x7A0B;&#x5E8F;&#x5D29;&#x6E83;&#x3002;</p>
<p>&#x81F3;&#x4E8E;&#x4EC0;&#x4E48;&#x662F;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#xFF0C;&#x8BF7;&#x81EA;&#x884C;&#x641C;&#x7D22;&#x5B66;&#x4E60;&#xFF0C;&#x8BE5;&#x77E5;&#x8BC6;&#x70B9;&#x4E0D;&#x5728;&#x672C;&#x7BC7;&#x6559;&#x7A0B;&#x5185;&#x3002;</p>
<a id="more"></a>
<h2 id="Java&#x7684;&#x56DB;&#x79CD;&#x5F15;&#x7528;">Java&#x7684;&#x56DB;&#x79CD;&#x5F15;&#x7528;</h2><p>&#x804A;&#x5230;Java&#x7684;&#x56DB;&#x79CD;&#x5F15;&#x7528;&#xFF0C;&#x5176;&#x5B9E;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x77E5;&#x8BC6;&#x70B9;&#x7684;&#x52A0;&#x56FA;&#xFF0C;&#x56E0;&#x4E3A;&#x4E00;&#x4E9B;&#x8003;&#x8651;&#x5230;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x4E2D;&#xFF0C;&#x9700;&#x8981;&#x7528;&#x5230;&#x8FD9;&#x91CC;&#x7684;&#x77E5;&#x8BC6;&#x70B9;&#xFF0C;&#x6240;&#x4EE5;&#x5148;&#x8BB2;&#x89E3;&#x7ED9;&#x5927;&#x5BB6;&#xFF1A;</p>
<ul>
<li>&#x5F3A;&#x5F15;&#x7528;&#xFF1A;&#x5F3A;&#x5F15;&#x7528;&#x662F;Java&#x4E2D;&#x6700;&#x666E;&#x901A;&#x7684;&#x5F15;&#x7528;&#xFF0C;&#x968F;&#x610F;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7136;&#x540E;&#x5728;&#x5176;&#x4ED6;&#x7684;&#x5730;&#x65B9;&#x5F15;&#x7528;&#x4E00;&#x4E0B;&#xFF0C;&#x5C31;&#x662F;&#x5F3A;&#x5F15;&#x7528;&#xFF0C;<strong>&#x5F3A;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;Java&#x5B81;&#x613F;OOM&#x4E5F;&#x4E0D;&#x4F1A;&#x56DE;&#x6536;&#x4ED6;</strong></li>
<li><strong>&#x8F6F;&#x5F15;&#x7528;</strong>: &#x8F6F;&#x5F15;&#x7528;&#x662F;&#x6BD4;&#x5F3A;&#x5F15;&#x7528;&#x5F31;&#x7684;&#x5F15;&#x7528;&#xFF0C;&#x5728;Java gc&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5982;&#x679C;&#x8F6F;&#x5F15;&#x7528;&#x6240;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#x88AB;&#x56DE;&#x6536;&#xFF0C;&#x9996;&#x6B21;gc&#x5931;&#x8D25;&#x7684;&#x8BDD;&#x4F1A;&#x7EE7;&#x800C;&#x56DE;&#x6536;&#x8F6F;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;<strong>&#x8F6F;&#x5F15;&#x7528;&#x9002;&#x5408;&#x505A;&#x7F13;&#x5B58;&#x5904;&#x7406;</strong> &#x53EF;&#x4EE5;&#x548C;&#x5F15;&#x7528;&#x961F;&#x5217;&#xFF08;ReferenceQueue&#xFF09;&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#xFF0C;&#x5F53;&#x5BF9;&#x8C61;&#x88AB;&#x56DE;&#x6536;&#x4E4B;&#x540E;&#x4FDD;&#x5B58;&#x4ED6;&#x7684;&#x8F6F;&#x5F15;&#x7528;&#x4F1A;&#x653E;&#x5165;&#x5F15;&#x7528;&#x961F;&#x5217;</li>
<li><strong>&#x5F31;&#x5F15;&#x7528;</strong>: &#x5F31;&#x5F15;&#x7528;&#x662F;&#x6BD4;&#x8F6F;&#x5F15;&#x7528;&#x66F4;&#x52A0;&#x5F31;&#x7684;&#x5F15;&#x7528;&#xFF0C;&#x5F53;Java&#x6267;&#x884C;gc&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5982;&#x679C;&#x5F31;&#x5F15;&#x7528;&#x6240;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#x88AB;&#x56DE;&#x6536;&#xFF0C;&#x65E0;&#x8BBA;&#x4ED6;&#x6709;&#x6CA1;&#x6709;&#x7528;&#x90FD;&#x4F1A;&#x56DE;&#x6536;&#x6389;&#x5F31;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x4E0D;&#x8FC7;gc&#x662F;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x4F4E;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;&#x4E0D;&#x4F1A;&#x90A3;&#x4E48;&#x53CA;&#x65F6;&#x7684;&#x56DE;&#x6536;&#x6389;&#x4F60;&#x7684;&#x5BF9;&#x8C61;&#x3002; <strong>&#x53EF;&#x4EE5;&#x548C;&#x5F15;&#x7528;&#x961F;&#x5217;&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#xFF0C;&#x5F53;&#x5BF9;&#x8C61;&#x88AB;&#x56DE;&#x6536;&#x4E4B;&#x540E;&#x4FDD;&#x5B58;&#x4ED6;&#x7684;&#x5F31;&#x5F15;&#x7528;&#x4F1A;&#x653E;&#x5165;&#x5F15;&#x7528;&#x961F;&#x5217;</strong></li>
<li><strong>&#x865A;&#x5F15;&#x7528;</strong>: &#x865A;&#x5F15;&#x7528;&#x548C;&#x6CA1;&#x6709;&#x5F15;&#x7528;&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x4ED6;&#x5FC5;&#x987B;&#x548C;&#x5F15;&#x7528;&#x961F;&#x5217;&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#xFF0C;&#x5F53;Java&#x56DE;&#x6536;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5982;&#x679C;&#x53D1;&#x73B0;&#x4ED6;&#x6709;&#x865A;&#x5F15;&#x7528;&#xFF0C;&#x4F1A;&#x5728;&#x56DE;&#x6536;&#x5BF9;&#x8C61;&#x4E4B;&#x524D;&#x5C06;&#x4ED6;&#x7684;&#x865A;&#x5F15;&#x7528;&#x52A0;&#x5165;&#x5230;&#x4E0E;&#x4E4B;&#x5173;&#x8054;&#x7684;&#x5F15;&#x7528;&#x961F;&#x5217;&#x4E2D;&#x3002;<strong>&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x7279;&#x6027;&#x5728;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x88AB;&#x56DE;&#x6536;&#x4E4B;&#x524D;&#x91C7;&#x53D6;&#x63AA;&#x65BD;</strong></li>
</ul>
<p>&#x5177;&#x4F53;&#x7528;&#x6CD5;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x67E5;&#x8BE2;&#x4E00;&#x4E0B;&#xFF0C;&#x5199;&#x51E0;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x5C55;&#x5F00;&#x8BB2;&#x4E86;&#x3002;</p>
<h2 id="&#x5E38;&#x89C1;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;">&#x5E38;&#x89C1;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;</h2><ul>
<li><p>&#x975E;&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;&#x548C;&#x533F;&#x540D;&#x5185;&#x90E8;&#x7C7B;&#x9020;&#x6210;&#x7684;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;</p>
<p>&#x8FD9;&#x91CC;&#x9996;&#x5148;&#x6211;&#x4EEC;&#x4E86;&#x89E3;&#x4E00;&#x4E0B;&#x5185;&#x90E8;&#x7C7B;&#x548C;&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;&#x7684;&#x533A;&#x522B;&#xFF1A;</p>
<p>|        &#x4E24;&#x79CD;&#x7C7B;&#x5BF9;&#x6BD4;&#x9879;        |          &#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;          |     &#x975E;&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;     |<br>| :&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;: | :&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2013;: | :&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;: |<br>|     &#x4E0E;&#x5916;&#x90E8;&#x7C7B;&#x7684;&#x5F15;&#x7528;&#x5173;&#x7CFB;     | &#x5982;&#x679C;&#x6CA1;&#x6709;&#x4F20;&#x5165;&#x53C2;&#x6570;&#x5219;&#x65E0;&#x5F15;&#x7528;&#x5173;&#x7CFB; |  &#x81EA;&#x52A8;&#x83B7;&#x5F97;&#x5F3A;&#x5F15;&#x7528;&#x5173;&#x7CFB;  |<br>|    &#x88AB;&#x8C03;&#x7528;&#x65F6;&#x9700;&#x8981;&#x5916;&#x90E8;&#x5B9E;&#x4F8B;    |            &#x4E0D;&#x9700;&#x8981;            |         &#x9700;&#x8981;         |<br>| &#x80FD;&#x5426;&#x4F7F;&#x7528;&#x5916;&#x90E8;&#x7C7B;&#x7684;&#x975E;&#x9759;&#x6001;&#x6210;&#x5458; |             &#x4E0D;&#x80FD;             |          &#x80FD;          |<br>|          &#x751F;&#x547D;&#x5468;&#x671F;          |        &#x81EA;&#x4E3B;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;        | &#x4F9D;&#x8D56;&#x5916;&#x90E8;&#x7C7B;&#xFF0C;&#x751A;&#x81F3;&#x66F4;&#x957F; |</p>
<p>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x8981;&#x8003;&#x8651;&#x4E00;&#x4E0B;&#xFF0C;&#x5728;Android&#x91CC;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x4F1A;&#x7528;&#x5230;&#x5185;&#x90E8;&#x7C7B;&#x5462;&#xFF1F;</p>
<p>&#x6700;&#x5E38;&#x89C1;&#x7684;&#x5C31;&#x662F;Handler&#x3001;AysncTask&#x548C;Thread&#x8FD9;&#x4E09;&#x4E2A;&#x7C7B;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x5C31;&#x4F1A;&#x9020;&#x6210;&#x4E00;&#x4E2A;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x7684;&#x9690;&#x60A3;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x6B63;&#x5728;&#x901A;&#x8FC7;Handler&#x8BF7;&#x6C42;&#x7F51;&#x7EDC;&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x65F6;&#x6211;&#x4EEC;&#x7A81;&#x7136;&#x5173;&#x95ED;&#x4E86;Activity,&#x4F46;&#x662F;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x5E76;&#x6CA1;&#x6709;&#x7ED3;&#x675F;&#xFF0C;&#x6B64;&#x65F6;&#x4F5C;&#x4E3A;&#x5185;&#x90E8;&#x7C7B;&#x7684;Handler&#x8FD8;&#x6301;&#x6709;&#x5916;&#x90E8;Activity&#x7684;&#x5F3A;&#x5F15;&#x7528;&#x5173;&#x7CFB;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x8BE5;Activity&#x7684;&#x5185;&#x5B58;&#x5E76;&#x6CA1;&#x6709;&#x88AB;&#x6B63;&#x5E38;&#x56DE;&#x6536;&#xFF0C;&#x8FD9;&#x5C31;&#x53D1;&#x751F;&#x4E86;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#xFF0C;&#x800C;&#x4E14;&#x8FD8;&#x6709;&#x53EF;&#x80FD;&#x9020;&#x6210;&#x4E00;&#x4E9B;&#x4E0D;&#x53EF;&#x9884;&#x6D4B;&#x7684;&#x7A7A;&#x6307;&#x9488;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x5C06;&#x4E09;&#x4E2A;&#x7C7B;&#x7684;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x53CA;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x90FD;&#x5217;&#x51FA;&#x6765;&#xFF0C;&#x4EE5;&#x540E;&#x9047;&#x5230;&#x7C7B;&#x4F3C;&#x7684;&#x95EE;&#x9898;&#x5C31;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x4E86;&#xFF1A;</p>
<ol>
<li><p>AsyncTask</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsyncTaskOOMActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>{</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(@Nullable Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        <span class="keyword">new</span> MyAsyncTask().execute();</span><br><span class="line">    }</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MyAsyncTask</span> <span class="keyword">extends</span> <span class="title">AsyncTask</span>&lt;<span class="title">Void</span>,<span class="title">Integer</span>,<span class="title">String</span>&gt;</span>{</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> String <span class="title">doInBackground</span><span class="params">(Void... voids)</span> </span>{</span><br><span class="line">            <span class="keyword">try</span> {</span><br><span class="line">                Thread.sleep(<span class="number">5000</span>);</span><br><span class="line">            } <span class="keyword">catch</span> (InterruptedException e) {</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x79CD;&#x5199;&#x6CD5;&#x7684;AsyncTask&#x5728;AndroidStudio&#x4E2D;&#x4F1A;&#x6709;&#x8B66;&#x544A;&#x63D0;&#x793A;&#xFF0C;&#x63D0;&#x793A;&#x7684;&#x5185;&#x5BB9;&#x662F;&#xFF1A;</p>
<blockquote>
<p>This AsyncTask class should be static or leaks might occur (com.jasoncool.study.oom.asynctask.AsyncTaskOOMActivity.MyAsyncTask) less&#x2026; (Ctrl+F1)<br>A static field will leak contexts.  Non-static inner classes have an implicit reference to their outer class. If that outer class is for example a Fragment or Activity, then this reference means that the long-running handler/loader/task will hold a reference to the activity which prevents it from getting garbage collected.  Similarly, direct field references to activities and fragments from these longer running instances can cause leaks.  ViewModel classes should never point to Views or non-application Contexts.</p>
</blockquote>
<p>&#x8BF4;&#x767D;&#x4E86;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x544A;&#x8BC9;&#x4F60;&#xFF0C;&#x975E;&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;&#x8FD9;&#x4E48;&#x7528;&#x5C31;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x4E86;&#xFF0C;&#x8BA9;&#x4F60;&#x6539;&#x6B63;&#x8FC7;&#x6765;&#xFF0C;&#x6211;&#x4EEC;&#x770B;&#x4E00;&#x4E0B;&#x6539;&#x540E;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsyncTaskOOMActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>{</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(@Nullable Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        <span class="keyword">new</span> MyAsyncTask().execute();</span><br><span class="line">    }</span><br><span class="line">   <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAsyncTask</span> <span class="keyword">extends</span> <span class="title">AsyncTask</span>&lt;<span class="title">Void</span>,<span class="title">Integer</span>,<span class="title">String</span>&gt;</span>{</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> String <span class="title">doInBackground</span><span class="params">(Void... voids)</span> </span>{</span><br><span class="line">            <span class="keyword">try</span> {</span><br><span class="line">                Thread.sleep(<span class="number">5000</span>);</span><br><span class="line">            } <span class="keyword">catch</span> (InterruptedException e) {</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x5C31;&#x662F;&#x8FD9;&#x4E48;&#x7B80;&#x5355;&#xFF0C;&#x52A0;&#x4E00;&#x4E2A;static&#x5173;&#x952E;&#x5B57;&#x5C31;&#x836F;&#x5230;&#x75C5;&#x9664;&#x4E86;&#x3002;</p>
<ol>
<li>Handler</li>
</ol>
<p>Handler&#x662F;&#x6211;&#x4EEC;&#x5728;&#x5F00;&#x53D1;&#x8FC7;&#x7A0B;&#x4E2D;&#x6BD4;&#x8F83;&#x5E38;&#x89C1;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#x4E86;&#xFF0C;&#x51E0;&#x4E4E;&#x662F;&#x6BCF;&#x4E2A;Android&#x7A0B;&#x5E8F;&#x5458;&#x5165;&#x95E8;&#x5FC5;&#x987B;&#x638C;&#x63E1;&#x7684;&#x77E5;&#x8BC6;&#x70B9;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x7C7B;&#x4E5F;&#x662F;&#x7ECF;&#x5E38;&#x51FA;&#x73B0;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x7684;&#x5143;&#x51F6;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x4E0D;&#x597D;&#xFF0C;&#x4F1A;&#x5E26;&#x6765;&#x5F88;&#x591A;&#x610F;&#x60F3;&#x4E0D;&#x5230;&#x7684;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#xFF0C;&#x4E0B;&#x9762;&#x8BF7;&#x770B;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HandlerOOMActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TextView mTextView;</span><br><span class="line">    <span class="keyword">private</span> Handler mHandler = <span class="keyword">new</span> Handler(){</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>{</span><br><span class="line">            mTextView.setText(<span class="string">&quot;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x4E86;&quot;</span>);</span><br><span class="line">        }</span><br><span class="line">    };</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        mTextView = (TextView) findViewById(R.id.text);<span class="comment">//&#x6A21;&#x62DF;&#x5185;&#x5B58;&#x6CC4;&#x9732;</span></span><br><span class="line">        loadData();</span><br><span class="line">        <span class="keyword">this</span>.finish();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">loadData</span><span class="params">()</span></span>{</span><br><span class="line">        mHandler.postDelayed(<span class="keyword">new</span> Runnable() {</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</span><br><span class="line">                <span class="comment">//&#x4EC0;&#x4E48;&#x90FD;&#x4E0D;&#x5E72; &#x5C31;&#x5EF6;&#x8FDF;180&#x79D2;</span></span><br><span class="line">            }</span><br><span class="line">        }, <span class="number">3</span> * <span class="number">60</span> * <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onDestroy();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x5176;&#x5B9E;&#x548C;&#x4E0A;&#x4E00;&#x4E2A;AsyncTask&#x975E;&#x5E38;&#x7C7B;&#x4F3C;&#xFF0C;&#x53EA;&#x4E0D;&#x8FC7;&#x8FD9;&#x91CC;&#x591A;&#x4E86;&#x4E00;&#x4E2A;&#x6982;&#x5FF5;&#x5C31;&#x662F;&#x5728;&#x5185;&#x90E8;&#x7C7B;&#x4E2D;&#x6211;&#x4EEC;&#x5F15;&#x7528;&#x4E86;&#x5916;&#x90E8;&#x7C7B;&#x7684;TextView,&#x5982;&#x679C;&#x7B80;&#x5355;&#x7684;&#x5C06;Handler&#x6539;&#x6210;&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;&#x7684;&#x8BDD;&#xFF0C;&#x6211;&#x4EEC;&#x8FD8;&#x8BB0;&#x5F97; &#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;&#x6709;&#x4E00;&#x4E2A;&#x7279;&#x70B9;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x65E0;&#x6CD5;&#x4F3C;&#x4E4E;&#x7528;&#x5916;&#x90E8;&#x7C7B;&#x7684;&#x975E;&#x9759;&#x6001;&#x8D44;&#x6E90;&#xFF0C;&#x90A3;&#x8FD9;&#x4E2A;TextView&#x5C31;&#x65E0;&#x6CD5;&#x5728;Handler&#x4E2D;&#x8FDB;&#x884C;&#x4F7F;&#x7528;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;&#x5982;&#x4F55;&#x89E3;&#x51B3;&#x5462;&#xFF1F;&#x5176;&#x5B9E;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4F20;&#x5165;&#x5916;&#x90E8;Activity&#x7684;Context&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x89E3;&#x51B3;&#x8BE5;&#x95EE;&#x9898;&#xFF0C;&#x4E3A;&#x4E86;&#x4FDD;&#x9669;&#x8D77;&#x89C1;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x5C06;&#x8BE5;Context&#x8BBE;&#x7F6E;&#x6210;&#x5F31;&#x5F15;&#x7528;&#x7684;&#x65B9;&#x5F0F;&#x4F7F;&#x7528;&#xFF0C;&#x5E76;&#x4E14;&#x6211;&#x4EEC;&#x518D;onDestroy&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;  mHandler.removeCallbacksAndMessages(null);&#x65B9;&#x6CD5;&#x6765;&#x4E2D;&#x7AEF;handler&#x7684;&#x8BF7;&#x6C42;&#x548C;&#x56DE;&#x8C03;&#xFF0C;&#x5E76;&#x5C06;handler&#x7F6E;&#x7A7A;&#xFF0C;&#x5177;&#x4F53;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HandlerOOMActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TextView mTextView;</span><br><span class="line">    <span class="keyword">private</span> SoftHandler mHandler = <span class="keyword">new</span> SoftHandler(<span class="keyword">this</span>);</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        mTextView = (TextView) findViewById(R.id.text);<span class="comment">//&#x6A21;&#x62DF;&#x5185;&#x5B58;&#x6CC4;&#x9732;</span></span><br><span class="line">        loadData();</span><br><span class="line">        <span class="keyword">this</span>.finish();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SoftHandler</span> <span class="keyword">extends</span> <span class="title">Handler</span></span>{</span><br><span class="line">        WeakReference&lt;Activity&gt; weakContext;</span><br><span class="line">         <span class="function"><span class="keyword">public</span> <span class="title">SoftHandler</span><span class="params">(Activity context)</span> </span>{</span><br><span class="line">            weakContext = <span class="keyword">new</span> WeakReference&lt;&gt;(context);</span><br><span class="line">        }</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>{</span><br><span class="line">            HandlerOOMActivity weakActivity= (HandlerOOMActivity)weakContext.get();</span><br><span class="line">            weakActivity.mTextView.setText(<span class="string">&quot;&#x5185;&#x5B58;&#x4E0D;&#x6EA2;&#x51FA;&#x4E86;&quot;</span>);</span><br><span class="line">        }</span><br><span class="line">    };</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">loadData</span><span class="params">()</span></span>{</span><br><span class="line">        mHandler.postDelayed(<span class="keyword">new</span> Runnable() {</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</span><br><span class="line">                <span class="comment">//&#x4EC0;&#x4E48;&#x90FD;&#x4E0D;&#x5E72; &#x5C31;&#x5EF6;&#x8FDF;180&#x79D2;</span></span><br><span class="line">            }</span><br><span class="line">        }, <span class="number">3</span> * <span class="number">60</span> * <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onDestroy();</span><br><span class="line">        mHandler.removeCallbacksAndMessages(<span class="keyword">null</span>);</span><br><span class="line">        mHandler=<span class="keyword">null</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x867D;&#x7136;&#x5199;&#x6CD5;&#x590D;&#x6742;&#x4E86;&#x4E00;&#x4E9B;&#xFF0C;&#x4F46;&#x662F;&#x4E5F;&#x975E;&#x5E38;&#x597D;&#x7406;&#x89E3;&#xFF0C;&#x8FD9;&#x6837;&#x57FA;&#x672C;&#x4E0A;&#x5C31;&#x53EF;&#x4EE5;&#x907F;&#x514D;Handler&#x7684;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x4E86;&#x3002;</p>
<p>3.Thread</p>
<p>&#x6211;&#x4EEC;&#x5728;&#x5F00;&#x53D1;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x6709;&#x65F6;&#x5019;&#x4F1A;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x4E00;&#x4E9B;&#x8017;&#x65F6;&#x64CD;&#x4F5C;&#xFF0C;&#x4F46;&#x662F;&#x5199;&#x8017;&#x65F6;&#x64CD;&#x4F5C;&#x65F6;&#x6211;&#x4EEC;&#x5EFA;&#x7ACB;&#x7684;&#x7EBF;&#x7A0B;&#x4E00;&#x822C;&#x90FD;&#x662F;&#x533F;&#x540D;&#x5185;&#x90E8;&#x7C7B;&#x7684;&#x65B9;&#x5F0F;&#x521B;&#x5EFA;&#x7684;&#xFF0C;&#x533F;&#x540D;&#x5185;&#x90E8;&#x7C7B;&#x4E5F;&#x4F1A;&#x6301;&#x6709;&#x5916;&#x90E8;&#x7C7B;&#x7684;&#x5F3A;&#x5F15;&#x7528;&#xFF0C;&#x4E00;&#x6837;&#x4F1A;&#x9047;&#x5230;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x8BF7;&#x770B;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadOOMActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() {</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</span><br><span class="line">                <span class="keyword">try</span> {</span><br><span class="line">                    Thread.sleep(<span class="number">50000</span>);</span><br><span class="line">                } <span class="keyword">catch</span> (InterruptedException e) {</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }).start();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x4E2A;new Thread&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x533F;&#x540D;&#x5185;&#x90E8;&#x7C7B;&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x7EBF;&#x7A0B;&#x4F11;&#x7720;&#x7684;&#x8FD9;&#x6BB5;&#x65F6;&#x95F4;&#x5185;&#x6211;&#x5173;&#x95ED;&#x4E86;&#x8BE5;Activity&#x7684;&#x8BDD;&#xFF0C;&#x4E00;&#x6837;&#x4F1A;&#x9020;&#x6210;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5EFA;&#x8BAE;&#x7684;&#x5199;&#x6CD5;&#x5E94;&#x5F53;&#x662F;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadOOMActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>{</span><br><span class="line">    SoftThread softThread;</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">       softThread=<span class="keyword">new</span> SoftThread();</span><br><span class="line">       softThread.start();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SoftThread</span>  <span class="keyword">extends</span>  <span class="title">Thread</span></span>{</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</span><br><span class="line">            <span class="comment">//&#x81EA;&#x5DF1;&#x7684;&#x6269;&#x5C55;...</span></span><br><span class="line">            <span class="keyword">try</span> {</span><br><span class="line">                Thread.sleep(<span class="number">50000</span>);</span><br><span class="line">            } <span class="keyword">catch</span> (InterruptedException e) {</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x5F15;&#x8D77;&#x7684;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;</p>
<p>&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x662F;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x6700;&#x7ECF;&#x5E38;&#x63A5;&#x89E6;&#x7684;&#x4E00;&#x4E2A;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x4E86;&#xFF0C;&#x5176;&#x4E3B;&#x8981;&#x76EE;&#x7684;&#x662F;&#x4E3A;&#x4E86;&#x8BA9;&#x5E94;&#x7528;&#x4E2D;&#x53EA;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5728;&#x5E94;&#x7528;&#x4E2D;&#x4F7F;&#x7528;&#xFF0C;&#x56E0;&#x4E3A;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x4E5F;&#x8981;&#x8017;&#x8D39;&#x4E00;&#x5B9A;&#x7684;&#x8D44;&#x6E90;&#xFF0C;&#x9891;&#x7E41;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x80AF;&#x5B9A;&#x4E0D;&#x5982;&#x957F;&#x671F;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x8981;&#x5408;&#x7406;&#xFF0C;&#x6240;&#x4EE5;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;&#x5E94;&#x7528;&#x975E;&#x5E38;&#x5E7F;&#x6CDB;&#xFF0C;&#x4E00;&#x822C;&#x7684;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingleUtils</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> SingleUtils mInstance = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">private</span> Context context;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">SingleUtils</span> <span class="params">(Context context)</span></span>{</span><br><span class="line">        <span class="keyword">this</span>.context = context;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SingleUtils <span class="title">getInstance</span><span class="params">(Context context)</span></span>{</span><br><span class="line">        <span class="keyword">if</span>(mInstance == <span class="keyword">null</span>){</span><br><span class="line">            <span class="keyword">synchronized</span> (Singleton.class) {</span><br><span class="line">                <span class="keyword">if</span>(mInstance == <span class="keyword">null</span>)</span><br><span class="line">            mInstance = <span class="keyword">new</span> SingleUtils (context);</span><br><span class="line">            }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> mInstance;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getObject</span><span class="params">()</span></span>{<span class="comment">//&#x6839;&#x636E;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x4F20;&#x5165;&#x53C2;&#x6570;</span></span><br><span class="line">        <span class="comment">//&#x8FD4;&#x56DE;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x7ED3;&#x679C;&#xFF0C;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x7528;&#x5230;context</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x4E00;&#x822C;&#x53EA;&#x8981;&#x4E0D;&#x51FA;&#x73B0;&#x91CD;&#x5927;&#x7684;&#x7A0B;&#x5E8F;&#x95EE;&#x9898;&#xFF0C;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x90FD;&#x662F;&#x8DDF;&#x5E94;&#x7528;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x4E00;&#x81F4;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x628A;&#x4E00;&#x4E2A;Activity&#x7684;Context&#x4F20;&#x7ED9;&#x4E86;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;&#x903B;&#x8F91;&#x4E2D;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x5C31;&#x4F1A;&#x5F15;&#x7528;&#x4E86;&#x6211;&#x4EEC;&#x7684;Activity&#x7684;Context,&#x5728;&#x9ED8;&#x8BA4;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x5C31;&#x4F1A;&#x9020;&#x6210;&#x5373;&#x4FBF;&#x5173;&#x95ED;&#x4E86;&#x8BE5;Activity&#xFF0C;&#x4E5F;&#x65E0;&#x6CD5;&#x5728;&#x5185;&#x4ECE;&#x4E2D;&#x56DE;&#x6536;&#x8BE5;Activity&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x4E86;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x3002;</p>
<p>&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF1A;</p>
<p>&#x5C06;&#x8BE5;Activity&#x7684;Context&#x6362;&#x6210;&#x751F;&#x547D;&#x5468;&#x671F;&#x8F83;&#x957F;&#x7684;ApplicationContext&#xFF0C;ApplicationContext&#x662F;&#x8DDF;&#x7740;&#x5E94;&#x7528;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x800C;&#x5EFA;&#x7ACB;&#x548C;&#x9500;&#x6BC1;&#x7684;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x548C;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;&#x4E00;&#x81F4;&#x4E86;&#xFF0C;&#x4E5F;&#x907F;&#x514D;&#x4E86;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x95EE;&#x9898;&#x7684;&#x53D1;&#x751F;&#x3002;</p>
</li>
<li><p>&#x8D44;&#x6E90;&#x4E0D;&#x53CA;&#x65F6;&#x56DE;&#x6536;&#x5F15;&#x8D77;&#x7684;&#x5185;&#x5B58;&#x6CC4;&#x9732;</p>
<p>&#x56FE;&#x7247;&#x52A0;&#x8F7D;&#x662F;&#x624B;&#x673A;&#x7AEF;&#x5360;&#x7528;&#x5185;&#x5B58;&#x7684;&#x5927;&#x6237;&#xFF0C;&#x5904;&#x7406;&#x4E0D;&#x597D;&#x56FE;&#x7247;&#x5F88;&#x5BB9;&#x6613;&#x9020;&#x6210;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#xFF0C;&#x751A;&#x81F3;&#x5BFC;&#x81F4;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#xFF0C;&#x4E0D;&#x8FC7;&#x5904;&#x7406;&#x56FE;&#x7247;&#x9700;&#x8981;&#x8BB2;&#x89E3;&#x7684;&#x4E1C;&#x897F;&#x592A;&#x591A;&#x4E86;&#xFF0C;&#x6211;&#x5728;&#x8FD9;&#x91CC;&#x4E3B;&#x8981;&#x8BF4;&#x4E00;&#x4E0B;Bitmap&#x7684;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#xFF0C;&#x81F3;&#x4E8E;&#x5982;&#x4F55;&#x4F18;&#x5316;&#x56FE;&#x7247;&#x7684;&#x6280;&#x672F;&#xFF0C;&#x5982;&#xFF1A;&#x56FE;&#x7247;&#x8D28;&#x91CF;&#x538B;&#x7F29;&#x3001;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x88C1;&#x526A;&#x3001;&#x6539;&#x53D8;&#x56FE;&#x7247;&#x989C;&#x8272;&#x6A21;&#x5F0F;&#x7B49;&#x77E5;&#x8BC6;&#x70B9;&#x8BF7;&#x81EA;&#x884C;&#x641C;&#x7D22;&#x5B66;&#x4E60;&#xFF0C;&#x6211;&#x5C31;&#x4E0D;&#x5C55;&#x5F00;&#x8BA8;&#x8BBA;&#x4E86;&#x3002;</p>
<p>&#x8BF4;&#x5230;Bitmap&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#xFF0C;&#x5176;&#x5B9E;&#x6700;&#x5927;&#x7684;&#x95EE;&#x9898;&#x5C31;&#x662F;&#x6CA1;&#x6709;&#x53CA;&#x65F6;&#x7684;&#x56DE;&#x6536;&#x8D44;&#x6E90;&#xFF0C;&#x53EA;&#x8981;&#x5728;&#x56FE;&#x7247;&#x4F7F;&#x7528;&#x5B8C;&#x540E;&#x8C03;&#x7528;recylce()&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x5C06;Bitmap&#x5BF9;&#x8C61;&#x8D4B;&#x503C;&#x4E3A;null&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;</p>
<p>&#x5F88;&#x591A;&#x5730;&#x65B9;&#x5176;&#x5B9E;&#x90FD;&#x9002;&#x7528;&#x8FD9;&#x79CD;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#xFF0C;&#x6BD4;&#x5982; Sqlite&#x6570;&#x636E;&#x5E93;&#x5728;&#x67E5;&#x8BE2;&#x7ED3;&#x675F;&#x540E;&#x8981;&#x8BB0;&#x5F97;&#x5173;&#x95ED;Cursor.close(),&#x53C8;&#x6216;&#x8005;&#x6211;&#x4EEC;&#x5728;&#x5904;&#x7406;&#x5B8C;&#x6587;&#x4EF6;&#x6D41;&#x540E;&#x8981;&#x8BB0;&#x5F97;InputStream.close(),&#x4EE5;&#x53CA;EventBus&#x5728;&#x4F7F;&#x7528;&#x5B8C;&#x6210;&#x540E;&#x4E5F;&#x8981;&#x8BB0;&#x5F97;unregister()&#xFF0C;&#x7B49;&#x7B49;&#xFF0C;&#x8FD9;&#x4E9B;&#x77E5;&#x8BC6;&#x70B9;&#x8981;&#x5728;&#x5E73;&#x65F6;&#x5F00;&#x53D1;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x5F88;&#x6CE8;&#x610F;&#xFF0C;&#x4E0D;&#x7136;&#x5C31;&#x4F1A;&#x4E3A;&#x672A;&#x6765;&#x7684;&#x9879;&#x76EE;&#x7EF4;&#x62A4;&#x57CB;&#x4E0B;&#x5404;&#x79CD;&#x6DF1;&#x5751;&#xFF0C;&#x8C28;&#x8BB0;&#x3002;</p>
</li>
<li><p>WebView&#x5F15;&#x8D77;&#x7684;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;</p>
<p>WebView&#x4E3B;&#x8981;&#x662F;&#x7528;&#x6765;&#x52A0;&#x8F7D;&#x7F51;&#x9875;&#x7684;&#xFF0C;&#x5728;H5&#x5927;&#x884C;&#x5176;&#x9053;&#x7684;&#x4ECA;&#x5929;&#xFF0C;WebView&#x7684;&#x4F7F;&#x7528;&#x573A;&#x666F;&#x975E;&#x5E38;&#x5E38;&#x89C1;&#xFF0C;&#x5408;&#x7406;&#x7684;&#x91CA;&#x653E;WebView&#x5360;&#x7528;&#x7684;&#x8D44;&#x6E90;&#x4E5F;&#x662F;&#x5904;&#x7406;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x7684;&#x5173;&#x952E;&#xFF0C;&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x4E00;&#x4E0B;WebView&#x5982;&#x4F55;&#x91CA;&#x653E;&#x8D44;&#x6E90;&#xFF0C;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">destroyWebView</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (mWebView != <span class="keyword">null</span>) {</span><br><span class="line">            mWebView.pauseTimers();</span><br><span class="line">            mWebView.removeAllViews();</span><br><span class="line">            mWebView.destroy();</span><br><span class="line">            mWebView = <span class="keyword">null</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>
</li>
<li><p>&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x5F15;&#x8D77;&#x7684;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;</p>
<p>&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x4E2D;&#x6709;&#x4E00;&#x79CD;&#x52A8;&#x753B;&#x7684;&#x6267;&#x884C;&#x65F6;&#x95F4;&#x6A21;&#x5F0F;&#x662F;ValueAnimator.INFINITE&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x662F;&#x65E0;&#x9650;&#x5FAA;&#x73AF;&#x7684;&#x3002;&#x5982;&#x679C;&#x9875;&#x9762;&#x903B;&#x8F91;&#x6BD4;&#x8F83;&#x590D;&#x6742;&#xFF0C;&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x53EF;&#x80FD;&#x4F1A;&#x548C;Handler&#x914D;&#x5408;&#x4F7F;&#x7528;&#xFF0C;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5C31;&#x6709;&#x53EF;&#x80FD;&#x9020;&#x6210;&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x4E86;&#xFF0C;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x7684;&#x65B9;&#x6CD5;&#x4E5F;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#xFF0C;&#x5728;&#x5173;&#x95ED;&#x8BE5;&#x9875;&#x9762;&#x524D;&#xFF0C;&#x5728;onDestory&#x65B9;&#x6CD5;&#x4E2D;&#x8C03;&#x7528;&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x7684;cancel()&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x5C06;&#x8BE5;&#x52A8;&#x753B;&#x7684;&#x5BF9;&#x8C61;&#x7F6E;&#x4E3A;Null&#x5373;&#x53EF;&#x3002;</p>
</li>
<li><p>Service&#x5F15;&#x8D77;&#x7684;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;</p>
<p>Service&#x505C;&#x6B62;&#x5931;&#x8D25;&#xFF0C;&#x4E5F;&#x4F1A;&#x5BFC;&#x81F4;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#xFF0C;&#x56E0;&#x4E3A;&#x7CFB;&#x7EDF;&#x4F1A;&#x5C06;&#x8FD9;&#x4E2A;Service&#x6240;&#x5728;&#x7684;&#x8FDB;&#x7A0B;&#x8FDB;&#x884C;&#x4FDD;&#x7559;&#xFF0C;&#x5982;&#x679C;&#x8BE5;&#x8FDB;&#x7A0B;&#x8017;&#x5185;&#x5B58;&#x5F88;&#x5927;&#xFF0C;&#x4FBF;&#x4F1A;&#x9020;&#x6210;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#xFF0C;&#x5BB9;&#x6613;&#x83AB;&#x540D;&#x7684;&#x5F15;&#x53D1;GC&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x5728;&#x4F7F;&#x7528;Service&#x65B9;&#x9762;&#xFF0C;&#x53EF;&#x4EE5;&#x5C3D;&#x91CF;&#x5C1D;&#x8BD5;&#x4F7F;&#x7528;IntentService,IntentService&#x7684;&#x672C;&#x8D28;&#x5176;&#x5B9E;&#x5C31;&#x662F;Service+HandlerThread,&#x5B83;&#x6709;&#x5F88;&#x591A;&#x4F18;&#x70B9;&#xFF0C;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x5C31;&#x662F;IntentService&#x5728;&#x6267;&#x884C;&#x5B8C;&#x6307;&#x5B9A;&#x7684;&#x4EFB;&#x52A1;&#x540E;&#x4F1A;&#x81EA;&#x884C;&#x5173;&#x95ED;&#xFF0C;&#x4E0D;&#x7528;&#x7528;&#x6237;&#x624B;&#x52A8;&#x5173;&#x95ED;&#xFF0C;&#x907F;&#x514D;&#x4E86;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x7684;&#x53D1;&#x751F;,&#x4E0B;&#x9762;&#x6765;&#x770B;&#x4E00;&#x4E0B;IntentService&#x7684;&#x6E90;&#x7801;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> android.app;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.annotation.WorkerThread;</span><br><span class="line"><span class="keyword">import</span> android.annotation.Nullable;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.os.Handler;</span><br><span class="line"><span class="keyword">import</span> android.os.HandlerThread;</span><br><span class="line"><span class="keyword">import</span> android.os.IBinder;</span><br><span class="line"><span class="keyword">import</span> android.os.Looper;</span><br><span class="line"><span class="keyword">import</span> android.os.Message;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">IntentService</span> <span class="keyword">extends</span> <span class="title">Service</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> Looper mServiceLooper;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> ServiceHandler mServiceHandler;</span><br><span class="line">    <span class="keyword">private</span> String mName;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> mRedelivery;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ServiceHandler</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>{</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ServiceHandler</span><span class="params">(Looper looper)</span> </span>{</span><br><span class="line">            <span class="keyword">super</span>(looper);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>{</span><br><span class="line">            onHandleIntent((Intent)msg.obj);</span><br><span class="line">            stopSelf(msg.arg1);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Creates an IntentService.  Invoked by your subclass&apos;s constructor.</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">IntentService</span><span class="params">(String name)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        mName = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Sets intent redelivery preferences.  Usually called from the constructor</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIntentRedelivery</span><span class="params">(<span class="keyword">boolean</span> enabled)</span> </span>{</span><br><span class="line">        mRedelivery = enabled;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> It would be nice to have an option to hold a partial wakelock</span></span><br><span class="line">        <span class="comment">// during processing, and to have a static startService(Context, Intent)</span></span><br><span class="line">        <span class="comment">// method that would launch the service &amp; hand off a wakelock.</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">super</span>.onCreate();</span><br><span class="line">        HandlerThread thread = <span class="keyword">new</span> HandlerThread(<span class="string">&quot;IntentService[&quot;</span> + mName + <span class="string">&quot;]&quot;</span>);</span><br><span class="line">        thread.start();</span><br><span class="line"></span><br><span class="line">        mServiceLooper = thread.getLooper();</span><br><span class="line">        mServiceHandler = <span class="keyword">new</span> ServiceHandler(mServiceLooper);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStart</span><span class="params">(@Nullable Intent intent, <span class="keyword">int</span> startId)</span> </span>{</span><br><span class="line">        Message msg = mServiceHandler.obtainMessage();</span><br><span class="line">        msg.arg1 = startId;</span><br><span class="line">        msg.obj = intent;</span><br><span class="line">        mServiceHandler.sendMessage(msg);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * You should not override this method for your IntentService. Instead,</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">onStartCommand</span><span class="params">(@Nullable Intent intent, <span class="keyword">int</span> flags, <span class="keyword">int</span> startId)</span> </span>{</span><br><span class="line">        onStart(intent, startId);</span><br><span class="line">        <span class="keyword">return</span> mRedelivery ? START_REDELIVER_INTENT : START_NOT_STICKY;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>{</span><br><span class="line">        mServiceLooper.quit();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Unless you provide binding for your service, you don&apos;t need to implement this</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="annotation">@Nullable</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IBinder <span class="title">onBind</span><span class="params">(Intent intent)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@WorkerThread</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">onHandleIntent</span><span class="params">(@Nullable Intent intent)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x6E90;&#x7801;&#x5E76;&#x4E0D;&#x591A;&#xFF0C;&#x5927;&#x5BB6;&#x5E94;&#x8BE5;&#x8981;&#x901A;&#x8BFB;&#x4E00;&#x4E0B;&#xFF0C;&#x5176;&#x4E2D;&#x5173;&#x952E;&#x4E00;&#x884C;&#x4EE3;&#x7801;&#x662F;26&#x884C;&#xFF1A;stopSelf(msg.arg1);</p>
<p>&#x8FD9;&#x91CC;stopSelf(msg.arg1),&#x4F1A;&#x5148;&#x770B;&#x961F;&#x5217;&#x4E2D;&#x662F;&#x5426;&#x6709;&#x6D88;&#x606F;&#x5F85;&#x5904;&#x7406;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x5219;&#x7EE7;&#x7EED;&#x5904;&#x7406;&#x540E;&#x9762;&#x7684;&#x6D88;&#x606F;&#xFF0C;&#x6CA1;&#x6709;&#x624D;&#x4F1A;&#x5C06;Service&#x9500;&#x6BC1;&#x3002; </p>
</li>
<li><p>Static&#x5F15;&#x8D77;&#x7684;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;</p>
<p>&#x5728;&#x975E;&#x5FC5;&#x8981;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4E0D;&#x8981;&#x8F7B;&#x6613;&#x7684;&#x4F7F;&#x7528;Static&#x6765;&#x4FEE;&#x9970;&#x6210;&#x5458;&#x53D8;&#x91CF;&#xFF0C;&#x8FD9;&#x4F1A;&#x5BFC;&#x81F4;&#x5176;&#x751F;&#x547D;&#x5468;&#x671F;&#x548C;app&#x8FDB;&#x7A0B;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x4E00;&#x6837;&#xFF0C;&#x4ECE;&#x800C;&#x5728;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x5927;&#x91CF;&#x5B58;&#x5728;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x4F1A;&#x5BFC;&#x81F4;&#x5E94;&#x7528;&#x5185;&#x5B58;&#x5360;&#x7528;&#x91CF;&#x5927;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4E14;&#x66F4;&#x5BB9;&#x6613;&#x88AB;&#x7CFB;&#x7EDF;&#x56DE;&#x6536;&#xFF0C;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x5C31;&#x662F;&#x5C3D;&#x91CF;&#x7528;&#x61D2;&#x52A0;&#x8F7D;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x5B9A;&#x4E49;&#x6210;&#x5458;&#x53D8;&#x91CF;&#x3002;Static&#x5F15;&#x8D77;&#x7684;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;</p>
</li>
<li><p>&#x7528;&#x7F13;&#x5B58;&#x907F;&#x514D;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;</p>
<p>&#x5F88;&#x5E38;&#x89C1;&#x7684;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#x5C31;&#x662F;&#x56FE;&#x7247;&#x7684;&#x4E09;&#x7EA7;&#x7F13;&#x5B58;&#x7ED3;&#x6784;&#xFF0C;&#x5206;&#x522B;&#x4E3A;&#x7F51;&#x7EDC;&#x7F13;&#x5B58;&#xFF0C;&#x672C;&#x5730;&#x7F13;&#x5B58;&#x4EE5;&#x53CA;&#x5185;&#x5B58;&#x7F13;&#x5B58;&#x3002;&#x5728;&#x5185;&#x5B58;&#x7F13;&#x5B58;&#x903B;&#x8F91;&#x7C7B;&#x4E2D;&#xFF0C;&#x901A;&#x5E38;&#x4F1A;&#x5B9A;&#x4E49;&#x8FD9;&#x6837;&#x7684;&#x96C6;&#x5408;&#x7C7B;&#x3002;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> HashMap&lt;String, Bitmap&gt; mMemoryCache = <span class="keyword">new</span> HashMap&lt;String, Bitmap&gt;();<span class="comment">//String&#x7C7B;&#x4E3A;&#x8BE5;&#x56FE;&#x7247;&#x5BF9;&#x5E94;url</span></span><br></pre></td></tr></table></figure>
<p>&#x4E09;&#x7EA7;&#x7F13;&#x5B58;&#x7ED3;&#x6784;&#x8FC7;&#x7A0B;&#x4ECB;&#x7ECD;&#xFF1A;</p>
<p>&#x5728;&#x7528;&#x6237;&#x5207;&#x6362;&#x5230;&#x5C55;&#x793A;&#x56FE;&#x7247;&#x7684;&#x754C;&#x9762;&#x65F6;&#xFF0C;&#x5F53;&#x7136;&#x662F;&#x4F18;&#x5148;&#x5224;&#x65AD;&#x5185;&#x5B58;&#x7F13;&#x5B58;&#x662F;&#x5426;&#x4E3A;Null&#xFF0C;&#x4E0D;&#x4E3A;&#x7A7A;&#x76F4;&#x63A5;&#x5C55;&#x793A;&#x56FE;&#x7247;&#xFF0C;&#x82E5;&#x4E3A;&#x7A7A;&#xFF0C;&#x540C;&#x6837;&#x7684;&#x903B;&#x8F91;&#x53BB;&#x5224;&#x65AD;&#x672C;&#x5730;&#x7F13;&#x5B58;&#xFF08;&#x4E0D;&#x4E3A;&#x7A7A;&#x4FBF;&#x8BBE;&#x7F6E;&#x5185;&#x5B58;&#x7F13;&#x5B58;&#x5E76;&#x5C55;&#x793A;&#x56FE;&#x7247;&#xFF09;&#xFF0C;&#x672C;&#x5730;&#x7F13;&#x5B58;&#x518D;&#x4E3A;&#x7A7A;&#x624D;&#x4F1A;&#x6839;&#x636E;&#x8BE5;&#x56FE;&#x7247;&#x7684;url&#x7528;&#x7F51;&#x7EDC;&#x4E0B;&#x8F7D;&#x7C7B;&#x53BB;&#x4E0B;&#x8F7D;&#x8BE5;&#x56FE;&#x7247;&#x5E76;&#x5C55;&#x793A;&#x56FE;&#x7247;&#xFF08;&#x5F53;&#x7136;&#x4E86;&#xFF0C;&#x4E0B;&#x8F7D;&#x5230;&#x56FE;&#x7247;&#x540E;&#x4F1A;&#x6709;&#x8BBE;&#x7F6E;&#x672C;&#x5730;&#x7F13;&#x5B58;&#x4EE5;&#x53CA;&#x5185;&#x5B58;&#x7F13;&#x5B58;&#x7684;&#x64CD;&#x4F5C;&#xFF09;&#x3002;</p>
<p>&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x7684;&#x95EE;&#x9898;&#x5C31;&#x51FA;&#x73B0;&#x5728;&#x5185;&#x5B58;&#x7F13;&#x5B58;&#x4E2D;&#xFF1A;&#x53EA;&#x8981;HashMap&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x88AB;&#x5F15;&#x7528;&#xFF0C;&#x800C;Bitmap&#x5BF9;&#x8C61;&#x53C8;&#x90FD;&#x662F;&#x5F3A;&#x5F15;&#x7528;&#xFF0C;Bitmap&#x4E2D;&#x56FE;&#x7247;&#x8D8A;&#x6765;&#x8D8A;&#x591A;&#xFF0C;&#x5373;&#x4FBF;&#x662F;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x4E86;&#xFF0C;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#x4E5F;&#x4E0D;&#x4F1A;&#x5904;&#x7406;&#x3002;</p>
</li>
</ul>
<p>  &#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF1A;</p>
<p>  &#xFF08;1&#xFF09;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x4F7F;&#x7528;&#x8F6F;&#x5F15;&#x7528;&#xFF0C;&#x4ECE;&#x800C;&#x5728;&#x5185;&#x5B58;&#x4E0D;&#x8DB3;&#x65F6;&#xFF0C;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#x66F4;&#x5BB9;&#x6613;&#x56DE;&#x6536;Bitmap&#x5783;&#x573E;&#x3002;</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> HashMap&lt;String, SoftReference&lt;Bitmap&gt;&gt; mMemoryCache = <span class="keyword">new</span> HashMap&lt;String, SoftReference&lt;Bitmap&gt;&gt;();</span><br></pre></td></tr></table></figure>
<p>  &#xFF08;2&#xFF09;Android2.3&#x4EE5;&#x540E;&#xFF0C;SoftReference&#x4E0D;&#x518D;&#x53EF;&#x9760;&#x3002;&#x5783;&#x573E;&#x56DE;&#x6536;&#x671F;&#x66F4;&#x5BB9;&#x6613;&#x56DE;&#x6536;&#x5B83;&#xFF0C;&#x4E0D;&#x518D;&#x662F;&#x5185;&#x5B58;&#x4E0D;&#x8DB3;&#x65F6;&#x624D;&#x56DE;&#x6536;&#x8F6F;&#x5F15;&#x7528;&#x3002;&#x90A3;&#x4E48;&#x7F13;&#x5B58;&#x673A;&#x5236;&#x4FBF;&#x5931;&#x53BB;&#x4E86;&#x610F;&#x4E49;&#x3002;</p>
<p>  Google&#x5B98;&#x65B9;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;LruCache&#x4F5C;&#x4E3A;&#x7F13;&#x5B58;&#x7684;&#x96C6;&#x5408;&#x7C7B;&#x3002;&#x5176;&#x5B9E;&#x5185;&#x90E8;&#x5C01;&#x88C5;&#x4E86;LinkedHashMap&#x3002;&#x5185;&#x90E8;&#x539F;&#x7406;&#x662F;&#x4E00;&#x76F4;&#x5224;&#x65AD;&#x96C6;&#x5408;&#x5927;&#x5C0F;&#x662F;&#x5426;&#x8D85;&#x51FA;&#x7ED9;&#x5B9A;&#x7684;&#x6700;&#x5927;&#x503C;&#xFF0C;&#x8D85;&#x51FA;&#x5C31;&#x628A;&#x6700;&#x65E9;&#x6700;&#x5C11;&#x4F7F;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#x8E22;&#x51FA;&#x96C6;&#x5408;&#x3002;</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> LruCache&lt;String, Bitmap&gt; mMemoryCache = <span class="keyword">new</span> LruCache&lt;String, Bitmap&gt;</span><br><span class="line">((<span class="keyword">int</span>)(Runtime.getRuntime().maxMemory()/<span class="number">8</span>)){ </span><br><span class="line"><span class="comment">//&#x7528;&#x6700;&#x5927;&#x5185;&#x5B58;&#x7684;1/8&#x5206;&#x914D;&#x7ED9;&#x8FD9;&#x4E2A;&#x96C6;&#x5408;&#x4F7F;&#x7528;</span></span><br><span class="line"><span class="comment">//&#x8BA9;&#x8FD9;&#x4E2A;&#x96C6;&#x5408;&#x77E5;&#x9053;&#x6BCF;&#x4E2A;&#x56FE;&#x7247;&#x7684;&#x5927;&#x5C0F;</span></span><br><span class="line"><span class="annotation">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">int</span> <span class="title">sizeOf</span><span class="params">(String key, Bitmap value)</span></span>{</span><br><span class="line"><span class="keyword">int</span> byteCount = value.getRowBytes() * value.getHeight();<span class="comment">//&#x8BA1;&#x7B97;&#x56FE;&#x7247;&#x5927;&#x5C0F;&#xFF0C;&#x6BCF;&#x884C;&#x5B57;&#x8282;&#x6570;*&#x9AD8;&#x5EA6;</span></span><br><span class="line"><span class="keyword">return</span> byteCount;</span><br><span class="line">  }</span><br><span class="line">};</span><br></pre></td></tr></table></figure>
<ul>
<li><p>&#x96C6;&#x5408;&#x7C7B;&#x5BFC;&#x81F4;&#x7684;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;</p>
<p>&#x96C6;&#x5408;&#x7C7B;&#x6DFB;&#x52A0;&#x5143;&#x7D20;&#x540E;&#xFF0C;&#x4ECD;&#x5F15;&#x7528;&#x7740;&#x96C6;&#x5408;&#x5143;&#x7D20;&#x5BF9;&#x8C61;&#xFF0C;&#x5BFC;&#x81F4;&#x8BE5;&#x96C6;&#x5408;&#x4E2D;&#x7684;&#x5143;&#x7D20;&#x5BF9;&#x8C61;&#x65E0;&#x6CD5;&#x88AB;&#x56DE;&#x6536;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x5185;&#x5B58;&#x6CC4;&#x9732;&#xFF0C;&#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> List&lt;Object&gt; objectList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) {</span><br><span class="line">      Object obj = <span class="keyword">new</span> Object();</span><br><span class="line">      objectList.add(obj);</span><br><span class="line">      obj = <span class="keyword">null</span>;</span><br><span class="line">   }</span><br></pre></td></tr></table></figure>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x5FAA;&#x73AF;&#x591A;&#x6B21;&#x5C06; new &#x51FA;&#x6765;&#x7684;&#x5BF9;&#x8C61;&#x653E;&#x5165;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x7684;&#x96C6;&#x5408;&#x4E2D;&#xFF0C;&#x56E0;&#x4E3A;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x548C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E00;&#x81F4;&#xFF0C;&#x800C;&#x4E14;&#x4ED6;&#x4EEC;&#x6240;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61; Object &#x4E5F;&#x4E0D;&#x80FD;&#x91CA;&#x653E;&#xFF0C;&#x8FD9;&#x6837;&#x4FBF;&#x9020;&#x6210;&#x4E86;&#x5185;&#x5B58;&#x6CC4;&#x9732;&#x3002;</p>
<p><strong>&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#xFF1A;</strong>&#x5728;&#x96C6;&#x5408;&#x5143;&#x7D20;&#x4F7F;&#x7528;&#x4E4B;&#x540E;&#x4ECE;&#x96C6;&#x5408;&#x4E2D;&#x5220;&#x9664;&#xFF0C;&#x7B49;&#x6240;&#x6709;&#x5143;&#x7D20;&#x90FD;&#x4F7F;&#x7528;&#x5B8C;&#x4E4B;&#x540E;&#xFF0C;&#x5C06;&#x96C6;&#x5408;&#x7F6E;&#x7A7A;&#x3002;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">objectList.clear();</span><br><span class="line">objectList = <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x603B;&#x7ED3;">&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x603B;&#x7ED3;</h2><p>&#x8BF4;&#x4E86;&#x8FD9;&#x4E48;&#x591A;&#xFF0C;&#x5176;&#x5B9E;&#x8FD9;&#x4E9B;&#x77E5;&#x8BC6;&#x70B9;&#x5F88;&#x591A;&#x670B;&#x53CB;&#x5728;&#x5176;&#x4ED6;&#x6280;&#x672F;&#x6587;&#x7AE0;&#x4E2D;&#x4E5F;&#x90FD;&#x770B;&#x5230;&#x8FC7;&#x4E86;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x4E5F;&#x53EA;&#x662F;&#x505A;&#x4E86;&#x5F52;&#x7EB3;&#x548C;&#x603B;&#x7ED3;&#xFF0C;&#x5176;&#x4E2D;&#x6BD4;&#x8F83;&#x5173;&#x952E;&#x7684;&#x5C31;&#x662F;&#x5728;&#x5F00;&#x53D1;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x4E00;&#x5B9A;&#x8981;&#x5FC3;&#x7EC6;&#xFF0C;&#x4E0D;&#x8981;&#x6015;&#x9EBB;&#x70E6;&#xFF0C;&#x5BF9;&#x4E00;&#x4E9B;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x7684;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x4E00;&#x5B9A;&#x8981;&#x53CA;&#x65F6;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x517B;&#x6210;&#x826F;&#x597D;&#x7684;&#x7F16;&#x7A0B;&#x4E60;&#x60EF;&#x548C;&#x8D23;&#x4EFB;&#x5FC3;&#x3002;</p>
<p>&#x5E73;&#x65F6;&#x5728;&#x5F00;&#x53D1;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x9664;&#x4E86;&#x77E5;&#x9053;&#x8FD9;&#x4E9B;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x7684;&#x77E5;&#x8BC6;&#x70B9;&#x5916;&#x8FD8;&#x5E94;&#x5F53;&#x5B66;&#x4E60;&#x548C;&#x5229;&#x7528;&#x4E00;&#x4E9B;&#x5DE5;&#x5177;&#x6765;&#x5E2E;&#x52A9;&#x81EA;&#x5DF1;&#x5206;&#x6790;&#x5E94;&#x7528;&#x7684;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x95EE;&#x9898;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x5148;&#x63A8;&#x8350;&#x4E24;&#x4E2A;&#xFF1A;&#x4E00;&#x4E2A;&#x662F;Android&#x7AEF;&#x7684;LeakCanary,&#x8FD8;&#x4E00;&#x4E2A;&#x662F;AndroidStudio3.0&#x51FA;&#x6765;&#x7684;Profiler&#x5206;&#x6790;&#x5668;&#xFF0C;&#x81F3;&#x4E8E;&#x600E;&#x4E48;&#x7528;&#xFF0C;&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x67E5;&#x8BE2;&#x76F8;&#x5173;&#x6587;&#x6863;&#x5B66;&#x4E60;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x5C31;&#x53EA;&#x662F;&#x629B;&#x4E2A;&#x7816;&#x3002;</p>
<p>&#x8C22;&#x8C22;&#x4F60;&#x770B;&#x5B8C;&#xFF01;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Springboot2.0中利用自定义属性动态设置SQL语句]]></title>
      <url>http://jasoncool.com/2018/08/28/Springboot2.0%E4%B8%AD%E5%88%A9%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7%E5%8A%A8%E6%80%81%E8%AE%BE%E7%BD%AESQL%E8%AF%AD%E5%8F%A5/</url>
      <content type="html"><![CDATA[<h2 id="&#x8D77;&#x56E0;">&#x8D77;&#x56E0;</h2><p>&#x770B;&#x5230;&#x6807;&#x9898;&#x53EF;&#x80FD;&#x5F88;&#x591A;&#x670B;&#x53CB;&#x4F1A;&#x61F5;&#xFF0C;&#x8FD9;&#x4EC0;&#x4E48;&#x610F;&#x601D;&#xFF0C;&#x4EC0;&#x4E48;&#x662F;&#x5229;&#x7528;&#x81EA;&#x5B9A;&#x4E49;&#x5C5E;&#x6027;&#x52A8;&#x6001;&#x8BBE;&#x7F6E;SQL&#x8BED;&#x53E5;&#xFF0C;&#x8FD9;&#x4E48;&#x505A;&#x56FE;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;<br>&#x5176;&#x5B9E;&#x8FD9;&#x4E2A;&#x6807;&#x9898;&#x8981;&#x7ED3;&#x5408;&#x7740;&#x76EE;&#x524D;&#x7684;&#x5927;&#x6846;&#x67B6;&#x6765;&#x770B;&#xFF0C;&#x7531;&#x4E8E;&#x5C06;&#x6743;&#x9650;&#x6846;&#x67B6;&#x5C01;&#x88C5;&#x6210;&#x4E86;Maven&#x9879;&#x76EE;&#xFF0C;&#x4ECE;&#x800C;&#x5728;&#x4F7F;&#x7528;&#x6743;&#x9650;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x53EA;&#x8981;&#x5728;Pom.xml&#x4E2D;&#x5F15;&#x5165;&#x6211;&#x4E0A;&#x4F20;&#x5728;Maven&#x79C1;&#x670D;&#x7684;&#x6743;&#x9650;&#x6846;&#x67B6;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x4E4B;&#x524D;&#x7684;&#x6743;&#x9650;&#x6846;&#x67B6;&#x7531;&#x4E8E;&#x4E4B;&#x8003;&#x8651;&#x4E86;&#x6700;&#x57FA;&#x672C;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x539F;&#x6765;&#x7684;&#x6743;&#x9650;&#x6846;&#x67B6;&#x5BF9;&#x5E94;&#x7684;&#x6570;&#x636E;&#x5E93;&#x8868;&#x5355;&#x4E3B;&#x8981;&#x6709;&#xFF1A;&#x7528;&#x6237;&#x8868;&#xFF0C;&#x89D2;&#x8272;&#x8868;&#xFF0C;&#x6743;&#x9650;&#x8868;&#xFF0C;&#x83DC;&#x5355;&#x8868;&#x548C;&#x8D44;&#x6E90;&#x8868;&#xFF0C;&#x73B0;&#x5728;&#x7531;&#x4E8E;&#x4E1A;&#x52A1;&#x7684;&#x589E;&#x52A0;&#xFF0C;&#x5BFC;&#x81F4;&#x4E86;&#x6211;&#x4EEC;&#x52A0;&#x5165;&#x4E86;&#x5BA1;&#x6279;&#x6743;&#x9650;&#x8868;&#xFF0C;&#x8BE5;&#x8868;&#x662F;&#x548C;&#x89D2;&#x8272;&#x8868;&#x76F8;&#x5173;&#x8054;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x91CC;&#x5C31;&#x9762;&#x4E34;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#xFF0C;&#x4E0D;&#x662F;&#x6BCF;&#x4E2A;&#x9879;&#x76EE;&#x90FD;&#x6709;&#x5BA1;&#x6279;&#x6743;&#x9650;&#x7684;&#x800C;&#x4E14;&#x8FD9;&#x4E48;&#x6539;&#x6743;&#x9650;&#x6846;&#x67B6;&#x4F1A;&#x5BFC;&#x81F4;&#x6743;&#x9650;&#x6846;&#x67B6;&#x81C3;&#x80BF;&#x4E14;&#x4E1A;&#x52A1;&#x4FB5;&#x5165;&#x6027;&#x5F88;&#x5F3A;&#xFF0C;&#x90A3;&#x4E48;&#x6709;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x5462;&#xFF1F;</p>
<a id="more"></a>
<h2 id="&#x601D;&#x8DEF;">&#x601D;&#x8DEF;</h2><p>&#x9047;&#x5230;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x5176;&#x5B9E;&#x6211;&#x4EEC;&#x4E3B;&#x8981;&#x5C31;&#x662F;&#x627E;&#x5230;&#x95EE;&#x9898;&#x7684;&#x6838;&#x5FC3;&#xFF0C;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x6838;&#x5FC3;&#x70B9;&#x5C31;&#x662F;&#x5B50;MAVEN&#x9879;&#x76EE;&#x7684;&#x4E1A;&#x52A1;&#x662F;&#x6839;&#x636E;&#x4E3B;&#x4E1A;&#x52A1;&#x9879;&#x76EE;&#x7684;&#x53D8;&#x5316;&#x800C;&#x53D8;&#x5316;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x80FD;&#x505A;&#x5230;&#x7075;&#x6D3B;&#x5E94;&#x5BF9;&#x5417;&#xFF1F;<br>&#x7B54;&#x6848;&#x5F53;&#x7136;&#x662F;&#xFF1A;&#x80FD;&#xFF01;<br>&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x4E86;&#x89E3;&#x51E0;&#x4E2A;&#x5173;&#x952E;&#x77E5;&#x8BC6;&#x70B9;:</p>
<blockquote>
<p>JDBC&#xFF0C;Springboot&#x5F15;&#x5165;&#x5916;&#x90E8;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x81EA;&#x5B9A;&#x4E49;&#x5C5E;&#x6027;</p>
</blockquote>
<p>&#x53EA;&#x8981;&#x77E5;&#x9053;&#x8FD9;&#x4E09;&#x4E2A;&#x77E5;&#x8BC6;&#x70B9;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x5C31;&#x80FD;&#x591F;&#x89E3;&#x51B3;&#x6211;&#x4EEC;&#x7684;&#x95EE;&#x9898;&#x4E86;&#xFF0C;&#x5177;&#x4F53;&#x65B9;&#x6CD5;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x5373;&#x53EF;&#x3002;</p>
<h2 id="&#x65B9;&#x6848;">&#x65B9;&#x6848;</h2><p>&#x7B2C;&#x4E00;&#x6B65;&#xFF1A;&#x5F15;&#x5165;Jdbc&#x7684;POM(&#x6743;&#x9650;&#x7BA1;&#x7406;&#x6A21;&#x5757;&#x5185;)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.0.4.RELEASE<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>&#x5F15;&#x5165;&#x8FD9;&#x4E2A;&#x4F9D;&#x8D56;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;JdbcTemplate&#x4E86;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x539F;&#x751F;&#x7684;Sql&#x8BED;&#x53E5;&#x4E86;&#x3002;</p>
<p>&#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;&#x7F16;&#x5199;&#x6570;&#x636E;&#x7684;&#x67E5;&#x8BE2;&#x7C7B;(&#x6743;&#x9650;&#x7BA1;&#x7406;&#x6A21;&#x5757;&#x5185;)</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">**</span><br><span class="line"> * <span class="annotation">@Author</span>:&#x8D3E;&#x771F;</span><br><span class="line"> * <span class="annotation">@Description</span>:</span><br><span class="line"> * <span class="annotation">@Date</span>:&#x521B;&#x5EFA;&#x4E8E;&#x4E0A;&#x5348; <span class="number">09</span>:<span class="number">52</span> <span class="number">2018</span>/<span class="number">8</span>/<span class="number">24</span></span><br><span class="line"> * <span class="annotation">@Modified</span>:&#x4E3A;&#x4E86;&#x4FDD;&#x8BC1;&#x6743;&#x9650;&#x67E5;&#x8BE2;&#x7684;&#x7075;&#x6D3B;&#x6027;&#xFF0C;&#x4E14;&#x7531;&#x4E8E;&#x672C;&#x6B21;&#x9879;&#x76EE;&#x4E2D;&#x7684;&#x6743;&#x9650;&#x8868;&#x52A0;&#x5165;&#x4E86;&#x5BA1;&#x6279;&#x6743;&#x9650;&#xFF0C;&#x5173;&#x4E8E;&#x6743;&#x9650;&#x67E5;&#x8BE2;&#x7684;SQL&#x5C31;&#x5FC5;&#x987B;&#x8981;&#x66F4;&#x6539;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x91CC;&#x5199;&#x6B7B;&#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x4F1A;&#x9020;&#x6210;&#x4E1A;&#x52A1;&#x7684;&#x65E0;&#x6CD5;&#x6269;&#x5C55;</span><br><span class="line"> * &#x6211;&#x4EEC;&#x76EE;&#x524D;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x662F;&#xFF0C;&#x7075;&#x6D3B;&#x7684;SQL&#x4F7F;&#x7528;JDBC&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x67E5;&#x8BE2;&#xFF0C;SQL&#x8BED;&#x53E5;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5B50;&#x9879;&#x76EE;&#x7684;&#x81EA;&#x5B9A;&#x4E49;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x8BBE;&#x7F6E;&#x5373;&#x53EF;&#x3002;</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line"><span class="annotation">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcOperation</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x81EA;&#x5B9A;&#x4E49;&#x7684;SQL&#x8BED;&#x53E5;&#x5C5E;&#x6027;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Value</span>(<span class="string">&quot;${security.find.auth.by.id.sql}&quot;</span>)</span><br><span class="line">    <span class="keyword">private</span> String findAuthByIdSQL;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x9ED8;&#x8BA4;&#x7684;SQL&#x8BED;&#x53E5;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> String default_findAuthByIdSQL = <span class="string">&quot;SELECT&quot;</span> +</span><br><span class="line">            <span class="string">&quot;        sa.*&quot;</span> +</span><br><span class="line">            <span class="string">&quot;    FROM&quot;</span> +</span><br><span class="line">            <span class="string">&quot;        sys_authorities sa&quot;</span> +</span><br><span class="line">            <span class="string">&quot;    LEFT JOIN sys_role_auth sra ON sra.auth_id = sa.auth_id&quot;</span> +</span><br><span class="line">            <span class="string">&quot;    LEFT JOIN sys_user_role sur ON sur.role_id = sra.role_id&quot;</span> +</span><br><span class="line">            <span class="string">&quot;    LEFT JOIN sys_user su ON su.user_id = sur.user_id&quot;</span> +</span><br><span class="line">            <span class="string">&quot;    WHERE su.user_id=?&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6839;&#x636E;ID&#x83B7;&#x53D6;&#x7528;&#x6237;&#x6743;&#x9650;</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@return</span></span><br><span class="line">     * <span class="doctag">@throws</span> Exception</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Transactional</span>(readOnly = <span class="keyword">true</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;SysAuth&gt; <span class="title">findAuthById</span><span class="params">(<span class="keyword">final</span> Long id)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        <span class="keyword">if</span> ((<span class="string">&quot;&quot;</span>).equals(findAuthByIdSQL) || findAuthByIdSQL.length() == <span class="number">0</span>) {</span><br><span class="line">            findAuthByIdSQL = default_findAuthByIdSQL;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> jdbcTemplate.query(findAuthByIdSQL, <span class="keyword">new</span> Object[]{id,id,id}, <span class="keyword">new</span> SysAuthRowMapper());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x884C;&#x6620;&#x5C04;</span><br><span class="line">     * &#x6620;&#x5C04;&#x7684;&#x5FC5;&#x987B;&#x662F;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5B57;&#x6BB5;&#x540D;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">SysAuthRowMapper</span> <span class="keyword">implements</span> <span class="title">RowMapper</span>&lt;<span class="title">SysAuth</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> SysAuth <span class="title">mapRow</span><span class="params">(ResultSet resultSet, <span class="keyword">int</span> i)</span> <span class="keyword">throws</span> SQLException </span>{</span><br><span class="line">            SysAuth sysAuth = <span class="keyword">new</span> SysAuth();</span><br><span class="line">            sysAuth.setAuthId(resultSet.getLong(<span class="string">&quot;auth_id&quot;</span>));</span><br><span class="line">            sysAuth.setAuthName(resultSet.getString(<span class="string">&quot;auth_name&quot;</span>));</span><br><span class="line">            sysAuth.setAuthDesc(resultSet.getString(<span class="string">&quot;auth_desc&quot;</span>));</span><br><span class="line">            sysAuth.setEnable(resultSet.getShort(<span class="string">&quot;enable&quot;</span>));</span><br><span class="line">            sysAuth.setIsSys(resultSet.getShort(<span class="string">&quot;is_sys&quot;</span>));</span><br><span class="line">            <span class="keyword">return</span> sysAuth;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x91CC;&#x8981;&#x6CE8;&#x610F;&#x4E00;&#x4E0B;&#xFF0C;&#x9996;&#x5148;&#x901A;&#x8FC7;@Value(&#x201C;${security.find.auth.by.id.sql}&#x201D;)&#x6765;&#x81EA;&#x5B9A;&#x4E49;&#x5C5E;&#x6027;&#xFF0C;&#x5C5E;&#x6027;&#x7684;Key&#x662F;security.find.auth.by.id.sql&#xFF0C;&#x7136;&#x540E;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;Jdbc&#x7684;&#x884C;&#x6620;&#x5C04;&#x5FC5;&#x987B;&#x6620;&#x5C04;&#x7684;&#x662F;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5B57;&#x6BB5;&#x540D;&#xFF0C;&#x81F3;&#x4E8E;&#x903B;&#x8F91;&#x5C31;&#x662F;&#x5982;&#x679C;&#x6709;&#x81EA;&#x5B9A;&#x4E49;&#x5C5E;&#x6027;&#x5C31;&#x6267;&#x884C;&#x81EA;&#x5B9A;&#x4E49;&#x5C5E;&#x6027;&#x4E2D;&#x7684;Sql&#x8BED;&#x53E5;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x5219;&#x6267;&#x884C;&#x9ED8;&#x8BA4;&#x7684;Sql&#x8BED;&#x53E5;&#x3002;</p>
<p>&#x7B2C;&#x4E09;&#x6B65;:&#x5728;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x52A0;&#x5165;&#x4E1A;&#x52A1;Sql(&#x4E3B;&#x4E1A;&#x52A1;&#x9879;&#x76EE;)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spring.profiles.active=ss_cas</span><br><span class="line">#security.find.atuth.by.id.sq=SELECT a.* FROM `sys_authorities` a</span><br></pre></td></tr></table></figure>
<p>OK,&#x5C31;&#x8FD9;&#x4E09;&#x6B65;&#xFF0C;&#x4E3B;&#x4E1A;&#x52A1;&#x7CFB;&#x7EDF;&#x5C31;&#x53EF;&#x4EE5;&#x7075;&#x6D3B;&#x7684;&#x5B9A;&#x4E49;&#x5BF9;&#x5E94;&#x7684;&#x6743;&#x9650;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;SQL&#x8BED;&#x53E5;&#x4E86;&#xFF0C;&#x5F53;&#x7136;&#x4EE5;&#x540E;&#x6709;&#x4EC0;&#x4E48;&#x5176;&#x4ED6;&#x7684;&#x7075;&#x6D3B;&#x6027;&#x4E1A;&#x52A1;&#x4E5F;&#x53EF;&#x4EE5;&#x8FD9;&#x4E48;&#x505A;&#xFF0C;&#x4E0D;&#x8FC7;&#x4E00;&#x5B9A;&#x8981;&#x5199;&#x597D;&#x6587;&#x6863;&#x548C;&#x6CE8;&#x91CA;&#xFF0C;&#x4EE5;&#x514D;&#x65F6;&#x95F4;&#x8FC7;&#x957F;&#x5FD8;&#x8BB0;&#x8FD9;&#x91CC;&#x7684;&#x601D;&#x8DEF;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Springboot2.0中封装RabbitMQ到Maven私服]]></title>
      <url>http://jasoncool.com/2018/07/27/Springboot2.0%E4%B8%AD%E5%B0%81%E8%A3%85RabbitMQ%E5%88%B0Maven%E7%A7%81%E6%9C%8D/</url>
      <content type="html"><![CDATA[<h2 id="&#x8D77;&#x56E0;">&#x8D77;&#x56E0;</h2><p>&#x7531;&#x4E8E;&#x672A;&#x6765;&#x6211;&#x4EEC;&#x7684;&#x7CFB;&#x7EDF;&#x90FD;&#x662F;&#x7531;&#x4E00;&#x4E2A;&#x7EDF;&#x4E00;&#x7684;&#x7528;&#x6237;&#x7BA1;&#x7406;&#x7CFB;&#x7EDF;&#x6765;&#x7BA1;&#x7406;&#x7528;&#x6237;&#x6570;&#x636E;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5404;&#x4E2A;&#x5B50;&#x7CFB;&#x7EDF;&#x4E2D;&#x4E0D;&#x9700;&#x8981;&#x4E5F;&#x4E0D;&#x53EF;&#x4EE5;&#x968F;&#x610F;&#x7684;&#x65B0;&#x589E;&#x6216;&#x4FEE;&#x6539;&#x7528;&#x6237;&#x7684;&#x4E2A;&#x4EBA;&#x4FE1;&#x606F;&#xFF0C;&#x9274;&#x4E8E;&#x6B64;&#xFF0C;&#x6211;&#x8003;&#x8651;&#x901A;&#x8FC7;MQ&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x5B9E;&#x73B0;&#x5728;&#x7528;&#x6237;&#x7CFB;&#x7EDF;&#x4E2D;&#x6DFB;&#x52A0;&#x3001;&#x5220;&#x9664;&#x6216;&#x4FEE;&#x6539;&#x7528;&#x6237;&#x4FE1;&#x606F;&#x65F6;&#x540C;&#x65F6;&#x5C06;&#x8FD9;&#x6761;&#x64CD;&#x4F5C;&#x8BB0;&#x5F55;&#x53D1;&#x9001;&#x7ED9;&#x8BE5;&#x7528;&#x6237;&#x62E5;&#x6709;&#x6743;&#x9650;&#x7684;&#x5B50;&#x7CFB;&#x7EDF;&#x4E2D;&#x53BB;&#x3002;</p>
<p>&#x6709;&#x56FE;&#x66F4;&#x597D;&#x7406;&#x89E3;&#xFF1A;</p>
<p><img src="/2018/07/27/Springboot2.0&#x4E2D;&#x5C01;&#x88C5;RabbitMQ&#x5230;Maven&#x79C1;&#x670D;/1.png" alt="logo"></p>
<p>&#x65E2;&#x7136;&#x8BF4;&#x5230;MQ&#xFF0C;&#x5219;&#x9700;&#x8981;&#x7B80;&#x5355;&#x7684;&#x4ECB;&#x7ECD;&#x5E76;&#x4E86;&#x89E3;&#x4E00;&#x4E0B;MQ&#x4E86;&#xFF0C;&#x4E0B;&#x6587;&#x6458;&#x81EA;&#x767E;&#x5EA6;&#x767E;&#x79D1;&#xFF1A;</p>
<blockquote>
<p>MQ&#x5168;&#x79F0;&#x4E3A;Message Queue, <a href="https://baike.baidu.com/item/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97" target="_blank" rel="external">&#x6D88;&#x606F;&#x961F;&#x5217;</a>&#xFF08;MQ&#xFF09;&#x662F;&#x4E00;&#x79CD;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5BF9;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x901A;&#x4FE1;&#x65B9;&#x6CD5;&#x3002;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x901A;&#x8FC7;&#x8BFB;&#x5199;&#x51FA;&#x5165;&#x961F;&#x5217;&#x7684;&#x6D88;&#x606F;&#xFF08;&#x9488;&#x5BF9;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x6570;&#x636E;&#xFF09;&#x6765;&#x901A;&#x4FE1;&#xFF0C;&#x800C;&#x65E0;&#x9700;&#x4E13;&#x7528;&#x8FDE;&#x63A5;&#x6765;&#x94FE;&#x63A5;&#x5B83;&#x4EEC;&#x3002;&#x6D88;&#x606F;&#x4F20;&#x9012;&#x6307;&#x7684;&#x662F;&#x7A0B;&#x5E8F;&#x4E4B;&#x95F4;&#x901A;&#x8FC7;&#x5728;&#x6D88;&#x606F;&#x4E2D;&#x53D1;&#x9001;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x901A;&#x8FC7;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x5F7C;&#x6B64;&#x6765;&#x901A;&#x4FE1;&#xFF0C;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x901A;&#x5E38;&#x662F;&#x7528;&#x4E8E;&#x8BF8;&#x5982;<a href="https://baike.baidu.com/item/%E8%BF%9C%E7%A8%8B%E8%BF%87%E7%A8%8B%E8%B0%83%E7%94%A8" target="_blank" rel="external">&#x8FDC;&#x7A0B;&#x8FC7;&#x7A0B;&#x8C03;&#x7528;</a>&#x7684;&#x6280;&#x672F;&#x3002;&#x6392;&#x961F;&#x6307;&#x7684;&#x662F;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x901A;&#x8FC7; &#x961F;&#x5217;&#x6765;&#x901A;&#x4FE1;&#x3002;&#x961F;&#x5217;&#x7684;&#x4F7F;&#x7528;&#x9664;&#x53BB;&#x4E86;&#x63A5;&#x6536;&#x548C;&#x53D1;&#x9001;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x540C;&#x65F6;&#x6267;&#x884C;&#x7684;&#x8981;&#x6C42;&#x3002;&#x5176;&#x4E2D;&#x8F83;&#x4E3A;&#x6210;&#x719F;&#x7684;MQ&#x4EA7;&#x54C1;&#x6709;IBM WEBSPHERE MQ&#x7B49;&#x7B49;&#x3002; </p>
</blockquote>
<p>&#x7ECF;&#x8FC7;&#x5404;&#x79CD;&#x6587;&#x7AE0;&#x7684;&#x5BF9;&#x6BD4;&#x7279;&#x6027;&#x4EE5;&#x53CA;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x7684;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#x7B49;&#x7EFC;&#x5408;&#x5206;&#x6790;&#xFF0C;&#x6700;&#x540E;&#x9009;&#x62E9;&#x4E86;RabbitMQ&#x4F5C;&#x4E3A;&#x6211;&#x4EEC;&#x7684;&#x6D88;&#x606F;&#x961F;&#x5217;&#xFF0C;&#x81F3;&#x4E8E;&#x5BF9;&#x6BD4;&#x7684;&#x6587;&#x7AE0;&#x4E5F;&#x90FD;&#x662F;&#x767E;&#x5EA6;&#x7684;&#xFF0C;&#x6709;&#x5174;&#x8DA3;&#x7684;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x67E5;&#x627E;&#x3002;</p>
<a id="more"></a>
<h2 id="&#x6559;&#x7A0B;">&#x6559;&#x7A0B;</h2><p>RabbitMQ&#x7684;&#x57FA;&#x7840;&#x6559;&#x7A0B;&#x6211;&#x5C31;&#x4E0D;&#x5199;&#x4E86;&#xFF0C;&#x4E5F;&#x662F;&#x8DDF;&#x7740;&#x5F80;&#x4E0A;&#x7684;&#x524D;&#x8F88;&#x5206;&#x4EAB;&#x8FB9;&#x5B66;&#x8FB9;&#x770B;&#x7684;&#xFF0C;&#x5728;&#x8FD9;&#x91CC;&#x6211;&#x5206;&#x4EAB;&#x4E00;&#x4E0B;&#xFF1A;</p>
<p>&#x9996;&#x5148;&#x662F;RabbitMQ&#x7684;&#x5B89;&#x88C5;&#xFF1A;</p>
<p><a href="https://www.cnblogs.com/ericli-ericli/p/5902270.html" target="_blank" rel="external">windows&#x4E0B; &#x5B89;&#x88C5; rabbitMQ &#x53CA;&#x64CD;&#x4F5C;&#x5E38;&#x7528;&#x547D;&#x4EE4;</a></p>
<p><a href="https://my.oschina.net/hncscwc/blog/262246?fromerr=hs1eUWw0" target="_blank" rel="external">Rabbitmq&#x2014;&#x2014;&#x7528;&#x6237;&#x7BA1;&#x7406;</a></p>
<p>&#x5176;&#x6B21;&#x662F;RabbitMQ&#x7684;&#x57FA;&#x7840;&#xFF1A;</p>
<p><a href="http://www.jianshu.com/p/36a328ff8a6b" target="_blank" rel="external">&#x3010;&#x8BD1;&#x3011;RabbitMQ&#x6559;&#x7A0B;&#x4E00;</a> </p>
<p><a href="http://www.jianshu.com/p/37c23ed0a5f1" target="_blank" rel="external">&#x3010;&#x8BD1;&#x3011;RabbitMQ&#x6559;&#x7A0B;&#x4E8C;</a> </p>
<p><a href="http://www.jianshu.com/p/9a5bde4798dd" target="_blank" rel="external">&#x3010;&#x8BD1;&#x3011;RabbitMQ&#x6559;&#x7A0B;&#x4E09;</a> </p>
<p><a href="http://www.jianshu.com/p/c6b922b7c8a5" target="_blank" rel="external">&#x3010;&#x8BD1;&#x3011;RabbitMQ&#x6559;&#x7A0B;&#x56DB;</a> </p>
<p><a href="http://www.jianshu.com/p/603b3e8542c6" target="_blank" rel="external">&#x3010;&#x8BD1;&#x3011;RabbitMQ&#x6559;&#x7A0B;&#x4E94;</a> </p>
<p><a href="http://www.jianshu.com/p/a2f085c669ec" target="_blank" rel="external">&#x3010;&#x8BD1;&#x3011;RabbitMQ&#x6559;&#x7A0B;&#x516D;</a> </p>
<p>&#x7136;&#x540E;&#x5B66;&#x4E60;RabbitMQ&#x4E0E;Springboot&#x7684;&#x96C6;&#x6210;&#xFF1A;</p>
<p><a href="https://blog.csdn.net/ztx114/article/details/78410727" target="_blank" rel="external">springboot(&#x96C6;&#x6210;&#x7BC7;)&#xFF1A;RabbitMQ&#x96C6;&#x6210;&#x8BE6;&#x89E3;</a></p>
<p><a href="https://blog.csdn.net/liaokailin/article/details/49559571" target="_blank" rel="external">spring boot&#x5B9E;&#x6218;(&#x7B2C;&#x5341;&#x4E8C;&#x7BC7;)&#x6574;&#x5408;RabbitMQ</a></p>
<p>&#x6700;&#x540E;&#x5B66;&#x4E60;&#x4E00;&#x4E0B;&#x6D88;&#x606F;&#x6D88;&#x8D39;&#x673A;&#x5236;&#x5728;Springboot&#x4E0B;&#x7684;&#x5B9E;&#x73B0;&#xFF1A;</p>
<p><a href="https://my.oschina.net/xiaominmin/blog/1811978?from=singlemessage" target="_blank" rel="external">&#x5B66;&#x4E60;Spring Boot&#xFF1A;&#xFF08;&#x4E8C;&#x5341;&#x516D;&#xFF09;&#x4F7F;&#x7528; RabbitMQ &#x6D88;&#x606F;&#x961F;&#x5217;&#xFF08;&#x6D88;&#x606F;&#x786E;&#x8BA4;ack,rpc&#xFF09;</a></p>
<h2 id="&#x4E1A;&#x52A1;">&#x4E1A;&#x52A1;</h2><p>&#x5B66;&#x4E60;&#x5B8C;&#x4E0A;&#x9762;&#x7684;&#x6559;&#x7A0B;&#x540E;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x5BF9;&#x4E8E;RabbitMQ&#x7684;&#x57FA;&#x7840;&#x64CD;&#x4F5C;&#x5C31;&#x7B97;&#x662F;&#x4E86;&#x89E3;&#x4E86;&#xFF0C;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x6765;&#x7ED3;&#x5408;&#x6211;&#x4EEC;&#x7684;&#x4E1A;&#x52A1;&#xFF0C;&#x8003;&#x8651;&#x4E00;&#x4E0B;&#x5177;&#x4F53;&#x7684;&#x5B9E;&#x73B0;&#x5185;&#x5BB9;&#x548C;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x52A0;&#x5165;&#x6D88;&#x606F;&#x961F;&#x5217;&#x6700;&#x6838;&#x5FC3;&#x7684;&#x76EE;&#x7684;&#x5C31;&#x662F;&#x8981;&#x505A;&#x4E00;&#x4E2A;&#x57FA;&#x7840;&#x7684;&#x6570;&#x636E;&#x540C;&#x6B65;&#xFF1A;</p>
<blockquote>
<p>&#x5F53;&#x7528;&#x6237;&#x7BA1;&#x7406;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x7528;&#x6237;&#x6709;&#x589E;&#x52A0;&#x3001;&#x5220;&#x9664;&#x3001;&#x4FEE;&#x6539;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6D88;&#x606F;&#x961F;&#x5217;&#x5C06;&#x8BE5;&#x6B21;&#x64CD;&#x4F5C;&#x53D1;&#x7ED9;&#x5BF9;&#x5E94;&#x7684;&#x5B50;&#x7CFB;&#x7EDF;&#xFF0C;&#x5B50;&#x7CFB;&#x7EDF;&#x63A5;&#x5230;&#x8BE5;&#x64CD;&#x4F5C;&#x6307;&#x4EE4;&#x540E;&#xFF0C;&#x540C;&#x6B65;&#x7684;&#x7EF4;&#x62A4;&#x5B50;&#x7CFB;&#x7EDF;&#x7684;&#x7528;&#x6237;&#x8868;&#x5373;&#x53EF;&#x3002;</p>
</blockquote>
<p>&#x65E2;&#x7136;&#x6838;&#x5FC3;&#x76EE;&#x7684;&#x77E5;&#x9053;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&#x5B9E;&#x73B0;&#x5185;&#x5BB9;&#x5C31;&#x662F;&#x5206;&#x522B;&#x8981;&#x5728;&#x7528;&#x6237;&#x7BA1;&#x7406;&#x7CFB;&#x7EDF;&#x4E2D;&#x52A0;&#x5165;&#x4E00;&#x4E2A;MQ&#x7684;&#x6D88;&#x606F;&#x53D1;&#x9001;&#x7AEF;&#x3001;&#x5728;&#x5404;&#x4E2A;&#x5B50;&#x7CFB;&#x7EDF;&#x4E2D;&#x52A0;&#x5165;&#x6D88;&#x606F;&#x7684;&#x63A5;&#x6536;&#x7AEF;&#xFF0C;&#x63A5;&#x6536;&#x7AEF;&#x63A5;&#x6536;&#x5230;&#x6D88;&#x606F;&#x540E;&#x6267;&#x884C;&#x5BF9;&#x5E94;&#x7684;&#x6570;&#x636E;&#x5E93;&#x64CD;&#x4F5C;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x91CC;&#x5176;&#x5B9E;&#x8FD8;&#x9690;&#x85CF;&#x7740;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x968F;&#x7740;&#x5B50;&#x7CFB;&#x7EDF;&#x8D8A;&#x6765;&#x8D8A;&#x591A;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x964D;&#x63A5;&#x6536;&#x7AEF;&#x5C01;&#x88C5;&#x6210;&#x516C;&#x7528;&#x6A21;&#x5757;&#x7684;&#x8BDD;&#xFF0C;&#x5C06;&#x4F1A;&#x9762;&#x4E34;&#x7684;&#x662F;&#x707E;&#x96BE;&#x6027;&#x7684;&#x7EF4;&#x62A4;&#x6210;&#x672C;&#xFF0C;&#x6240;&#x4EE5;&#x8FD8;&#x5FC5;&#x987B;&#x8003;&#x8651;&#x5C06;&#x63A5;&#x6536;&#x7AEF;&#x5C01;&#x88C5;&#x6210;Maven&#x79C1;&#x670D;&#x7684;&#x5305;&#xFF0C;&#x5E76;&#x7EF4;&#x62A4;&#x5176;&#x7248;&#x672C;&#x3002;</p>
<h2 id="&#x5B9E;&#x73B0;">&#x5B9E;&#x73B0;</h2><p>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x8981;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#xFF0C;&#x7528;&#x6765;&#x89C4;&#x8303;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5E38;&#x7528;&#x64CD;&#x4F5C;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@author</span> &#x8D3E;&#x771F;</span><br><span class="line"> * &#x6570;&#x636E;&#x5E93;&#x64CD;&#x4F5C;&#x89C4;&#x8303;&#x7684;&#x5E38;&#x7528;&#x63A5;&#x53E3;&#x5B9A;&#x4E49;</span><br><span class="line"> * <span class="doctag">@param</span> &lt;T&gt;</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IsqlOperation</span>&lt;<span class="title">T</span>&gt; </span>{</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x63A5;&#x5230;&#x6570;&#x636E;&#x6DFB;&#x52A0;&#x7528;&#x6237;</span><br><span class="line">     * <span class="doctag">@param</span> t</span><br><span class="line">     */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">addUser</span><span class="params">(T t)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x63A5;&#x5230;&#x6570;&#x636E;&#x4FEE;&#x6539;&#x7528;&#x6237;</span><br><span class="line">     * <span class="doctag">@param</span> t</span><br><span class="line">     */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">updateUser</span><span class="params">(T t)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x63A5;&#x5230;&#x6570;&#x636E;&#x5220;&#x9664;&#x7528;&#x6237;</span><br><span class="line">     * <span class="doctag">@param</span> t</span><br><span class="line">     */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">deleteUser</span><span class="params">(T t)</span></span>;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x4E4B;&#x540E;&#x6211;&#x4EEC;&#x8981;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x7236;&#x7C7B;&#xFF0C;&#x8FD9;&#x4E2A;&#x7236;&#x7C7B;&#x7528;&#x6765;&#x89C4;&#x8303;&#x64CD;&#x4F5C;&#x6D41;&#x7A0B;&#xFF0C;&#x5E76;&#x8FDE;&#x63A5;RabbitMQ&#x7684;&#x76F8;&#x5173;&#x8BBE;&#x7F6E;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@author</span>  &#x8D3E;&#x771F;</span><br><span class="line"> * &#x8FD9;&#x4E2A;&#x662F;MQ&#x63A5;&#x6536;&#x7C7B;&#x7684;&#x7236;&#x7C7B;</span><br><span class="line"> *</span><br><span class="line"> * */</span></span><br><span class="line"><span class="keyword">public</span>  <span class="class"><span class="keyword">class</span> <span class="title">AbsMessageRecv</span> <span class="keyword">implements</span> <span class="title">ChannelAwareMessageListener</span> </span>{</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log = LoggerFactory.getLogger(AbsMessageRecv.class);</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">final</span> Gson gson =<span class="keyword">new</span> Gson();</span><br><span class="line">    <span class="annotation">@Value</span>(<span class="string">&quot;${mq.queuename}&quot;</span>)</span><br><span class="line">    <span class="keyword">private</span>  String queuename;</span><br><span class="line">   <span class="keyword">public</span>  String commandOrder;</span><br><span class="line">   <span class="keyword">public</span>  String commandBody;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCommandBody</span><span class="params">(String command)</span></span>{</span><br><span class="line">      <span class="keyword">return</span>  MqSplitUtil.SplitCommandBody(command);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCommandOrder</span><span class="params">(String command)</span></span>{</span><br><span class="line">        <span class="keyword">return</span>  MqSplitUtil.SplitCommandOrder(command);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(Message message, Channel channel)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            receive(message);</span><br><span class="line">            channel.basicAck(message.getMessageProperties().getDeliveryTag(), <span class="keyword">false</span>);</span><br><span class="line">        }<span class="keyword">catch</span> (IOException e){</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">(Message message)</span><span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        String messageString=<span class="keyword">new</span> String(message.getBody());</span><br><span class="line">        log.info(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt; receive&#xFF1A; &quot;</span> + messageString);</span><br><span class="line">        commandOrder=<span class="keyword">this</span>.getCommandOrder(messageString);</span><br><span class="line">        commandBody=<span class="keyword">this</span>.getCommandBody(messageString);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SimpleMessageListenerContainer <span class="title">SimpleContainer</span><span class="params">(ConnectionFactory connectionFactory)</span> </span>{</span><br><span class="line">        SimpleMessageListenerContainer container = <span class="keyword">new</span> SimpleMessageListenerContainer();</span><br><span class="line">        container.setConnectionFactory(connectionFactory);</span><br><span class="line">        container.setQueueNames(queuename);</span><br><span class="line">        container.setMessageListener(<span class="keyword">this</span>);</span><br><span class="line">        container.setExposeListenerChannel(<span class="keyword">true</span>);</span><br><span class="line">        container.setMaxConcurrentConsumers(Constant.MAX_CONCURRENT_CONSUMERS);</span><br><span class="line">        container.setConcurrentConsumers(Constant.CONCURRENT_CONSUMERS);</span><br><span class="line">        <span class="comment">// &#x8BBE;&#x7F6E;&#x4E3A;&#x624B;&#x52A8;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A; AUTO&#xFF0C;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;&#x624B;&#x52A8;&#x5E94;&#x7B54; basicack&#xFF0C;&#x5C31;&#x8981;&#x8BBE;&#x7F6E;manual</span></span><br><span class="line">        container.setAcknowledgeMode(AcknowledgeMode.MANUAL);</span><br><span class="line">        <span class="keyword">return</span> container;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x6211;&#x5728;&#x8FD9;&#x91CC;&#x8BB2;&#x6D88;&#x606F;&#x89C4;&#x8303;&#x4E3A;&#x5E26;&#x6D88;&#x606F;&#x5934;&#x548C;&#x6D88;&#x606F;&#x4F53;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x4E2D;&#x95F4;&#x7528; &#x201C;|&#x201D; &#x8FDB;&#x884C;&#x5206;&#x5272;&#xFF0C;&#x6D88;&#x606F;&#x5934;&#x4E3B;&#x8981;&#x653E;&#x7684;&#x662F;&#x64CD;&#x4F5C;&#x5F62;&#x5F0F;&#xFF0C;&#x5982;&#xFF1A;add&#x3001;update&#x548C;delete&#xFF0C;&#x6D88;&#x606F;&#x4F53;&#x653E;&#x7684;&#x5C31;&#x662F;&#x7528;&#x6237;&#x4FE1;&#x606F;&#x7684;bean&#x8F6C;&#x5316;&#x7684;json&#x4E32;&#x4E86;&#x3002;</p>
<p>&#x4E3E;&#x4F8B;&#x6765;&#x8BF4;&#xFF1A;add|{&#x201C;username&#x201D;:&#x201D;jason&#x201D;,&#x201D;password&#x201D;:&#x201D;123456&#x201D;}</p>
<p>&#x4E00;&#x65E6;&#x6D88;&#x606F;&#x683C;&#x5F0F;&#x786E;&#x5B9A;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x9700;&#x8981;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x5DE5;&#x5177;&#x7C7B;&#x6765;&#x5904;&#x7406;&#x8FD9;&#x79CD;&#x6D88;&#x606F;&#x7C7B;&#x578B;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@author</span> &#x8D3E;&#x771F;</span><br><span class="line"> * &#x8D1F;&#x8D23;&#x5904;&#x7406;MQ&#x53D1;&#x9001;&#x8FC7;&#x6765;&#x7684;&#x6D88;&#x606F;</span><br><span class="line"> * &#x5176;&#x683C;&#x5F0F;&#x4E3A;add|{json&#x5BF9;&#x8C61;}</span><br><span class="line"> * &#x6D88;&#x606F;&#x5934;&#x4E3A;add/update/delete&#x5206;&#x522B;&#x4EE3;&#x8868;&#x65B0;&#x589E;&#x3001;&#x4FEE;&#x6539;&#x548C;&#x5220;&#x9664;&#x64CD;&#x4F5C;</span><br><span class="line"> * &#x6D88;&#x606F;&#x4F53;&#x4E3A;json&#x5BF9;&#x8C61; &#x4EE3;&#x8868;&#x7684;&#x662F;&#x67D0;&#x4E2A;&#x7528;&#x6237;&#x7684;&#x7528;&#x6237;&#x4FE1;&#x606F;</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MqSplitUtil</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log = LoggerFactory.getLogger(MqSplitUtil.class);</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">MqSplitUtil</span><span class="params">()</span></span>{</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x4F20;&#x8F93;&#x547D;&#x4EE4;&#x7684;&#x901A;&#x7528;&#x6821;&#x9A8C;&#x89C4;&#x5219;</span><br><span class="line">     * <span class="doctag">@param</span> command</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">checkCommand</span><span class="params">(String command)</span></span>{</span><br><span class="line">        <span class="keyword">if</span>(command==<span class="keyword">null</span>||<span class="string">&quot;&quot;</span>.equals(command)){</span><br><span class="line">            log.error(Constant.MQEXCEPTION_101_INFO+<span class="string">&quot;Command&#x503C;:&quot;</span>+command);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> MQException(Constant.MQEXCEPTION_101_CODE,Constant.MQEXCEPTION_101_INFO);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(!command.contains(<span class="string">&quot;|&quot;</span>)){</span><br><span class="line">            log.error(Constant.MQEXCEPTION_102_INFO+<span class="string">&quot;Command&#x503C;:&quot;</span>+command);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> MQException(Constant.MQEXCEPTION_102_CODE,Constant.MQEXCEPTION_102_INFO);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x83B7;&#x53D6;MQ&#x6D88;&#x606F;&#x7684;&#x6D88;&#x606F;&#x4F53;</span><br><span class="line">     * <span class="doctag">@param</span> command</span><br><span class="line">     * <span class="doctag">@return</span></span><br><span class="line">     */</span></span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">SplitCommandBody</span><span class="params">(String command)</span></span>{</span><br><span class="line">        checkCommand(command);</span><br><span class="line">        <span class="keyword">return</span> command.substring(command.indexOf(<span class="string">&quot;|&quot;</span>)+<span class="number">1</span>, command.length());</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x83B7;&#x53D6;MQ&#x6D88;&#x606F;&#x7684;&#x6D88;&#x606F;&#x5934;</span><br><span class="line">     * <span class="doctag">@param</span> command</span><br><span class="line">     * <span class="doctag">@return</span></span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">static</span> String <span class="title">SplitCommandOrder</span><span class="params">(String command)</span></span>{</span><br><span class="line">        checkCommand(command);</span><br><span class="line">        <span class="keyword">return</span> command.substring(<span class="number">0</span>,command.indexOf(<span class="string">&quot;|&quot;</span>));</span><br><span class="line">    }</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>{</span><br><span class="line">      System.out.println(SplitCommandOrder(<span class="string">&quot;add|{adb@|dddasdcc}&quot;</span>));</span><br><span class="line">      System.out.println(SplitCommandBody(<span class="string">&quot;aaa|{adb@|dddasdcc}&quot;</span>));</span><br><span class="line">    <span class="comment">/*    Gson gson=new Gson();</span><br><span class="line">      User user =new User();</span><br><span class="line">      user.setName(&quot;&#x5F20;&#x4E09;&quot;);</span><br><span class="line">      user.setPassword(&quot;123456&quot;);</span><br><span class="line">      user.setSex(&quot;&#x7537;&quot;);</span><br><span class="line">      System.out.println(gson.toJson(user));*/</span></span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x4E3A;&#x4E86;&#x89C4;&#x8303;&#x7531;&#x4E8E;&#x6D88;&#x606F;&#x4E0D;&#x89C4;&#x8303;&#x5E26;&#x6765;&#x7684;&#x9519;&#x8BEF;&#xFF0C;&#x6211;&#x4E5F;&#x8BBE;&#x7F6E;&#x4E86;&#x4E00;&#x4E2A;&#x57FA;&#x7840;&#x7684;&#x5F02;&#x5E38;&#x7C7B;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * &#x81EA;&#x5B9A;&#x4E49;&#x5F02;&#x5E38;&#x7C7B;(&#x7EE7;&#x627F;&#x8FD0;&#x884C;&#x65F6;&#x5F02;&#x5E38;)</span><br><span class="line"> * <span class="doctag">@author</span> &#x8D3E;&#x771F;</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MQException</span>  <span class="keyword">extends</span>  <span class="title">RuntimeException</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x9519;&#x8BEF;&#x7F16;&#x7801;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> String errorCode;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6D88;&#x606F;&#x662F;&#x5426;&#x4E3A;&#x5C5E;&#x6027;&#x6587;&#x4EF6;&#x4E2D;&#x7684;Key</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> propertiesKey = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6784;&#x9020;&#x4E00;&#x4E2A;&#x57FA;&#x672C;&#x5F02;&#x5E38;.</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@param</span> message</span><br><span class="line">     *            &#x4FE1;&#x606F;&#x63CF;&#x8FF0;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MQException</span><span class="params">(String message)</span></span><br><span class="line">    </span>{</span><br><span class="line">        <span class="keyword">super</span>(message);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6784;&#x9020;&#x4E00;&#x4E2A;&#x57FA;&#x672C;&#x5F02;&#x5E38;.</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@param</span> errorCode</span><br><span class="line">     *            &#x9519;&#x8BEF;&#x7F16;&#x7801;</span><br><span class="line">     * <span class="doctag">@param</span> message</span><br><span class="line">     *            &#x4FE1;&#x606F;&#x63CF;&#x8FF0;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MQException</span><span class="params">(String errorCode, String message)</span></span><br><span class="line">    </span>{</span><br><span class="line">        <span class="keyword">this</span>(errorCode, message, <span class="keyword">true</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6784;&#x9020;&#x4E00;&#x4E2A;&#x57FA;&#x672C;&#x5F02;&#x5E38;.</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@param</span> errorCode</span><br><span class="line">     *            &#x9519;&#x8BEF;&#x7F16;&#x7801;</span><br><span class="line">     * <span class="doctag">@param</span> message</span><br><span class="line">     *            &#x4FE1;&#x606F;&#x63CF;&#x8FF0;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MQException</span><span class="params">(String errorCode, String message, Throwable cause)</span></span><br><span class="line">    </span>{</span><br><span class="line">        <span class="keyword">this</span>(errorCode, message, cause, <span class="keyword">true</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6784;&#x9020;&#x4E00;&#x4E2A;&#x57FA;&#x672C;&#x5F02;&#x5E38;.</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@param</span> errorCode</span><br><span class="line">     *            &#x9519;&#x8BEF;&#x7F16;&#x7801;</span><br><span class="line">     * <span class="doctag">@param</span> message</span><br><span class="line">     *            &#x4FE1;&#x606F;&#x63CF;&#x8FF0;</span><br><span class="line">     * <span class="doctag">@param</span> propertiesKey</span><br><span class="line">     *            &#x6D88;&#x606F;&#x662F;&#x5426;&#x4E3A;&#x5C5E;&#x6027;&#x6587;&#x4EF6;&#x4E2D;&#x7684;Key</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MQException</span><span class="params">(String errorCode, String message, <span class="keyword">boolean</span> propertiesKey)</span></span><br><span class="line">    </span>{</span><br><span class="line">        <span class="keyword">super</span>(message);</span><br><span class="line">        <span class="keyword">this</span>.setErrorCode(errorCode);</span><br><span class="line">        <span class="keyword">this</span>.setPropertiesKey(propertiesKey);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6784;&#x9020;&#x4E00;&#x4E2A;&#x57FA;&#x672C;&#x5F02;&#x5E38;.</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@param</span> errorCode</span><br><span class="line">     *            &#x9519;&#x8BEF;&#x7F16;&#x7801;</span><br><span class="line">     * <span class="doctag">@param</span> message</span><br><span class="line">     *            &#x4FE1;&#x606F;&#x63CF;&#x8FF0;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MQException</span><span class="params">(String errorCode, String message, Throwable cause, <span class="keyword">boolean</span> propertiesKey)</span></span><br><span class="line">    </span>{</span><br><span class="line">        <span class="keyword">super</span>(message, cause);</span><br><span class="line">        <span class="keyword">this</span>.setErrorCode(errorCode);</span><br><span class="line">        <span class="keyword">this</span>.setPropertiesKey(propertiesKey);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6784;&#x9020;&#x4E00;&#x4E2A;&#x57FA;&#x672C;&#x5F02;&#x5E38;.</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@param</span> message</span><br><span class="line">     *            &#x4FE1;&#x606F;&#x63CF;&#x8FF0;</span><br><span class="line">     * <span class="doctag">@param</span> cause</span><br><span class="line">     *            &#x6839;&#x5F02;&#x5E38;&#x7C7B;&#xFF08;&#x53EF;&#x4EE5;&#x5B58;&#x5165;&#x4EFB;&#x4F55;&#x5F02;&#x5E38;&#xFF09;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MQException</span><span class="params">(String message, Throwable cause)</span></span><br><span class="line">    </span>{</span><br><span class="line">        <span class="keyword">super</span>(message, cause);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getErrorCode</span><span class="params">()</span></span><br><span class="line">    </span>{</span><br><span class="line">        <span class="keyword">return</span> errorCode;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setErrorCode</span><span class="params">(String errorCode)</span></span><br><span class="line">    </span>{</span><br><span class="line">        <span class="keyword">this</span>.errorCode = errorCode;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isPropertiesKey</span><span class="params">()</span></span><br><span class="line">    </span>{</span><br><span class="line">        <span class="keyword">return</span> propertiesKey;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPropertiesKey</span><span class="params">(<span class="keyword">boolean</span> propertiesKey)</span></span><br><span class="line">    </span>{</span><br><span class="line">        <span class="keyword">this</span>.propertiesKey = propertiesKey;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x4EE5;&#x53CA;&#x516C;&#x7528;&#x6570;&#x636E;&#x7C7B;,&#x4E3B;&#x8981;&#x653E;&#x7F6E;&#x7684;&#x662F;&#x547D;&#x4EE4;&#x5934;&#x3001;&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#x4EE3;&#x7801;&#x548C;&#x4FE1;&#x606F;&#x4F53;&#x4EE5;&#x53CA;&#x6D88;&#x606F;&#x961F;&#x5217;&#x7684;&#x53C2;&#x6570;&#x8BBE;&#x7F6E;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@author</span>  &#x8D3E;&#x771F;</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Constant</span> </span>{</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x64CD;&#x4F5C;&#x547D;&#x4EE4;&#x5934;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String COMMAND_ADD=<span class="string">&quot;add&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String COMMAND_UPDATE=<span class="string">&quot;update&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String COMMAND_DELETE=<span class="string">&quot;delete&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x5F02;&#x5E38;&#x4FE1;&#x606F;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MQEXCEPTION_101_CODE=<span class="string">&quot;101&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MQEXCEPTION_101_INFO=<span class="string">&quot;MQ&#x6570;&#x636E;&#x4E3A;&#x7A7A;,&#x8BF7;&#x67E5;&#x9A8C;&#xFF01;&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MQEXCEPTION_102_CODE=<span class="string">&quot;102&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MQEXCEPTION_102_INFO=<span class="string">&quot;MQ&#x6570;&#x636E;&#x683C;&#x5F0F;&#x4E0D;&#x5305;&#x542B;&#x5173;&#x952E;&#x7B26;&#x53F7;,&#x8BF7;&#x67E5;&#x9A8C;&#xFF01;&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MQEXCEPTION_103_CODE=<span class="string">&quot;103&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MQEXCEPTION_103_INFO=<span class="string">&quot;&#x627E;&#x4E0D;&#x5230;&#x5BF9;&#x5E94;&#x7684;&#x547D;&#x4EE4;&#x5934;,&#x8BF7;&#x68C0;&#x67E5;&#x53D1;&#x9001;&#x6570;&#x636E;&#xFF01;&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6D88;&#x606F;&#x961F;&#x5217;&#x6700;&#x5927;&#x6D88;&#x8D39;&#x6570;&#x548C;&#x9ED8;&#x8BA4;&#x6D88;&#x8D39;&#x6570;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_CONCURRENT_CONSUMERS=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> CONCURRENT_CONSUMERS=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x961F;&#x5217;&#x662F;&#x5426;&#x6301;&#x4E45;&#x5316;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">boolean</span> QUEUE_DURABLE = <span class="keyword">true</span>;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x4EC5;&#x521B;&#x5EFA;&#x8005;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7684;&#x79C1;&#x6709;&#x961F;&#x5217;&#xFF0C;&#x65AD;&#x5F00;&#x540E;&#x81EA;&#x52A8;&#x5220;&#x9664;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">boolean</span> QUEUE_EXCLUSIVE = <span class="keyword">false</span>;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  &#x5F53;&#x6240;&#x6709;&#x6D88;&#x8D39;&#x5BA2;&#x6237;&#x7AEF;&#x8FDE;&#x63A5;&#x65AD;&#x5F00;&#x540E;&#xFF0C;&#x662F;&#x5426;&#x81EA;&#x52A8;&#x5220;&#x9664;&#x961F;&#x5217;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span>  <span class="keyword">boolean</span> QUEUE_AUTO_DELETE = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x4EA4;&#x6362;&#x5668;&#x662F;&#x5426;&#x6301;&#x4E45;&#x5316;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">boolean</span> EXCHANGE_DURABLE = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x5F53;&#x6240;&#x6709;&#x6D88;&#x8D39;&#x5BA2;&#x6237;&#x7AEF;&#x8FDE;&#x63A5;&#x65AD;&#x5F00;&#x540E;&#xFF0C;&#x662F;&#x5426;&#x81EA;&#x52A8;&#x5220;&#x9664;&#x961F;&#x5217;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span>  <span class="keyword">boolean</span> EXCHANGE_AUTO_DELETE = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x7136;&#x540E;&#x662F;&#x6D88;&#x606F;&#x961F;&#x5217;&#x7684;&#x57FA;&#x7840;&#x8BBE;&#x7F6E;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@author</span> &#x8D3E;&#x771F;</span><br><span class="line"> */</span></span><br><span class="line"><span class="annotation">@Configuration</span></span><br><span class="line"><span class="annotation">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RabbitConfig</span> </span>{</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x961F;&#x5217;&#x540D;&#x79F0;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Value</span>(<span class="string">&quot;${mq.queuename}&quot;</span>)</span><br><span class="line">    <span class="keyword">private</span>  String queuename;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x4EA4;&#x6362;&#x5668;&#x540D;&#x79F0;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Value</span>(<span class="string">&quot;${mq.exchangename}&quot;</span>)</span><br><span class="line">    <span class="keyword">private</span>  String exchangename;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x8DEF;&#x7531;&#x952E;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Value</span>(<span class="string">&quot;${mq.routingkey}&quot;</span>)</span><br><span class="line">    <span class="keyword">private</span>  String routingkey;</span><br><span class="line">  <span class="annotation">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Queue <span class="title">queue</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Queue(queuename, Constant.QUEUE_DURABLE, Constant.QUEUE_EXCLUSIVE, Constant.QUEUE_AUTO_DELETE);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">  <span class="annotation">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> TopicExchange <span class="title">exchange</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> TopicExchange(exchangename, Constant.EXCHANGE_DURABLE, Constant.EXCHANGE_AUTO_DELETE);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">    <span class="annotation">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Binding <span class="title">binding</span><span class="params">(Queue queue, TopicExchange exchange)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queue).to(exchange).with(routingkey);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p> &#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x6211;&#x7528;&#x5230;&#x4E86;&#x81EA;&#x5B9A;&#x4E49;&#x5C5E;&#x6027;&#xFF0C;&#x76EE;&#x7684;&#x662F;&#x5B50;&#x7CFB;&#x7EDF;&#x5F15;&#x7528;&#x8FD9;&#x4E2A;&#x5C01;&#x88C5;&#x5305;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x81EA;&#x5DF1;&#x7684;&#x961F;&#x5217;&#x540D;&#x79F0;&#x3001;&#x4EA4;&#x6362;&#x5668;&#x540D;&#x79F0;&#x548C;&#x8DEF;&#x7531;&#x952E;&#x540D;&#x79F0;&#xFF0C;&#x505A;&#x5230;&#x7075;&#x6D3B;&#x5904;&#x7406;&#x5404;&#x5B50;&#x7CFB;&#x7EDF;&#x7684;&#x5DEE;&#x5F02;&#x6027;(&#x6CE8;&#x610F;&#xFF1A;&#x4E0B;&#x9762;&#x6CE8;&#x91CA;&#x7684;&#x662F;&#x5B50;&#x7CFB;&#x7EDF;&#x9700;&#x8981;&#x5206;&#x522B;&#x8BBE;&#x7F6E;&#x7684;&#x5C5E;&#x6027;)&#xFF1A;</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">spring.rabbitmq.host=192.168.3.134</span><br><span class="line">spring.rabbitmq.port=5672</span><br><span class="line">spring.rabbitmq.username=admin</span><br><span class="line">spring.rabbitmq.password=dhcc_mq</span><br><span class="line"># &#x5F00;&#x542F;&#x786E;&#x8BA4;&#x6D88;&#x606F;&#x662F;&#x5426;&#x5230;&#x8FBE;&#x4EA4;&#x6362;&#x5668;&#xFF0C;&#x9700;&#x8981;&#x8BBE;&#x7F6E;true</span><br><span class="line">spring.rabbitmq.publisher-confirms=true</span><br><span class="line"># &#x5F00;&#x542F;&#x786E;&#x8BA4;&#x6D88;&#x606F;&#x662F;&#x5426;&#x5230;&#x8FBE;&#x961F;&#x5217;&#xFF0C;&#x9700;&#x8981;&#x8BBE;&#x7F6E;true</span><br><span class="line">spring.rabbitmq.publisher-returns=true</span><br><span class="line"></span><br><span class="line">#mq.queuename=com.example.recv1</span><br><span class="line">#mq.exchangename=demo-exchanges1</span><br><span class="line">#mq.routingkey=route-key1</span><br></pre></td></tr></table></figure>
<p>&#x5F53;&#x7136;&#xFF0C;&#x4E3A;&#x4E86;&#x5C06;json&#x4E32;&#x8F6C;&#x5316;&#x4E3A;&#x5BF9;&#x8C61;&#xFF0C;&#x5B50;&#x7CFB;&#x7EDF;&#x672C;&#x5730;&#x8FD8;&#x9700;&#x8981;&#x81EA;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;Bean&#x6765;&#x63A5;&#x6536;&#x6570;&#x636E;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x53EA;&#x662F;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x7684;Bean:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@author</span> &#x8D3E;&#x771F;</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMQUser</span> </span>{</span><br><span class="line"></span><br><span class="line">    String name;</span><br><span class="line">    String password;</span><br><span class="line">    String sex;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x8F85;&#x52A9;&#x5DE5;&#x4F5C;&#x57FA;&#x672C;&#x4E0A;&#x90FD;&#x505A;&#x5B8C;&#x4E86;&#xFF0C;&#x4E0B;&#x9762;&#x662F;&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x4E86;&#xFF0C;&#x6839;&#x636E;&#x6211;&#x7684;&#x8BBE;&#x8BA1;&#xFF0C;&#x5176;&#x5B9E;&#x975E;&#x5E38;&#x7B80;&#x5355;&#x4E86;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x7EE7;&#x627F;AbsMessageRecv&#x7C7B;&#x75C5;&#x5B9E;&#x73B0;IsqlOperation&#x63A5;&#x53E3;&#xFF0C;&#x5E76;&#x4F20;&#x5165;&#x5BF9;&#x5E94;&#x7684;&#x6CDB;&#x578B;&#x7C7B;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF0C;&#x8BF7;&#x53C2;&#x770B;&#x4EE3;&#x7801;&#xFF08;&#x8FD9;&#x4E2A;&#x7C7B;&#x662F;&#x5728;&#x5B50;&#x7CFB;&#x7EDF;&#x4E2D;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x524D;&#x63D0;&#x662F;&#x8981;&#x5C06;&#x6D88;&#x606F;&#x961F;&#x5217;&#x63A5;&#x6536;&#x7AEF;&#x5F15;&#x5165;&#x5230;&#x4F60;&#x7684;&#x9879;&#x76EE;&#x4E2D;&#x53BB;&#xFF09;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MessageRecvImpl</span> <span class="keyword">extends</span> <span class="title">AbsMessageRecv</span> <span class="keyword">implements</span> <span class="title">IsqlOperation</span>&lt;<span class="title">TestMQUser</span>&gt; </span>{</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log = LoggerFactory.getLogger(MessageRecvImpl.class);</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">(Message message)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">           <span class="keyword">super</span>.receive(message);</span><br><span class="line">            <span class="keyword">switch</span> (commandOrder){</span><br><span class="line">                <span class="keyword">case</span> Constant.COMMAND_ADD:</span><br><span class="line">                    addUser(gson.fromJson(commandBody,TestMQUser.class));</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> Constant.COMMAND_UPDATE:</span><br><span class="line">                    updateUser(gson.fromJson(commandBody,TestMQUser.class));</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> Constant.COMMAND_DELETE:</span><br><span class="line">                    deleteUser(gson.fromJson(commandBody,TestMQUser.class));</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">default</span>:</span><br><span class="line">                        log.error(Constant.MQEXCEPTION_103_INFO+<span class="string">&quot;Command Body&#x503C;:&quot;</span>+commandBody);</span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> MQException(Constant.MQEXCEPTION_103_CODE,Constant.MQEXCEPTION_103_INFO);</span><br><span class="line">            }</span><br><span class="line">    }</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">(TestMQUser user)</span> </span>{</span><br><span class="line">        log.info(<span class="string">&quot;&#x65B0;&#x589E;&#x7528;&#x6237;&#xFF1A;&quot;</span>+user.getName());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUser</span><span class="params">(TestMQUser user)</span> </span>{</span><br><span class="line">        log.info(<span class="string">&quot;&#x4FEE;&#x6539;&#x7528;&#x6237;&#xFF1A;&quot;</span>+user.getName());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUser</span><span class="params">(TestMQUser user)</span> </span>{</span><br><span class="line">        log.info(<span class="string">&quot;&#x5220;&#x9664;&#x7528;&#x6237;&#xFF1A;&quot;</span>+user.getName());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x6574;&#x4E2A;&#x903B;&#x8F91;&#x5C31;&#x662F;&#xFF1A;</p>
<blockquote>
<p>&#x7531;&#x4E8E;AbsMessageRecv&#x7236;&#x7C7B;&#x4E2D;&#x7684;container.setMessageListener(this);&#x7684;&#x8BBE;&#x7F6E;&#xFF0C;&#x6240;&#x4EE5;&#x63A5;&#x6536;&#x5230;&#x7684;&#x6D88;&#x606F;&#x4F1A;&#x6700;&#x5148;&#x8FDB;&#x5165;&#x5230;&#x7236;&#x7C7B;&#x4E2D;ChannelAwareMessageListener&#x63A5;&#x53E3;&#x7684;&#x5B9E;&#x73B0;&#x65B9;&#x6CD5;onMessage&#x4E2D;&#xFF0C;&#x5728;&#x8BE5;&#x65B9;&#x6CD5;&#x4E2D;&#x6211;&#x53C8;&#x8C03;&#x7528;&#x4E86;&#x672C;&#x7C7B;&#x7684;receive(Message message)&#x65B9;&#x6CD5;&#x5BF9;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x9996;&#x5148;&#x4F1A;&#x9ED8;&#x8BA4;&#x7684;&#x8C03;&#x7528;MqSplitUtil&#x5DE5;&#x5177;&#x7C7B;&#x5C06;&#x6570;&#x636E;&#x62C6;&#x5206;&#x4E2D;&#x6D88;&#x606F;&#x5934;&#x548C;&#x6D88;&#x606F;&#x4F53;&#xFF0C;&#x7136;&#x540E;&#x5B50;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;MessageRecvImpl&#x7C7B;&#x7531;&#x4E8E;&#x7EE7;&#x627F;&#x4E86;AbsMessageRecv&#x5E76;&#x91CD;&#x5199;&#x4E86;receive(Message message)&#x65B9;&#x6CD5;&#xFF0C;&#x4FBF;&#x53EF;&#x4EE5;&#x5728;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x5185;&#x90E8;&#x5B9E;&#x73B0;&#x76F8;&#x5173;&#x7684;&#x6D88;&#x606F;&#x5934;&#x5224;&#x65AD;&#x903B;&#x8F91;&#xFF0C;&#x5E76;&#x6839;&#x636E;IsqlOperation&#x63A5;&#x53E3;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x65B9;&#x6CD5;&#x6765;&#x5B9E;&#x73B0;&#x5BF9;&#x5E94;&#x7684;&#x6D88;&#x606F;&#x4F53;&#x5165;&#x5E93;&#x64CD;&#x4F5C;&#x3002;</p>
</blockquote>
<h2 id="&#x603B;&#x7ED3;">&#x603B;&#x7ED3;</h2><p>&#x901A;&#x8FC7;&#x5BF9;MQ&#x63A5;&#x6536;&#x7AEF;&#x7684;&#x5C01;&#x88C5;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5FEB;&#x901F;&#x7684;&#x5F15;&#x5165;&#x8BE5;&#x5C01;&#x88C5;&#x67B6;&#x6784;&#xFF0C;&#x4F7F;&#x5B50;&#x7CFB;&#x7EDF;&#x5FEB;&#x901F;&#x7684;&#x5EFA;&#x7ACB;&#x8D77;&#x6570;&#x636E;&#x63A5;&#x6536;&#x529F;&#x80FD;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Java面试手册]]></title>
      <url>http://jasoncool.com/2018/07/27/Java%E9%9D%A2%E8%AF%95%E6%89%8B%E5%86%8C/</url>
      <content type="html"><![CDATA[<p>&#x4ECA;&#x5929;&#x4E4B;&#x6240;&#x4EE5;&#x5206;&#x4EAB;&#x8FD9;&#x5957;&#x9762;&#x8BD5;&#x9898;&#xFF0C;&#x6709;&#x51E0;&#x4E2A;&#x539F;&#x56E0;&#xFF0C;&#x6211;&#x4E2A;&#x4EBA;&#x8BA4;&#x4E3A;&#x4E0D;&#x4E00;&#x5B9A;&#x975E;&#x8981;&#x6362;&#x5DE5;&#x4F5C;&#x4E86;&#x624D;&#x770B;&#x9762;&#x8BD5;&#x9898;&#xFF0C;&#x5E73;&#x65F6;&#x95F2;&#x6687;&#x4E4B;&#x4F59;&#x5C31;&#x5E94;&#x5F53;&#x770B;&#x770B;&#x9762;&#x8BD5;&#x9898;:</p>
<ol>
<li>&#x6709;&#x597D;&#x9898;&#x76EE;&#x53EF;&#x4EE5;&#x5B66;&#x4E60;&#x77E5;&#x8BC6;&#xFF1B;</li>
<li>&#x6709;&#x597D;&#x9898;&#x76EE;&#x53EF;&#x4EE5;&#x7559;&#x7740;&#x9762;&#x8BD5;&#x7528;&#xFF1B;</li>
<li>&#x8865;&#x8DB3;&#x81EA;&#x5DF1;&#x7684;&#x77E5;&#x8BC6;&#x76F2;&#x533A;&#xFF1B;</li>
<li>&#x5B66;&#x4E60;&#x4E86;&#x89E3;&#x884C;&#x4E1A;&#x5185;&#x5173;&#x6CE8;&#x7684;&#x77E5;&#x8BC6;&#x70B9;&#x3002;</li>
</ol>
<p>&#x8FD9;&#x4E2A;&#x9762;&#x8BD5;&#x624B;&#x518C;&#x662F;&#x6211;&#x770B;&#x8FC7;&#x7684;&#x5F88;&#x4E0D;&#x9519;&#x7684;&#x4E00;&#x4E2A;&#xFF0C;&#x4F5C;&#x8005;&#x662F;&#xFF1A;WebFuse,&#x4ED6;&#x7684;&#x535A;&#x5BA2;&#x662F;&#xFF1A;<a href="http://webfuse.cn/" target="_blank" rel="external">http://webfuse.cn/</a></p>
<p>&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x4ED6;&#x7684;&#x5185;&#x5BB9;&#x5427;&#xFF1A;</p>
<a id="more"></a>
<p>&#x300A;Java&#x9762;&#x8BD5;&#x624B;&#x518C;&#x300B;&#x6574;&#x7406;&#x4E86;&#x4ECE;&#x4E1A;&#x5230;&#x73B0;&#x5728;&#x770B;&#x5230;&#x7684;&#x3001;&#x7ECF;&#x5386;&#x8FC7;&#x7684;&#x4E00;&#x4E9B;Java&#x9762;&#x8BD5;&#x9898;&#x3002;</p>
<p>&#x4E3B;&#x8981;&#x53D1;&#x5E03;&#x5728;&#x6211;&#x7684;GitHUb&#x4E0A;&#xFF0C;&#x89C1;&#xFF1A;<a href="https://github.com/guanzhenxing/java_interview_manual" target="_blank" rel="external">Java&#x9762;&#x8BD5;&#x624B;&#x518C;</a></p>
<p>&#x8FD9;&#x4E9B;&#x9762;&#x8BD5;&#x9898;&#x7684;&#x4E3B;&#x8981;&#x6765;&#x6E90;&#x662F;&#x4E00;&#x4E9B;&#x7F51;&#x7AD9;&#x8FD8;&#x6709;github&#x4E0A;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x7531;&#x4E8E;&#x5E73;&#x5E38;&#x5728;&#x6536;&#x85CF;&#x5230;&#x201C;&#x5370;&#x8C61;&#x7B14;&#x8BB0;&#x201D;&#x4E2D;&#x7684;&#x65F6;&#x5019;&#x6CA1;&#x6709;&#x4FDD;&#x7559;&#x6765;&#x6E90;&#x51FA;&#x5904;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x4ECB;&#x610F;&#x7248;&#x6743;&#x7684;&#x53EF;&#x4EE5;&#x8054;&#x7CFB;&#x6211;&#x3002;</p>
<p>&#x4E3B;&#x8981;&#x5206;&#x4E3A;&#x4EE5;&#x4E0B;&#x90E8;&#x5206;&#xFF1A;</p>
<ul>
<li>Java&#x57FA;&#x7840;<ul>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/java-basic/oop.md" target="_blank" rel="external">&#x9762;&#x5411;&#x5BF9;&#x8C61;</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/java-basic/basic.md" target="_blank" rel="external">&#x57FA;&#x7840;</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/java-basic/collections.md" target="_blank" rel="external">&#x96C6;&#x5408;</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/java-basic/multithread.md" target="_blank" rel="external">&#x591A;&#x7EBF;&#x7A0B;</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/java-basic/jvm.md" target="_blank" rel="external">JVM</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/java-basic/nio.md" target="_blank" rel="external">NIO</a></li>
</ul>
</li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/design-pattern/index.md" target="_blank" rel="external">&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;</a></li>
<li>&#x6570;&#x636E;&#x7ED3;&#x6784;&#x4E0E;&#x7B97;&#x6CD5;<ul>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/data-structures-and-algorithms/algorithms.md" target="_blank" rel="external">&#x7B97;&#x6CD5;</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/data-structures-and-algorithms/data-structures.md" target="_blank" rel="external">&#x6570;&#x636E;&#x7ED3;&#x6784;</a></li>
</ul>
</li>
<li>JavaWeb<ul>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/java-web/http.md" target="_blank" rel="external">HTTP&#x57FA;&#x7840;</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/java-web/java-web-basic.md" target="_blank" rel="external">JavaWeb&#x57FA;&#x7840;</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/java-web/spring.md" target="_blank" rel="external">Spring&#x7CFB;&#x5217;</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/java-web/mybatis.md" target="_blank" rel="external">MyBatis</a></li>
<li>Hibernate</li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/java-web/tomcat.md" target="_blank" rel="external">Tomcat</a></li>
</ul>
</li>
<li>&#x6570;&#x636E;&#x5E93;&#x4E0E;&#x7F13;&#x5B58;<ul>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/db-cache/db_basic.md" target="_blank" rel="external">&#x6570;&#x636E;&#x5E93;&#x57FA;&#x672C;&#x7406;&#x8BBA;</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/db-cache/cache_basic.md" target="_blank" rel="external">&#x7F13;&#x5B58;&#x57FA;&#x672C;&#x7406;&#x8BBA;</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/db-cacahe/db-index.md" target="_blank" rel="external">&#x6570;&#x636E;&#x5E93;&#x7D22;&#x5F15;</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/db-cache/sharding.md" target="_blank" rel="external">&#x5206;&#x5E93;&#x5206;&#x8868;</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/db-cache/mysql.md" target="_blank" rel="external">MySQL</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/db-cache/mongodb.md" target="_blank" rel="external">MongoDB</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/db-cache/redis.md" target="_blank" rel="external">Redis</a></li>
</ul>
</li>
<li>&#x6D88;&#x606F;&#x961F;&#x5217;<ul>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/mq/basic.md" target="_blank" rel="external">MQ&#x57FA;&#x7840;</a></li>
</ul>
</li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/distributed/index.md" target="_blank" rel="external">&#x5206;&#x5E03;&#x5F0F;</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/mic-service/index.md" target="_blank" rel="external">&#x5FAE;&#x670D;&#x52A1;</a></li>
<li>&#x5B89;&#x5168;&#x548C;&#x6027;&#x80FD;<ul>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/security-performance/security.md" target="_blank" rel="external">&#x5B89;&#x5168;</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/security-performance/performance.md" target="_blank" rel="external">&#x6027;&#x80FD;</a></li>
</ul>
</li>
<li>&#x7F51;&#x7EDC;&#x4E0E;&#x670D;&#x52A1;&#x5668;<ul>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/network-server/network.md" target="_blank" rel="external">&#x8BA1;&#x7B97;&#x673A;&#x7F51;&#x7EDC;</a></li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/network-server/nginx.md" target="_blank" rel="external">Nginx</a></li>
</ul>
</li>
<li>&#x8F6F;&#x4EF6;&#x5DE5;&#x7A0B;<ul>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/software_engineering-server/uml.md" target="_blank" rel="external">UML</a></li>
</ul>
</li>
<li><a href="https://github.com/guanzhenxing/java_interview_manual/blob/master/business/index.md" target="_blank" rel="external">&#x4E1A;&#x52A1;</a></li>
</ul>
<hr>
<p>&#x4E3B;&#x8981;&#x53C2;&#x8003;&#xFF1A;</p>
<ul>
<li><a href="http://blog.720ui.com/2018/java_interview_final/" target="_blank" rel="external">Java&#x9762;&#x8BD5;&#x901A;&#x5173;&#x8981;&#x70B9;&#x6C47;&#x603B;&#x96C6;&#x3010;&#x7EC8;&#x6781;&#x7248;&#x3011;</a></li>
<li><a href="https://github.com/xingshaocheng/architect-awesome" target="_blank" rel="external">&#x300A;&#x540E;&#x7AEF;&#x67B6;&#x6784;&#x5E08;&#x6280;&#x672F;&#x56FE;&#x8C31;&#x300B;</a></li>
<li><code>https://github.com/hadyang/interview</code></li>
<li><code>https://github.com/crossoverJie/Java-Interview</code></li>
<li><a href="https://segmentfault.com/a/1190000012063898" target="_blank" rel="external">&#x540E;&#x53F0;&#x5F00;&#x53D1;&#x5E38;&#x95EE;&#x9762;&#x8BD5;&#x9898;&#x96C6;&#x9526;</a></li>
</ul>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[关于Activiti6的封装设计方案]]></title>
      <url>http://jasoncool.com/2018/06/14/%E5%85%B3%E4%BA%8EActiviti6%E7%9A%84%E5%B0%81%E8%A3%85%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/</url>
      <content type="html"><![CDATA[<h2 id="&#x4F5C;&#x8005;">&#x4F5C;&#x8005;</h2><p>&#x672C;&#x6587;&#x7684;&#x4F5C;&#x8005;&#x662F;&#x6211;&#x90E8;&#x95E8;&#x7684;&#x540C;&#x4E8B;&#xFF1A;&#x51CC;&#x6D77;&#x5929;&#xFF0C;&#x4E00;&#x4E2A;&#x70ED;&#x8877;&#x4E8E;&#x6280;&#x672F;&#x7684;LOLer,&#x5728;Activiti&#x65B9;&#x9762;&#x6709;&#x4E0D;&#x5C11;&#x7ECF;&#x9A8C;&#xFF0C;&#x8FD9;&#x6B21;&#x7684;&#x5C01;&#x88C5;&#x4E5F;&#x662F;&#x57FA;&#x4E8E;&#x6211;&#x4EEC;&#x90E8;&#x95E8;&#x7684;&#x6574;&#x4F53;Web&#x5F00;&#x53D1;&#x6846;&#x67B6;&#x7684;&#x53D1;&#x5C55;&#x76EE;&#x7684;&#x800C;&#x505A;&#x7684;&#x3002;</p>
<h2 id="&#x51FA;&#x73B0;&#x95EE;&#x9898;">&#x51FA;&#x73B0;&#x95EE;&#x9898;</h2><p>&#x5728;&#x4F7F;&#x7528;act&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x4F7F;&#x7528;act&#x65F6;&#x6709;&#x4E9B;&#x5730;&#x65B9;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x4E00;&#x70B9;&#x5305;&#x88C5;&#xFF0C;&#x56E0;&#x4E3A;&#x4E0D;&#x540C;&#x4E1A;&#x52A1;&#x53D1;&#x8D77;&#x6D41;&#x7A0B;&#x5199;&#x5165;&#x7684;&#x4EE3;&#x7801;&#x5374;&#x4E0D;&#x5C3D;&#x76F8;&#x540C;&#xFF0C;&#x4E3A;&#x4E86;&#x9632;&#x6B62;&#x4EE3;&#x7801;&#x7684;&#x574F;&#x5473;&#x9053;&#xFF0C;&#x6211;&#x4EEC;&#x6253;&#x7B97;&#x5BF9;act&#x8FDB;&#x884C;&#x4E00;&#x4E9B;&#x5BF9;&#x5E94;&#x6211;&#x4EEC;&#x516C;&#x53F8;&#x4E1A;&#x52A1;&#x7684;&#x4E00;&#x4E9B;&#x5EF6;&#x4F38;&#xFF0C;&#x4EE5;&#x65B9;&#x4FBF;&#x6211;&#x4EEC;&#x80FD;&#x591F;&#x66F4;&#x52A0;&#x7684;&#x65B9;&#x4FBF;&#x4F7F;&#x7528;</p>
<a id="more"></a>
<h2 id="&#x89E3;&#x51B3;&#x601D;&#x8DEF;">&#x89E3;&#x51B3;&#x601D;&#x8DEF;</h2><p>&#x901A;&#x8FC7;&#x5C06;activit&#x7B80;&#x5355;&#x7684;&#x5C01;&#x88C5;&#x4E00;&#x5C42;&#xFF0C;&#x6253;&#x6210;jar&#x5305;&#x540E;&#x653E;&#x5165;&#x6211;&#x4EEC;&#x7684;maven&#x79C1;&#x670D;&#x4E2D;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x9047;&#x5230;&#x4E86;&#x7B2C;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF1A;&#x5982;&#x4F55;&#x5C01;&#x88C5;activiti&#x3002;&#x3002;&#x3002;</p>
<h2 id="&#x914D;&#x7F6E;activiti">&#x914D;&#x7F6E;activiti</h2><ol>
<li><h4 id="&#x95EE;&#x9898;&#xFF1A;&#x5728;&#x4E00;&#x4E2A;&#x7EAF;&#x51C0;&#x7684;&#x73AF;&#x5883;&#x4E0B;&#x914D;&#x7F6E;activiti&#x5E76;&#x4E14;&#x5C06;&#x91CD;&#x8981;&#x8D44;&#x6E90;&#x914D;&#x7F6E;&#x5916;&#x7F6E;">&#x95EE;&#x9898;&#xFF1A;&#x5728;&#x4E00;&#x4E2A;&#x7EAF;&#x51C0;&#x7684;&#x73AF;&#x5883;&#x4E0B;&#x914D;&#x7F6E;activiti&#x5E76;&#x4E14;&#x5C06;&#x91CD;&#x8981;&#x8D44;&#x6E90;&#x914D;&#x7F6E;&#x5916;&#x7F6E;</h4><blockquote>
<p>&#x5728;&#x7F51;&#x4E0A;&#x627E;&#x7EDD;&#x5927;&#x591A;&#x6570;activiti&#x914D;&#x7F6E;&#x90FD;&#x662F;&#x901A;&#x8FC7;xml&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;&#x4F7F;&#x7528;xml&#x7684;&#x8BDD;&#x5C31;&#x4E0D;&#x80FD;&#x5C06;&#x6570;&#x636E;&#x6E90;&#x653E;&#x5230;&#x5916;&#x9762;&#x52A8;&#x6001;&#x7684;&#x914D;&#x7F6E;&#x4E86;&#xFF08;&#x4E5F;&#x53EF;&#x80FD;&#x662F;&#x6211;&#x592A;&#x6E23;&#xFF0C;&#x6CA1;&#x6709;&#x6DF1;&#x5165;&#x4E86;&#x89E3;&#x7684;&#x9505;&#xFF09;&#xFF0C;&#x6240;&#x4EE5;&#x53EA;&#x80FD;&#x81EA;&#x5DF1;&#x6162;&#x6162;&#x6765;&#x4E86;&#xFF1B;&#x601D;&#x8DEF;&#xFF1A;&#x770B;&#x7740;xml&#x7684;&#x914D;&#x7F6E;&#x5C06;&#x5176;&#x4E2D;&#x7684;&#x7C7B;&#x53D6;&#x51FA;&#x5E76;&#x505A;&#x76F8;&#x5E94;&#x914D;&#x7F6E;</p>
</blockquote>
</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">//&#x5F15;&#x5165;maven</span><br><span class="line"></span><br><span class="line"> &lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.activiti&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;activiti-engine&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;6.0.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.activiti&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;activiti-spring&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;6.0.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//&#x914D;&#x7F6E;act</span><br><span class="line"></span><br><span class="line">//act&#x5F15;&#x64CE;</span><br><span class="line">private ProcessEngine processEngine;</span><br><span class="line">//act&#x5F15;&#x64CE;&#x914D;&#x7F6E;</span><br><span class="line">private SpringProcessEngineConfiguration springProcessEngineConfiguration;</span><br><span class="line">//act&#x5F15;&#x64CE;&#x751F;&#x6210;&#x5DE5;&#x5382;</span><br><span class="line">private ProcessEngineFactoryBean processEngineFactoryBean;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> /**</span><br><span class="line">       * @author lht</span><br><span class="line">       * @doc   &#x521D;&#x59CB;&#x5316;act&#x4E8B;&#x52A1;</span><br><span class="line">       * @date 2018/6/8</span><br><span class="line">       * @param dataSource</span><br><span class="line">       * @return</span><br><span class="line">     */</span><br><span class="line">     private DataSourceTransactionManager initTransactionManager(DataSource dataSource) {</span><br><span class="line">         DataSourceTransactionManager dataSourceTransactionManager = new DataSourceTransactionManager();</span><br><span class="line">         dataSourceTransactionManager.setDataSource(dataSource);</span><br><span class="line">         return dataSourceTransactionManager;</span><br><span class="line">     }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> /**</span><br><span class="line">       * @author lht</span><br><span class="line">       * @doc   &#x83B7;&#x5F97;act&#x5F15;&#x64CE;&#x5B9E;&#x4F8B;</span><br><span class="line">       * @date 2018/6/8</span><br><span class="line">       * @param dataSource</span><br><span class="line">       * @param dataSourceTransactionManager</span><br><span class="line">       * @return</span><br><span class="line">     */</span><br><span class="line">public final ProcessEngine setProcessEngine(DataSource dataSource, DataSourceTransactionManager dataSourceTransactionManager) throws Exception {</span><br><span class="line">     this.springProcessEngineConfiguration.setTransactionManager(dataSourceTransactionManager);</span><br><span class="line">     this.springProcessEngineConfiguration.setDataSource(dataSource);</span><br><span class="line">     this.processEngineFactoryBean.setProcessEngineConfiguration(this.springProcessEngineConfiguration);</span><br><span class="line">     this.processEngine = this.processEngineFactoryBean.getObject();</span><br><span class="line">     return this.processEngine;</span><br><span class="line"> }</span><br></pre></td></tr></table></figure>
<ol>
<li><h4 id="&#x907F;&#x514D;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x6E90;&#x751F;&#x591A;&#x4E2A;&#x6D41;&#x7A0B;&#x5F15;&#x64CE;&#xFF0C;&#x5C06;&#x6D41;&#x7A0B;&#x5F15;&#x64CE;&#x85CF;&#x5728;&#x4E86;ActSpringFactory&#x7C7B;&#x4E2D;&#xFF0C;&#x7528;&#x4EE5;&#x751F;&#x6210;act&#x5E38;&#x7528;&#x7684;&#x65B9;&#x6CD5;">&#x907F;&#x514D;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x6E90;&#x751F;&#x591A;&#x4E2A;&#x6D41;&#x7A0B;&#x5F15;&#x64CE;&#xFF0C;&#x5C06;&#x6D41;&#x7A0B;&#x5F15;&#x64CE;&#x85CF;&#x5728;&#x4E86;ActSpringFactory&#x7C7B;&#x4E2D;&#xFF0C;&#x7528;&#x4EE5;&#x751F;&#x6210;act&#x5E38;&#x7528;&#x7684;&#x65B9;&#x6CD5;</h4></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActSpringFactory</span> <span class="keyword">implements</span> <span class="title">ProcessEngine</span></span>{</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//act&#x5F15;&#x64CE;</span></span><br><span class="line">    <span class="keyword">private</span> ProcessEngine processEngine;</span><br><span class="line">    <span class="comment">//act&#x914D;&#x7F6E;</span></span><br><span class="line">    <span class="keyword">private</span> CasActConfig casActConfig;</span><br><span class="line">    <span class="comment">//&#x5185;&#x90E8;myBatis&#x7684;sqlSession</span></span><br><span class="line">    <span class="keyword">private</span> SqlSessionTemplate sqlSessionTemplate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ProcessEngine <span class="title">getProcessEngine</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> processEngine;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProcessEngine</span><span class="params">(ProcessEngine processEngine)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.processEngine = processEngine;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SqlSessionTemplate <span class="title">getSqlSessionTemplate</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> sqlSessionTemplate;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSqlSessionTemplate</span><span class="params">(SqlSessionTemplate sqlSessionTemplate)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.sqlSessionTemplate = sqlSessionTemplate;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">      * <span class="doctag">@author</span> lht</span><br><span class="line">      * <span class="doctag">@doc</span>   &#x521B;&#x5EFA;ActSpringFactory</span><br><span class="line">      * <span class="doctag">@date</span> 2018/6/8</span><br><span class="line">      * <span class="doctag">@param</span> dataSource</span><br><span class="line">      * <span class="doctag">@return</span></span><br><span class="line">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ActSpringFactory</span><span class="params">(DataSource dataSource)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.casActConfig = <span class="keyword">new</span> CasActConfig();</span><br><span class="line">        <span class="keyword">try</span>{</span><br><span class="line">            processEngine = casActConfig.setProcessEngine(dataSource);</span><br><span class="line">        }<span class="keyword">catch</span> (Exception e){</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">      * <span class="doctag">@author</span> lht</span><br><span class="line">      * <span class="doctag">@doc</span>   &#x521B;&#x5EFA;ActSpringFactory</span><br><span class="line">      * <span class="doctag">@date</span> 2018/6/8</span><br><span class="line">      * <span class="doctag">@param</span> dataSource</span><br><span class="line">    * <span class="doctag">@param</span> dataSourceTransactionManager</span><br><span class="line">      * <span class="doctag">@return</span></span><br><span class="line">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ActSpringFactory</span><span class="params">(DataSource dataSource, DataSourceTransactionManager dataSourceTransactionManager)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.casActConfig = <span class="keyword">new</span> CasActConfig();</span><br><span class="line">        <span class="keyword">try</span>{</span><br><span class="line">            processEngine = casActConfig.setProcessEngine(dataSource,dataSourceTransactionManager);</span><br><span class="line">        }<span class="keyword">catch</span> (Exception e){</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> RuntimeService <span class="title">getRuntimeService</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> processEngine.getRuntimeService();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> FormService <span class="title">getFormService</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> processEngine.getFormService();</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> HistoryService <span class="title">getHistoryService</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> processEngine.getHistoryService();</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IdentityService <span class="title">getIdentityService</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> processEngine.getIdentityService();</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ManagementService <span class="title">getManagementService</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> processEngine.getManagementService();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DynamicBpmnService <span class="title">getDynamicBpmnService</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> processEngine.getDynamicBpmnService();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ProcessEngineConfiguration <span class="title">getProcessEngineConfiguration</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> processEngine.getProcessEngineConfiguration();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> FormRepositoryService <span class="title">getFormEngineRepositoryService</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> processEngine.getFormEngineRepositoryService();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> org.activiti.form.api.<span class="function">FormService <span class="title">getFormEngineFormService</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> processEngine.getFormEngineFormService();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> processEngine.getName();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>{</span><br><span class="line">        processEngine.close();</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> RepositoryService <span class="title">getRepositoryService</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> processEngine.getRepositoryService();</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> TaskService <span class="title">getTaskService</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> processEngine.getTaskService();</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="&#x5230;&#x8FD9;&#x4E3A;&#x6B62;activiti&#x5C31;&#x7B97;&#x662F;&#x914D;&#x7F6E;&#x597D;&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x8981;&#x7528;&#x7684;&#x8BDD;&#x53EF;&#x4EE5;&#x6253;&#x4E2A;jar&#x5305;&#x76F4;&#x63A5;&#x5C31;&#x4F7F;&#x7528;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x5E76;&#x6CA1;&#x6709;&#x5BF9;activiti&#x7684;&#x529F;&#x80FD;&#x8FDB;&#x884C;&#x6269;&#x5C55;&#xFF0C;&#x4E0B;&#x9762;&#x5C06;&#x5F00;&#x59CB;&#x7B80;&#x5355;&#x7684;&#x8BF4;&#x4E00;&#x4E0B;&#x5F53;&#x521D;&#x9047;&#x5230;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x65F6;&#x7684;&#x60F3;&#x6CD5;&#xFF0C;&#x5728;&#x8FD9;&#x91CC;&#x4E5F;&#x7B97;&#x662F;&#x4E00;&#x4E2A;&#x8BB0;&#x5F55;&#xFF0C;&#x4E0D;&#x81F3;&#x4E8E;&#x51E0;&#x5929;&#x4E4B;&#x540E;&#x5FD8;&#x5F97;&#x4E00;&#x5E72;&#x4E8C;&#x51C0;&#x3002;">&#x5230;&#x8FD9;&#x4E3A;&#x6B62;activiti&#x5C31;&#x7B97;&#x662F;&#x914D;&#x7F6E;&#x597D;&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x8981;&#x7528;&#x7684;&#x8BDD;&#x53EF;&#x4EE5;&#x6253;&#x4E2A;jar&#x5305;&#x76F4;&#x63A5;&#x5C31;&#x4F7F;&#x7528;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x5E76;&#x6CA1;&#x6709;&#x5BF9;activiti&#x7684;&#x529F;&#x80FD;&#x8FDB;&#x884C;&#x6269;&#x5C55;&#xFF0C;&#x4E0B;&#x9762;&#x5C06;&#x5F00;&#x59CB;&#x7B80;&#x5355;&#x7684;&#x8BF4;&#x4E00;&#x4E0B;&#x5F53;&#x521D;&#x9047;&#x5230;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x65F6;&#x7684;&#x60F3;&#x6CD5;&#xFF0C;&#x5728;&#x8FD9;&#x91CC;&#x4E5F;&#x7B97;&#x662F;&#x4E00;&#x4E2A;&#x8BB0;&#x5F55;&#xFF0C;&#x4E0D;&#x81F3;&#x4E8E;&#x51E0;&#x5929;&#x4E4B;&#x540E;&#x5FD8;&#x5F97;&#x4E00;&#x5E72;&#x4E8C;&#x51C0;&#x3002;</h3><h2 id="&#x629B;&#x51FA;&#x95EE;&#x9898;">&#x629B;&#x51FA;&#x95EE;&#x9898;</h2><p>&#x5047;&#x5982;&#xFF0C;&#x73B0;&#x5728;&#x7684;&#x4E1A;&#x52A1;&#x662F;&#x6709;&#x591A;&#x4E2A;&#x6D41;&#x7A0B;&#xFF0C;&#x6BCF;&#x4E2A;&#x6D41;&#x7A0B;&#x90FD;&#x7684;&#x5177;&#x4F53;&#x4E1A;&#x52A1;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x4F46;&#x662F;&#x4ED6;&#x4EEC;&#x53D1;&#x8D77;&#x6D41;&#x7A0B;&#x7684;&#x65B9;&#x5F0F;&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x90FD;&#x662F;&#x5C06;&#x4E1A;&#x52A1;&#x57FA;&#x7840;&#x4FE1;&#x606F;&#x653E;&#x5165;&#x4E00;&#x4E2A;&#x8868;&#x4E2D;&#xFF0C;&#x542F;&#x52A8;&#x6D41;&#x7A0B;&#xFF0C;&#xFF0C;&#x5C06;&#x5176;&#x4E2D;&#x80FD;&#x591F;&#x7B80;&#x5355;&#x5C55;&#x793A;&#x7684;&#x90E8;&#x5206;&#x63D0;&#x51FA;&#x548C;activiti&#x7684;&#x6D41;&#x7A0B;id&#x4E00;&#x8D77;&#x653E;&#x5165;&#x5230;&#x4E00;&#x4E2A;&#x4E2D;&#x5FC3;&#x8868;&#xFF0C;&#x5728;&#x5BA1;&#x6279;&#x65F6;&#x53EA;&#x9700;&#x8981;&#x67E5;&#x8BE2;&#x4E2D;&#x5FC3;&#x8868;&#x5217;&#x51FA;&#x5217;&#x8868;&#xFF0C;&#x5728;&#x5BA1;&#x6279;&#x65F6;&#x5982;&#x679C;&#x9700;&#x8981;&#x67E5;&#x770B;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#xFF0C;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x57FA;&#x672C;&#x4FE1;&#x606F;id&#x53BB;&#x5BF9;&#x5E94;&#x7684;&#x4FE1;&#x606F;&#x8868;&#x67E5;&#x8BE2;&#x3002;&#x5230;&#x8FD9;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x57FA;&#x672C;&#x7684;&#x6D41;&#x7A0B;&#x95ED;&#x73AF;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x95EE;&#x9898;&#x4E5F;&#x51FA;&#x73B0;&#x4E86;<br><img src="/2018/06/14/&#x5173;&#x4E8E;Activiti6&#x7684;&#x5C01;&#x88C5;&#x8BBE;&#x8BA1;&#x65B9;&#x6848;/1.png" alt="logo"></p>
<p>&#x4ECE;&#x56FE;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x867D;&#x7136;&#x6D41;&#x7A0B;&#x4E1A;&#x52A1;&#x4FDD;&#x5B58;&#x7684;&#x6570;&#x636E;&#x90FD;&#x4E0D;&#x76F8;&#x540C;&#xFF0C;&#x4F46;&#x662F;&#x4ED6;&#x4EEC;&#x7684;&#x65B9;&#x5F0F;&#x662F;&#x4E00;&#x6837;&#xFF0C;&#x5F88;&#x660E;&#x663E;&#x7684;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x80FD;&#x591F;&#x8FDB;&#x884C;&#x5408;&#x5E76;&#xFF0C;&#x800C;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x4E2D;&#x7B56;&#x7565;&#x6A21;&#x5F0F;&#x5C31;&#x975E;&#x5E38;&#x7684;&#x5408;&#x9002;&#x8FD9;&#x4E00;&#x4E1A;&#x52A1;&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x56DE;&#x987E;&#x4E00;&#x4E0B;&#x7B56;&#x7565;&#x6A21;&#x5F0F;&#xFF08;&#x5F15;&#x81EA;&#x767E;&#x5EA6;&#x767E;&#x79D1;&#xFF09;&#xFF1A;</p>
<h4 id="&#x5B9A;&#x4E49;&#xFF1A;&#x7B56;&#x7565;&#x6A21;&#x5F0F;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x7B97;&#x6CD5;&#xFF0C;&#x5E76;&#x5C06;&#x6BCF;&#x4E00;&#x4E2A;&#x7B97;&#x6CD5;&#x5C01;&#x88C5;&#x8D77;&#x6765;&#xFF0C;&#x800C;&#x4E14;&#x4F7F;&#x5B83;&#x4EEC;&#x8FD8;&#x53EF;&#x4EE5;&#x76F8;&#x4E92;&#x66FF;&#x6362;&#x3002;&#x7B56;&#x7565;&#x6A21;&#x5F0F;&#x8BA9;&#x7B97;&#x6CD5;&#x72EC;&#x7ACB;&#x4E8E;&#x4F7F;&#x7528;&#x5B83;&#x7684;&#x5BA2;&#x6237;&#x800C;&#x72EC;&#x7ACB;&#x53D8;&#x5316;">&#x5B9A;&#x4E49;&#xFF1A;&#x7B56;&#x7565;&#x6A21;&#x5F0F;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x7B97;&#x6CD5;&#xFF0C;&#x5E76;&#x5C06;&#x6BCF;&#x4E00;&#x4E2A;&#x7B97;&#x6CD5;&#x5C01;&#x88C5;&#x8D77;&#x6765;&#xFF0C;&#x800C;&#x4E14;&#x4F7F;&#x5B83;&#x4EEC;&#x8FD8;&#x53EF;&#x4EE5;&#x76F8;&#x4E92;&#x66FF;&#x6362;&#x3002;&#x7B56;&#x7565;&#x6A21;&#x5F0F;&#x8BA9;&#x7B97;&#x6CD5;&#x72EC;&#x7ACB;&#x4E8E;&#x4F7F;&#x7528;&#x5B83;&#x7684;&#x5BA2;&#x6237;&#x800C;&#x72EC;&#x7ACB;&#x53D8;&#x5316;</h4><h2 id="&#x6D41;&#x7A0B;&#x7B56;&#x7565;&#x7684;&#x8BBE;&#x8BA1;&#x601D;&#x8DEF;">&#x6D41;&#x7A0B;&#x7B56;&#x7565;&#x7684;&#x8BBE;&#x8BA1;&#x601D;&#x8DEF;</h2><ol>
<li><h4 id="&#x9996;&#x5148;&#x6839;&#x636E;&#x7B56;&#x7565;&#x6A21;&#x5F0F;&#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x5B9A;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#xFF0C;&#x662F;&#x6240;&#x6709;&#x5C06;&#x8981;&#x53D1;&#x8D77;&#x6D41;&#x7A0B;&#x7684;dao&#x90FD;&#x8981;&#x53BB;&#x5B9E;&#x73B0;&#x7684;&#x9876;&#x5C42;&#x63A5;&#x53E3;">&#x9996;&#x5148;&#x6839;&#x636E;&#x7B56;&#x7565;&#x6A21;&#x5F0F;&#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x5B9A;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#xFF0C;&#x662F;&#x6240;&#x6709;&#x5C06;&#x8981;&#x53D1;&#x8D77;&#x6D41;&#x7A0B;&#x7684;dao&#x90FD;&#x8981;&#x53BB;&#x5B9E;&#x73B0;&#x7684;&#x9876;&#x5C42;&#x63A5;&#x53E3;</h4></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">  * <span class="doctag">@author</span> lht</span><br><span class="line">  * <span class="doctag">@doc</span>  &#x9876;&#x5C42;&#x63A5;&#x53E3;&#xFF0C;&#x7528;&#x4E8E;&#x4E0D;&#x540C;&#x4E1A;&#x52A1;&#x4E2D;&#x7684;&#x6D41;&#x7A0B;&#x542F;&#x52A8;&#x548C;&#x6570;&#x636E;&#x83B7;&#x53D6;</span><br><span class="line">  * <span class="doctag">@date</span> 2018/6/8</span><br><span class="line">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ActBaseDao</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">ActBaseBean</span>&gt; </span>{</span><br><span class="line">    <span class="comment">//&#x65B0;&#x589E;&#x6570;&#x636E;</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(T t)</span></span>;</span><br><span class="line">    <span class="comment">//&#x83B7;&#x5F97;&#x6570;&#x636E;</span></span><br><span class="line">    <span class="function">List&lt;T&gt; <span class="title">getMsg</span><span class="params">(T t)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<ol>
<li><h4 id="&#x5B9A;&#x4E49;&#x63A5;&#x53E3;&#x540E;&#x53D1;&#x73B0;&#x6570;&#x636E;&#x6765;&#x6E90;&#x4E5F;&#x5FC5;&#x987B;&#x786E;&#x5B9A;&#xFF0C;&#x6240;&#x4EE5;&#x89C4;&#x5B9A;&#x4E86;bean&#x7684;&#x9876;&#x5C42;&#x7236;&#x7C7B;&#x3002;&#x3002;&#x3002;(&#x53EA;&#x662F;&#x5148;&#x653E;&#x4E86;&#x4E00;&#x4E9B;&#x6211;&#x4EEC;&#x4E1A;&#x52A1;&#x4F1A;&#x7528;&#x5230;&#x7684;&#x4E00;&#x4E9B;&#x5E38;&#x7528;&#x53C2;&#x6570;)">&#x5B9A;&#x4E49;&#x63A5;&#x53E3;&#x540E;&#x53D1;&#x73B0;&#x6570;&#x636E;&#x6765;&#x6E90;&#x4E5F;&#x5FC5;&#x987B;&#x786E;&#x5B9A;&#xFF0C;&#x6240;&#x4EE5;&#x89C4;&#x5B9A;&#x4E86;bean&#x7684;&#x9876;&#x5C42;&#x7236;&#x7C7B;&#x3002;&#x3002;&#x3002;(&#x53EA;&#x662F;&#x5148;&#x653E;&#x4E86;&#x4E00;&#x4E9B;&#x6211;&#x4EEC;&#x4E1A;&#x52A1;&#x4F1A;&#x7528;&#x5230;&#x7684;&#x4E00;&#x4E9B;&#x5E38;&#x7528;&#x53C2;&#x6570;)</h4></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">  * <span class="doctag">@author</span> lht</span><br><span class="line">  * <span class="doctag">@doc</span>  &#x57FA;&#x7840;bean&#xFF0C;&#x4E3A;bean&#x7684;&#x9876;&#x5C42;</span><br><span class="line">  * <span class="doctag">@date</span> 2018/6/8</span><br><span class="line">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActBaseBean</span> </span>{</span><br><span class="line">    <span class="comment">//&#x4E1A;&#x52A1;id</span></span><br><span class="line">    <span class="keyword">private</span> String bssId;</span><br><span class="line">    <span class="comment">//&#x6D41;&#x7A0B;id</span></span><br><span class="line">    <span class="keyword">private</span> String actId;</span><br><span class="line">    <span class="comment">//&#x4E1A;&#x52A1;&#x7C7B;&#x578B;</span></span><br><span class="line">    <span class="keyword">private</span> String bssType;</span><br><span class="line">    <span class="comment">//&#x6D41;&#x7A0B;&#x53D1;&#x8D77;&#x4EBA;</span></span><br><span class="line">    <span class="keyword">private</span> String createUser;</span><br><span class="line">    <span class="comment">//&#x7533;&#x8BF7;&#x65F6;&#x95F4;</span></span><br><span class="line">    <span class="keyword">private</span> Date createDate;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//get...  set...  </span></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<ol>
<li><h4 id="&#x5728;&#x5C06;&#x63A5;&#x53E3;&#x548C;bean&#x90FD;&#x914D;&#x7F6E;&#x597D;&#x540E;&#x6211;&#x4EEC;&#x8FD8;&#x8981;&#x8BB2;&#x4ED6;&#x4EEC;&#x7ED9;&#x62FC;&#x88C5;&#x8D77;&#x6765;&#xFF0C;&#x4E0D;&#x7136;&#x662F;&#x6CA1;&#x529E;&#x6CD5;&#x627E;&#x5230;&#x5BF9;&#x5E94;bean&#x7684;&#xFF0C;&#x4E3A;&#x907F;&#x514D;&#x6570;&#x636E;&#x7684;&#x4E0D;&#x7EAF;&#x51C0;&#xFF0C;&#x6240;&#x4EE5;&#x9996;&#x5148;&#x89C4;&#x5B9A;&#x7C7B;dao&#x548C;bean&#x5BF9;&#x5E94;&#x9632;&#x6B62;&#x7684;&#x7C7B;DaoAndBean&#xFF0C;&#x5E76;&#x89C4;&#x5B9A;&#x4E86;&#x8303;&#x56F4;&#xFF1B;&#x7136;&#x540E;&#x662F;&#x5B58;&#x653E;&#x7684;&#x5BB9;&#x5668;ActDaoAndBeanMap&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x4E00;&#x4E2A;map&#xFF0C;&#x53EA;&#x662F;&#x5728;put&#x8FDB;map&#x65F6;&#x7B80;&#x5355;&#x7684;&#x68C0;&#x6D4B;&#x4E86;&#x4E00;&#x4E0B;&#x6570;&#x636E;&#x7684;&#x6B63;&#x786E;&#x6027;&#xFF0C;&#x5E76;&#x4E14;&#x56E0;&#x4E3A;&#x4E0D;&#x80FD;&#x786E;&#x5B9A;&#x4E00;&#x4E2A;&#x4E1A;&#x52A1;&#x7684;&#x6570;&#x636E;&#x8868;&#x7684;&#x6570;&#x91CF;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;bean&#x548C;dao&#x7684;&#x5BF9;&#x5E94;&#x6570;&#x91CF;&#xFF0C;&#x6240;&#x4EE5;&#x505A;&#x6210;&#x4E86;&#x53EF;&#x53D8;&#x53C2;&#x6570;">&#x5728;&#x5C06;&#x63A5;&#x53E3;&#x548C;bean&#x90FD;&#x914D;&#x7F6E;&#x597D;&#x540E;&#x6211;&#x4EEC;&#x8FD8;&#x8981;&#x8BB2;&#x4ED6;&#x4EEC;&#x7ED9;&#x62FC;&#x88C5;&#x8D77;&#x6765;&#xFF0C;&#x4E0D;&#x7136;&#x662F;&#x6CA1;&#x529E;&#x6CD5;&#x627E;&#x5230;&#x5BF9;&#x5E94;bean&#x7684;&#xFF0C;&#x4E3A;&#x907F;&#x514D;&#x6570;&#x636E;&#x7684;&#x4E0D;&#x7EAF;&#x51C0;&#xFF0C;&#x6240;&#x4EE5;&#x9996;&#x5148;&#x89C4;&#x5B9A;&#x7C7B;dao&#x548C;bean&#x5BF9;&#x5E94;&#x9632;&#x6B62;&#x7684;&#x7C7B;DaoAndBean&#xFF0C;&#x5E76;&#x89C4;&#x5B9A;&#x4E86;&#x8303;&#x56F4;&#xFF1B;&#x7136;&#x540E;&#x662F;&#x5B58;&#x653E;&#x7684;&#x5BB9;&#x5668;ActDaoAndBeanMap&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x4E00;&#x4E2A;map&#xFF0C;&#x53EA;&#x662F;&#x5728;put&#x8FDB;map&#x65F6;&#x7B80;&#x5355;&#x7684;&#x68C0;&#x6D4B;&#x4E86;&#x4E00;&#x4E0B;&#x6570;&#x636E;&#x7684;&#x6B63;&#x786E;&#x6027;&#xFF0C;&#x5E76;&#x4E14;&#x56E0;&#x4E3A;&#x4E0D;&#x80FD;&#x786E;&#x5B9A;&#x4E00;&#x4E2A;&#x4E1A;&#x52A1;&#x7684;&#x6570;&#x636E;&#x8868;&#x7684;&#x6570;&#x91CF;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;bean&#x548C;dao&#x7684;&#x5BF9;&#x5E94;&#x6570;&#x91CF;&#xFF0C;&#x6240;&#x4EE5;&#x505A;&#x6210;&#x4E86;&#x53EF;&#x53D8;&#x53C2;&#x6570;</h4></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">  * <span class="doctag">@author</span> lht</span><br><span class="line">  * <span class="doctag">@doc</span>  dao&#x548C;bean&#x6210;&#x5BF9;&#x5B58;&#x653E;&#x7684;&#x5BB9;&#x5668;</span><br><span class="line">  * <span class="doctag">@date</span> 2018/6/8</span><br><span class="line">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DaoAndBean</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">ActBaseBean</span>,<span class="title">K</span> <span class="keyword">extends</span> <span class="title">ActBaseDao</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Class&lt;T&gt; actBean;</span><br><span class="line">    <span class="keyword">private</span> Class&lt;K&gt; actDao;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DaoAndBean</span><span class="params">(Class&lt;T&gt; actBean, Class&lt;K&gt; actDao)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.actBean = actBean;</span><br><span class="line">        <span class="keyword">this</span>.actDao = actDao;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Class&lt;T&gt; <span class="title">getActBean</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> actBean;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Class&lt;K&gt; <span class="title">getActDao</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> actDao;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">  * <span class="doctag">@author</span> lht</span><br><span class="line">  * <span class="doctag">@doc</span> &#x7528;&#x4E8E;&#x5B58;&#x653E;&#x4E1A;&#x52A1;&#x548C;dao&#x548C;bean&#x7684;&#x5173;&#x7CFB;</span><br><span class="line">  * <span class="doctag">@date</span> 2018/6/8</span><br><span class="line">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActDaoAndBeanMap</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String,DaoAndBean[]&gt; map;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ActDaoAndBeanMap</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> DaoAndBean[] put(String bssType, DaoAndBean... daoAndBeans){</span><br><span class="line">        <span class="keyword">for</span>(DaoAndBean daoAndBean:daoAndBeans){</span><br><span class="line">            <span class="keyword">if</span>(!ActBaseDao.class.isAssignableFrom(daoAndBean.getActDao())||!ActBaseBean.class.isAssignableFrom(daoAndBean.getActBean())){</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;Implanting parameter type error&quot;</span>);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> (DaoAndBean[])map.put(bssType,daoAndBeans);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>  DaoAndBean[] get(String bssType){</span><br><span class="line">        <span class="keyword">return</span> (DaoAndBean[]) map.get(bssType);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<ol>
<li><h4 id="&#x6700;&#x540E;&#x7684;&#x7B56;&#x7565;&#x8C03;&#x7528;&#xFF0C;&#x4E24;&#x4E2A;&#x4E3B;&#x8981;&#x65B9;&#x6CD5;&#xFF1A;insert&#x548C;getMsg&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x65B9;&#x5F0F;&#x5C31;&#x662F;&#x5C06;&#x9876;&#x5C42;&#x63A5;&#x53E3;&#x7684;&#x65B9;&#x6CD5;&#x6839;&#x636E;&#x5B58;&#x5165;map&#x7684;&#x914D;&#x5BF9;&#x53D6;&#x51FA;&#x540E;&#xFF0C;&#x5FAA;&#x73AF;&#x7684;&#x6267;&#x884C;&#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x65B9;&#x6CD5;&#x90FD;&#x662F;&#x542F;&#x52A8;&#x6D41;&#x7A0B;&#xFF0C;&#x52A0;&#x5165;&#x4E86;activiti&#x7684;start&#x65B9;&#x5F0F;">&#x6700;&#x540E;&#x7684;&#x7B56;&#x7565;&#x8C03;&#x7528;&#xFF0C;&#x4E24;&#x4E2A;&#x4E3B;&#x8981;&#x65B9;&#x6CD5;&#xFF1A;insert&#x548C;getMsg&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x65B9;&#x5F0F;&#x5C31;&#x662F;&#x5C06;&#x9876;&#x5C42;&#x63A5;&#x53E3;&#x7684;&#x65B9;&#x6CD5;&#x6839;&#x636E;&#x5B58;&#x5165;map&#x7684;&#x914D;&#x5BF9;&#x53D6;&#x51FA;&#x540E;&#xFF0C;&#x5FAA;&#x73AF;&#x7684;&#x6267;&#x884C;&#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x65B9;&#x6CD5;&#x90FD;&#x662F;&#x542F;&#x52A8;&#x6D41;&#x7A0B;&#xFF0C;&#x52A0;&#x5165;&#x4E86;activiti&#x7684;start&#x65B9;&#x5F0F;</h4></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">  * <span class="doctag">@author</span> lht</span><br><span class="line">  * <span class="doctag">@doc</span>   &#x9A71;&#x52A8;actBaseDao&#x5B9E;&#x73B0;</span><br><span class="line">  * <span class="doctag">@date</span> 2018/6/8</span><br><span class="line">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActBaseUtils</span> </span>{</span><br><span class="line"></span><br><span class="line">    ActDaoAndBeanMap actDaoAndBeanMap ;</span><br><span class="line"></span><br><span class="line">    RuntimeService runtimeService;</span><br><span class="line"></span><br><span class="line">    ApplicationContext applicationContext;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">      * <span class="doctag">@author</span> lht</span><br><span class="line">      * <span class="doctag">@doc</span>   &#x521D;&#x59CB;&#x5316;</span><br><span class="line">      * <span class="doctag">@date</span> 2018/6/8</span><br><span class="line">      * <span class="doctag">@param</span> actDaoAndBeanMap</span><br><span class="line">    * <span class="doctag">@param</span> runtimeService</span><br><span class="line">    * <span class="doctag">@param</span> applicationContext</span><br><span class="line">      * <span class="doctag">@return</span></span><br><span class="line">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ActBaseUtils</span><span class="params">(ActDaoAndBeanMap actDaoAndBeanMap, RuntimeService runtimeService, ApplicationContext applicationContext)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.actDaoAndBeanMap = actDaoAndBeanMap;</span><br><span class="line">        <span class="keyword">this</span>.runtimeService = runtimeService;</span><br><span class="line">        <span class="keyword">this</span>.applicationContext = applicationContext;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">      * <span class="doctag">@author</span> lht</span><br><span class="line">      * <span class="doctag">@doc</span>  &#x65B0;&#x589E;&#x4E1A;&#x52A1;&#x6570;&#x636E;</span><br><span class="line">      * <span class="doctag">@date</span> 2018/6/8</span><br><span class="line">      * <span class="doctag">@param</span> bssType &#x4E1A;&#x52A1;&#x7C7B;&#x578B;</span><br><span class="line">    * <span class="doctag">@param</span> beans  &#x6570;&#x636E;</span><br><span class="line">      * <span class="doctag">@return</span></span><br><span class="line">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">insert</span><span class="params">(String bssType, ActBaseBean... beans)</span></span>{</span><br><span class="line">        <span class="comment">//&#x6839;&#x636E;&#x4E1A;&#x52A1;&#x83B7;&#x5F97;&#x5BF9;&#x5E94;dao&#x548C;bean&#xFF0C;&#x6267;&#x884C;&#x65B0;&#x589E;&#x65B9;&#x6CD5;</span></span><br><span class="line">        DaoAndBean[] daoAndBeans = actDaoAndBeanMap.get(bssType);</span><br><span class="line">        <span class="comment">//&#x904D;&#x5386;dao</span></span><br><span class="line">        <span class="keyword">for</span>(DaoAndBean daoAndBean : daoAndBeans){</span><br><span class="line">            ActBaseDao actBaseDao = (ActBaseDao)applicationContext.getBean(daoAndBean.getActDao());</span><br><span class="line">            <span class="comment">//&#x904D;&#x5386;bean&#xFF0C;&#x6267;&#x884C;&#x65B9;&#x6CD5;</span></span><br><span class="line">            <span class="keyword">for</span>(ActBaseBean  o : beans){</span><br><span class="line">                <span class="keyword">if</span>(o.getClass()==daoAndBean.getActBean()){</span><br><span class="line">                    actBaseDao.insert(o);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">      * <span class="doctag">@author</span> lht</span><br><span class="line">      * <span class="doctag">@doc</span>   &#x83B7;&#x5F97;&#x4E1A;&#x52A1;&#x6570;&#x636E;</span><br><span class="line">      * <span class="doctag">@date</span> 2018/6/8</span><br><span class="line">      * <span class="doctag">@param</span> bssType</span><br><span class="line">      * <span class="doctag">@param</span> resultBean  &#x6570;&#x636E;&#x548C;&#x8FD4;&#x56DE;&#x6570;&#x636E;&#x7C7B;&#x578B;</span><br><span class="line">      * <span class="doctag">@return</span></span><br><span class="line">    */</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T extends ActBaseBean&gt; <span class="function">List&lt;T&gt; <span class="title">getMsg</span><span class="params">(String bssType,T resultBean)</span></span>{</span><br><span class="line">        <span class="comment">//&#x6839;&#x636E;&#x4E1A;&#x52A1;&#x83B7;&#x5F97;&#x5BF9;&#x5E94;dao&#x548C;bean&#xFF0C;&#x6267;&#x884C;&#x65B0;&#x589E;&#x65B9;&#x6CD5;</span></span><br><span class="line">        DaoAndBean[] daoAndBeans = actDaoAndBeanMap.get(bssType);</span><br><span class="line">        <span class="comment">//&#x904D;&#x5386;dao&#x83B7;&#x5F97;&#x5BF9;&#x5E94;&#x65B9;&#x6CD5;</span></span><br><span class="line">        <span class="keyword">for</span>(DaoAndBean daoAndBean : daoAndBeans){</span><br><span class="line">            ActBaseDao actBaseDao = (ActBaseDao)applicationContext.getBean(daoAndBean.getActDao());</span><br><span class="line">            <span class="comment">//&#x904D;&#x5386;bean&#xFF0C;&#x6267;&#x884C;&#x65B9;&#x6CD5;</span></span><br><span class="line">            <span class="keyword">if</span>(resultBean.getClass()==daoAndBean.getActBean()){</span><br><span class="line">               <span class="keyword">return</span>  actBaseDao.getMsg(resultBean);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">      * <span class="doctag">@author</span> lht</span><br><span class="line">      * <span class="doctag">@doc</span>   &#x542F;&#x52A8;&#x6D41;&#x7A0B;&#x5E76;&#x65B0;&#x589E;&#x4E1A;&#x52A1;&#x6570;&#x636E;</span><br><span class="line">      * <span class="doctag">@date</span> 2018/6/8</span><br><span class="line">      * <span class="doctag">@param</span> bssType &#x4E1A;&#x52A1;&#x7C7B;&#x578B;</span><br><span class="line">      * <span class="doctag">@param</span> actKey &#x6D41;&#x7A0B;id</span><br><span class="line">      * <span class="doctag">@param</span> beans  &#x6570;&#x636E;</span><br><span class="line">      * <span class="doctag">@return</span></span><br><span class="line">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">startProcess</span><span class="params">(String bssType, String actKey,ActBaseBean... beans)</span></span>{</span><br><span class="line">        insert(bssType,beans);</span><br><span class="line">        <span class="comment">//activiti&#x5F00;&#x542F;&#x6D41;&#x7A0B;</span></span><br><span class="line">        runtimeService.startProcessInstanceByKey(actKey);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">      * <span class="doctag">@author</span> lht</span><br><span class="line">      * <span class="doctag">@doc</span>   &#x542F;&#x52A8;&#x6D41;&#x7A0B;&#x5E76;&#x65B0;&#x589E;&#x4E1A;&#x52A1;&#x6570;&#x636E;</span><br><span class="line">      * <span class="doctag">@date</span> 2018/6/8</span><br><span class="line">      * <span class="doctag">@param</span> bssType &#x4E1A;&#x52A1;&#x7C7B;&#x578B;</span><br><span class="line">      * <span class="doctag">@param</span> actKey  &#x6D41;&#x7A0B;id</span><br><span class="line">      * <span class="doctag">@param</span> bssId &#x4E1A;&#x52A1;id</span><br><span class="line">      * <span class="doctag">@param</span> beans  &#x6570;&#x636E;</span><br><span class="line">      * <span class="doctag">@return</span></span><br><span class="line">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">startProcess</span><span class="params">(String bssType, String actKey,String bssId,ActBaseBean... beans)</span></span>{</span><br><span class="line">        insert(bssType,beans);</span><br><span class="line">        <span class="comment">//activiti&#x5F00;&#x542F;&#x6D41;&#x7A0B;</span></span><br><span class="line">        runtimeService.startProcessInstanceByKey(actKey,bssId);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">      * <span class="doctag">@author</span> lht</span><br><span class="line">      * <span class="doctag">@doc</span>   &#x542F;&#x52A8;&#x6D41;&#x7A0B;&#x5E76;&#x65B0;&#x589E;&#x4E1A;&#x52A1;&#x6570;&#x636E;</span><br><span class="line">      * <span class="doctag">@date</span> 2018/6/8</span><br><span class="line">      * <span class="doctag">@param</span> bssType &#x4E1A;&#x52A1;&#x7C7B;&#x578B;</span><br><span class="line">      * <span class="doctag">@param</span> actKey &#x6D41;&#x7A0B;id</span><br><span class="line">      * <span class="doctag">@param</span> actMap &#x6D41;&#x7A0B;&#x53C2;&#x6570;</span><br><span class="line">      * <span class="doctag">@param</span> beans  &#x6570;&#x636E;</span><br><span class="line">      * <span class="doctag">@return</span></span><br><span class="line">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">startProcess</span><span class="params">(String bssType, String actKey, Map&lt;String,Object&gt; actMap,ActBaseBean... beans)</span></span>{</span><br><span class="line">        insert(bssType,beans);</span><br><span class="line">        <span class="comment">//activiti&#x5F00;&#x542F;&#x6D41;&#x7A0B;</span></span><br><span class="line">        runtimeService.startProcessInstanceByKey(actKey,actMap);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">      * <span class="doctag">@author</span> lht</span><br><span class="line">      * <span class="doctag">@doc</span>   &#x542F;&#x52A8;&#x6D41;&#x7A0B;&#x5E76;&#x65B0;&#x589E;&#x4E1A;&#x52A1;&#x6570;&#x636E;</span><br><span class="line">      * <span class="doctag">@date</span> 2018/6/8</span><br><span class="line">      * <span class="doctag">@param</span> bssType &#x4E1A;&#x52A1;&#x7C7B;&#x578B;</span><br><span class="line">      * <span class="doctag">@param</span> actKey &#x6D41;&#x7A0B;id</span><br><span class="line">      * <span class="doctag">@param</span> bssId &#x4E1A;&#x52A1;id</span><br><span class="line">      * <span class="doctag">@param</span> actMap &#x6D41;&#x7A0B;&#x53C2;&#x6570;</span><br><span class="line">      * <span class="doctag">@param</span> beans   &#x6570;&#x636E;</span><br><span class="line">      * <span class="doctag">@return</span></span><br><span class="line">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">startProcess</span><span class="params">(String bssType, String actKey,String bssId, Map&lt;String,Object&gt; actMap,ActBaseBean... beans)</span></span>{</span><br><span class="line">        insert(bssType,beans);</span><br><span class="line">        <span class="comment">//activiti&#x5F00;&#x542F;&#x6D41;&#x7A0B;</span></span><br><span class="line">        runtimeService.startProcessInstanceByKey(actKey,bssId,actMap);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="&#x597D;&#x4E86;&#xFF0C;&#x5230;&#x8FD9;&#x4E3A;&#x6B62;&#x5C31;&#x5DF2;&#x7ECF;&#x5168;&#x90E8;&#x8BF4;&#x5B8C;&#x6211;&#x7684;&#x4E00;&#x4E9B;&#x60F3;&#x6CD5;&#x4E86;&#xFF0C;&#x76EE;&#x524D;&#x53EA;&#x662F;&#x521A;&#x521A;&#x5199;&#x5B8C;&#xFF0C;&#x8FD8;&#x6CA1;&#x6709;&#x7ECF;&#x8FC7;&#x771F;&#x5B9E;&#x3001;&#x5177;&#x4F53;&#x7684;&#x4E1A;&#x52A1;&#x6D4B;&#x8BD5;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x5B58;&#x5728;&#x4EFB;&#x4F55;&#x95EE;&#x9898;&#xFF0C;&#x672C;&#x4EBA;&#x6982;&#x4E0D;&#x8D1F;&#x8D23;&#x2026;">&#x597D;&#x4E86;&#xFF0C;&#x5230;&#x8FD9;&#x4E3A;&#x6B62;&#x5C31;&#x5DF2;&#x7ECF;&#x5168;&#x90E8;&#x8BF4;&#x5B8C;&#x6211;&#x7684;&#x4E00;&#x4E9B;&#x60F3;&#x6CD5;&#x4E86;&#xFF0C;&#x76EE;&#x524D;&#x53EA;&#x662F;&#x521A;&#x521A;&#x5199;&#x5B8C;&#xFF0C;&#x8FD8;&#x6CA1;&#x6709;&#x7ECF;&#x8FC7;&#x771F;&#x5B9E;&#x3001;&#x5177;&#x4F53;&#x7684;&#x4E1A;&#x52A1;&#x6D4B;&#x8BD5;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x5B58;&#x5728;&#x4EFB;&#x4F55;&#x95EE;&#x9898;&#xFF0C;&#x672C;&#x4EBA;&#x6982;&#x4E0D;&#x8D1F;&#x8D23;&#x2026;</h4><h2 id="&#x518D;&#x52A0;&#x4E0A;&#x4E00;&#x70B9;&#x914D;&#x7F6E;demo">&#x518D;&#x52A0;&#x4E0A;&#x4E00;&#x70B9;&#x914D;&#x7F6E;demo</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActConfig</span> </span>{</span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    DataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    ActSpringFactory actSpringFactory;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * <span class="doctag">@author</span> lht</span><br><span class="line">     * <span class="doctag">@doc</span>   &#x6838;&#x5FC3; &#x914D;&#x7F6E;ProcessEngine</span><br><span class="line">     * <span class="doctag">@date</span> 2018/6/6</span><br><span class="line">     * <span class="doctag">@param</span></span><br><span class="line">     * <span class="doctag">@return</span></span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ActSpringFactory <span class="title">getActSpringFactory</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ActSpringFactory(dataSource);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="annotation">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ActBaseUtils <span class="title">setActDaoAndBeanFactory</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ActBaseUtils(</span><br><span class="line">                getActDaoAndBeanMap(),</span><br><span class="line">                actSpringFactory.getRuntimeService(),</span><br><span class="line">                SpringUtils.getApplicationContext());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x914D;&#x7F6E;&#x5177;&#x4F53;&#x4E1A;&#x52A1;&#x548C;dao&#x3001;bean&#x5173;&#x8054;</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> ActDaoAndBeanMap <span class="title">getActDaoAndBeanMap</span><span class="params">()</span></span>{</span><br><span class="line">        ActDaoAndBeanMap actDaoAndBeanMap = <span class="keyword">new</span> ActDaoAndBeanMap();</span><br><span class="line">        actDaoAndBeanMap.put(<span class="string">&quot;user&quot;</span></span><br><span class="line">                ,<span class="keyword">new</span> DaoAndBean&lt;&gt;(SysUser.class,SysUserMapper.class)</span><br><span class="line">                ,<span class="keyword">new</span> DaoAndBean&lt;&gt;(SysRoleUser.class,SysRoleUserMapper.class));</span><br><span class="line">        <span class="keyword">return</span> actDaoAndBeanMap;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="&#x5982;&#x679C;&#x662F;&#x4F7F;&#x7528;springboot&#x4F5C;&#x4E3A;&#x9879;&#x76EE;&#x57FA;&#x7840;&#x6846;&#x67B6;&#x7684;&#x8BDD;&#xFF0C;&#x4F60;&#x4EEC;&#x9700;&#x8981;&#x8FD9;&#x4E2A;&#xFF08;&#x83B7;&#x53D6;spring&#x7684;ApplicationContext&#xFF09;">&#x5982;&#x679C;&#x662F;&#x4F7F;&#x7528;springboot&#x4F5C;&#x4E3A;&#x9879;&#x76EE;&#x57FA;&#x7840;&#x6846;&#x67B6;&#x7684;&#x8BDD;&#xFF0C;&#x4F60;&#x4EEC;&#x9700;&#x8981;&#x8FD9;&#x4E2A;&#xFF08;&#x83B7;&#x53D6;spring&#x7684;ApplicationContext&#xFF09;</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringUtils</span> <span class="keyword">implements</span> <span class="title">ApplicationContextAware</span> </span>{</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ApplicationContext appCtx;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6B64;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x628A;ApplicationContext&#x5BF9;&#x8C61;inject&#x5230;&#x5F53;&#x524D;&#x7C7B;&#x4E2D;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x6210;&#x5458;&#x53D8;&#x91CF;&#x3002;</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@param</span> applicationContext ApplicationContext &#x5BF9;&#x8C61;.</span><br><span class="line">     * <span class="doctag">@throws</span> BeansException</span><br><span class="line">     * <span class="doctag">@author</span> wangdf</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span> <span class="keyword">throws</span> BeansException </span>{</span><br><span class="line">        appCtx = applicationContext;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x83B7;&#x53D6;ApplicationContext</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@return</span></span><br><span class="line">     * <span class="doctag">@author</span> wangdf</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ApplicationContext <span class="title">getApplicationContext</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> appCtx;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x4FBF;&#x5229;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5E2E;&#x52A9;&#x6211;&#x4EEC;&#x5FEB;&#x901F;&#x5F97;&#x5230;&#x4E00;&#x4E2A;BEAN</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@param</span> beanName bean&#x7684;&#x540D;&#x5B57;</span><br><span class="line">     * <span class="doctag">@return</span> &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;bean&#x5BF9;&#x8C61;</span><br><span class="line">     * <span class="doctag">@author</span> wangdf</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getBean</span><span class="params">(String beanName)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> appCtx.getBean(beanName);</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getBean</span><span class="params">(Class beanClass)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> appCtx.getBean(beanClass);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="&#x518D;&#x6765;&#x4E00;&#x4E2A;&#x67B6;&#x6784;&#x56FE;">&#x518D;&#x6765;&#x4E00;&#x4E2A;&#x67B6;&#x6784;&#x56FE;</h4><p><img src="/2018/06/14/&#x5173;&#x4E8E;Activiti6&#x7684;&#x5C01;&#x88C5;&#x8BBE;&#x8BA1;&#x65B9;&#x6848;/3.png" alt="logo"></p>
<h2 id="&#x6700;&#x540E;&#x9644;&#x4E0A;&#x6E90;&#x7801;&#x548C;demo">&#x6700;&#x540E;&#x9644;&#x4E0A;&#x6E90;&#x7801;&#x548C;demo</h2><p>&#x6E90;&#x7801;&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/lhtGit/MyHandyAct" target="_blank" rel="external">https://github.com/lhtGit/MyHandyAct</a></p>
<p>&#x5BF9;&#x5E94;&#x6D4B;&#x8BD5;&#xFF1A;<a href="https://github.com/lhtGit/MyHandyActDemo" target="_blank" rel="external">https://github.com/lhtGit/MyHandyActDemo</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[搭建Maven私服Nexus3并在IDEA的Springboot项目下使用]]></title>
      <url>http://jasoncool.com/2018/06/05/%E6%90%AD%E5%BB%BAMaven%E7%A7%81%E6%9C%8DNexus3%E5%B9%B6%E5%9C%A8IDEA%E7%9A%84Springboot%E9%A1%B9%E7%9B%AE%E4%B8%8B%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<h2 id="&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x642D;&#x5EFA;maven&#x79C1;&#x670D;&#xFF1F;">&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x642D;&#x5EFA;maven&#x79C1;&#x670D;&#xFF1F;</h2><p>&#x6BD5;&#x7ADF;&#x4E0D;&#x662F;&#x4F20;&#x5947;&#x79C1;&#x670D;&#xFF0C;&#x597D;&#x597D;&#x7684;maven&#x4E0D;&#x7528;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x642D;&#x5EFA;maven&#x79C1;&#x670D;&#x5462;&#xFF1F;&#x5176;&#x5B9E;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x6709;&#x5F88;&#x591A;&#x7B54;&#x6848;&#xFF0C;&#x6211;&#x8FD9;&#x8FB9;&#x642D;&#x5EFA;&#x79C1;&#x670D;&#x7684;&#x76EE;&#x7684;&#x6709;&#x4E24;&#x4E2A;&#xFF1A;</p>
<ol>
<li>&#x5C01;&#x88C5;&#x516C;&#x5171;&#x7C7B;&#x5E93;&#xFF0C;&#x4EE5;&#x5DE5;&#x5177;&#x7C7B;&#x548C;&#x9A8C;&#x8BC1;&#x7C7B;&#x4E3A;&#x4E3B;&#x3002;</li>
<li>&#x5C01;&#x88C5;&#x6743;&#x9650;&#x7CFB;&#x7EDF;&#xFF0C;&#x5C06;&#x6743;&#x9650;&#x7CFB;&#x7EDF;&#x5206;&#x4E3A;&#x5E26;&#x90E8;&#x95E8;&#x7684;&#x5BA1;&#x6279;&#x6743;&#x9650;&#x7CFB;&#x7EDF;&#x548C;&#x4E0D;&#x5E26;&#x90E8;&#x95E8;&#x7684;&#x6D4F;&#x89C8;&#x6743;&#x9650;&#x7CFB;&#x7EDF;&#x4E24;&#x79CD;&#xFF0C;&#x6839;&#x636E;&#x5177;&#x4F53;&#x7684;&#x4E1A;&#x52A1;&#xFF0C;&#x5F15;&#x5165;&#x4E0D;&#x540C;&#x7684;&#x6743;&#x9650;&#x7CFB;&#x7EDF;&#x3002;<a id="more"></a>
<h2 id="&#x5B89;&#x88C5;&#x5E76;&#x542F;&#x52A8;Nexus3(Windows)">&#x5B89;&#x88C5;&#x5E76;&#x542F;&#x52A8;Nexus3(Windows)</h2>&#x7531;&#x4E8E;&#x6211;&#x4EEC;&#x7684;&#x670D;&#x52A1;&#x5668;&#x90FD;&#x662F;windows2008&#x7684;&#x7248;&#x672C;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x8FD9;&#x8FB9;&#x5728;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x4E5F;&#x662F;&#x5B89;&#x88C5;&#x7684;Nexus3&#x7684;Windows&#x7248;&#x3002;<br>&#x5B89;&#x88C5;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</li>
<li>&#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;<a href="http://www.sonatype.com/download-oss-sonatype" target="_blank" rel="external">http://www.sonatype.com/download-oss-sonatype</a><br>&#x7136;&#x540E;&#x9009;&#x62E9;Windows&#x7248;&#x8FDB;&#x884C;&#x4E0B;&#x8F7D;</li>
</ol>
<p><img src="/2018/06/05/&#x642D;&#x5EFA;Maven&#x79C1;&#x670D;Nexus3&#x5E76;&#x5728;IDEA&#x7684;Springboot&#x9879;&#x76EE;&#x4E0B;&#x4F7F;&#x7528;/1.png" alt="logo"></p>
<p>&#x4E0B;&#x8F7D;&#x5B8C;&#x6210;&#x540E;&#x662F;&#x4E00;&#x4E2A;&#x538B;&#x7F29;&#x5305;&#xFF0C;&#x5C06;&#x538B;&#x7F29;&#x5305;&#x8FDB;&#x884C;&#x89E3;&#x538B;&#x3002;</p>
<ul>
<li>&#x8FD9;&#x91CC;&#x6CE8;&#x610F;&#x6709;&#x4E00;&#x4E2A;&#x5751;&#xFF0C;&#x89E3;&#x538B;&#x7684;&#x5730;&#x5740;&#x4E00;&#x5B9A;&#x4E0D;&#x8981;&#x653E;&#x5728;C&#x76D8;&#xFF0C;&#x56E0;&#x4E3A;&#x7CFB;&#x7EDF;&#x76D8;&#x6709;&#x8BFB;&#x5199;&#x6743;&#x9650;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4F1A;&#x5BFC;&#x81F4;&#x542F;&#x52A8;&#x4E0D;&#x6210;&#x529F;&#x62A5;&#x9519;&#xFF0C;&#x6700;&#x597D;&#x5C06;&#x89E3;&#x538B;&#x540E;&#x7684;&#x6587;&#x4EF6;&#x653E;&#x5728;&#x4E00;&#x4E2A;&#x975E;&#x7CFB;&#x7EDF;&#x76D8;&#x4E14;&#x8DEF;&#x5F84;&#x4E0D;&#x542B;&#x4E2D;&#x6587;&#x7684;&#x6587;&#x4EF6;&#x5939;&#x4E2D;&#x3002;</li>
</ul>
<p>&#x7136;&#x540E;&#x6253;&#x5F00;E:\nexus-3.11.0-01-win64\nexus-3.11.0-01&#x76EE;&#x5F55;&#xFF0C;&#x627E;&#x5230;bin&#x6587;&#x4EF6;&#x52A0;&#xFF0C;&#x6309;&#x4F4F;shift&#x952E;&#x5E76;&#x70B9;&#x51FB;&#x9F20;&#x6807;&#x53F3;&#x952E;&#xFF0C;&#x9009;&#x62E9;&#x5728;&#x6B64;&#x5904;&#x6253;&#x5F00;&#x7A97;&#x53E3;&#x547D;&#x4EE4;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8F93;&#x5165;&#x542F;&#x52A8;&#x7684;&#x547D;&#x4EE4;&#xFF1A;</p>
<ul>
<li>nexus.exe/run &#x56DE;&#x8F66;</li>
</ul>
<p>&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x7A97;&#x53E3;&#x5C31;&#x4F1A;&#x5F00;&#x59CB;&#x542F;&#x52A8;&#x9879;&#x76EE;&#xFF0C;&#x5F53;&#x63A7;&#x5236;&#x53F0;&#x663E;&#x793A;&#x201D;&#xFF1A;Started Sonatype Nexus OSS 3.11.0-01&#x201D;&#x65F6;&#x5C31;&#x8BF4;&#x660E;Nexus3&#x7684;&#x670D;&#x52A1;&#x5DF2;&#x7ECF;&#x542F;&#x52A8;&#x4E86;&#x3002;<br>&#x4E4B;&#x540E;&#x5728;&#x6D4F;&#x89C8;&#x5668;&#x5730;&#x5740;&#x680F;&#x8F93;&#x5165;&#xFF1A;<a href="http://localhost:8081" target="_blank" rel="external">http://localhost:8081</a> &#x5C31;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;nexus3&#x7684;&#x670D;&#x52A1;&#x53F0;&#x4E86;&#x3002;</p>
<p><img src="/2018/06/05/&#x642D;&#x5EFA;Maven&#x79C1;&#x670D;Nexus3&#x5E76;&#x5728;IDEA&#x7684;Springboot&#x9879;&#x76EE;&#x4E0B;&#x4F7F;&#x7528;/2.png" alt="logo"><br>&#x70B9;&#x51FB;&#x53F3;&#x4E0A;&#x89D2;&#x7684;Sign In&#x5C31;&#x53EF;&#x4EE5;&#x767B;&#x5F55;&#x8BE5;&#x7BA1;&#x7406;&#x5E73;&#x53F0;&#xFF0C;&#x7BA1;&#x7406;&#x5E73;&#x53F0;&#x9ED8;&#x8BA4;&#x7684;&#x7528;&#x6237;&#x540D;&#x4E3A;admin&#xFF0C;&#x5BC6;&#x7801;&#x4E3A;admin123&#x3002;<br>&#x767B;&#x5F55;&#x4E4B;&#x540E;&#x8FD9;&#x4E2A;&#x7BA1;&#x7406;&#x5E73;&#x53F0;&#x6682;&#x65F6;&#x5C31;&#x53EF;&#x4EE5;&#x653E;&#x5728;&#x90A3;&#x91CC;&#x5907;&#x7528;&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x9700;&#x6C42;&#xFF0C;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x767E;&#x5EA6;&#x4E00;&#x4E0B;&#x5982;&#x4F55;&#x65B0;&#x5EFA;&#x8D26;&#x6237;&#x548C;&#x66F4;&#x6539;&#x9ED8;&#x8BA4;&#x7AEF;&#x53E3;&#x53F7;&#x3002;</p>
<h2 id="&#x57FA;&#x7840;&#x8BF4;&#x660E;&#x548C;&#x76F8;&#x5173;&#x95EE;&#x9898;">&#x57FA;&#x7840;&#x8BF4;&#x660E;&#x548C;&#x76F8;&#x5173;&#x95EE;&#x9898;</h2><p><img src="/2018/06/05/&#x642D;&#x5EFA;Maven&#x79C1;&#x670D;Nexus3&#x5E76;&#x5728;IDEA&#x7684;Springboot&#x9879;&#x76EE;&#x4E0B;&#x4F7F;&#x7528;/5.png" alt="logo"></p>
<ol>
<li>component name&#x7684;&#x4E00;&#x4E9B;&#x8BF4;&#x660E;&#xFF1A;<br> 1&#xFF09; maven-central&#xFF1A;maven&#x4E2D;&#x592E;&#x5E93;&#xFF0C;&#x9ED8;&#x8BA4;&#x4ECE;<a href="https://repo1.maven.org/maven2/&#x62C9;&#x53D6;jar" target="_blank" rel="external">https://repo1.maven.org/maven2/&#x62C9;&#x53D6;jar</a><br> 2&#xFF09; maven-releases&#xFF1A;&#x79C1;&#x5E93;&#x53D1;&#x884C;&#x7248;jar<br> 3&#xFF09;maven-snapshots&#xFF1A;&#x79C1;&#x5E93;&#x5FEB;&#x7167;&#xFF08;&#x8C03;&#x8BD5;&#x7248;&#x672C;&#xFF09;jar<br> 4&#xFF09;maven-public&#xFF1A;&#x4ED3;&#x5E93;&#x5206;&#x7EC4;&#xFF0C;&#x628A;&#x4E0A;&#x9762;&#x4E09;&#x4E2A;&#x4ED3;&#x5E93;&#x7EC4;&#x5408;&#x5728;&#x4E00;&#x8D77;&#x5BF9;&#x5916;&#x63D0;&#x4F9B;&#x670D;&#x52A1;&#xFF0C;&#x5728;&#x672C;&#x5730;maven&#x57FA;&#x7840;&#x914D;&#x7F6E;settings.xml&#x4E2D;&#x4F7F;&#x7528;&#x3002;</li>
<li>Nexus&#x9ED8;&#x8BA4;&#x7684;&#x4ED3;&#x5E93;&#x7C7B;&#x578B;&#x6709;&#x4EE5;&#x4E0B;&#x56DB;&#x79CD;&#xFF1A;<br> 1&#xFF09;group(&#x4ED3;&#x5E93;&#x7EC4;&#x7C7B;&#x578B;)&#xFF1A;&#x53C8;&#x53EB;&#x7EC4;&#x4ED3;&#x5E93;&#xFF0C;&#x7528;&#x4E8E;&#x65B9;&#x4FBF;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x81EA;&#x5DF1;&#x8BBE;&#x5B9A;&#x7684;&#x4ED3;&#x5E93;&#xFF1B;<br> 2&#xFF09;hosted(&#x5BBF;&#x4E3B;&#x7C7B;&#x578B;)&#xFF1A;&#x5185;&#x90E8;&#x9879;&#x76EE;&#x7684;&#x53D1;&#x5E03;&#x4ED3;&#x5E93;&#xFF08;&#x5185;&#x90E8;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#xFF0C;&#x53D1;&#x5E03;&#x4E0A;&#x53BB;&#x5B58;&#x653E;&#x7684;&#x4ED3;&#x5E93;&#xFF09;&#xFF1B;<br> 3&#xFF09;proxy(&#x4EE3;&#x7406;&#x7C7B;&#x578B;)&#xFF1A;&#x4ECE;&#x8FDC;&#x7A0B;&#x4E2D;&#x592E;&#x4ED3;&#x5E93;&#x4E2D;&#x5BFB;&#x627E;&#x6570;&#x636E;&#x7684;&#x4ED3;&#x5E93;&#xFF08;&#x53EF;&#x4EE5;&#x70B9;&#x51FB;&#x5BF9;&#x5E94;&#x7684;&#x4ED3;&#x5E93;&#x7684;Configuration&#x9875;&#x7B7E;&#x4E0B;Remote Storage Location&#x5C5E;&#x6027;&#x7684;&#x503C;&#x5373;&#x88AB;&#x4EE3;&#x7406;&#x7684;&#x8FDC;&#x7A0B;&#x4ED3;&#x5E93;&#x7684;&#x8DEF;&#x5F84;&#xFF09;&#xFF1B;<br> 4&#xFF09;virtual(&#x865A;&#x62DF;&#x7C7B;&#x578B;)&#xFF1A;&#x865A;&#x62DF;&#x4ED3;&#x5E93;&#xFF08;&#x8FD9;&#x4E2A;&#x57FA;&#x672C;&#x7528;&#x4E0D;&#x5230;&#xFF0C;&#x91CD;&#x70B9;&#x5173;&#x6CE8;&#x4E0A;&#x9762;&#x4E09;&#x4E2A;&#x4ED3;&#x5E93;&#x7684;&#x4F7F;&#x7528;&#xFF09;&#xFF1B;</li>
<li>Policy(&#x7B56;&#x7565;):&#x8868;&#x793A;&#x8BE5;&#x4ED3;&#x5E93;&#x4E3A;&#x53D1;&#x5E03;(Release)&#x7248;&#x672C;&#x4ED3;&#x5E93;&#x8FD8;&#x662F;&#x5FEB;&#x7167;(Snapshot)&#x7248;&#x672C;&#x4ED3;&#x5E93;&#xFF1B;</li>
<li>Public Repositories&#x4E0B;&#x7684;&#x4ED3;&#x5E93;<br>1&#xFF09; 3rd party: &#x65E0;&#x6CD5;&#x4ECE;&#x516C;&#x5171;&#x4ED3;&#x5E93;&#x83B7;&#x5F97;&#x7684;&#x7B2C;&#x4E09;&#x65B9;&#x53D1;&#x5E03;&#x7248;&#x672C;&#x7684;&#x6784;&#x4EF6;&#x4ED3;&#x5E93;&#xFF0C;&#x5373;&#x7B2C;&#x4E09;&#x65B9;&#x4F9D;&#x8D56;&#x7684;&#x4ED3;&#x5E93;&#xFF0C;&#x8FD9;&#x4E2A;&#x6570;&#x636E;&#x901A;&#x5E38;&#x662F;&#x7531;&#x5185;&#x90E8;&#x4EBA;&#x5458;&#x81EA;&#x884C;&#x4E0B;&#x8F7D;&#x4E4B;&#x540E;&#x53D1;&#x5E03;&#x4E0A;&#x53BB;&#xFF1B;<br>2&#xFF09;Apache Snapshots: &#x7528;&#x4E86;&#x4EE3;&#x7406;ApacheMaven&#x4ED3;&#x5E93;&#x5FEB;&#x7167;&#x7248;&#x672C;&#x7684;&#x6784;&#x4EF6;&#x4ED3;&#x5E93;<br>3&#xFF09;Central: &#x7528;&#x6765;&#x4EE3;&#x7406;maven&#x4E2D;&#x592E;&#x4ED3;&#x5E93;&#x4E2D;&#x53D1;&#x5E03;&#x7248;&#x672C;&#x6784;&#x4EF6;&#x7684;&#x4ED3;&#x5E93;<br>4&#xFF09;Central M1 shadow: &#x7528;&#x4E8E;&#x63D0;&#x4F9B;&#x4E2D;&#x592E;&#x4ED3;&#x5E93;&#x4E2D;M1&#x683C;&#x5F0F;&#x7684;&#x53D1;&#x5E03;&#x7248;&#x672C;&#x7684;&#x6784;&#x4EF6;&#x955C;&#x50CF;&#x4ED3;&#x5E93;<br>5&#xFF09;Codehaus Snapshots: &#x7528;&#x6765;&#x4EE3;&#x7406;CodehausMaven &#x4ED3;&#x5E93;&#x7684;&#x5FEB;&#x7167;&#x7248;&#x672C;&#x6784;&#x4EF6;&#x7684;&#x4ED3;&#x5E93;<br>6&#xFF09;Releases: &#x5185;&#x90E8;&#x7684;&#x6A21;&#x5757;&#x4E2D;release&#x6A21;&#x5757;&#x7684;&#x53D1;&#x5E03;&#x4ED3;&#x5E93;&#xFF0C;&#x7528;&#x6765;&#x90E8;&#x7F72;&#x7BA1;&#x7406;&#x5185;&#x90E8;&#x7684;&#x53D1;&#x5E03;&#x7248;&#x672C;&#x6784;&#x4EF6;&#x7684;&#x5BBF;&#x4E3B;&#x7C7B;&#x578B;&#x4ED3;&#x5E93;&#xFF1B;release&#x662F;&#x53D1;&#x5E03;&#x7248;&#x672C;&#xFF1B;<br>7&#xFF09;Snapshots:&#x53D1;&#x5E03;&#x5185;&#x90E8;&#x7684;SNAPSHOT&#x6A21;&#x5757;&#x7684;&#x4ED3;&#x5E93;&#xFF0C;&#x7528;&#x6765;&#x90E8;&#x7F72;&#x7BA1;&#x7406;&#x5185;&#x90E8;&#x7684;&#x5FEB;&#x7167;&#x7248;&#x672C;&#x6784;&#x4EF6;&#x7684;&#x5BBF;&#x4E3B;&#x7C7B;&#x578B;&#x4ED3;&#x5E93;&#xFF1B;snapshots&#x662F;&#x5FEB;&#x7167;&#x7248;&#x672C;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x4E0D;&#x7A33;&#x5B9A;&#x7248;&#x672C;<br>&#x6240;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x6784;&#x5EFA;&#x7684;&#x4ED3;&#x5E93;&#x7EC4;&#x4EE3;&#x7406;&#x4ED3;&#x5E93;&#x7684;&#x987A;&#x5E8F;&#x4E3A;&#xFF1A;Releases&#xFF0C;Snapshots&#xFF0C;3rd party&#xFF0C;Central&#x3002;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;oschina&#x653E;&#x5230;Central&#x524D;&#x9762;&#xFF0C;&#x4E0B;&#x8F7D;&#x5305;&#x4F1A;&#x66F4;&#x5FEB;&#x3002;</li>
<li>Nexus&#x9ED8;&#x8BA4;&#x7684;&#x7AEF;&#x53E3;&#x662F;8081&#xFF0C;&#x53EF;&#x4EE5;&#x5728;etc/nexus-default.properties&#x914D;&#x7F6E;&#x4E2D;&#x4FEE;&#x6539;&#x3002;</li>
<li>Nexus&#x9ED8;&#x8BA4;&#x7684;&#x7528;&#x6237;&#x540D;&#x5BC6;&#x7801;&#x662F;admin/admin123</li>
<li>&#x5F53;&#x9047;&#x5230;&#x5947;&#x602A;&#x95EE;&#x9898;&#x65F6;&#xFF0C;&#x91CD;&#x542F;nexus&#xFF0C;&#x91CD;&#x542F;&#x540E;web&#x754C;&#x9762;&#x8981;1&#x5206;&#x949F;&#x5DE6;&#x53F3;&#x540E;&#x624D;&#x80FD;&#x8BBF;&#x95EE;&#x3002;</li>
</ol>
<p>&#x4EE5;&#x4E0A;&#x8FD9;&#x4E9B;&#x63CF;&#x8FF0;&#x548C;&#x95EE;&#x9898;&#xFF0C;&#x5728;&#x4F60;&#x4ECA;&#x540E;&#x7684;&#x4F7F;&#x7528;&#x8FC7;&#x7A0B;&#x4E2D;&#x4E00;&#x5B9A;&#x80FD;&#x7528;&#x5F97;&#x4E0A;&#xFF0C;&#x76EE;&#x524D;&#x6765;&#x8BF4;&#xFF0C;&#x53EF;&#x4EE5;&#x6682;&#x65F6;&#x8FC7;&#x4E00;&#x904D;&#x5BF9;&#x8FD9;&#x4E9B;&#x57FA;&#x7840;&#x77E5;&#x8BC6;&#x6709;&#x4E2A;&#x4E86;&#x89E3;&#x5373;&#x53EF;&#x3002;</p>
<h2 id="&#x914D;&#x7F6E;Maven&#x7684;Settings-xml">&#x914D;&#x7F6E;Maven&#x7684;Settings.xml</h2><p>Settings.xml&#x662F;Maven&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x5176;&#x8DEF;&#x5F84;&#x6709;&#x4E24;&#x4E2A;&#xFF0C;&#x5206;&#x4E3A;&#x5168;&#x5C40;&#x914D;&#x7F6E;&#x548C;&#x7528;&#x6237;&#x914D;&#x7F6E;&#xFF1A;</p>
<ol>
<li>&#x5168;&#x5C40;&#x914D;&#x7F6E;&#x4E3A;&#xFF1A;Maven&#x7684;&#x5B89;&#x88C5;&#x76EE;&#x5F55;/conf/settings.xml</li>
<li>&#x7528;&#x6237;&#x914D;&#x7F6E;&#x4E3A;&#xFF1A;C:\&#x7528;&#x6237;(&#x4F60;&#x7684;&#x7528;&#x6237;&#x540D;).m2\settings.xml<br>&#x5148;&#x5F3A;&#x8C03;&#x4E00;&#x70B9;&#xFF0C;&#x5168;&#x5C40;&#x914D;&#x7F6E;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x9ED8;&#x8BA4;&#x662F;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#xFF0C;&#x9700;&#x8981;&#x7528;&#x6237;&#x81EA;&#x5DF1;&#x624B;&#x52A8;&#x521B;&#x5EFA;&#x3002;</li>
</ol>
<p>&#x5176;&#x8C03;&#x7528;&#x89C4;&#x5219;&#x662F;&#xFF0C;&#x9ED8;&#x8BA4;&#x4F7F;&#x7528;&#x5168;&#x5C40;&#x914D;&#x7F6E;&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;&#x7528;&#x6237;&#x914D;&#x7F6E;&#xFF0C;&#x5219;&#x4F1A;&#x5408;&#x5E76;&#x8FD9;&#x4E24;&#x4E2A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x76F8;&#x540C;&#x7684;&#x914D;&#x7F6E;&#x53C2;&#x6570;&#xFF0C;&#x5219;&#x4F18;&#x5148;&#x4F7F;&#x7528;&#x7528;&#x6237;&#x914D;&#x7F6E;&#x4E2D;&#x7684;&#x53C2;&#x6570;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x6211;&#x7684;Settings.xml&#xFF0C;&#x6211;&#x662F;&#x81EA;&#x5DF1;&#x521B;&#x5EFA;&#x4E86;&#x7528;&#x6237;&#x914D;&#x7F6E;&#x7684;&#xFF1A;<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">settings</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">mirrors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">mirror</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--This sends everything else to /public --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="title">mirrorOf</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">url</span>&gt;</span>http://172.18.18.21:8081/repository/maven-public/<span class="tag">&lt;/<span class="title">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">mirror</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">mirror</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="title">id</span>&gt;</span>repo2<span class="tag">&lt;/<span class="title">id</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="title">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="title">mirrorOf</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="title">name</span>&gt;</span>Human Readable Name for this Mirror.<span class="tag">&lt;/<span class="title">name</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="title">url</span>&gt;</span>http://repo2.maven.org/maven2/<span class="tag">&lt;/<span class="title">url</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="title">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">mirrors</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">profiles</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">profile</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--Enable snapshots for the built in central repo to direct --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--all requests to nexus via the mirror --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">repositories</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">repository</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">id</span>&gt;</span>central<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">url</span>&gt;</span>http://central<span class="tag">&lt;/<span class="title">url</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">releases</span>&gt;</span><span class="tag">&lt;<span class="title">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="title">enabled</span>&gt;</span><span class="tag">&lt;/<span class="title">releases</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">snapshots</span>&gt;</span><span class="tag">&lt;<span class="title">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="title">enabled</span>&gt;</span><span class="tag">&lt;/<span class="title">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">repository</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="title">repositories</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="title">pluginRepositories</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">pluginRepository</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">id</span>&gt;</span>central<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">url</span>&gt;</span>http://central<span class="tag">&lt;/<span class="title">url</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">releases</span>&gt;</span><span class="tag">&lt;<span class="title">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="title">enabled</span>&gt;</span><span class="tag">&lt;/<span class="title">releases</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">snapshots</span>&gt;</span><span class="tag">&lt;<span class="title">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="title">enabled</span>&gt;</span><span class="tag">&lt;/<span class="title">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">pluginRepository</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="title">pluginRepositories</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">profile</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">profiles</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">activeProfiles</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--make the profile active all the time --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">activeProfile</span>&gt;</span>nexus<span class="tag">&lt;/<span class="title">activeProfile</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">activeProfiles</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">pluginGroups</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">pluginGroup</span>&gt;</span>org.sonatype.plugins<span class="tag">&lt;/<span class="title">pluginGroup</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">pluginGroups</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">servers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">server</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="title">username</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">password</span>&gt;</span>admin123<span class="tag">&lt;/<span class="title">password</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">server</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">servers</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="title">settings</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x4E00;&#x4E2A;XML&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x5176;&#x5185;&#x90E8;&#x6709;&#x5F88;&#x591A;&#x6807;&#x7B7E;&#x6765;&#x5B9E;&#x73B0;&#x4E0D;&#x901A;&#x7684;&#x914D;&#x7F6E;&#xFF1A;</p>
<h3 id="Mirrors">Mirrors</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">mirrors</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="title">mirror</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!--This sends everything else to /public --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="title">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="title">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="title">mirrorOf</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="title">url</span>&gt;</span>http://172.18.18.21:8081/repository/maven-public/<span class="tag">&lt;/<span class="title">url</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="title">mirror</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">mirror</span>&gt;</span>  </span><br><span class="line">     <span class="tag">&lt;<span class="title">id</span>&gt;</span>repo2<span class="tag">&lt;/<span class="title">id</span>&gt;</span>  </span><br><span class="line">     <span class="tag">&lt;<span class="title">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="title">mirrorOf</span>&gt;</span>  </span><br><span class="line">     <span class="tag">&lt;<span class="title">name</span>&gt;</span>Human Readable Name for this Mirror.<span class="tag">&lt;/<span class="title">name</span>&gt;</span>  </span><br><span class="line">     <span class="tag">&lt;<span class="title">url</span>&gt;</span>http://repo2.maven.org/maven2/<span class="tag">&lt;/<span class="title">url</span>&gt;</span>  </span><br><span class="line">   <span class="tag">&lt;/<span class="title">mirror</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="title">mirrors</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>&#x955C;&#x50CF;&#x4ED3;&#x5E93;&#xFF0C;&#x5185;&#x90E8;&#x7531;n&#x4E2A;mirror&#x8282;&#x70B9;&#x7EC4;&#x6210;&#x3002;&#x7528;&#x6765;&#x4EE3;&#x66FF;&#x4E2D;&#x592E;&#x4ED3;&#x5E93;&#xFF08;Maven&#x9ED8;&#x8BA4;&#x7684;&#x8FDC;&#x7A0B;&#x4ED3;&#x5E93;&#xFF09;&#xFF0C;&#x7528;&#x4E8E;&#x63D0;&#x5347;&#x4F20;&#x8F93;&#x901F;&#x5EA6;&#x3002;&#x56E0;&#x6B64;&#x6B64;&#x5904;&#x53EF;&#x4EE5;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x955C;&#x50CF;&#xFF0C;&#x4EE5;&#x63D0;&#x5347;&#x6211;&#x4EEC;&#x4E0B;&#x8F7D;&#x7684;&#x901F;&#x5EA6;&#x3002;<br>&#x6211;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x91CC;&#x5C31;&#x5305;&#x542B;&#x4E86;&#x4E24;&#x4E2A;&#x955C;&#x50CF;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;&#x6211;&#x81EA;&#x5DF1;&#x672C;&#x5730;&#x7684;&#x79C1;&#x6709;&#x955C;&#x50CF;&#x5E93;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x5C31;&#x662F;Maven&#x7684;&#x955C;&#x50CF;&#x5E93;&#x3002;</p>
<h3 id="Profiles">Profiles</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">profiles</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">profile</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--Enable snapshots for the built in central repo to direct --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--all requests to nexus via the mirror --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">repositories</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">repository</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">id</span>&gt;</span>central<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">url</span>&gt;</span>http://central<span class="tag">&lt;/<span class="title">url</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">releases</span>&gt;</span><span class="tag">&lt;<span class="title">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="title">enabled</span>&gt;</span><span class="tag">&lt;/<span class="title">releases</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">snapshots</span>&gt;</span><span class="tag">&lt;<span class="title">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="title">enabled</span>&gt;</span><span class="tag">&lt;/<span class="title">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">repository</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="title">repositories</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="title">pluginRepositories</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">pluginRepository</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">id</span>&gt;</span>central<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">url</span>&gt;</span>http://central<span class="tag">&lt;/<span class="title">url</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">releases</span>&gt;</span><span class="tag">&lt;<span class="title">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="title">enabled</span>&gt;</span><span class="tag">&lt;/<span class="title">releases</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">snapshots</span>&gt;</span><span class="tag">&lt;<span class="title">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="title">enabled</span>&gt;</span><span class="tag">&lt;/<span class="title">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">pluginRepository</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="title">pluginRepositories</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">profile</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">profiles</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>&#x7528;&#x4E8E;&#x8986;&#x76D6;&#x5728;&#x4E00;&#x4E2A;POM&#x6216;&#x8005;profiles.xml&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x4EFB;&#x4F55;&#x76F8;&#x540C;id&#x7684;profiles&#x8282;&#x70B9;,&#x8FD9;&#x91CC;&#x7684;&#x4E3B;&#x8981;&#x662F;&#x7528;&#x6765;&#x8BBE;&#x7F6E;nexus&#x670D;&#x52A1;&#x7684;&#x76F8;&#x5173;&#x914D;&#x7F6E;&#x548C;&#x8C03;&#x7528;&#x7684;&#x5E93;&#x7684;&#x3002;</p>
<h3 id="activeProfiles">activeProfiles</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">activeProfiles</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--make the profile active all the time --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">activeProfile</span>&gt;</span>nexus<span class="tag">&lt;/<span class="title">activeProfile</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">activeProfiles</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>activeProfile&#x503C;&#x4E3A;profile&#x4E2D;&#x6240;&#x5B9A;&#x4E49;&#x7684;id&#xFF0C;&#x5728;&#x8FD9;&#x91CC;&#x5B9A;&#x4E49;&#x7684;activeProfile&#x603B;&#x662F;&#x88AB;&#x6FC0;&#x6D3B;.</p>
<h3 id="Servers">Servers</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">servers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">server</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="title">username</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">password</span>&gt;</span>admin123<span class="tag">&lt;/<span class="title">password</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">server</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">servers</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x5185;&#x90E8;&#x7531;n&#x4E2A;server&#x8282;&#x70B9;&#x7EC4;&#x6210;&#x3002;&#x6709;2&#x79CD;&#x914D;&#x7F6E;&#x65B9;&#x5F0F;&#xFF1A;&#x4E00;&#x79CD;&#x662F;&#x901A;&#x8FC7;id&#x5339;&#x914D;&#xFF0C;username&#x548C;password&#x8FDB;&#x884C;&#x8BA4;&#x8BC1;&#x767B;&#x5F55;&#xFF1B;&#x53E6;&#x4E00;&#x79CD;&#x662F;&#x901A;&#x8FC7;id&#x5339;&#x914D;&#x6307;&#x5411;&#x4E00;&#x4E2A;privateKey&#xFF08;&#x79C1;&#x94A5;&#xFF09;&#x548C;&#x4E00;&#x4E2A;passphrase,&#x76EE;&#x524D;&#x8FD9;&#x4E2A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x7B2C;&#x4E00;&#x79CD;&#x9A8C;&#x8BC1;&#x65B9;&#x5F0F;&#x3002;<br>&#x4EE5;&#x4E0A;&#x8FD9;&#x4E9B;&#x5927;&#x6982;&#x5C31;&#x662F;Settings.xml&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x7684;&#x6240;&#x6709;&#x914D;&#x7F6E;&#x53C2;&#x6570;&#x4E86;&#xFF0C;&#x53EA;&#x6709;&#x914D;&#x7F6E;&#x597D;&#x8FD9;&#x91CC;&#xFF0C;&#x4F60;&#x7684;&#x9879;&#x76EE;&#x624D;&#x53EF;&#x4EE5;&#x5F88;&#x597D;&#x7684;&#x548C;Nexus&#x79C1;&#x670D;&#x8FDB;&#x884C;&#x8054;&#x52A8;&#x3002;</p>
<h2 id="&#x9879;&#x76EE;&#x4E0A;&#x4F20;&#x5230;Nexus&#x79C1;&#x670D;">&#x9879;&#x76EE;&#x4E0A;&#x4F20;&#x5230;Nexus&#x79C1;&#x670D;</h2><p>&#x73B0;&#x5728;&#x4F60;&#x7684;&#x57FA;&#x7840;&#x73AF;&#x5883;&#x5DF2;&#x7ECF;&#x51C6;&#x5907;&#x597D;&#x4E86;&#xFF0C;&#x73B0;&#x5728;&#x53EF;&#x4EE5;&#x5C06;&#x9879;&#x76EE;&#x4E0A;&#x4F20;&#x5230;Nexus&#x7684;&#x79C1;&#x670D;&#x4E86;&#xFF0C;&#x5176;&#x4E3B;&#x8981;&#x64CD;&#x4F5C;&#x90FD;&#x96C6;&#x4E2D;&#x5728;&#x9879;&#x76EE;&#x7684;pom.xml&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x73B0;&#x5728;&#x8D34;&#x51FA;&#x6211;&#x7684;&#x9879;&#x76EE;pom&#x6587;&#x4EF6;&#xFF1A;<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">project</span> <span class="attribute">xmlns</span>=<span class="value">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span><br><span class="line">         <span class="attribute">xmlns:xsi</span>=<span class="value">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">         <span class="attribute">xsi:schemaLocation</span>=<span class="value">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="title">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>com.dhcc<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>commonlib<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">defaultGoal</span>&gt;</span>compile<span class="tag">&lt;/<span class="title">defaultGoal</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">version</span>&gt;</span>3.3<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="title">source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="title">source</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="title">target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="title">target</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>maven-resources-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.6<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.6<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="title">skipTests</span>&gt;</span>true<span class="tag">&lt;/<span class="title">skipTests</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">distributionManagement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">name</span>&gt;</span>Releases<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">url</span>&gt;</span>http://172.18.18.21:8081/repository/maven-releases/<span class="tag">&lt;/<span class="title">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">repository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">snapshotRepository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">name</span>&gt;</span>Snapshot<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">url</span>&gt;</span>http://172.18.18.21:8081/repository/maven-snapshots/<span class="tag">&lt;/<span class="title">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">snapshotRepository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">distributionManagement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-web --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>com.google.code.gson<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>gson<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.8.2<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">version</span>&gt;</span>5.0.5.RELEASE<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>javax.validation<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>validation-api<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.0.1.Final<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">version</span>&gt;</span>5.0.5.RELEASE<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--easypoi&#x5BFC;&#x51FA;excel--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.jeecg<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>easypoi-base<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.3.1<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.jeecg<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>easypoi-web<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.3.1<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.jeecg<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>easypoi-annotation<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.3.1<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">project</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x5176;&#x5B9E;&#x5927;&#x90E8;&#x5206;&#x8FD8;&#x662F;&#x9879;&#x76EE;&#x81EA;&#x5E26;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x57FA;&#x7840;&#x4E0A;&#x52A0;&#x5165;&#x4E86;&#x4E00;&#x4E9B;&#x9488;&#x5BF9;&#x79C1;&#x6709;Maven&#x5E93;&#x7684;&#x63D2;&#x4EF6;&#x914D;&#x7F6E;&#xFF1A;<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">build</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">defaultGoal</span>&gt;</span>compile<span class="tag">&lt;/<span class="title">defaultGoal</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">plugins</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">plugin</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="title">version</span>&gt;</span>3.3<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="title">configuration</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="title">source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="title">source</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="title">target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="title">target</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="title">plugin</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">plugin</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>maven-resources-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.6<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="title">plugin</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">plugin</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.6<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="title">configuration</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="title">skipTests</span>&gt;</span>true<span class="tag">&lt;/<span class="title">skipTests</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="title">plugin</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="title">plugins</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">build</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<ol>
<li>defaultGoal:&#x6267;&#x884C;build&#x4EFB;&#x52A1;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x76EE;&#x6807;&#xFF0C;&#x5C06;&#x4F7F;&#x7528;&#x7684;&#x9ED8;&#x8BA4;&#x503C;&#xFF0C;&#x5982;&#xFF1A;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x6267;&#x884C;mvn&#xFF0C;&#x5219;&#x76F8;&#x5F53;&#x4E8E;&#x6267;&#x884C;mvn install&#xFF1B;</li>
<li>maven-compiler-plugin:&#x6307;&#x5B9A;&#x9879;&#x76EE;&#x6E90;&#x7801;&#x7684;JDK&#x7248;&#x672C;&#x548C;&#x7F16;&#x8BD1;&#x540E;&#x7684;JDK&#x7248;&#x672C;&#xFF0C;&#x4EE5;&#x53CA;&#x7F16;&#x7801;&#x7B49;&#x3002;</li>
<li>maven-surefire-plugin:surefire &#x63D2;&#x4EF6;&#x7528;&#x6765;&#x5728;maven&#x6784;&#x5EFA;&#x751F;&#x547D;&#x5468;&#x671F;&#x7684;test phase&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x7684;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#x3002;<br>&#x5982;&#x679C;&#x53D1;&#x751F;# org.apache.maven.plugins:maven-surefire-plugin:2.7.1:test (default-test) on project&#x7684;&#x9519;&#x8BEF;&#xFF0C;&#x8BB0;&#x5F97;&#x52A0;&#x4E0A;<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">skipTests</span>&gt;</span>true<span class="tag">&lt;/<span class="title">skipTests</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>&#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x914D;&#x7F6E;&#x5C31;&#x662F;&#x548C;Maven&#x79C1;&#x6709;&#x5E93;&#x8FDE;&#x63A5;&#x4E86;&#xFF1A;<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="title">distributionManagement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">name</span>&gt;</span>Releases<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">url</span>&gt;</span>http://172.18.18.21:8081/repository/maven-releases/<span class="tag">&lt;/<span class="title">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">repository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">snapshotRepository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">name</span>&gt;</span>Snapshot<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">url</span>&gt;</span>http://172.18.18.21:8081/repository/maven-snapshots/<span class="tag">&lt;/<span class="title">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">snapshotRepository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">distributionManagement</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x4E3B;&#x8981;&#x5C31;&#x662F;&#x548C;Nexus&#x8FDB;&#x884C;&#x8FDE;&#x63A5;&#x7684;&#x914D;&#x7F6E;&#x4EE3;&#x7801;&#xFF0C;&#x914D;&#x7F6E;&#x4E0A;&#x4F20;&#x7684;&#x4EE3;&#x7801;&#x5E93;&#x5730;&#x5740;&#x7B49;&#x3002;<br>&#x9996;&#x5148;id&#x662F;nexus&#xFF0C;&#x5C31;&#x8BF4;&#x660E;&#x8FD9;&#x4E2A;id&#x5176;&#x5B9E;&#x5C31;&#x662F;settings.xml&#x7684;server&#x7684;id&#xFF0C;&#x8D1F;&#x8D23;&#x786E;&#x5B9A;&#x670D;&#x52A1;&#x914D;&#x7F6E;&#x7684;&#xFF0C;&#x4E4B;&#x540E;&#x662F;name&#x6807;&#x7B7E;&#x5C31;&#x662F;&#x6807;&#x8BC6;&#x8FD9;&#x4E2A;&#x5E93;&#x5177;&#x4F53;&#x662F;&#x4EC0;&#x4E48;&#x7528;&#x9014;&#x7684;&#xFF0C;&#x6709;releases&#x7248;&#x548C;snapshot&#x7248;&#x4E24;&#x4E2A;&#x5730;&#x5740;&#xFF0C;&#x4E4B;&#x540E;&#x7684;url&#x5C31;&#x662F;&#x4EE3;&#x7801;&#x5E93;&#x7684;&#x94FE;&#x63A5;&#x4E86;&#x3002;<br>&#x7136;&#x540E;&#x5728;IDEA&#x4E2D;&#x901A;&#x8FC7;&#x63A7;&#x5236;&#x53F0;&#x6267;&#x884C; mvn clean deploy&#x6216;&#x8005;&#x901A;&#x8FC7;IDEA&#x754C;&#x9762;&#x53F3;&#x4FA7;&#x7684;Maven Prjects&#x7684;lifecycle&#x6765;&#x6267;&#x884C;<br><img src="/2018/06/05/&#x642D;&#x5EFA;Maven&#x79C1;&#x670D;Nexus3&#x5E76;&#x5728;IDEA&#x7684;Springboot&#x9879;&#x76EE;&#x4E0B;&#x4F7F;&#x7528;/3.png" alt="logo"></p>
<p>&#x5982;&#x679C;&#x671F;&#x95F4;&#x6CA1;&#x4EC0;&#x4E48;&#x95EE;&#x9898;&#xFF0C;&#x6267;&#x884C;&#x5B8C;deploy&#x76F8;&#x5173;&#x7684;&#x4EE3;&#x7801;&#x5C31;&#x4F1A;&#x63D0;&#x4EA4;&#x5230;Nexus&#x670D;&#x52A1;&#x5668;&#x6307;&#x5B9A;&#x7684;&#x5E93;&#x4E2D;&#x53BB;&#x4E86;&#x3002;</p>
<p><img src="/2018/06/05/&#x642D;&#x5EFA;Maven&#x79C1;&#x670D;Nexus3&#x5E76;&#x5728;IDEA&#x7684;Springboot&#x9879;&#x76EE;&#x4E0B;&#x4F7F;&#x7528;/4.png" alt="logo"><br>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x76F8;&#x5173;&#x7684;commonlib&#x9879;&#x76EE;&#x5DF2;&#x7ECF;&#x8FDB;&#x5165;&#x5230;maven-release&#x5E93;&#x4E2D;&#x53BB;&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x8981;&#x53D1;&#x5E03;&#x5230;snapshot&#x5E93;&#xFF0C;&#x5C31;&#x628A;artifactId&#x4E2D;&#x7684;commonlib&#x540E;&#x9762;&#x52A0;&#x4E0A;&#x201D;-snapshot&#x201D;&#x5373;&#x53EF;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x8FD8;&#x8981;&#x63D0;&#x5230;&#x4E00;&#x4E2A;&#x77E5;&#x8BC6;&#x70B9;&#xFF0C;&#x5C31;&#x662F;&#x5982;&#x679C;&#x4F60;&#x53EA;&#x662F;&#x60F3;&#x8BA9;&#x4F60;&#x7684;&#x67D0;&#x4E00;&#x4E2A;&#x6216;&#x51E0;&#x4E2A;&#x9879;&#x76EE;&#x4F7F;&#x7528;Nexus&#x79C1;&#x670D;&#x800C;&#x5176;&#x4ED6;&#x7684;&#x9879;&#x76EE;&#x8FD8;&#x8981;&#x4F7F;&#x7528;Maven&#x7684;&#x5E93;&#xFF0C;&#x90A3;&#x5C31;&#x4E0D;&#x8981;&#x5728;.m2&#x6587;&#x4EF6;&#x5939;&#x91CC;&#x653E;&#x7F6E;settings.xml&#x800C;&#x5C06;&#x5176;&#x6539;&#x540D;&#x4E3A;&#x5176;&#x4ED6;&#x7684;&#x540D;&#x5B57;&#x6BD4;&#x5982;&#xFF1A;settings2.xml&#xFF0C;&#x8FD9;&#x6837;&#x8FD9;&#x4E2A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5C31;&#x4E0D;&#x4F1A;&#x9ED8;&#x8BA4;&#x8986;&#x76D6;&#x4F60;&#x7684;Maven&#x914D;&#x7F6E;&#xFF0C;&#x800C;&#x4F60;&#x67D0;&#x4E00;&#x4E2A;&#x9879;&#x76EE;&#x60F3;&#x7528;&#x8FD9;&#x4E2A;&#x79C1;&#x6709;Maven&#x5E93;&#x8BE5;&#x600E;&#x4E48;&#x529E;&#x5462;&#xFF1F;&#x770B;&#x4E0B;&#x56FE;&#xFF1A;</p>
<p><img src="/2018/06/05/&#x642D;&#x5EFA;Maven&#x79C1;&#x670D;Nexus3&#x5E76;&#x5728;IDEA&#x7684;Springboot&#x9879;&#x76EE;&#x4E0B;&#x4F7F;&#x7528;/6.png" alt="logo"></p>
<p>&#x53EA;&#x8981;&#x5355;&#x72EC;&#x7ED9;&#x9879;&#x76EE;&#x6240;&#x5728;&#x7684;IDEA&#x4E0B;&#x4FEE;&#x6539;Settings-&gt;Build Excution Deployment-&gt;Build Tools -&gt;Maven&#x4E2D;&#x7684;User Settings file &#xFF0C;&#x7136;&#x540E;&#x9009;&#x4E2D;Override&#x9009;&#x9879;&#x540E;&#x5728;&#x9009;&#x62E9;&#x4F60;&#x60F3;&#x4F7F;&#x7528;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5373;&#x53EF;&#x3002;</p>
<h2 id="&#x5728;Springboot&#x4E2D;&#x4F7F;&#x7528;Nexus&#x79C1;&#x670D;&#x7684;&#x5E93;">&#x5728;Springboot&#x4E2D;&#x4F7F;&#x7528;Nexus&#x79C1;&#x670D;&#x7684;&#x5E93;</h2><p>&#x4F7F;&#x7528;Nexus&#x79C1;&#x670D;&#x7684;&#x5E93;&#x6709;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x79CD;&#x662F;&#x5728;Pom.xml&#x4E2D;&#x52A0;&#x5165;&#xFF1A;<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">repositories</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">repository</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="title">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">url</span>&gt;</span>http://172.18.18.21:8081/repository/maven-releases/<span class="tag">&lt;/<span class="title">url</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">repository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">repositories</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x5E76;&#x5F15;&#x5165;&#x4F60;&#x8981;&#x52A0;&#x5165;&#x7684;Dependency&#x5C31;&#x53EF;&#x4EE5;&#x4E86;<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>com.dhcc<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>commonlib<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="title">version</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#x5C31;&#x662F;&#x901A;&#x8FC7;&#x4FEE;&#x6539;IDEA&#x7684;&#x9ED8;&#x8BA4;settings.xml&#x6765;&#x5B9E;&#x73B0;&#xFF0C;&#x4E0A;&#x4E00;&#x8282;&#x5DF2;&#x7ECF;&#x4ECB;&#x7ECD;&#x8FC7;&#x4E86;&#xFF0C;&#x53EA;&#x8981;&#x4FEE;&#x6539;&#x4E86;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x5BF9;&#x5E94;&#x7684;&#x9879;&#x76EE;&#x4E5F;&#x81EA;&#x7136;&#x4F1A;&#x53BB;&#x79C1;&#x670D;&#x4E0A;&#x4E0B;&#x8F7D;&#x5BF9;&#x5E94;&#x7684;&#x4F9D;&#x8D56;&#x6587;&#x4EF6;&#xFF0C;&#x8FBE;&#x5230;&#x7684;&#x6548;&#x679C;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Springboot2.0集成SpringSecurity实现权限管理]]></title>
      <url>http://jasoncool.com/2018/05/30/Springboot2.0%E9%9B%86%E6%88%90SpringSecurity%E5%AE%9E%E7%8E%B0%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/</url>
      <content type="html"><![CDATA[<h2 id="&#x4E3A;&#x4EC0;&#x4E48;&#x7528;SpringSecurity&#xFF1F;">&#x4E3A;&#x4EC0;&#x4E48;&#x7528;SpringSecurity&#xFF1F;</h2><p>   &#x4E4B;&#x524D;&#x642D;&#x5EFA;&#x597D;Nexus&#x79C1;&#x670D;&#x4E4B;&#x540E;&#xFF0C;&#x5C31;&#x60F3;&#x7740;&#x5F00;&#x59CB;&#x5C01;&#x88C5;&#x4E00;&#x5957;&#x56FA;&#x5B9A;&#x7684;&#x6743;&#x9650;&#x7BA1;&#x7406;&#x6A21;&#x5757;&#xFF0C;&#x4EE5;&#x5907;&#x516C;&#x53F8;&#x9879;&#x76EE;&#x4F7F;&#x7528;&#xFF0C;&#x4E4B;&#x524D;&#x6211;&#x4EEC;&#x90E8;&#x95E8;&#x4E00;&#x76F4;&#x4F7F;&#x7528;&#x7684;&#x662F;Shiro&#xFF0C;&#x4F46;&#x662F;&#x540E;&#x6765;&#x7ECF;&#x8FC7;&#x518D;&#x4E09;&#x7684;&#x8003;&#x8651;&#xFF0C;&#x611F;&#x89C9;Shiro&#x6BD5;&#x7ADF;&#x4E0D;&#x662F;Spring&#x7684;&#x4EB2;&#x513F;&#x5B50;&#xFF0C;&#x5C0F;&#x7248;&#x672C;&#x5347;&#x7EA7;&#x8FD8;&#x597D;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x65E6;&#x9047;&#x5230;Springboot&#x7684;&#x5927;&#x7248;&#x672C;&#x5347;&#x7EA7;&#xFF0C;&#x5219;&#x4F1A;&#x660E;&#x663E;&#x611F;&#x89C9;&#x5230;&#x4EB2;&#x513F;&#x5B50;&#x5728;&#x65F6;&#x6548;&#x6027;&#x4E0A;&#x7684;&#x4F18;&#x52BF;&#xFF08;&#x4E4B;&#x524D;&#x6211;&#x4EEC;&#x8BD5;&#x56FE;&#x5728;Springboot2.0&#x4E0A;&#x4F7F;&#x7528;Activiti6&#xFF0C;&#x5669;&#x68A6;&#x554A;&#xFF01;&#xFF09;<br>&#x597D;&#x4E86;&#xFF0C;&#x95F2;&#x8A00;&#x5C11;&#x53D9;&#xFF0C;&#x73B0;&#x5728;&#x5F00;&#x59CB;&#x5728;Springboot2.0&#x4E2D;&#x52A0;&#x5165;SpringSecurity&#x5427;&#xFF01;<br><a id="more"></a></p>
<h2 id="&#x4E3A;&#x4EC0;&#x4E48;&#x6211;&#x8FD8;&#x8981;&#x5199;&#x8FD9;&#x4E2A;&#x6587;&#x7AE0;&#xFF1F;">&#x4E3A;&#x4EC0;&#x4E48;&#x6211;&#x8FD8;&#x8981;&#x5199;&#x8FD9;&#x4E2A;&#x6587;&#x7AE0;&#xFF1F;</h2><p>&#x786E;&#x5B9E;&#xFF0C;&#x5E02;&#x9762;&#x4E0A;&#x7684;SpringSecurity&#x7684;&#x6559;&#x7A0B;&#x6570;&#x4E0D;&#x80DC;&#x6570;&#xFF0C;&#x5165;&#x95E8;&#x6559;&#x7A0B;&#x548C;&#x96C6;&#x6210;&#x6559;&#x7A0B;&#x4E00;&#x5927;&#x5806;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x6211;&#x8FD8;&#x8981;&#x518D;&#x5199;&#x4E00;&#x7BC7;&#x8FD9;&#x6837;&#x7684;&#x6559;&#x7A0B;&#x5462;&#xFF1F;<br>&#x5176;&#x5B9E;&#x7F51;&#x4E0A;&#x6709;&#x5F88;&#x591A;&#x6559;&#x7A0B;&#xFF0C;&#x867D;&#x7136;&#x6559;&#x4F1A;&#x4E86;&#x4F60;&#x5982;&#x4F55;&#x96C6;&#x6210;SpringScurity&#x5E76;&#x4E14;&#x57FA;&#x4E8E;&#x8FD9;&#x4E2A;&#x6846;&#x67B6;&#x505A;&#x7B80;&#x5355;&#x7684;&#x6743;&#x9650;&#x7BA1;&#x7406;&#xFF0C;&#x4F46;&#x662F;&#x4ED6;&#x4EEC;&#x90FD;&#x662F;&#x6709;&#x4E00;&#x4E2A;&#x5F88;&#x5927;&#x7684;&#x5F0A;&#x7AEF;&#x5C31;&#x662F;&#x5728;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x4E2D;&#xFF0C;&#x6BCF;&#x6B21;&#x8BF7;&#x6C42;&#x90FD;&#x8981;&#x53BB;&#x6570;&#x636E;&#x5E93;&#x67E5;&#x8BE2;&#x8BE5;&#x7528;&#x6237;&#x7684;&#x89D2;&#x8272;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x5728;&#x5C0F;&#x7CFB;&#x7EDF;&#x6216;&#x8005;&#x662F;&#x6743;&#x9650;&#x4E0D;&#x654F;&#x611F;&#x7684;&#x7CFB;&#x7EDF;&#x4E2D;&#x8FD8;&#x884C;&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x6743;&#x9650;&#x654F;&#x611F;&#x7684;&#x5927;&#x7CFB;&#x7EDF;&#xFF0C;&#x6BCF;&#x6B21;&#x8BF7;&#x6C42;&#x90FD;&#x8981;&#x53BB;&#x6570;&#x636E;&#x5E93;&#x67E5;&#x89D2;&#x8272;&#x548C;&#x6743;&#x9650;&#x7684;&#x8BDD;&#xFF0C;&#x5BF9;&#x8FD9;&#x4E2A;&#x7CFB;&#x7EDF;&#x6765;&#x8BF4;&#x7B80;&#x76F4;&#x5C31;&#x662F;&#x5669;&#x68A6;&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x505A;&#x4E00;&#x4E2A;&#x767B;&#x5F55;&#x4E00;&#x6B21;&#x5C31;&#x80FD;&#x83B7;&#x53D6;&#x76F8;&#x5173;&#x89D2;&#x8272;&#x548C;&#x6743;&#x9650;&#xFF0C;&#x5728;&#x8FD9;&#x6B21;&#x8BF7;&#x6C42;&#x4E2D;&#x90FD;&#x57FA;&#x4E8E;&#x7F13;&#x5B58;&#x4E2D;&#x7684;&#x89D2;&#x8272;&#x548C;&#x6743;&#x9650;&#x6765;&#x8BBF;&#x95EE;&#x5373;&#x53EF;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x5927;&#x5927;&#x51CF;&#x5C11;&#x8BBF;&#x95EE;&#x6570;&#x636E;&#x5E93;&#x8BBF;&#x95EE;&#x6B21;&#x6570;&#xFF0C;&#x63D0;&#x9AD8;&#x7528;&#x6237;&#x54CD;&#x5E94;&#x901F;&#x5EA6;&#x3002;</p>
<h2 id="SpringSecurity&#x57FA;&#x7840;&#x6559;&#x7A0B;">SpringSecurity&#x57FA;&#x7840;&#x6559;&#x7A0B;</h2><p>&#x8FD9;&#x4E2A;&#x57FA;&#x7840;&#x6559;&#x7A0B;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#xFF1A;<br><a href="https://www.jitwxs.cn/SpringBoot%25E9%259B%2586%25E6%2588%2590Spring-Security%25EF%25BC%25881%25EF%25BC%2589%25E2%2580%2594%25E2%2580%2594%25E5%2585%25A5%25E9%2597%25A8%25E7%25A8%258B%25E5%25BA%258F.html" target="_blank" rel="external">SpringBoot&#x96C6;&#x6210;Spring Security&#xFF08;1&#xFF09;&#x2014;&#x2014;&#x5165;&#x95E8;&#x7A0B;&#x5E8F;</a><br><a href="https://www.jitwxs.cn/SpringBoot%25E9%259B%2586%25E6%2588%2590Spring-Security%25EF%25BC%25882%25EF%25BC%2589%25E2%2580%2594%25E2%2580%2594%25E8%2587%25AA%25E5%258A%25A8%25E7%2599%25BB%25E5%25BD%2595.html" target="_blank" rel="external">SpringBoot&#x96C6;&#x6210;Spring Security&#xFF08;2&#xFF09;&#x2014;&#x2014;&#x81EA;&#x52A8;&#x767B;&#x5F55;</a><br><a href="https://www.jitwxs.cn/SpringBoot%25E9%259B%2586%25E6%2588%2590Spring-Security%25EF%25BC%25883%25EF%25BC%2589%25E2%2580%2594%25E2%2580%2594%25E5%25BC%2582%25E5%25B8%25B8%25E5%25A4%2584%25E7%2590%2586.html" target="_blank" rel="external">SpringBoot&#x96C6;&#x6210;Spring Security&#xFF08;3&#xFF09;&#x2014;&#x2014;&#x5F02;&#x5E38;&#x5904;&#x7406;</a><br><a href="https://www.jitwxs.cn/SpringBoot%25E9%259B%2586%25E6%2588%2590Spring-Security%25EF%25BC%25884%25EF%25BC%2589%25E2%2580%2594%25E2%2580%2594%25E8%2587%25AA%25E5%25AE%259A%25E4%25B9%2589%25E8%25A1%25A8%25E5%258D%2595%25E7%2599%25BB%25E5%25BD%2595.html" target="_blank" rel="external">SpringBoot&#x96C6;&#x6210;Spring Security&#xFF08;4&#xFF09;&#x2014;&#x2014;&#x81EA;&#x5B9A;&#x4E49;&#x8868;&#x5355;&#x767B;&#x5F55;</a><br><a href="https://www.jitwxs.cn/SpringBoot%25E9%259B%2586%25E6%2588%2590Spring-Security%25EF%25BC%25885%25EF%25BC%2589%25E2%2580%2594%25E2%2580%2594%25E6%259 &#x554A;&#x554A;83%25E9%2599%2590%25E6%258E%25A7%25E5%2588%25B6.html" target="_blank" rel="external">SpringBoot&#x96C6;&#x6210;Spring Security&#xFF08;5&#xFF09;&#x2014;&#x2014;&#x6743;&#x9650;&#x63A7;&#x5236;</a><br>&#x8FD9;&#x4E2A;SpringSecurity&#x6559;&#x7A0B;&#x662F;&#x6211;&#x770B;&#x8FC7;&#x7684;&#x5165;&#x95E8;&#x6559;&#x7A0B;&#x91CC;&#x975E;&#x5E38;&#x4E0D;&#x9519;&#x7684;&#x6587;&#x7AE0;&#x4E86;&#xFF0C;&#x5EFA;&#x8BAE;&#x5728;&#x5B66;&#x4E60;&#x672C;&#x7BC7;&#x6587;&#x7AE0;&#x524D;&#x5148;&#x53BB;&#x5B66;&#x4E60;&#x8BE5;&#x7CFB;&#x5217;&#x6559;&#x7A0B;&#x3002;</p>
<h2 id="&#x66F4;&#x9AD8;&#x7684;&#x8FFD;&#x6C42;">&#x66F4;&#x9AD8;&#x7684;&#x8FFD;&#x6C42;</h2><p>&#x901A;&#x8FC7;&#x5B66;&#x4E60;&#x4E4B;&#x524D;&#x7684;&#x5165;&#x95E8;&#x6559;&#x7A0B;&#xFF0C;&#x6211;&#x4EEC;&#x57FA;&#x672C;&#x4E0A;&#x4E0A;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;SpringSecurity&#x7684;&#x57FA;&#x7840;&#x529F;&#x80FD;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x4E5F;&#x4F1A;&#x53D1;&#x73B0;&#xFF0C;&#x6BCF;&#x6B21;&#x70B9;&#x51FB;&#x8BF7;&#x6C42;&#x7684;&#x65F6;&#x5019;&#x90FD;&#x4F1A;&#x6267;&#x884C;&#x67E5;&#x8BE2;&#x89D2;&#x8272;&#x548C;&#x6743;&#x9650;&#x7684;Sql&#x8BED;&#x53E5;&#xFF0C;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002;<br>&#x6309;&#x7167;&#x8FD9;&#x4E2A;&#x9879;&#x76EE;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x4FEE;&#x6539;&#x4E00;&#x4E0B;&#x6743;&#x9650;&#x8868;&#x7684;&#x6570;&#x636E;&#x5C55;&#x793A;&#x65B9;&#x5F0F;&#xFF0C;&#x4F7F;&#x5B83;&#x66F4;&#x7B26;&#x5408;&#x771F;&#x5B9E;&#x9879;&#x76EE;&#x7ED3;&#x6784;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line">Navicat MySQL Data Transfer</span><br><span class="line"></span><br><span class="line">Source Server         : &#x672C;&#x5730;&#x6570;&#x636E;&#x5E93;</span><br><span class="line">Source Server Version : 50624</span><br><span class="line">Source Host           : localhost:3306</span><br><span class="line">Source Database       : test</span><br><span class="line"></span><br><span class="line">Target Server Type    : MYSQL</span><br><span class="line">Target Server Version : 50624</span><br><span class="line">File Encoding         : 65001</span><br><span class="line"></span><br><span class="line">Date: 2018-05-28 16:58:48</span><br><span class="line">*/</span></span><br><span class="line"></span><br><span class="line">SET FOREIGN_KEY_CHECKS=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure <span class="keyword">for</span> sys_permission</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS `sys_permission`;</span><br><span class="line">CREATE TABLE `sys_permission` (</span><br><span class="line">  `id` <span class="keyword">int</span>(<span class="number">11</span>) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `url` varchar(<span class="number">255</span>) DEFAULT NULL,</span><br><span class="line">  `role_id` <span class="keyword">int</span>(<span class="number">11</span>) DEFAULT NULL,</span><br><span class="line">  `permission` varchar(<span class="number">255</span>) DEFAULT NULL,</span><br><span class="line">  <span class="function">PRIMARY <span class="title">KEY</span> <span class="params">(`id`)</span>,</span><br><span class="line">  KEY `fk_roleId` <span class="params">(`role_id`)</span>,</span><br><span class="line">  CONSTRAINT `fk_roleId` FOREIGN <span class="title">KEY</span> <span class="params">(`role_id`)</span> REFERENCES `sys_role` <span class="params">(`id`)</span> ON DELETE CASCADE ON UPDATE CASCADE</span><br><span class="line">) ENGINE</span>=InnoDB AUTO_INCREMENT=<span class="number">7</span> DEFAULT CHARSET=utf8;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Records of sys_permission</span><br><span class="line">-- ----------------------------</span><br><span class="line">INSERT INTO `sys_permission` VALUES (<span class="string">&apos;1&apos;</span>, <span class="string">&apos;/admin/c&apos;</span>, <span class="string">&apos;1&apos;</span>, <span class="string">&apos;create&apos;</span>);</span><br><span class="line">INSERT INTO `sys_permission` VALUES (<span class="string">&apos;2&apos;</span>, <span class="string">&apos;/admin/r&apos;</span>, <span class="string">&apos;2&apos;</span>, <span class="string">&apos;read&apos;</span>);</span><br><span class="line">INSERT INTO `sys_permission` VALUES (<span class="string">&apos;3&apos;</span>, <span class="string">&apos;/admin/r&apos;</span>, <span class="string">&apos;1&apos;</span>, <span class="string">&apos;read&apos;</span>);</span><br><span class="line">INSERT INTO `sys_permission` VALUES (<span class="string">&apos;4&apos;</span>, <span class="string">&apos;/admin/u&apos;</span>, <span class="string">&apos;1&apos;</span>, <span class="string">&apos;update&apos;</span>);</span><br><span class="line">INSERT INTO `sys_permission` VALUES (<span class="string">&apos;5&apos;</span>, <span class="string">&apos;/admin/d&apos;</span>, <span class="string">&apos;1&apos;</span>, <span class="string">&apos;delete&apos;</span>);</span><br><span class="line">INSERT INTO `sys_permission` VALUES (<span class="string">&apos;6&apos;</span>, <span class="string">&apos;/admin/d&apos;</span>, <span class="string">&apos;2&apos;</span>, <span class="string">&apos;delete&apos;</span>);</span><br></pre></td></tr></table></figure></p>
<p>&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4E86;&#x89E3;&#x5230;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x6743;&#x9650;&#x8868;&#x662F;&#x901A;&#x8FC7;&#x8DEF;&#x5F84;&#x3001;&#x6743;&#x9650;&#x540D;&#x79F0;&#x548C;&#x89D2;&#x8272;ID&#x76F8;&#x5173;&#x8054;&#x6765;&#x63A7;&#x5236;&#x7528;&#x6237;&#x7684;&#x6743;&#x9650;&#x7684;&#x3002;<br>&#x7136;&#x540E;&#x5C31;&#x5F00;&#x59CB;&#x6211;&#x4EEC;&#x7684;&#x81EA;&#x5B9A;&#x4E49;&#x4E4B;&#x65C5;&#x4E86;:<br>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x5148;&#x4E86;&#x89E3;&#x4E00;&#x4E0B;SpringSecurity&#x662F;&#x5982;&#x4F55;&#x901A;&#x8FC7;&#x6743;&#x9650;&#x6765;&#x7BA1;&#x7406;&#x7528;&#x6237;&#x8BBF;&#x95EE;&#x7684;&#x754C;&#x9762;&#x7684;&#xFF1A;<br>1&#xFF09; &#x7CFB;&#x7EDF;&#x542F;&#x52A8;&#x65F6;&#x5148;&#x52A0;&#x8F7D;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x8BBE;&#x7F6E;&#x7684;&#x6240;&#x6709;&#x9700;&#x8981;&#x6743;&#x9650;&#x624D;&#x80FD;&#x8BBF;&#x95EE;&#x7684;&#x754C;&#x9762;&#x8DEF;&#x5F84;&#x548C;&#x6743;&#x9650;&#xFF0C;&#x653E;&#x7F6E;&#x5728;Map&#x4E2D;&#x5B58;&#x50A8;&#x5907;&#x7528;&#x3002;<br>2&#xFF09; &#x7528;&#x6237;&#x767B;&#x5F55;&#x7684;&#x65F6;&#x5019;&#x83B7;&#x53D6;&#x8BE5;&#x7528;&#x6237;&#x5E94;&#x6709;&#x7684;&#x89D2;&#x8272;&#x4FE1;&#x606F;&#x548C;&#x6743;&#x9650;&#x4FE1;&#x606F;&#xFF0C;&#x5E76;&#x5B58;&#x5165;&#x8BE5;&#x7528;&#x6237;&#x7684;&#x4E2A;&#x4EBA;&#x4FE1;&#x606F;&#x4E2D;&#x3002;<br>3&#xFF09; &#x901A;&#x8FC7;&#x4F60;&#x8BF7;&#x6C42;&#x7684;&#x8DEF;&#x5F84;&#x83B7;&#x53D6;&#x4F60;&#x7684;&#x6743;&#x9650;&#x4FE1;&#x606F;&#x4E0E;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x6743;&#x9650;&#x4FE1;&#x606F;&#x505A;&#x5BF9;&#x5E94;&#xFF0C;&#x770B;&#x4F60;&#x662F;&#x5426;&#x62E5;&#x6709;&#x8BE5;&#x6743;&#x9650;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x5C31;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x8BE5;&#x9875;&#x9762;&#x3002;<br>4&#xFF09; &#x5982;&#x679C;&#x6CA1;&#x6709;&#x8BE5;&#x6743;&#x9650;&#xFF0C;&#x8FD8;&#x8981;&#x518D;&#x5224;&#x65AD;&#x4F60;&#x662F;&#x5426;&#x62E5;&#x6709;&#x76F8;&#x5173;&#x7684;&#x89D2;&#x8272;&#x4FE1;&#x606F;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x76F8;&#x5173;&#x7684;&#x89D2;&#x8272;&#x5C31;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x5E26;@PreAuthorize(&#x201C;hasRole(&#x2018;ADMIN&#x2019;)&#x201D;)&#x6CE8;&#x89E3;&#x7684;&#x9875;&#x9762;&#x4E86;&#x3002;<br>5&#xFF09; &#x5982;&#x679C;&#x4F60;&#x8BBF;&#x95EE;&#x7684;&#x754C;&#x9762;&#x4E0D;&#x5728;&#x6743;&#x9650;&#x7BA1;&#x7406;&#x7684;&#x8303;&#x56F4;&#x5185;&#x5219;&#x76F4;&#x63A5;&#x653E;&#x884C;&#xFF0C;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x6BD4;&#x8F83;&#x7ED5;&#xFF0C;&#x4F46;&#x662F;&#x9700;&#x8981;&#x4F60;&#x6162;&#x6162;&#x6D88;&#x5316;&#x7406;&#x89E3;&#xFF0C;&#x6CA1;&#x6709;&#x597D;&#x529E;&#x6CD5;&#x3002;<br>&#x5E2E;&#x52A9;&#x7406;&#x89E3;&#x7684;&#x6D41;&#x7A0B;&#x56FE;&#xFF1A;<br><img src="/2018/05/30/Springboot2.0&#x96C6;&#x6210;SpringSecurity&#x5B9E;&#x73B0;&#x6743;&#x9650;&#x7BA1;&#x7406;/1.png" alt="logo"><br>3.1 &#x81EA;&#x5B9A;&#x4E49;UserDetailSerivce&#x63A5;&#x53E3;</p>
<p>&#x8FD9;&#x4E2A;&#x63A5;&#x53E3;&#x4E4B;&#x524D;&#x5DF2;&#x7ECF;&#x81EA;&#x5B9A;&#x4E49;&#x8FC7;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x8981;&#x7B26;&#x5408;&#x6743;&#x9650;&#x7BA1;&#x7406;&#xFF0C;&#x5219;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x91CD;&#x5199;&#x4FEE;&#x6539;&#xFF0C;&#x5177;&#x4F53;&#x7684;&#x5185;&#x5BB9;&#x770B;&#x4EE3;&#x7801;&#x548C;&#x6CE8;&#x91CA;&#x5427;&#xFF0C;&#x5199;&#x7684;&#x5F88;&#x6E05;&#x695A;&#x4E86;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test.security.security;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.test.security.entity.SysPermission;</span><br><span class="line"><span class="keyword">import</span> com.test.security.entity.SysRole;</span><br><span class="line"><span class="keyword">import</span> com.test.security.entity.SysUser;</span><br><span class="line"><span class="keyword">import</span> com.test.security.service.SysPermissionService;</span><br><span class="line"><span class="keyword">import</span> com.test.security.service.SysUserService;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.GrantedAuthority;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.authority.SimpleGrantedAuthority;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.userdetails.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.userdetails.UserDetails;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.userdetails.UserDetailsService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.userdetails.UsernameNotFoundException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@Author</span>:jasoncool</span><br><span class="line"> * <span class="doctag">@Description</span>:</span><br><span class="line"> * <span class="doctag">@Date</span>:&#x521B;&#x5EFA;&#x4E8E;&#x4E0A;&#x5348; 09:15 2018/5/23</span><br><span class="line"> * <span class="doctag">@Modified</span>:</span><br><span class="line"> */</span></span><br><span class="line"><span class="annotation">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomUserDetailService</span> <span class="keyword">implements</span> <span class="title">UserDetailsService</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> Logger log = LoggerFactory.getLogger(CustomUserDetailService.class);</span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysPermissionService permissionService;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserDetails <span class="title">loadUserByUsername</span><span class="params">(String username)</span> <span class="keyword">throws</span> UsernameNotFoundException </span>{</span><br><span class="line">        <span class="keyword">if</span> (username == <span class="keyword">null</span> || <span class="string">&quot;&quot;</span>.equals(username.trim())) {</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UsernameNotFoundException(<span class="string">&quot;&#x7528;&#x6237;&#x540D;&#x4E3A;&#x7A7A;&quot;</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">// &#x4ECE;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x53D6;&#x51FA;&#x7528;&#x6237;&#x4FE1;&#x606F;</span></span><br><span class="line">        SysUser user = userService.selectByName(username);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// &#x5224;&#x65AD;&#x7528;&#x6237;&#x662F;&#x5426;&#x5B58;&#x5728;</span></span><br><span class="line">        <span class="keyword">if</span> (user == <span class="keyword">null</span>) {</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UsernameNotFoundException(<span class="string">&quot;&#x7528;&#x6237;&#x540D;&#x4E0D;&#x5B58;&#x5728;&quot;</span>);</span><br><span class="line">        }</span><br><span class="line">        List&lt;SysPermission&gt; permissions = permissionService.listByUserId(user.getId());</span><br><span class="line">        List&lt;GrantedAuthority&gt; grantedAuthorities = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        List&lt;SysRole&gt; roles = userService.findRolesById(user.getId());</span><br><span class="line">        <span class="keyword">for</span> (SysRole role : roles) {</span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isNotBlank(role.getName())) {</span><br><span class="line">                GrantedAuthority grantedAuthority = <span class="keyword">new</span> SimpleGrantedAuthority(role.getName());</span><br><span class="line">                <span class="comment">//&#x6B64;&#x5904;&#x5C06;&#x89D2;&#x8272;&#x4FE1;&#x606F;&#x6DFB;&#x52A0;&#x5230; GrantedAuthority &#x5BF9;&#x8C61;&#x4E2D;&#xFF0C;&#x5728;&#x540E;&#x9762;&#x8FDB;&#x884C;&#x5168;&#x6743;&#x9650;&#x9A8C;&#x8BC1;&#x65F6;&#x4F1A;&#x4F7F;&#x7528;GrantedAuthority &#x5BF9;&#x8C61;&#x3002;</span></span><br><span class="line">                grantedAuthorities.add(grantedAuthority);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (SysPermission permission : permissions) {</span><br><span class="line">            <span class="keyword">if</span> (permission != <span class="keyword">null</span> &amp;&amp; permission.getPermission() != <span class="keyword">null</span>) {</span><br><span class="line">                GrantedAuthority grantedAuthority = <span class="keyword">new</span> SimpleGrantedAuthority(permission.getPermission());</span><br><span class="line">                <span class="comment">//&#x6B64;&#x5904;&#x5C06;&#x6743;&#x9650;&#x4FE1;&#x606F;&#x6DFB;&#x52A0;&#x5230; GrantedAuthority &#x5BF9;&#x8C61;&#x4E2D;&#xFF0C;&#x5728;&#x540E;&#x9762;&#x8FDB;&#x884C;&#x5168;&#x6743;&#x9650;&#x9A8C;&#x8BC1;&#x65F6;&#x4F1A;&#x4F7F;&#x7528;GrantedAuthority &#x5BF9;&#x8C61;&#x3002;</span></span><br><span class="line">                grantedAuthorities.add(grantedAuthority);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">// &#x8FD4;&#x56DE;UserDetails&#x5B9E;&#x73B0;&#x7C7B;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User(user.getName(), user.getPassword(), grantedAuthorities);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x4E4B;&#x540E;&#x662F;&#x6743;&#x9650;&#x62E6;&#x622A;&#x8FC7;&#x6EE4;&#x5668;CustomFilterSecurityInterceptor:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test.security.security.permission;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@Author</span>:jasoncool</span><br><span class="line"> * <span class="doctag">@Description</span>: &#x8BE5;&#x8FC7;&#x6EE4;&#x5668;&#x7684;&#x4E3B;&#x8981;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x901A;&#x8FC7;spring&#x8457;&#x540D;&#x7684;IoC&#x751F;&#x6210;securityMetadataSource&#x3002;</span><br><span class="line"> * securityMetadataSource&#x76F8;&#x5F53;&#x4E8E;&#x672C;&#x5305;&#x4E2D;&#x81EA;&#x5B9A;&#x4E49;&#x7684;MyInvocationSecurityMetadataSourceService&#x3002;</span><br><span class="line"> * &#x8BE5;MyInvocationSecurityMetadataSourceService&#x7684;&#x4F5C;&#x7528;&#x63D0;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x63D0;&#x53D6;&#x6743;&#x9650;&#x548C;&#x8D44;&#x6E90;&#xFF0C;&#x88C5;&#x914D;&#x5230;HashMap&#x4E2D;&#xFF0C;</span><br><span class="line"> * &#x4F9B;Spring Security&#x4F7F;&#x7528;&#xFF0C;&#x7528;&#x4E8E;&#x6743;&#x9650;&#x6821;&#x9A8C;&#x3002;</span><br><span class="line"> * <span class="doctag">@Date</span>:&#x521B;&#x5EFA;&#x4E8E;&#x4E0A;&#x5348; 11:44 2018/5/24</span><br><span class="line"> * <span class="doctag">@Modified</span>:</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">import</span> javax.servlet.Filter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterChain;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.access.SecurityMetadataSource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.access.intercept.AbstractSecurityInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.access.intercept.InterceptorStatusToken;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.FilterInvocation;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="annotation">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomFilterSecurityInterceptor</span> <span class="keyword">extends</span> <span class="title">AbstractSecurityInterceptor</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> Logger log = LoggerFactory.getLogger(CustomFilterSecurityInterceptor.class);</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6743;&#x9650;&#x914D;&#x7F6E;&#x8D44;&#x6E90;&#x7BA1;&#x7406;&#x5668;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CustomFilterInvocationSecurityMetadataSource customFilterInvocationSecurityMetadataSource;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**&#x6743;&#x9650;&#x7BA1;&#x7406;&#x51B3;&#x65AD;&#x5668;*/</span></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMyAccessDecisionManager</span><span class="params">(CustomAccessDecisionManager customAccessDecisionManager)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.setAccessDecisionManager(customAccessDecisionManager);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>{</span><br><span class="line"></span><br><span class="line">        FilterInvocation fi = <span class="keyword">new</span> FilterInvocation(request, response, chain);</span><br><span class="line">        invoke(fi);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">invoke</span><span class="params">(FilterInvocation fi)</span> <span class="keyword">throws</span> IOException, ServletException </span>{</span><br><span class="line">        <span class="comment">//fi&#x91CC;&#x9762;&#x6709;&#x4E00;&#x4E2A;&#x88AB;&#x62E6;&#x622A;&#x7684;url</span></span><br><span class="line">        <span class="comment">//&#x91CC;&#x9762;&#x8C03;&#x7528;CustomFilterInvocationSecurityMetadataSource&#x7684;getAttributes(Object object)&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x83B7;&#x53D6;fi&#x5BF9;&#x5E94;&#x7684;&#x6240;&#x6709;&#x6743;&#x9650;</span></span><br><span class="line">        <span class="comment">//&#x518D;&#x8C03;&#x7528;CustomAccessDecisionManager&#x7684;decide&#x65B9;&#x6CD5;&#x6765;&#x6821;&#x9A8C;&#x7528;&#x6237;&#x7684;&#x6743;&#x9650;&#x662F;&#x5426;&#x8DB3;&#x591F;</span></span><br><span class="line">        InterceptorStatusToken token = <span class="keyword">super</span>.beforeInvocation(fi);</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            <span class="comment">//&#x6267;&#x884C;&#x4E0B;&#x4E00;&#x4E2A;&#x62E6;&#x622A;&#x5668;</span></span><br><span class="line">            fi.getChain().doFilter(fi.getRequest(), fi.getResponse());</span><br><span class="line">        }<span class="keyword">finally</span> {</span><br><span class="line">            <span class="keyword">super</span>.afterInvocation(token, <span class="keyword">null</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; getSecureObjectClass() {</span><br><span class="line">        <span class="keyword">return</span> FilterInvocation.class;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SecurityMetadataSource <span class="title">obtainSecurityMetadataSource</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.customFilterInvocationSecurityMetadataSource;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x7136;&#x540E;&#x662F;&#x6743;&#x9650;&#x914D;&#x7F6E;&#x8D44;&#x6E90;&#x7BA1;&#x7406;&#x5668;CustomFilterInvocationSecurityMetadataSource&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test.security.security.permission;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.test.security.dao.SysPermissionMapper;</span><br><span class="line"><span class="keyword">import</span> com.test.security.dao.SysRoleMapper;</span><br><span class="line"><span class="keyword">import</span> com.test.security.entity.SysPermission;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.access.ConfigAttribute;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.access.SecurityConfig;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.FilterInvocation;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.access.intercept.FilterInvocationSecurityMetadataSource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.util.matcher.AntPathRequestMatcher;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.PostConstruct;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@author</span>:jasoncool</span><br><span class="line"> * <span class="doctag">@Description</span>:</span><br><span class="line"> * &#x6743;&#x9650;&#x914D;&#x7F6E;&#x8D44;&#x6E90;&#x7BA1;&#x7406;&#x5668;&#x5B9E;&#x73B0;&#x4E86;FilterInvocationSecurityMetadataSource&#xFF0C;</span><br><span class="line"> * &#x5728;&#x542F;&#x52A8;&#x65F6;&#x5C31;&#x53BB;&#x52A0;&#x8F7D;&#x4E86;&#x6240;&#x6709;&#x7684;&#x6743;&#x9650;&#x5217;&#x8868;&#xFF0C;&#x6743;&#x9650;&#x914D;&#x7F6E;&#x8D44;&#x6E90;&#x7BA1;&#x7406;&#x5668;&#x4E3A;&#x51B3;&#x65AD;&#x5668;&#x5B9E;&#x65F6;&#x63D0;&#x4F9B;&#x652F;&#x6301;&#xFF0C;</span><br><span class="line"> * &#x5224;&#x65AD;&#x7528;&#x6237;&#x8BBF;&#x95EE;&#x7684;&#x8D44;&#x6E90;&#x662F;&#x5426;&#x5728;&#x53D7;&#x4FDD;&#x62A4;&#x7684;&#x8303;&#x56F4;&#x4E4B;&#x5185;&#x3002;</span><br><span class="line"> * <span class="doctag">@Date</span>:&#x521B;&#x5EFA;&#x4E8E;&#x4E0A;&#x5348; 11:46 2018/5/24</span><br><span class="line"> * <span class="doctag">@Modified</span>:</span><br><span class="line"> */</span></span><br><span class="line"><span class="annotation">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomFilterInvocationSecurityMetadataSource</span> <span class="keyword">implements</span> <span class="title">FilterInvocationSecurityMetadataSource</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Logger log = LoggerFactory.getLogger(CustomFilterInvocationSecurityMetadataSource.class);</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysPermissionMapper sysPermissionDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x7CFB;&#x7EDF;&#x6839;&#x636E;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x8BBF;&#x95EE;&#x7684;url&#x4E3A;key&#xFF0C;&#x6743;&#x9650;&#x7684;&#x5217;&#x8868;&#x4E3A;&#x503C;&#xFF0C;</span><br><span class="line">     * &#x7528;&#x6765;&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;&#x76F8;&#x5173;&#x7684;&#x5168;&#x90E8;&#x6743;&#x9650;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;String, Collection&lt;ConfigAttribute&gt;&gt; urlPerMap =<span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x52A0;&#x8F7D;&#x6570;&#x636E;&#x5E93;&#x6743;&#x9650;&#x8868;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x6743;&#x9650;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@PostConstruct</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadResourceDefine</span><span class="params">()</span></span>{</span><br><span class="line">        urlPerMap = <span class="keyword">new</span> HashMap&lt;&gt;(<span class="number">16</span>);</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x5B58;&#x50A8;&#x7684;&#x662F;&#x9879;&#x76EE;&#x4E2D;&#x6743;&#x9650;&#x7684;&#x5217;&#x8868;&#xFF0C;&#x7528;&#x96C6;&#x5408;&#x7684;&#x65B9;&#x5F0F;&#x5B58;&#x50A8;&#x662F;&#x56E0;&#x4E3A;&#x4E00;&#x4E2A;url&#x53EF;&#x80FD;&#x4F1A;&#x5BF9;&#x5E94;&#x591A;&#x79CD;&#x6743;&#x9650;&#xFF0C;</span><br><span class="line">         * &#x5728;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5B57;&#x6BB5;&#x4E2D;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x7684;&#x5B57;&#x7B26;&#x8FDB;&#x884C;&#x5206;&#x5272;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x505A;&#x5230;&#x4E0D;&#x540C;&#x6743;&#x9650;&#x7684;&#x7528;&#x6237;</span><br><span class="line">         * &#x67E5;&#x770B;&#x4E0D;&#x901A;&#x7684;&#x754C;&#x9762;&#x6548;&#x679C;&#x3002;</span><br><span class="line">         */</span></span><br><span class="line">        Collection&lt;ConfigAttribute&gt; perList;</span><br><span class="line">        <span class="comment">//&#x7528;&#x6765;&#x5B58;&#x50A8;&#x6743;&#x9650;&#x7684;&#x5BB9;&#x5668;</span></span><br><span class="line">        ConfigAttribute cfg;</span><br><span class="line">        <span class="comment">//&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x67E5;&#x8BE2;&#x5168;&#x90E8;&#x7684;&#x6743;&#x9650;&#x4FE1;&#x606F;</span></span><br><span class="line">        List&lt;SysPermission&gt; permissions = sysPermissionDao.findAll();</span><br><span class="line">        <span class="comment">//&#x5FAA;&#x73AF;&#x6743;&#x9650;&#x4FE1;&#x606F;&#x5E76;&#x901A;&#x8FC7;&#x6570;&#x636E;&#x5E93;&#x7684;url&#x5B57;&#x6BB5;&#x4E3A;key,&#x4F20;&#x5165;&#x4E0D;&#x901A;&#x7684;&#x6743;&#x9650;&#x503C;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x5B58;&#x5165;&#x5230;urlPerMap&#x4E2D;&#x53BB;&#x3002;</span></span><br><span class="line">        <span class="keyword">for</span>(SysPermission permission : permissions) {</span><br><span class="line">            perList = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">            log.info(<span class="string">&quot;---------------------&#x52A0;&#x8F7D;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x5168;&#x90E8;&#x6743;&#x9650;----------------------&quot;</span>);</span><br><span class="line">            cfg = <span class="keyword">new</span> SecurityConfig(permission.getPermission());</span><br><span class="line">            perList.add(cfg);</span><br><span class="line">            urlPerMap.put(permission.getUrl(), perList);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6B64;&#x65B9;&#x6CD5;&#x662F;&#x4E3A;&#x4E86;&#x5224;&#x5B9A;&#x7528;&#x6237;&#x8BF7;&#x6C42;&#x7684;url</span><br><span class="line">     * &#x662F;&#x5426;&#x5728;&#x6743;&#x9650;&#x8868;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x6743;&#x9650;&#x8868;&#x4E2D;&#xFF0C;</span><br><span class="line">     * &#x5219;&#x8FD4;&#x56DE;&#x7ED9; decide &#x65B9;&#x6CD5;&#xFF0C;</span><br><span class="line">     * &#x7528;&#x6765;&#x5224;&#x5B9A;&#x7528;&#x6237;&#x662F;&#x5426;&#x6709;&#x6B64;&#x6743;&#x9650;&#x3002;</span><br><span class="line">     * &#x5982;&#x679C;&#x4E0D;&#x5728;&#x6743;&#x9650;&#x8868;&#x4E2D;&#x5219;&#x653E;&#x884C;&#x3002;</span><br><span class="line">     * <span class="doctag">@param</span> object &#x8BF7;&#x6C42;&#x7684;url&#x8DEF;&#x5F84;</span><br><span class="line">     * <span class="doctag">@return</span> &#x8BF7;&#x6C42;&#x6B64;url&#x8DEF;&#x5F84;&#x5E94;&#x6709;&#x7684;&#x6743;&#x9650;</span><br><span class="line">     * <span class="doctag">@throws</span> IllegalArgumentException</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection&lt;ConfigAttribute&gt; <span class="title">getAttributes</span><span class="params">(Object object)</span> <span class="keyword">throws</span> IllegalArgumentException </span>{</span><br><span class="line">        <span class="comment">//&#x5982;&#x679C;&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;&#x6240;&#x6709;&#x6743;&#x9650;&#x7684;map&#x4E3A;&#x7A7A;&#xFF0C;&#x5219;&#x4ECE;&#x6267;&#x884C;loadResourceDefine()&#x65B9;&#x6CD5;</span></span><br><span class="line">        <span class="keyword">if</span>(urlPerMap ==<span class="keyword">null</span>){</span><br><span class="line">            loadResourceDefine();</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">//object &#x4E2D;&#x5305;&#x542B;&#x7528;&#x6237;&#x8BF7;&#x6C42;&#x7684;request &#x4FE1;&#x606F;</span></span><br><span class="line">        HttpServletRequest request = ((FilterInvocation) object).getHttpRequest();</span><br><span class="line">        AntPathRequestMatcher matcher;</span><br><span class="line">        String resUrl;</span><br><span class="line">        <span class="keyword">for</span>(Iterator&lt;String&gt; iter = urlPerMap.keySet().iterator(); iter.hasNext(); ) {</span><br><span class="line">            resUrl = iter.next();</span><br><span class="line">            <span class="comment">//ant&#x5339;&#x914D;&#x89C4;&#x5219;&#x7684;&#x5339;&#x914D;&#x8DEF;&#x5F84;&#xFF0C;&#x5982;&#x679C;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x4E2D;&#x81F3;&#x4F20;&#x5165;&#x8DEF;&#x5F84;&#x5219;&#x9700;&#x8981;&#x5B8C;&#x5168;&#x5339;&#x914D;&#x3002;</span></span><br><span class="line">            matcher = <span class="keyword">new</span> AntPathRequestMatcher(resUrl);</span><br><span class="line">            <span class="comment">//&#x8BF7;&#x6C42;&#x8DEF;&#x5F84;&#x548C;urlPerMap&#x4E2D;&#x7684;&#x8DEF;&#x5F84;&#x8FDB;&#x884C;&#x5339;&#x914D;&#xFF0C;&#x6210;&#x529F;&#x4E86;&#x5C31;&#x4ECE;urlPerMap&#x4E2D;&#x83B7;&#x53D6;&#x5BF9;&#x5E94;&#x8DEF;&#x5F84;&#x7684;&#x6743;&#x9650;</span></span><br><span class="line">            <span class="keyword">if</span>(matcher.matches(request)) {</span><br><span class="line">                <span class="keyword">return</span> urlPerMap.get(resUrl);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection&lt;ConfigAttribute&gt; <span class="title">getAllConfigAttributes</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Class&lt;?&gt; clazz)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x6743;&#x9650;&#x7BA1;&#x7406;&#x51B3;&#x65AD;&#x5668;CustomAccessDecisionManager&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test.security.security.permission;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * &#x6743;&#x9650;&#x7BA1;&#x7406;&#x51B3;&#x65AD;&#x5668;</span><br><span class="line"> *</span><br><span class="line"> * <span class="doctag">@Author</span>:jasoncool</span><br><span class="line"> * <span class="doctag">@Description</span>:</span><br><span class="line"> * AccessdecisionManager&#x5728;Spring security&#x4E2D;&#x662F;&#x5F88;&#x91CD;&#x8981;&#x7684;&#x3002;</span><br><span class="line"> * &#x5728;&#x9A8C;&#x8BC1;&#x90E8;&#x5206;&#x7B80;&#x7565;&#x63D0;&#x8FC7;&#x4E86;&#xFF0C;&#x6240;&#x6709;&#x7684;Authentication&#x5B9E;&#x73B0;&#x9700;&#x8981;&#x4FDD;&#x5B58;&#x5728;&#x4E00;&#x4E2A;GrantedAuthority&#x5BF9;&#x8C61;&#x6570;&#x7EC4;&#x4E2D;&#x3002;</span><br><span class="line"> * &#x8FD9;&#x5C31;&#x662F;&#x8D4B;&#x4E88;&#x7ED9;&#x4E3B;&#x4F53;&#x7684;&#x6743;&#x9650;&#x3002; GrantedAuthority&#x5BF9;&#x8C61;&#x901A;&#x8FC7;AuthenticationManager</span><br><span class="line"> * &#x4FDD;&#x5B58;&#x5230; Authentication&#x5BF9;&#x8C61;&#x91CC;&#xFF0C;&#x7136;&#x540E;&#x4ECE;AccessDecisionManager&#x8BFB;&#x51FA;&#x6765;&#xFF0C;&#x8FDB;&#x884C;&#x6388;&#x6743;&#x5224;&#x65AD;&#x3002;</span><br><span class="line"> * Spring Security&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E9B;&#x62E6;&#x622A;&#x5668;&#xFF0C;&#x6765;&#x63A7;&#x5236;&#x5BF9;&#x5B89;&#x5168;&#x5BF9;&#x8C61;&#x7684;&#x8BBF;&#x95EE;&#x6743;&#x9650;&#xFF0C;&#x4F8B;&#x5982;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x6216;web&#x8BF7;&#x6C42;&#x3002;</span><br><span class="line"> * &#x4E00;&#x4E2A;&#x662F;&#x5426;&#x5141;&#x8BB8;&#x6267;&#x884C;&#x8C03;&#x7528;&#x7684;&#x9884;&#x8C03;&#x7528;&#x51B3;&#x5B9A;&#xFF0C;&#x662F;&#x7531;AccessDecisionManager&#x5B9E;&#x73B0;&#x7684;&#x3002;</span><br><span class="line"> * &#x8FD9;&#x4E2A; AccessDecisionManager &#x88AB;AbstractSecurityInterceptor&#x8C03;&#x7528;&#xFF0C;</span><br><span class="line"> * &#x5B83;&#x7528;&#x6765;&#x4F5C;&#x6700;&#x7EC8;&#x8BBF;&#x95EE;&#x63A7;&#x5236;&#x7684;&#x51B3;&#x5B9A;&#x3002; &#x8FD9;&#x4E2A;AccessDecisionManager&#x63A5;&#x53E3;&#x5305;&#x542B;&#x4E09;&#x4E2A;&#x65B9;&#x6CD5;&#xFF1A;</span><br><span class="line"> * void decide(Authentication authentication, Object secureObject,</span><br><span class="line"> * List&lt;ConfigAttributeDefinition&gt; config) throws AccessDeniedException;</span><br><span class="line"> * boolean supports(ConfigAttribute attribute);</span><br><span class="line"> * boolean supports(Class clazz);</span><br><span class="line"> * &#x4ECE;&#x7B2C;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x6765;&#xFF0C;AccessDecisionManager&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x6240;&#x6709;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x597D;&#x50CF;&#x5728;&#x8BA4;&#x8BC1;&#x8BC4;&#x4F30;&#x65F6;&#x8FDB;&#x884C;&#x51B3;&#x5B9A;&#x3002;</span><br><span class="line"> * &#x7279;&#x522B;&#x662F;&#xFF0C;&#x5728;&#x771F;&#x5B9E;&#x7684;&#x5B89;&#x5168;&#x65B9;&#x6CD5;&#x671F;&#x671B;&#x8C03;&#x7528;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F20;&#x9012;&#x5B89;&#x5168;Object&#x542F;&#x7528;&#x90A3;&#x4E9B;&#x53C2;&#x6570;&#x3002;</span><br><span class="line"> * &#x6BD4;&#x5982;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x5047;&#x8BBE;&#x5B89;&#x5168;&#x5BF9;&#x8C61;&#x662F;&#x4E00;&#x4E2A;MethodInvocation&#x3002;</span><br><span class="line"> * &#x5F88;&#x5BB9;&#x6613;&#x4E3A;&#x4EFB;&#x4F55;Customer&#x53C2;&#x6570;&#x67E5;&#x8BE2;MethodInvocation&#xFF0C;</span><br><span class="line"> * &#x7136;&#x540E;&#x5728;AccessDecisionManager&#x91CC;&#x5B9E;&#x73B0;&#x4E00;&#x4E9B;&#x6709;&#x5E8F;&#x7684;&#x5B89;&#x5168;&#x903B;&#x8F91;&#xFF0C;&#x6765;&#x786E;&#x8BA4;&#x4E3B;&#x4F53;&#x662F;&#x5426;&#x5141;&#x8BB8;&#x5728;&#x90A3;&#x4E2A;&#x5BA2;&#x6237;&#x4E0A;&#x64CD;&#x4F5C;&#x3002;</span><br><span class="line"> * &#x5982;&#x679C;&#x8BBF;&#x95EE;&#x88AB;&#x62D2;&#x7EDD;&#xFF0C;&#x5B9E;&#x73B0;&#x5C06;&#x629B;&#x51FA;&#x4E00;&#x4E2A;AccessDeniedException&#x5F02;&#x5E38;&#x3002;</span><br><span class="line"> * &#x8FD9;&#x4E2A; supports(ConfigAttribute) &#x65B9;&#x6CD5;&#x5728;&#x542F;&#x52A8;&#x7684;&#x65F6;&#x5019;&#x88AB;</span><br><span class="line"> * AbstractSecurityInterceptor&#x8C03;&#x7528;&#xFF0C;&#x6765;&#x51B3;&#x5B9A;AccessDecisionManager</span><br><span class="line"> * &#x662F;&#x5426;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x4F20;&#x9012;ConfigAttribute&#x3002;</span><br><span class="line"> * supports(Class)&#x65B9;&#x6CD5;&#x88AB;&#x5B89;&#x5168;&#x62E6;&#x622A;&#x5668;&#x5B9E;&#x73B0;&#x8C03;&#x7528;&#xFF0C;</span><br><span class="line"> * &#x5305;&#x542B;&#x5B89;&#x5168;&#x62E6;&#x622A;&#x5668;&#x5C06;&#x663E;&#x793A;&#x7684;AccessDecisionManager&#x652F;&#x6301;&#x5B89;&#x5168;&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#x578B;&#x3002;</span><br><span class="line">        *<span class="doctag">@Date</span>:&#x521B;&#x5EFA;&#x4E8E;&#x4E0A;&#x5348; 11:45 2018/5/24</span><br><span class="line">        *<span class="doctag">@Modified</span>:</span><br><span class="line">        */</span></span><br><span class="line">        <span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line">        <span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line">        <span class="keyword">import</span> org.springframework.security.access.AccessDecisionManager;</span><br><span class="line">        <span class="keyword">import</span> org.springframework.security.access.AccessDeniedException;</span><br><span class="line">        <span class="keyword">import</span> org.springframework.security.access.ConfigAttribute;</span><br><span class="line">        <span class="keyword">import</span> org.springframework.security.authentication.InsufficientAuthenticationException;</span><br><span class="line">        <span class="keyword">import</span> org.springframework.security.core.Authentication;</span><br><span class="line">        <span class="keyword">import</span> org.springframework.security.core.GrantedAuthority;</span><br><span class="line">        <span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line">        <span class="keyword">import</span> java.util.Collection;</span><br><span class="line">        <span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="annotation">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomAccessDecisionManager</span> <span class="keyword">implements</span> <span class="title">AccessDecisionManager</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> Logger log = LoggerFactory.getLogger(CustomAccessDecisionManager.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x5224;&#x65AD;&#x8BE5;&#x7528;&#x6237;&#x5BF9;&#x4E8E;&#x6B64;&#x9875;&#x9762;&#x662F;&#x5426;&#x6709;&#x6743;&#x9650;&#x8BBF;&#x95EE;&#x7684;&#x51B3;&#x7B56;&#x65B9;&#x6CD5;</span><br><span class="line">     * <span class="doctag">@param</span> authentication &#x662F;&#x91CA;CustomUserService&#x4E2D;&#x5FAA;&#x73AF;&#x6DFB;&#x52A0;&#x5230; GrantedAuthority &#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x6743;&#x9650;&#x4FE1;&#x606F;&#x96C6;&#x5408;.</span><br><span class="line">     * <span class="doctag">@param</span> object &#x5305;&#x542B;&#x5BA2;&#x6237;&#x7AEF;&#x53D1;&#x8D77;&#x7684;&#x8BF7;&#x6C42;&#x7684;requset&#x4FE1;&#x606F;&#xFF0C;&#x53EF;&#x8F6C;&#x6362;&#x4E3A; HttpServletRequest request = ((FilterInvocation) object).getHttpRequest();</span><br><span class="line">     * <span class="doctag">@param</span> configAttributes &#x4E3A;MyInvocationSecurityMetadataSource&#x7684;getAttributes(Object object)&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x679C;&#xFF0C;</span><br><span class="line">     *                         &#x6B64;&#x65B9;&#x6CD5;&#x662F;&#x4E3A;&#x4E86;&#x5224;&#x5B9A;&#x7528;&#x6237;&#x8BF7;&#x6C42;&#x7684;url &#x662F;&#x5426;&#x5728;&#x6743;&#x9650;&#x8868;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x6743;&#x9650;&#x8868;&#x4E2D;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;&#x7ED9; decide &#x65B9;&#x6CD5;&#xFF0C;</span><br><span class="line">     *                         &#x7528;&#x6765;&#x5224;&#x5B9A;&#x7528;&#x6237;&#x662F;&#x5426;&#x6709;&#x6B64;&#x6743;&#x9650;&#x3002;&#x5982;&#x679C;&#x4E0D;&#x5728;&#x6743;&#x9650;&#x8868;&#x4E2D;&#x5219;&#x653E;&#x884C;&#x3002;</span><br><span class="line">     * <span class="doctag">@throws</span> AccessDeniedException &#x5982;&#x679C;&#x8BA4;&#x8BC1;&#x5BF9;&#x8C61;&#x4E0D;&#x5177;&#x6709;&#x6240;&#x9700;&#x7684;&#x6743;&#x9650;&#x5219;&#x629B;&#x51FA;&#x6B64;&#x5F02;&#x5E38;</span><br><span class="line">     * <span class="doctag">@throws</span> InsufficientAuthenticationException &#x5982;&#x679C;&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#x8BF7;&#x6C42;&#x56E0;&#x4E3A;&#x51ED;&#x636E;&#x4FE1;&#x4EFB;&#x4E0D;&#x8DB3;&#x800C;&#x88AB;&#x62D2;&#x7EDD;&#xFF0C;&#x5219;&#x4F1A;&#x629B;&#x51FA;&#x6B64;&#x9519;&#x8BEF;&#x3002;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">decide</span><span class="params">(Authentication authentication, Object object, Collection&lt;ConfigAttribute&gt; configAttributes)</span> <span class="keyword">throws</span> AccessDeniedException, InsufficientAuthenticationException </span>{</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == configAttributes || configAttributes.size() &lt;= <span class="number">0</span>) {</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        }</span><br><span class="line">        String needRole;</span><br><span class="line">        <span class="keyword">for</span> (Iterator&lt;ConfigAttribute&gt; iter = configAttributes.iterator(); iter.hasNext(); ) {</span><br><span class="line">            ConfigAttribute c = iter.next();</span><br><span class="line">            <span class="comment">//&#x5F97;&#x5230;&#x8BBF;&#x95EE;&#x8FD9;&#x4E2A;&#x754C;&#x9762;&#x9700;&#x8981;&#x7684;&#x6743;&#x9650;</span></span><br><span class="line">            needRole = c.getAttribute();</span><br><span class="line">            <span class="comment">//authentication &#x4E3A;&#x5728;CustomUserService&#x4E2D;&#x5FAA;&#x73AF;&#x6DFB;&#x52A0;&#x5230; GrantedAuthority &#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x6743;&#x9650;&#x4FE1;&#x606F;&#x96C6;&#x5408;</span></span><br><span class="line">            <span class="keyword">for</span> (GrantedAuthority ga : authentication.getAuthorities()) {</span><br><span class="line">                <span class="keyword">if</span> (needRole.trim().equals(ga.getAuthority())) {</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            log.info(<span class="string">&quot;&#x3010;&#x6743;&#x9650;&#x7BA1;&#x7406;&#x51B3;&#x65AD;&#x5668;&#x3011;&#x9700;&#x8981;role:&quot;</span> + needRole);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> AccessDeniedException(<span class="string">&quot;Access is denied&quot;</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(ConfigAttribute attribute)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Class&lt;?&gt; clazz)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x6574;&#x4F53;&#x62E6;&#x622A;&#x5668;CustomDenyAllPermissionEvaluator:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test.security.security.permission;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.access.expression.DenyAllPermissionEvaluator;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.Authentication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.GrantedAuthority;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.userdetails.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@author</span>:jasoncool</span><br><span class="line"> * <span class="doctag">@Description</span>:</span><br><span class="line"> * &#x4E00;&#x4E2A;&#x62D2;&#x7EDD;&#x6240;&#x6709;&#x8BBF;&#x95EE;&#x7684;&#x7A7A;PermissionEvaluator&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x7528;&#x4E8E;&#x4E0D;&#x9700;&#x8981;&#x6743;&#x9650;&#x8BC4;&#x4F30;&#x7684;&#x60C5;&#x51B5;&#x3002; </span><br><span class="line"> *  &#x5982;&#x679C;Controller&#x4E2D;&#x52A0;&#x5165;&#x4E86;&#x6CE8;&#x89E3;<span class="doctag">@PreAuthorize</span>(&quot;hasPermission(&apos;GUEST&apos;)&quot;)&#xFF0C;&#x5C31;&#x4F1A;&#x8C03;&#x7528;DenyAllPermissionEvaluator </span><br><span class="line"> * &#x7531;&#x4E8E;DenyAllPermissionEvaluator&#x4F1A;&#x9ED8;&#x8BA4;&#x62E6;&#x622A;&#x6240;&#x6709;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#xFF0C;&#x4F46;&#x5176;&#x5B9E;&#x8FD9;&#x65F6;&#x7684;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x5DF2;&#x7ECF;&#x662F;&#x7ECF;&#x8FC7;&#x6743;&#x9650;&#x8FC7;&#x6EE4;&#x8FC7;&#x7684;&#x8BF7;&#x6C42;&#x4E86;&#xFF0C; </span><br><span class="line"> * &#x662F;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x7684;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x7EE7;&#x627F;DenyAllPermissionEvaluator &#x5E76;&#x91CD;&#x5199;haspermission&#x65B9;&#x6CD5;&#xFF0C;&#x8BA9;&#x5176;&#x8FD4;&#x56DE;true&#x5373;&#x53EF;&#x3002; </span><br><span class="line"> * &#x5982;&#x679C;&#x53BB;&#x6389;&#x4E86;<span class="doctag">@PreAuthorize</span>(&quot;hasPermission(&apos;GUEST&apos;)&quot;)&#x6CE8;&#x89E3;&#xFF0C;&#x8BBF;&#x95EE;&#x5BF9;&#x5E94;&#x7684;Controller&#x65B9;&#x6CD5;&#x5219;&#x4E0D;&#x4F1A;&#x8FDB;&#x5165;&#x672C;&#x7C7B;&#x3002;</span><br><span class="line"> * <span class="doctag">@Date</span>:&#x521B;&#x5EFA;&#x4E8E;&#x4E0A;&#x5348; 11:50 2018/5/25</span><br><span class="line"> * <span class="doctag">@Modified</span>:</span><br><span class="line"> */</span></span><br><span class="line"><span class="annotation">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomDenyAllPermissionEvaluator</span> <span class="keyword">extends</span> <span class="title">DenyAllPermissionEvaluator</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> Logger logger = LoggerFactory.getLogger(<span class="keyword">this</span>.getClass());</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasPermission</span><span class="params">(Authentication authentication, Object target, Object permission)</span> </span>{</span><br><span class="line">        User user = (User)authentication.getPrincipal();</span><br><span class="line">        logger.info(<span class="string">&quot;&#x7528;&#x6237;&#x540D;&#x662F;&#xFF1A;&quot;</span>+user.getUsername());</span><br><span class="line">        Collection&lt;GrantedAuthority&gt; authorities = user.getAuthorities();</span><br><span class="line">        <span class="keyword">for</span>(GrantedAuthority authority : authorities) {</span><br><span class="line">            String roleName = authority.getAuthority();</span><br><span class="line">            logger.info(user.getUsername()+<span class="string">&quot;&#x7684;&#x6743;&#x9650;&#x6709;&#xFF1A;&quot;</span>+roleName);</span><br><span class="line">        }</span><br><span class="line">        logger.info(authentication.getName()+<span class="string">&quot;&#x8BBF;&#x95EE;&#x4E86;&quot;</span>+target.toString()+<span class="string">&quot;&#x8DEF;&#x5F84;&#x7684;&quot;</span>+permission.toString()+<span class="string">&quot;&#x6743;&#x9650;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD8;&#x6709;&#x5C31;&#x662F;LoginController,&#x5206;&#x4E3A;&#x6709;&#x89D2;&#x8272;&#x8FC7;&#x6EE4;&#x7684;&#x8BF7;&#x6C42;&#x548C;&#x666E;&#x901A;&#x8BF7;&#x6C42;&#xFF0C;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test.security.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.access.prepost.PreAuthorize;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.AuthenticationException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.context.SecurityContextHolder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@Author</span>:jasoncool</span><br><span class="line"> * <span class="doctag">@Description</span>:</span><br><span class="line"> * <span class="doctag">@Date</span>:&#x521B;&#x5EFA;&#x4E8E;&#x4E0A;&#x5348; 09:12 2018/5/23</span><br><span class="line"> * <span class="doctag">@Modified</span>:</span><br><span class="line"> */</span></span><br><span class="line"><span class="annotation">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginController</span> </span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> Logger logger = LoggerFactory.getLogger(LoginController.class);</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@RequestMapping</span>(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">showHome</span><span class="params">()</span> </span>{</span><br><span class="line">        String name = SecurityContextHolder.getContext().getAuthentication().getName();</span><br><span class="line">        logger.info(<span class="string">&quot;&#x5F53;&#x524D;&#x767B;&#x9646;&#x7528;&#x6237;&#xFF1A;&quot;</span> + name);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;home.html&quot;</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@RequestMapping</span>(<span class="string">&quot;/login&quot;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">showLogin</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;login.html&quot;</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">  <span class="annotation">@RequestMapping</span>(<span class="string">&quot;/admin&quot;</span>)</span><br><span class="line">    <span class="annotation">@ResponseBody</span></span><br><span class="line">    <span class="annotation">@PreAuthorize</span>(<span class="string">&quot;hasRole(&apos;ADMIN&apos;)&quot;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">printAdmin</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#x5982;&#x679C;&#x4F60;&#x770B;&#x89C1;&#x8FD9;&#x53E5;&#x8BDD;&#xFF0C;&#x8BF4;&#x660E;&#x4F60;&#x6709;ROLE_ADMIN&#x89D2;&#x8272;&quot;</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="annotation">@RequestMapping</span>(<span class="string">&quot;/user&quot;</span>)</span><br><span class="line">    <span class="annotation">@ResponseBody</span></span><br><span class="line">    <span class="annotation">@PreAuthorize</span>(<span class="string">&quot;hasRole(&apos;USER&apos;)&quot;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">printUser</span><span class="params">(String s)</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">&quot;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~: &quot;</span>+s);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#x5982;&#x679C;&#x4F60;&#x770B;&#x89C1;&#x8FD9;&#x53E5;&#x8BDD;&#xFF0C;&#x8BF4;&#x660E;&#x4F60;&#x6709;ROLE_USER&#x89D2;&#x8272;&quot;</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@RequestMapping</span>(<span class="string">&quot;/admin/r&quot;</span>)</span><br><span class="line">    <span class="annotation">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">printAdminR</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#x5982;&#x679C;&#x4F60;&#x770B;&#x89C1;&#x8FD9;&#x53E5;&#x8BDD;&#xFF0C;&#x8BF4;&#x660E;&#x4F60;&#x8BBF;&#x95EE;/admin&#x8DEF;&#x5F84;&#x5177;&#x6709;r&#x6743;&#x9650;&quot;</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@RequestMapping</span>(<span class="string">&quot;/admin/u&quot;</span>)</span><br><span class="line">    <span class="annotation">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">printAdminU</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#x5982;&#x679C;&#x4F60;&#x770B;&#x89C1;&#x8FD9;&#x53E5;&#x8BDD;&#xFF0C;&#x8BF4;&#x660E;&#x4F60;&#x8BBF;&#x95EE;/admin&#x8DEF;&#x5F84;&#x5177;&#x6709;update&#x6743;&#x9650;&quot;</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@RequestMapping</span>(<span class="string">&quot;/admin/d&quot;</span>)</span><br><span class="line">    <span class="annotation">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">printAdminD</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#x5982;&#x679C;&#x4F60;&#x770B;&#x89C1;&#x8FD9;&#x53E5;&#x8BDD;&#xFF0C;&#x8BF4;&#x660E;&#x4F60;&#x8BBF;&#x95EE;/admin&#x8DEF;&#x5F84;&#x5177;&#x6709;delete&#x6743;&#x9650;&quot;</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@RequestMapping</span>(<span class="string">&quot;/admin/c&quot;</span>)</span><br><span class="line">    <span class="annotation">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">printAdminC</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#x5982;&#x679C;&#x4F60;&#x770B;&#x89C1;&#x8FD9;&#x53E5;&#x8BDD;&#xFF0C;&#x8BF4;&#x660E;&#x4F60;&#x8BBF;&#x95EE;/admin&#x8DEF;&#x5F84;&#x5177;&#x6709;c&#x6743;&#x9650;&quot;</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@RequestMapping</span>(<span class="string">&quot;/login/error&quot;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loginError</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> </span>{</span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">        AuthenticationException exception =</span><br><span class="line">                (AuthenticationException)request.getSession().getAttribute(<span class="string">&quot;SPRING_SECURITY_LAST_EXCEPTION&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            response.getWriter().write(exception.toString());</span><br><span class="line">        }<span class="keyword">catch</span> (IOException e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x65B0;&#x7684;&#x767B;&#x5F55;&#x6210;&#x529F;&#x754C;&#x9762;home.html:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">lang</span>=<span class="value">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">h1</span>&gt;</span>&#x767B;&#x9646;&#x6210;&#x529F;<span class="tag">&lt;/<span class="title">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">&quot;/admin&quot;</span>&gt;</span>&#x68C0;&#x6D4B;ROLE_ADMIN&#x89D2;&#x8272;<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">&quot;/user&quot;</span>&gt;</span>&#x68C0;&#x6D4B;ROLE_USER&#x89D2;&#x8272;<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">&quot;/admin/c&quot;</span>&gt;</span>&#x68C0;&#x6D4B;admin&#x7684;C&#x6743;&#x9650;<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">&quot;/admin/r&quot;</span>&gt;</span>&#x68C0;&#x6D4B;admin&#x7684;R&#x6743;&#x9650;<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">&quot;/admin/u&quot;</span>&gt;</span>&#x68C0;&#x6D4B;admin&#x7684;U&#x6743;&#x9650;<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">&quot;/admin/d&quot;</span>&gt;</span>&#x68C0;&#x6D4B;admin&#x7684;D&#x6743;&#x9650;<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">button</span> <span class="attribute">onclick</span>=<span class="value">&quot;window.location.href=&apos;/logout&apos;&quot;</span>&gt;</span>&#x9000;&#x51FA;&#x767B;&#x5F55;<span class="tag">&lt;/<span class="title">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;/html&gt; --&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x65B0;&#x52A0;&#x7684;&#x67E5;&#x8BE2;&#x65B9;&#x6CD5;findByAdminUserId,&#x5C31;&#x662F;&#x6839;&#x636E;&#x7528;&#x6237;id&#x83B7;&#x53D6;&#x7528;&#x6237;&#x62E5;&#x6709;&#x7684;&#x6240;&#x6709;&#x6743;&#x9650;&#xFF1A;<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">select</span> <span class="attribute">id</span>=<span class="value">&quot;findByAdminUserId&quot;</span> <span class="attribute">parameterType</span>=<span class="value">&quot;java.lang.Long&quot;</span> <span class="attribute">resultType</span>=<span class="value">&quot;com.test.security.entity.SysPermission&quot;</span>&gt;</span>   SELECT</span><br><span class="line">  p.*</span><br><span class="line">  FROM sys_user u</span><br><span class="line">  LEFT JOIN sys_user_role sru ON u.id= sru.user_id</span><br><span class="line">  LEFT JOIN sys_role r ON sru.role_id=r.id</span><br><span class="line">  LEFT JOIN Sys_permission p ON p.role_id =r.id</span><br><span class="line">  WHERE u.id=#{userId}</span><br><span class="line"><span class="tag">&lt;/<span class="title">select</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x4E0A;&#x8FB9;&#x5C31;&#x662F;&#x901A;&#x8FC7;&#x89D2;&#x8272;&#x548C;&#x6743;&#x9650;&#x6765;&#x7BA1;&#x7406;&#x7CFB;&#x7EDF;&#x7684;&#x8BBF;&#x95EE;&#x8303;&#x56F4;&#x4E86;&#xFF0C;&#x539F;&#x7406;&#x5728;&#x524D;&#x4E00;&#x7AE0;&#x5DF2;&#x7ECF;&#x5199;&#x6E05;&#x695A;&#x4E86;&#xFF0C;&#x5269;&#x4E0B;&#x7684;&#x5C31;&#x662F;&#x901A;&#x8FC7;&#x5B66;&#x4E60;&#x548C;&#x7406;&#x89E3;&#x8FD9;&#x90E8;&#x5206;&#x77E5;&#x8BC6;&#x540E;&#xFF0C;&#x5728;&#x5C06;&#x5176;&#x5E94;&#x7528;&#x5230;&#x81EA;&#x5DF1;&#x7684;&#x6743;&#x9650;&#x7BA1;&#x7406;&#x4E2D;&#x53BB;&#x3002;</p>
<p>&#x6700;&#x540E;&#x518D;&#x9644;&#x4E00;&#x7BC7;&#x524D;&#x8F88;&#x5199;&#x7684;&#x5173;&#x4E8E;&#x4ED6;&#x6240;&#x7406;&#x89E3;&#x7684;&#x6743;&#x9650;&#x7BA1;&#x7406;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x5E2E;&#x52A9;&#x4F60;&#x7406;&#x89E3;&#xFF1A;</p>
<p>&#x542F;&#x52A8;&#x670D;&#x52A1;&#xFF0C;&#x6253;&#x5F00;&#x6D4F;&#x89C8;&#x5668;&#xFF0C;&#x8F93;&#x5165;<a href="http://localhost:8080/ThirdSpringSecurity/user/user.jsp" target="_blank" rel="external">http://localhost:8080/ThirdSpringSecurity/user/user.jsp</a>&#xFF0C;&#x7531;&#x4E8E;&#x6709;&#x6743;&#x9650;&#x9650;&#x5236;&#xFF0C;&#x4F1A;&#x8DF3;&#x8F6C;&#x5230;&#x767B;&#x5F55;&#x9875;&#x9762;&#xFF0C;&#x8F93;&#x5165;user&#x8D26;&#x53F7;&#x548C;&#x5BC6;&#x7801;&#xFF08;&#x6CA1;&#x6709;&#x91C7;&#x7528;&#x5BC6;&#x6587;&#xFF09;&#x767B;&#x5F55;&#x540E;&#x5C31;&#x53EF;&#x4EE5;&#x5230;user.jsp&#x9875;&#x9762;&#xFF0C;&#x5982;&#x679C;&#x5C06;url&#x6539;&#x4E3A;<a href="http://localhost:8080/ThirdSpringSecurity/user/user.jsp" target="_blank" rel="external">http://localhost:8080/ThirdSpringSecurity/admin/admin.jsp</a>,&#x4F1A;&#x8DF3;&#x8F6C;&#x5230;&#x6743;&#x9650;&#x4E0D;&#x8DB3;&#x7684;&#x754C;&#x9762;&#x3002;<br>&#xFF0C;&#x9A8C;&#x8BC1;&#x53CA;&#x6388;&#x6743;&#x7684;&#x8FC7;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;</p>
<ol>
<li><p>&#x5F53;Web&#x670D;&#x52A1;&#x5668;&#x542F;&#x52A8;&#x65F6;&#xFF0C;&#x901A;&#x8FC7;Web.xml&#x4E2D;&#x5BF9;&#x4E8E;Spring Security&#x7684;&#x914D;&#x7F6E;&#xFF0C;&#x52A0;&#x8F7D;&#x8FC7;&#x6EE4;&#x5668;&#x94FE;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x52A0;&#x8F7D;MyFilterSecurityInterceptor&#x7C7B;&#x65F6;&#xFF0C;&#x4F1A;&#x6CE8;&#x5165;MyInvocationSecurityMetadataSourceService&#x3001;MyUserDetailsService&#x3001;MyAccessDecisionManager&#x7C7B;&#x3002;</p>
</li>
<li><p>&#x8BE5;MyInvocationSecurityMetadataSourceService&#x7C7B;&#x5728;&#x6267;&#x884C;&#x65F6;&#x4F1A;&#x63D0;&#x53D6;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x6240;&#x6709;&#x7684;&#x7528;&#x6237;&#x6743;&#x9650;&#xFF0C;&#x5F62;&#x6210;&#x6743;&#x9650;&#x5217;&#x5E76;&#x5FAA;&#x73AF;&#x8BE5;&#x6743;&#x9650;&#x5217;&#x8868;&#xFF0C;&#x901A;&#x8FC7;&#x6BCF;&#x4E2A;&#x6743;&#x9650;&#x518D;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x63D0;&#x53D6;&#x51FA;&#x8BE5;&#x6743;&#x9650;&#x6240;&#x5BF9;&#x5E94;&#x7684;&#x8D44;&#x6E90;&#x5217;&#x8868;&#xFF0C;&#x5E76;&#x5C06;&#x8D44;&#x6E90;&#xFF08;URL&#xFF09;&#x4F5C;&#x4E3A;key&#xFF0C;&#x6743;&#x9650;&#x5217;&#x8868;&#x4F5C;&#x4E3A;value&#xFF0C;&#x5F62;&#x6210;Map&#x7ED3;&#x6784;&#x7684;&#x6570;&#x636E;&#x3002;</p>
</li>
<li><p>&#x5F53;&#x7528;&#x6237;&#x767B;&#x5F55;&#x65F6;&#xFF0C;AuthenticationManager&#x8FDB;&#x884C;&#x54CD;&#x5E94;&#xFF0C;&#x901A;&#x8FC7;&#x7528;&#x6237;&#x8F93;&#x5165;&#x7684;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x7801;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x6839;&#x636E;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x7684;&#x5BC6;&#x7801;&#x7B97;&#x6CD5;&#x548C;&#x76D0;&#x503C;&#x7B49;&#x8FDB;&#x884C;&#x8BA1;&#x7B97;&#x5E76;&#x548C;&#x6570;&#x636E;&#x5E93;&#x6BD4;&#x5BF9;&#xFF0C;&#x5F53;&#x6B63;&#x786E;&#x65F6;&#x901A;&#x8FC7;&#x9A8C;&#x8BC1;&#x3002;&#x6B64;&#x65F6;MyUserDetailsService&#x8FDB;&#x884C;&#x54CD;&#x5E94;&#xFF0C;&#x6839;&#x636E;&#x7528;&#x6237;&#x540D;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x63D0;&#x53D6;&#x8BE5;&#x7528;&#x6237;&#x7684;&#x6743;&#x9650;&#x5217;&#x8868;&#xFF0C;&#x7EC4;&#x5408;&#x6210;UserDetails&#x4F9B;Spring Security&#x4F7F;&#x7528;&#x3002;</p>
</li>
<li><p>&#x5F53;&#x7528;&#x6237;&#x70B9;&#x51FB;&#x67D0;&#x4E2A;&#x529F;&#x80FD;&#x65F6;&#xFF0C;&#x89E6;&#x53D1;MyAccessDecisionManager&#x7C7B;&#xFF0C;&#x8BE5;&#x7C7B;&#x901A;&#x8FC7;decide&#x65B9;&#x6CD5;&#x5BF9;&#x7528;&#x6237;&#x7684;&#x8D44;&#x6E90;&#x8BBF;&#x95EE;&#x8FDB;&#x884C;&#x62E6;&#x622A;&#x3002;&#x7528;&#x6237;&#x70B9;&#x51FB;&#x67D0;&#x4E2A;&#x529F;&#x80FD;&#x65F6;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x8BF7;&#x6C42;&#x67D0;&#x4E2A;URL&#x6216;Action&#xFF0C; &#x65E0;&#x8BBA;.jsp&#x4E5F;&#x597D;&#xFF0C;.action&#x6216;.do&#x4E5F;&#x597D;&#xFF0C;&#x5728;&#x8BF7;&#x6C42;&#x65F6;&#x65E0;&#x4E00;&#x4F8B;&#x5916;&#x7684;&#x8868;&#x73B0;&#x4E3A;URL&#x3002;&#x8FD8;&#x8BB0;&#x5F97;&#x7B2C;2&#x6B65;&#x65F6;&#x90A3;&#x4E2A;Map&#x7ED3;&#x6784;&#x7684;&#x6570;&#x636E;&#x5417;&#xFF1F; &#x82E5;&#x7528;&#x6237;&#x70B9;&#x51FB;&#x4E86;&#x201D;login.action&#x201D;&#x8FD9;&#x4E2A;URL&#x4E4B;&#x540E;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;URL&#x5C31;&#x8DDF;&#x90A3;&#x4E2A;Map&#x7ED3;&#x6784;&#x7684;&#x6570;&#x636E;&#x4E2D;&#x7684;key&#x5BF9;&#x6BD4;&#xFF0C;&#x82E5;&#x4E24;&#x8005;&#x76F8;&#x540C;&#xFF0C;&#x5219;&#x6839;&#x636E;&#x8BE5;url&#x63D0;&#x53D6;&#x51FA;Map&#x7ED3;&#x6784;&#x7684;&#x6570;&#x636E;&#x4E2D;&#x7684;value&#x6765;&#xFF0C;&#x8FD9;&#x8BF4;&#x660E;&#xFF1A;&#x82E5;&#x8981;&#x8BF7;&#x6C42;&#x8FD9;&#x4E2A;URL&#xFF0C;&#x5FC5;&#x987B;&#x5177;&#x6709;&#x8DDF;&#x8FD9;&#x4E2A;URL&#x76F8;&#x5BF9;&#x5E94;&#x7684;&#x6743;&#x9650;&#x503C;&#x3002;&#x8FD9;&#x4E2A;&#x6743;&#x9650;&#x6709;&#x53EF;&#x80FD;&#x662F;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x6743;&#x9650;&#xFF0C;&#x4E5F;&#x6709;&#x53EF;&#x80FD;&#x662F;&#x4E00;&#x4E2A;&#x6743;&#x9650;&#x5217;&#x8868;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x4E00;&#x4E2A;URL&#x6709;&#x53EF;&#x80FD;&#x88AB;&#x591A;&#x79CD;&#x6743;&#x9650;&#x8BBF;&#x95EE;&#x3002;<br>&#x90A3;&#x597D;&#xFF0C;&#x6211;&#x4EEC;&#x5728;MyAccessDecisionManager&#x7C7B;&#x7684;decide&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x91CC;&#xFF0C;&#x5C06;&#x901A;&#x8FC7;URL&#x53D6;&#x5F97;&#x7684;&#x6743;&#x9650;&#x5217;&#x8868;&#x8FDB;&#x884C;&#x5FAA;&#x73AF;&#xFF0C;&#x7136;&#x540E;&#x8DDF;&#x7B2C;3&#x6B65;&#x4E2D;&#x767B;&#x5F55;&#x7684;&#x7528;&#x6237;&#x6240;&#x5177;&#x6709;&#x7684;&#x6743;&#x9650;&#x8FDB;&#x884C;&#x6BD4;&#x5BF9;&#xFF0C;&#x82E5;&#x76F8;&#x540C;&#xFF0C;&#x5219;&#x8868;&#x660E;&#x8BE5;&#x7528;&#x6237;&#x5177;&#x6709;&#x8BBF;&#x95EE;&#x8BE5;&#x8D44;&#x6E90;&#x7684;&#x6743;&#x5229;&#x3002; &#x4E0D;&#x5927;&#x660E;&#x767D;&#x5427;&#xFF1F;  &#x7B80;&#x5355;&#x5730;&#x8BF4;&#xFF0C; &#x5728;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x4E86;&#x8BBF;&#x95EE;&#x201C;LOGIN&#x201D;&#x8FD9;&#x4E2A;URL&#x5FC5;&#x987B;&#x662F;&#x5177;&#x6709;ROLE_ADMIN&#x6743;&#x9650;&#x7684;&#x4EBA;&#x6765;&#x8BBF;&#x95EE;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x767B;&#x5F55;&#x7528;&#x6237;&#x6070;&#x6070;&#x5177;&#x6709;&#x8BE5;ROLE_ADMIN&#x6743;&#x9650;&#xFF0C;&#x4E24;&#x8005;&#x7684;&#x6BD4;&#x5BF9;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5C31;&#x80FD;&#x591F;&#x8FD4;&#x56DE;TRUE&#xFF0C;&#x53EF;&#x4EE5;&#x5141;&#x8BB8;&#x8BE5;&#x7528;&#x6237;&#x8FDB;&#x884C;&#x8BBF;&#x95EE;&#x3002;&#x5C31;&#x8FD9;&#x4E48;&#x7B80;&#x5355;&#xFF01;<br>&#x4E0D;&#x8FC7;&#x5728;&#x7B2C;2&#x6B65;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E00;&#x5B9A;&#x8981;&#x6CE8;&#x610F;&#xFF0C;MyInvocationSecurityMetadataSoruceService&#x7C7B;&#x7684;loadResourceDefine()&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x5F62;&#x6210;&#x4EE5;URL&#x4E3A;key&#xFF0C;&#x6743;&#x9650;&#x5217;&#x8868;&#x4E3A;value&#x7684;Map&#x65F6;&#xFF0C;&#x8981;&#x6CE8;&#x610F;key&#x548C;Value&#x7684;&#x5BF9;&#x5E94;&#x6027;&#xFF0C;&#x907F;&#x514D;Value&#x7684;&#x4E0D;&#x6B63;&#x786E;&#x5BF9;&#x5E94;&#x5F62;&#x6210;&#x91CD;&#x590D;&#xFF0C;&#x8FD9;&#x6837;&#x4F1A;&#x5BFC;&#x81F4;&#x6CA1;&#x6709;&#x6743;&#x9650;&#x7684;&#x4EBA;&#x4E5F;&#x80FD;&#x8BBF;&#x95EE;&#x5230;&#x4E0D;&#x8BE5;&#x8BBF;&#x95EE;&#x5230;&#x7684;&#x8D44;&#x6E90;&#x3002;<br>&#x8FD8;&#x6709;getAttributes()&#x65B9;&#x6CD5;&#xFF0C;&#x8981;&#x6709; url.indexOf(&#x201C;?&#x201D;)&#x8FD9;&#x6837;&#x7684;&#x5224;&#x65AD;&#xFF0C;&#x8981;&#x901A;&#x8FC7;&#x5224;&#x65AD;&#x5BF9;URL&#x7279;&#x522B;&#x662F;Action&#x95EE;&#x53F7;&#x4E4B;&#x524D;&#x7684;&#x90E8;&#x5206;&#x8FDB;&#x884C;&#x5339;&#x914D;&#xFF0C;&#x9632;&#x6B62;&#x7528;&#x6237;&#x8BF7;&#x6C42;&#x7684;&#x5E26;&#x53C2;&#x6570;&#x7684;URL&#x4E0E;&#x4F60;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;URL&#x4E0D;&#x5339;&#x914D;&#xFF0C;&#x9020;&#x6210;&#x8BBF;&#x95EE;&#x62D2;&#x7EDD;&#xFF01;</p>
</li>
</ol>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[如何在Springboot中调用Nexus私有项目中的Controller等]]></title>
      <url>http://jasoncool.com/2018/05/16/%E5%A6%82%E4%BD%95%E5%9C%A8Springboot%E4%B8%AD%E8%B0%83%E7%94%A8Nexus%E7%A7%81%E6%9C%89%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84Controller%E7%AD%89/</url>
      <content type="html"><![CDATA[<h2 id="&#x8D77;&#x56E0;">&#x8D77;&#x56E0;</h2><p>&#x4E0A;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;(&#x300A;&#x642D;&#x5EFA;Naven&#x79C1;&#x670D;Nexus3,&#x5E76;&#x5728;IDEA&#x7684;Springboot&#x9879;&#x76EE;&#x4E0B;&#x4F7F;&#x7528;&#x300B;)&#x6211;&#x4EEC;&#x8BB2;&#x5230;&#x4E86;&#x5982;&#x4F55;&#x4F7F;&#x7528;Nexus&#x642D;&#x5EFA;&#x79C1;&#x670D;&#x5E76;&#x4E0A;&#x4F20;&#x76F8;&#x5173;&#x7684;&#x9879;&#x76EE;&#x4EE5;&#x53CA;&#x5982;&#x4F55;&#x5728;&#x5BBF;&#x4E3B;&#x9879;&#x76EE;&#x4E2D;&#x4F7F;&#x7528;Nexus&#x79C1;&#x670D;&#x7684;&#x5E93;&#x3002;<br>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x56DE;&#x60F3;&#x4E00;&#x4E0B;&#x6211;&#x5F53;&#x65F6;&#x505A;&#x8FD9;&#x4E2A;&#x79C1;&#x670D;&#x6709;&#x4E24;&#x4E2A;&#x76EE;&#x7684;&#xFF1A;</p>
<ol>
<li>&#x5C01;&#x88C5;&#x516C;&#x5171;&#x7C7B;&#x5E93;&#xFF0C;&#x4EE5;&#x5DE5;&#x5177;&#x7C7B;&#x548C;&#x9A8C;&#x8BC1;&#x7C7B;&#x4E3A;&#x4E3B;&#x3002;</li>
<li>&#x5C01;&#x88C5;&#x6743;&#x9650;&#x7CFB;&#x7EDF;&#xFF0C;&#x5C06;&#x6743;&#x9650;&#x7CFB;&#x7EDF;&#x5206;&#x4E3A;&#x5E26;&#x90E8;&#x95E8;&#x7684;&#x5BA1;&#x6279;&#x6743;&#x9650;&#x7CFB;&#x7EDF;&#x548C;&#x4E0D;&#x5E26;&#x90E8;&#x95E8;&#x7684;&#x6D4F;&#x89C8;&#x6743;&#x9650;&#x7CFB;&#x7EDF;&#x4E24;&#x79CD;&#xFF0C;&#x6839;&#x636E;&#x5177;&#x4F53;&#x7684;&#x4E1A;&#x52A1;&#xFF0C;&#x5F15;&#x5165;&#x4E0D;&#x540C;&#x7684;&#x6743;&#x9650;&#x7CFB;&#x7EDF;&#x3002;</li>
</ol>
<p>&#x7B2C;&#x4E00;&#x4E2A;&#x76EE;&#x7684;&#x5F88;&#x597D;&#x5B9E;&#x73B0;&#xFF0C; &#x4E0A;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x5DF2;&#x7ECF;&#x5E26;&#x7740;&#x5927;&#x5BB6;&#x5B9E;&#x73B0;&#x4E86;&#xFF0C;&#x95EE;&#x9898;&#x4E0D;&#x5927;&#xFF0C;&#x4F46;&#x662F;&#x7B2C;&#x4E8C;&#x4E2A;&#x76EE;&#x7684;&#xFF0C;&#x9700;&#x8981;&#x5C06;&#x4E00;&#x4E2A;&#x9879;&#x76EE;&#x7684;Controller Service&#x548C;Mapper&#x4EE5;&#x53CA;&#x9759;&#x6001;&#x9875;&#x9762;&#x90FD;&#x8981;&#x5C01;&#x88C5;&#x8D77;&#x6765;&#xFF0C;&#x5E76;&#x4E14;&#x8BA9;&#x5BBF;&#x4E3B;&#x9879;&#x76EE;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;pom&#x6587;&#x4EF6;&#x7684;dependency&#x5C31;&#x53EF;&#x4EE5;&#x5F15;&#x5165;&#x5E76;&#x4F7F;&#x7528;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x9762;&#x4E34;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x4E86;&#xFF0C;&#x5982;&#x4F55;&#x8BA9;&#x5F15;&#x5165;&#x9879;&#x76EE;&#x7684;Controller&#x80FD;&#x8D77;&#x4F5C;&#x7528;&#x5462;&#xFF1F;&#x9ED8;&#x8BA4;Springboot&#x662F;&#x4E0D;&#x626B;&#x63CF;&#x5B50;&#x9879;&#x76EE;&#x7684;&#x6CE8;&#x89E3;&#x7684;&#x5440;&#xFF1F;<br><a id="more"></a></p>
<h2 id="&#x89E3;&#x51B3;&#x65B9;&#x6848;">&#x89E3;&#x51B3;&#x65B9;&#x6848;</h2><ol>
<li>&#x5BF9;&#x4E8E;@Controller @Service @Mapper&#x7B49;&#x6CE8;&#x89E3;&#x7684;&#x626B;&#x63CF;&#x95EE;&#x9898;<br>&#x5728;&#x4F60;&#x7684;Springboot&#x542F;&#x52A8;&#x7C7B;&#x4E2D;&#x52A0;&#x5165;&#x6CE8;&#x89E3;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF1A;<br>@MapperScan(basePackages = &#x201C;com.dhcc.manmanagement.dao&#x201D;)<br>&#x6216;<br>@ComponentScan({&#x201C;com.dhcc.utils.controller&#x201D;,&#x201D;com.dhcc.manmanagement&#x201D;})<br>&#x5C31;&#x53EF;&#x4E86;&#xFF0C;&#x8FD9;&#x6837;&#x4F60;&#x7684;&#x5B50;&#x9879;&#x76EE;&#x4E2D;&#x7684;&#x7EC4;&#x4EF6;&#x4E5F;&#x53EF;&#x4EE5;&#x5728;Springboot&#x9879;&#x76EE;&#x542F;&#x52A8;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x88AB;&#x626B;&#x63CF;&#xFF0C;&#x5E76;&#x88AB;&#x5BBF;&#x4E3B;&#x9879;&#x76EE;&#x4F7F;&#x7528;&#x4E86;&#x3002;</li>
<li>&#x5BF9;&#x4E8E;html&#xFF0C;css, js&#x7B49;&#x6587;&#x4EF6;<br>&#x53EA;&#x8981;&#x5728;&#x5B50;&#x9879;&#x76EE;&#x7684;resource&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;templates&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x76F8;&#x5173;&#x7684;&#x8D44;&#x6E90;&#x6587;&#x4EF6;&#x653E;&#x5165;&#xFF0C;&#x5373;&#x53EF;&#x5B9E;&#x73B0;&#x5171;&#x7528;&#x3002;</li>
</ol>
<p>&#x89E3;&#x51B3;&#x4E86;&#x4E0A;&#x8FF0;&#x95EE;&#x9898;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x60F3;&#x8981;&#x5C01;&#x88C5;&#x4EFB;&#x4F55;&#x5171;&#x7528;&#x5E93;&#xFF0C;&#x5C31;&#x7B97;&#x4EE5;&#x9879;&#x76EE;&#x7684;&#x5F62;&#x5F0F;&#x5C01;&#x88C5;&#xFF0C;&#x4E5F;&#x4E0D;&#x662F;&#x4E0D;&#x53EF;&#x80FD;&#x4E86;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[使用LayoutInflator发生的子View高度不正确解决办法]]></title>
      <url>http://jasoncool.com/2018/03/26/%E4%BD%BF%E7%94%A8LayoutInflator%E5%8F%91%E7%94%9F%E7%9A%84%E5%AD%90View%E9%AB%98%E5%BA%A6%E4%B8%8D%E6%AD%A3%E7%A1%AE%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/</url>
      <content type="html"><![CDATA[<h2 id="&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#x6211;&#x7684;&#x5E03;&#x5C40;&#x6846;&#x67B6;">&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#x6211;&#x7684;&#x5E03;&#x5C40;&#x6846;&#x67B6;</h2><p>  &#x8FD9;&#x91CC;&#x5927;&#x5BB6;&#x5E94;&#x8BE5;&#x5F88;&#x5947;&#x602A;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x5148;&#x8981;&#x4ECB;&#x7ECD;&#x6211;&#x7684;&#x5E03;&#x5C40;&#x6846;&#x67B6;&#x5462;&#xFF1F;&#x5176;&#x5B9E;&#x4E3B;&#x8981;&#x7684;&#x539F;&#x56E0;&#x662F;&#x56E0;&#x4E3A;&#x5148;&#x4E86;&#x89E3;&#x4E86;&#x6211;&#x7684;&#x5E03;&#x5C40;&#x6846;&#x67B6;&#x540E;&#xFF0C;&#x518D;&#x53BB;&#x7406;&#x89E3;&#x6211;&#x4E3A;&#x4EC0;&#x4E48;&#x4F1A;&#x9047;&#x5230;&#x8FD9;&#x6837;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4F1A;&#x6BD4;&#x8F83;&#x5BB9;&#x6613;&#x6709;&#x4EE3;&#x5165;&#x611F;&#xFF0C;&#x4E0B;&#x6B21;&#x770B;&#x5B98;&#x4F60;&#x4E5F;&#x9047;&#x5230;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x7684;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x5F88;&#x5FEB;&#x7684;&#x60F3;&#x8D77;&#x6765;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x4E86;&#x3002;<br>  &#x73B0;&#x5728;&#x5148;&#x6765;&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#x4E00;&#x4E0B;&#x6211;&#x7684;&#x5E03;&#x5C40;&#xFF0C;&#x770B;&#x4EE3;&#x7801;&#xFF1A;<br><a id="more"></a><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">android.support.design.widget.CoordinatorLayout</span></span><br><span class="line">        <span class="attribute">xmlns:android</span>=<span class="value">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line">        <span class="attribute">xmlns:app</span>=<span class="value">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span><br><span class="line">        <span class="attribute">android:id</span>=<span class="value">&quot;@+id/root_layout&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">        <span class="attribute">android:focusable</span>=<span class="value">&quot;true&quot;</span></span><br><span class="line">        <span class="attribute">android:focusableInTouchMode</span>=<span class="value">&quot;true&quot;</span></span><br><span class="line">        <span class="attribute">android:background</span>=<span class="value">&quot;@color/white&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">android.support.design.widget.AppBarLayout</span></span><br><span class="line">            <span class="attribute">android:id</span>=<span class="value">&quot;@+id/abl&quot;</span></span><br><span class="line">            <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">            <span class="attribute">android:layout_height</span>=<span class="value">&quot;wrap_content&quot;</span></span><br><span class="line">            <span class="attribute">android:theme</span>=<span class="value">&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;</span></span><br><span class="line">            <span class="attribute">app:popupTheme</span>=<span class="value">&quot;@style/ThemeOverlay.AppCompat.Light&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">android.support.v7.widget.Toolbar</span></span><br><span class="line">                <span class="attribute">android:id</span>=<span class="value">&quot;@+id/toolbar&quot;</span></span><br><span class="line">                <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">                <span class="attribute">android:layout_height</span>=<span class="value">&quot;?attr/actionBarSize&quot;</span></span><br><span class="line">                <span class="attribute">app:layout_scrollFlags</span>=<span class="value">&quot;scroll|enterAlways&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">android.support.design.widget.AppBarLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">android.support.v4.widget.NestedScrollView</span></span><br><span class="line">            <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">            <span class="attribute">android:layout_height</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">            <span class="attribute">app:layout_behavior</span>=<span class="value">&quot;@string/appbar_scrolling_view_behavior&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">com.dhcc.pms.custom.StatusLayout</span></span><br><span class="line">                <span class="attribute">android:id</span>=<span class="value">&quot;@+id/activity_container&quot;</span></span><br><span class="line">                <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">                <span class="attribute">android:layout_height</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">                <span class="attribute">android:background</span>=<span class="value">&quot;@color/colorAccent&quot;</span></span><br><span class="line">                /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">android.support.v4.widget.NestedScrollView</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">android.support.design.widget.CoordinatorLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>   &#x719F;&#x6089;&#x5B89;&#x5353;&#x5F00;&#x53D1;&#x7684;&#x5E94;&#x8BE5;&#x5F88;&#x5BB9;&#x6613;&#x7406;&#x89E3;&#xFF0C;&#x8FD9;&#x4E2A;&#x5E03;&#x5C40;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x6211;&#x7684;&#x4E00;&#x4E2A;&#x57FA;&#x7C7B;&#x7684;&#x57FA;&#x7840;&#x5E03;&#x5C40;&#xFF0C;&#x8FD9;&#x91CC;&#x4EC0;&#x4E48;&#x90FD;&#x6CA1;&#x6709;&#xFF0C;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x7B80;&#x5355;&#x7684;CoordinatorLayout&#x57FA;&#x7840;&#x5E03;&#x5C40;&#x65B9;&#x5F0F;,&#x91CC;&#x9762;&#x552F;&#x4E00;&#x53EF;&#x89C1;&#x7684;&#x5C31;&#x662F;Toolbar&#xFF0C;&#x4ECA;&#x5929;&#x6211;&#x4EEC;&#x4E0D;&#x53BB;&#x8FFD;&#x7A76;&#x4E3A;&#x4E86;&#x5F62;&#x6210; &#x8FD9;&#x4E2A;&#x5E03;&#x5C40;&#x800C;&#x505A;&#x7684;&#x5176;&#x4ED6;&#x5DE5;&#x4F5C;&#xFF0C;&#x800C;&#x4E3B;&#x8981;&#x7814;&#x7A76;&#x7684;&#x662F;&#x8FD9;&#x4E2A;&#x5E03;&#x5C40;&#x65B9;&#x5F0F;&#x6240;&#x5E26;&#x6765;&#x7684;&#x4E00;&#x4E2A;&#x5947;&#x602A;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5C31;&#x662F;&#x5B50;View&#x7684;&#x9AD8;&#x5EA6;&#x4E0D;&#x6B63;&#x786E;&#x7684;&#x95EE;&#x9898;&#x3002;    </p>
<p>&#x5728;&#x5B9E;&#x9645;&#x5F00;&#x53D1;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x6211;&#x7684;&#x8BBE;&#x8BA1;&#x662F;&#x5F00;&#x53D1;&#x8005;&#x5728;&#x5F00;&#x53D1;&#x7684;&#x65F6;&#x5019;&#x53EA;&#x8981;&#x5199;&#x5177;&#x4F53;&#x7684;&#x4E1A;&#x52A1;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x5373;&#x53EF;&#xFF0C;&#x5199;&#x5B8C;&#x7684;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x5728;&#x5229;&#x7528;LayoutInflator&#x6DFB;&#x52A0;&#x5230;StatusLayout&#x4E2D;&#x53BB;&#xFF0C;&#x8FD9;&#x4E2A;StatusLayout&#x5176;&#x672C;&#x8D28;&#x5C31;&#x662F;&#x4E2A;FrameLayout,&#x4F60;&#x5728;&#x8FD9;&#x91CC;&#x4E5F;&#x53EF;&#x4EE5;&#x5C06;&#x5176;&#x66FF;&#x6362;&#x4E3A;FrameLayout,&#x5728;&#x672C;&#x6587;&#x4E2D;&#x4E0D;&#x4F1A;&#x6709;&#x4EFB;&#x4F55;&#x5F71;&#x54CD;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x5C31;&#x6D89;&#x53CA;&#x5230;&#x672C;&#x6587;&#x7684;&#x6838;&#x5FC3;&#x95EE;&#x9898;&#x4E86;&#xFF0C;&#x6211;&#x5728;&#x57FA;&#x7C7B;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#x4F7F;&#x7528;&#x4E86;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flActivityContainer.addView(LayoutInflater.from(<span class="keyword">this</span>).inflate(layoutId, flActivityContainer, <span class="keyword">false</span>));</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x884C;&#x4EE3;&#x7801;&#x6765;&#x5B9E;&#x73B0;&#x5E03;&#x5C40;&#x7684;&#x52A8;&#x6001;&#x5F15;&#x5165;&#xFF0C;&#x4F46;&#x662F;&#x5F15;&#x5165;&#x540E;&#xFF0C;&#x6211;&#x53D1;&#x73B0;&#x6211;&#x5B9E;&#x9645;&#x7684;&#x5E03;&#x5C40;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;<br><img src="/2018/03/26/&#x4F7F;&#x7528;LayoutInflator&#x53D1;&#x751F;&#x7684;&#x5B50;View&#x9AD8;&#x5EA6;&#x4E0D;&#x6B63;&#x786E;&#x89E3;&#x51B3;&#x529E;&#x6CD5;/1.png" alt="logo"></p>
<p>&#x56FE;1<br>&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x7C89;&#x7EA2;&#x8272;&#x5E94;&#x8BE5;&#x94FA;&#x6EE1;&#x6574;&#x4E2A;&#x80CC;&#x666F;&#x5C4F;&#x5E55;&#xFF0C;&#x4F46;&#x662F;&#x4ECE;&#x56FE;&#x4E2D;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x7C89;&#x7EA2;&#x8272;&#x53EA;&#x6709;&#x5B50;View&#x7684;&#x9AD8;&#x5EA6;&#x6709;&#x591A;&#x9AD8;&#xFF0C;&#x624D;&#x4F1A;&#x663E;&#x793A;&#x591A;&#x9AD8;&#xFF0C;&#x5E76;&#x4E0D;&#x662F;&#x50CF;&#x6211;&#x4EEC;&#x5728;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x4E2D;&#x8BBE;&#x7F6E;&#x7684;&#x90A3;&#x6837;&#x94FA;&#x6EE1;&#x5C4F;&#x5E55;&#xFF0C;OK,&#x95EE;&#x9898;&#x7EC8;&#x4E8E;&#x6765;&#x4E86;&#x3002;</p>
<h2 id="&#x7B2C;&#x4E00;&#x6B21;&#x5206;&#x6790;&#x95EE;&#x9898;">&#x7B2C;&#x4E00;&#x6B21;&#x5206;&#x6790;&#x95EE;&#x9898;</h2><p>&#x4ECE;&#x6B63;&#x5E38;&#x7684;&#x89D2;&#x5EA6;&#x6765;&#x770B;&#xFF0C;&#x6211;&#x7684;&#x7B2C;&#x4E00;&#x53CD;&#x5E94;&#x80AF;&#x5B9A;&#x662F;LayoutInflator&#x5F15;&#x5165;View&#x7684;&#x65F6;&#x5019;&#x4EA7;&#x751F;&#x7684;&#x95EE;&#x9898; &#xFF0C;&#x6B63;&#x597D;&#x52A0;&#x4E0A;LayoutInflator&#x8FD9;&#x91CC;&#x7684;&#x77E5;&#x8BC6;&#x70B9;&#x4E5F;&#x4E0D;&#x662F;&#x5F88;&#x7262;&#x9760;&#xFF0C;&#x4E8E;&#x662F;&#x6253;&#x7B97;&#x4ECE;&#x8FD9;&#x91CC;&#x51FA;&#x53D1;&#xFF0C;&#x597D;&#x597D;&#x7684;&#x5206;&#x6790;&#x4E00;&#x4E0B;&#x95EE;&#x9898;&#x7684;&#x539F;&#x56E0;&#x3002;</p>
<p>&#x9996;&#x5148;&#xFF0C;&#x6211;&#x4F1A;&#x901A;&#x8FC7;&#x4E09;&#x4E2A;&#x6848;&#x4F8B;&#xFF0C;&#x6765;&#x8BB2;&#x89E3;inflate&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x7531;&#x4E8E;&#x4E0D;&#x901A;&#x7684;&#x53C2;&#x6570;&#x800C;&#x4EA7;&#x751F;&#x4E0D;&#x540C;&#x7684;&#x53D8;&#x5316;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x662F;&#x4E09;&#x4E2A;&#x6848;&#x4F8B;&#xFF1F;</p>
<p>&#x6211;&#x4EEC;&#x5148;&#x770B;&#x770B;&#x65B9;&#x6CD5;&#x4F53;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> View <span class="title">inflate</span><span class="params">(@LayoutRes <span class="keyword">int</span> resource, @Nullable ViewGroup root, <span class="keyword">boolean</span> attachToRoot)</span></span></span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4F53;&#x6709;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x5F15;&#x5165;&#x7684;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x7684;resourceId,&#x8FD9;&#x4E2A;&#x5982;&#x679C;&#x4E3A;&#x7A7A;&#xFF0C;&#x90A3;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x81EA;&#x7136;&#x6267;&#x884C;&#x4E0D;&#x4E0B;&#x53BB;&#x4E86;&#x3002;&#x7B2C;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#x4E3A;boolean&#x503C;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x4F1A;&#x6709;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x662F;&#x5426;&#x5C06;&#x5F53;&#x524D;&#x8FD9;&#x4E2A;&#x5B50;view&#x52A0;&#x5165;&#x5230;&#x7236;&#x5E03;&#x5C40;&#x5BB9;&#x5668;&#x4E2D;&#x53BB;&#xFF0C;&#x800C;&#x5982;&#x679C;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x8BF4;&#x7684;&#x7236;&#x5E03;&#x5C40;&#x5BB9;&#x5668;&#x5982;&#x679C;&#x4E3A;&#x7A7A;&#xFF0C;&#x90A3;&#x540E;&#x9762;&#x7684;&#x5E03;&#x5C14;&#x503C;&#x4E0D;&#x8BBA;&#x662F;true&#x8FD8;&#x662F;false&#xFF0C;&#x7ED3;&#x679C;&#x90FD;&#x662F;&#x4E00;&#x6837;&#x7684;&#x4E86;&#xFF0C;&#x5C31;&#x662F;&#x65E0;&#x5BB6;&#x53EF;&#x5F52;&#x3002;<br>&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x6709;&#x4E09;&#x79CD;&#x72B6;&#x6001;&#xFF1A;</p>
<p>1.&#x7236;&#x5E03;&#x5C40;&#x4E0D;&#x4E3A;&#x7A7A;&#xFF0C;&#x5B50;&#x5E03;&#x5C40;&#x6DFB;&#x52A0;&#x5230;&#x7236;&#x5E03;&#x5C40;&#x4E2D;&#x53BB;&#x3002;<br>2.&#x7236;&#x5E03;&#x5C40;&#x4E0D;&#x4E3A;&#x7A7A;&#xFF0C;&#x5B50;&#x5E03;&#x5C40;&#x4E0D;&#x6DFB;&#x52A0;&#x5230;&#x7236;&#x5E03;&#x5C40;&#x4E2D;&#x53BB;&#x3002;<br>3.&#x7236;&#x5E03;&#x5C40;&#x4E3A;&#x7A7A;&#xFF0C;&#x5B50;&#x5E03;&#x5C40;&#x6DFB;&#x4E0D;&#x6DFB;&#x52A0;&#x5230;&#x7236;&#x5E03;&#x5C40;&#x4E2D;&#x53BB;&#x5DF2;&#x7ECF;&#x4E0D;&#x91CD;&#x8981;&#x4E86;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x6839;&#x636E;&#x8FD9;&#x4E09;&#x79CD;&#x72B6;&#x6001;&#x6765;&#x5206;&#x6790;&#x5404;&#x81EA;&#x7684;&#x60C5;&#x51B5;&#xFF1A;</p>
<h3 id="1-null!=root_&amp;&amp;attachToRoot==true">1.null!=root &amp;&amp;attachToRoot==true</h3><p>&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x8868;&#x793A;&#x5C06;resource&#x6307;&#x5B9A;&#x7684;&#x5E03;&#x5C40;&#x6DFB;&#x52A0;&#x5230;root&#x4E2D;&#x53BB;&#xFF0C;&#x6DFB;&#x52A0;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x6240;&#x6709;&#x5B50;View&#x76F8;&#x5173;&#x7684;&#x5E03;&#x5C40;&#x53C2;&#x6570;&#x90FD;&#x662F;&#x8D77;&#x4F5C;&#x7528;&#x7684;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x95EE;&#x4E86;&#xFF0C;&#x4EC0;&#x4E48;&#x53EB;&#x5E03;&#x5C40;&#x53C2;&#x6570;&#x8D77;&#x4F5C;&#x7528;&#xFF1F;<br>&#x4E3E;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#x5427;&#xFF1A;</p>
<p>&#x5F53;&#x4F60;&#x5199;&#x4E00;&#x4E2A;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x76F8;&#x5173;&#x7EC4;&#x4EF6;&#x90FD;&#x662F;&#x9700;&#x8981;&#x7ED9;&#x8FD9;&#x4E2A;&#x7EC4;&#x4EF6;&#x8BBE;&#x5B9A;android:layout_width&#x548C;android:layout_height&#xFF0C;&#x5047;&#x5982;&#x4F60;&#x5C06;&#x8FD9;&#x4E24;&#x4E2A;&#x5C5E;&#x6027;&#x90FD;&#x8BBE;&#x7F6E;&#x4E3A;match_parent&#xFF0C;&#x5E76;&#x4E14;&#x754C;&#x9762;&#x4E2D;&#x53EA;&#x6709;&#x8FD9;&#x4E00;&#x4E2A;&#x7EC4;&#x4EF6;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x7EC4;&#x4EF6;&#x5C31;&#x5E94;&#x5F53;&#x94FA;&#x6EE1;&#x6574;&#x4E2A;&#x5E03;&#x5C40;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;layout_width&#x548C;layout_height&#x8D77;&#x4F5C;&#x7528;&#x4E86;&#x3002;</p>
<p>&#x7EC4;&#x4EF6;&#x7684;&#x5E03;&#x5C40;&#x5C5E;&#x6027;&#x60F3;&#x5176;&#x4F5C;&#x7528;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x5173;&#x952E;&#x7684;&#x56E0;&#x7D20;&#x662F;&#x5176;&#x5FC5;&#x987B;&#x6709;&#x7236;&#x5E03;&#x5C40;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x7236;&#x5E03;&#x5C40;&#x90A3;&#x4E48;&#x5B50;View&#x7684;&#x5BBD;&#x548C;&#x9AD8;&#x5C06;&#x4E0D;&#x53EF;&#x6D4B;&#x91CF;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x95EE;&#x4E86;&#xFF0C;&#x90A3;&#x6211;&#x4EEC;&#x7684;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x6700;&#x5916;&#x5C42;&#x7684;ViewGroup&#x5C31;&#x6CA1;&#x6709;&#x7236;&#x5E03;&#x5C40;&#xFF0C;&#x5E03;&#x5C40;&#x53C2;&#x6570;&#x4E0D;&#x662F;&#x4E5F;&#x4E00;&#x6837;&#x8D77;&#x4F5C;&#x7528;&#x4E86;&#x5417;&#xFF1F;&#x90A3;&#x662F;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x6BCF;&#x4E2A;Activity&#x5176;&#x5B9E;&#x90FD;&#x5305;&#x542B;&#x4E86;&#x4E00;&#x4E2A;PhoneWindow&#xFF0C;&#x800C;PhoneWindow&#x53C8;&#x5305;&#x542B;&#x4E86;&#x4E00;&#x4E2A;DecorView&#xFF0C;DecorView&#x53C8;&#x662F;&#x7531;&#x4E00;&#x4E2A;TitleView&#x548C;&#x4E00;&#x4E2A;ContentView&#x7EC4;&#x6210;&#x7684;&#xFF0C;&#x800C;ContentView&#x7684;&#x6700;&#x5916;&#x5C42;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x4E00;&#x4E2A;FrameLayout,&#x6240;&#x4EE5;&#x5176;&#x5B9E;&#x6BCF;&#x4E2A;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x90FD;&#x662F;&#x6709;&#x7236;&#x5E03;&#x5C40;&#x7684;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x56DE;&#x5230;&#x5F53;&#x524D;&#x7684;&#x5F15;&#x5165;&#x65B9;&#x5F0F;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x4F1A;&#x7ED9;&#x8981;&#x5F15;&#x5165;&#x7684;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x52A0;&#x4E00;&#x4E2A;&#x7236;&#x5E03;&#x5C40;&#xFF0C;&#x8FD9;&#x6837;&#x5F53;&#x8FD9;&#x4E2A;&#x7EC4;&#x4EF6;&#x5B58;&#x5728;&#x7236;&#x5E03;&#x5C40;&#x65F6;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x5E03;&#x5C40;&#x53C2;&#x6570;&#x90FD;&#x662F;&#x8D77;&#x4F5C;&#x7528;&#x7684;&#x3002;</p>
<p>&#x4F46;&#x662F;&#x5F53;&#x6211;&#x4EEC;&#x518D;&#x5C06;&#x8FD9;&#x4E2A;inflate&#x4EA7;&#x751F;&#x7684;View&#x653E;&#x7F6E;&#x5230;&#x67D0;&#x4E2A;&#x5E03;&#x5C40;&#x4E2D;&#x53BB;&#x7684;&#x8BDD;&#xFF0C;&#x7CFB;&#x7EDF;&#x5C31;&#x4F1A;&#x62A5;&#x8FD9;&#x4E2A;&#x5F02;&#x5E38;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.lang.IllegalStateException: The specified child already has a parent. <span class="function">You must call <span class="title">removeView</span><span class="params">()</span> on the child&apos;s parent first.</span></span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x4E2A;&#x5F02;&#x5E38;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x5F53;&#x524D;&#x8FD9;&#x4E2A;&#x5B50;View&#x5DF2;&#x7ECF;&#x6709;&#x7236;View&#x4E86;&#xFF0C;&#x4E0D;&#x53EF;&#x4EE5;&#x91CD;&#x590D;&#x6DFB;&#x52A0;&#x4E86;&#xFF0C;&#x8FD9;&#x4E5F;&#x5370;&#x8BC1;&#x4E86;&#x4E4B;&#x524D;&#x6211;&#x4EEC;&#x7684;&#x5BF9;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x7406;&#x89E3;&#x3002;</p>
<h3 id="2-null!=root_&amp;&amp;attachToRoot==false">2.null!=root &amp;&amp;attachToRoot==false</h3><p>&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x8BBE;&#x7F6E;&#x5176;&#x5B9E;&#x6709;&#x70B9;&#x7ED5;&#xFF0C;&#x7B80;&#x5355;&#x6765;&#x8BF4;&#x5C31;&#x662F;&#xFF0C;&#x6211;&#x53C8;&#x60F3;&#x8BA9;&#x8FD9;&#x4E2A;&#x5B50;&#x5E03;&#x5C40;&#x7684;&#x53C2;&#x6570;&#x8D77;&#x4F5C;&#x7528;&#xFF0C;&#x6211;&#x53C8;&#x4E0D;&#x60F3;&#x8BA9;&#x8FD9;&#x4E2A;&#x5B50;View&#x53EA;&#x5904;&#x4E8E;&#x67D0;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;&#x4E2D;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x6765;&#x5F15;&#x5165;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x4E86;&#x3002;&#x8BF4;&#x767D;&#x4E86;&#x5C31;&#x662F;root&#x4F1A;&#x534F;&#x52A9;&#x5B50;View&#x6765;&#x751F;&#x6210;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#xFF0C;&#x4F46;&#x662F;&#x4EC5;&#x4EC5;&#x662F;&#x534F;&#x52A9;&#xFF0C;&#x8FD9;&#x4E24;&#x8005;&#x5E76;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x76F4;&#x63A5;&#x5173;&#x7CFB;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x5F53;&#x6211;&#x4EEC;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5F15;&#x5165;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x7684;&#x8BDD;&#xFF0C;&#x8FD9;&#x4E2A;&#x751F;&#x6210;&#x7684;&#x5B50;View&#x8FD9;&#x4F1A;&#x5176;&#x5B9E;&#x662F;&#x6CA1;&#x6709;&#x7236;&#x5E03;&#x5C40;&#x7684;&#xFF0C;&#x5FC5;&#x987B;&#x7528;ViewGroup&#x7684;add&#x65B9;&#x6CD5;&#x5C06;&#x5176;&#x52A0;&#x8F7D;&#x5230;&#x67D0;&#x4E2A;&#x7236;&#x5E03;&#x5C40;&#x4E2D;&#x53BB;&#xFF0C;&#x8BE5;&#x5B50;View&#x624D;&#x80FD;&#x5728;&#x754C;&#x9762;&#x4E2D;&#x663E;&#x793A;&#x51FA;&#x6765;&#x3002;</p>
<p>&#x7528;&#x4EE3;&#x7801;&#x6765;&#x8BF4;&#x5C31;&#x662F;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">View view = inflater.inflate(R.layout.linearlayout, <span class="keyword">null</span>, <span class="keyword">false</span>);  </span><br><span class="line">ll.addView(view);</span><br></pre></td></tr></table></figure>
<p>&#x540C;&#x6837;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x653E;&#x5230;&#x7B2C;&#x4E00;&#x4E2A;&#x5F15;&#x5165;&#x65B9;&#x5F0F;&#x4E2D;&#x5C31;&#x4F1A;&#x62A5;&#x521A;&#x624D;&#x6307;&#x51FA;&#x7684;&#x591A;&#x6B21;&#x5F15;&#x5165;&#x7684;&#x9519;&#x8BEF;&#xFF0C;&#x800C;&#x653E;&#x5230;&#x8FD9;&#x4E2A;&#x5F15;&#x5165;&#x65B9;&#x5F0F;&#x4E2D;&#x5219;&#x4E0D;&#x4F1A;&#x4E86;&#x3002;<br>&#x6211;&#x5728;&#x9879;&#x76EE;&#x4E2D;&#x7528;&#x7684;&#x4E5F;&#x662F;&#x8FD9;&#x79CD;&#x5F15;&#x5165;&#x65B9;&#x5F0F;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x8FD8;&#x662F;&#x6BD4;&#x8F83;&#x7075;&#x6D3B;&#xFF0C;&#x6211;&#x53EF;&#x4EE5;&#x5C06;&#x5176;&#x5F15;&#x5165;&#x5230;&#x4E0D;&#x901A;&#x7684;&#x5E03;&#x5C40;&#x754C;&#x9762;&#x4E2D;&#x53BB;&#xFF0C;&#x800C;&#x4E0D;&#x7528;&#x5C40;&#x9650;&#x5728;&#x67D0;&#x4E2A;&#x5177;&#x4F53;&#x7684;&#x7236;View&#x4E0B;&#x3002;</p>
<h3 id="3-null==root">3.null==root</h3><p>&#x5F53;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;root&#x4E3A;null&#x65F6;&#xFF0C;&#x4E0D;&#x8BBA;&#x7B2C;&#x4E09;&#x4E2A;&#x53C2;&#x6570;attachToRoot&#x4E3A;true&#x8FD8;&#x662F;&#x4E3A;false&#xFF0C;&#x5176;&#x7ED3;&#x679C;&#x90FD;&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x5C31;&#x662F;&#x8BF4;&#x6211;&#x4EEC;&#x4E0D;&#x9700;&#x8981;&#x628A;&#x5B50;View&#x5F15;&#x5165;&#x5230;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;&#x4E2D;&#x53BB;&#xFF0C;&#x5E76;&#x4E14;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;&#x6765;&#x534F;&#x52A9;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x5B50;View&#x6765;&#x751F;&#x6210;&#x5E03;&#x5C40;&#x53C2;&#x6570;&#xFF0C;&#x4ECE;&#x800C;&#x5B50;View&#x6240;&#x8BBE;&#x7F6E;&#x7684;&#x4EFB;&#x4F55;&#x5E03;&#x5C40;&#x53C2;&#x6570;&#x4E5F;&#x662F;&#x4E0D;&#x4F1A;&#x8D77;&#x4F5C;&#x7528;&#x4E86;&#x3002;<br>&#x5C31;&#x7B97;&#x5C06;&#x6B64;&#x65B9;&#x6CD5;&#x5F15;&#x5165;&#x7684;&#x5B50;View&#x518D;&#x5F15;&#x5165;&#x5230;&#x4EFB;&#x4F55;&#x7236;&#x5E03;&#x5C40;&#x4E2D;&#x53BB;&#xFF0C;&#x5176;&#x5E03;&#x5C40;&#x53C2;&#x6570;&#x7684;&#x4FE1;&#x606F;&#x4E5F;&#x4F1A;&#x5982;&#x56FE;1&#x90A3;&#x6837;&#xFF0C;&#x4E0D;&#x4F1A;&#x8D77;&#x4EFB;&#x4F55;&#x4F5C;&#x7528;&#xFF0C;&#x53EA;&#x4F1A;&#x8DDF;&#x7740;&#x6211;&#x8FD9;&#x4E2A;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x4E2D;&#x6240;&#x5B58;&#x5728;&#x7684;&#x7EC4;&#x4EF6;&#x7684;&#x5BBD;&#x9AD8;&#x800C;&#x52A8;&#x6001;&#x7684;&#x4FEE;&#x6539;&#x81EA;&#x5DF1;&#x7684;&#x5BBD;&#x548C;&#x9AD8;&#x3002;</p>
<p>&#x901A;&#x8FC7;&#x4E0A;&#x9762;&#x7684;&#x4ECB;&#x7ECD;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x4E5F;&#x7406;&#x89E3;&#x4E86;inflate&#x7684;&#x65B9;&#x6CD5;&#x76F8;&#x5173;&#x7684;&#x53C2;&#x6570;&#x4E86;&#xFF0C;&#x53EF;&#x89C1;&#x6211;&#x5728;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x7B2C;&#x4E8C;&#x79CD;&#x5F15;&#x5165;&#x65B9;&#x5F0F;&#xFF0C;&#x8FD9;&#x79CD;&#x5F15;&#x5165;&#x65B9;&#x5F0F;&#x662F;&#x5E94;&#x5F53;&#x53EF;&#x4EE5;&#x8BA9;&#x5B50;View&#x7684;&#x5E03;&#x5C40;&#x53C2;&#x6570;&#x8D77;&#x4F5C;&#x7528;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x7684;&#x6846;&#x67B6;&#x4E2D;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x8D77;&#x4F5C;&#x7528;&#xFF0C;&#x6240;&#x4EE5;&#x95EE;&#x9898;&#x4E0D;&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x522B;&#x6025;&#x522B;&#x6025;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x662F;&#x66F4;&#x52A0;&#x6DF1;&#x523B;&#x7684;&#x7406;&#x89E3;&#x4E86;LayoutInflator&#x7684;inflate&#x65B9;&#x6CD5;&#x4E86;&#x5417;&#xFF1F;</p>
<h2 id="&#x7B2C;&#x4E8C;&#x6B21;&#x5206;&#x6790;">&#x7B2C;&#x4E8C;&#x6B21;&#x5206;&#x6790;</h2><p>&#x521A;&#x624D;&#x7684;&#x5206;&#x6790;&#x5E76;&#x6CA1;&#x6709;&#x89E3;&#x51B3;&#x6211;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4E8E;&#x662F;&#x6211;&#x53C8;&#x5F00;&#x59CB;&#x5206;&#x6790;&#x5230;&#x5E95;&#x662F;&#x54EA;&#x91CC;&#x51FA;&#x4E86;&#x95EE;&#x9898;&#xFF0C;&#x5F53;&#x7136;&#xFF0C;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x7834;&#x6848;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x7834;&#x6848;&#x4E0E;&#x5426;&#x5C31;&#x770B;&#x4F60;&#x638C;&#x63E1;&#x7684;&#x7EBF;&#x7D22;&#x591A;&#x5C11;&#x4E86;&#xFF0C;&#x6211;&#x627E;&#x5230;&#x7684;&#x7EBF;&#x7D22;&#x662F;&#xFF0C;&#x5305;&#x88F9;&#x7740;StatusLayout&#x5916;&#x90E8;&#x7684;NestScrollView,&#x8FD9;&#x4E2A;&#x7A81;&#x7136;&#x8BA9;&#x6211;&#x8B66;&#x89C9;&#x8D77;&#x6765;&#xFF0C;&#x56E0;&#x4E3A;&#x4E4B;&#x524D;&#x5728;&#x6CA1;&#x6709;NestScrollView&#x8FD9;&#x4E2A;&#x7EC4;&#x4EF6;&#x7684;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x90FD;&#x4F7F;&#x7528;&#x7684;&#x662F;ScrollView&#x8FD9;&#x4E2A;&#x7EC4;&#x4EF6;&#xFF0C;&#x8FD9;&#x4E2A;&#x7EC4;&#x4EF6;&#x6709;&#x4E00;&#x4E2A;&#x4E0D;&#x6210;&#x6587;&#x7684;&#x5751;&#xFF1A;<br>&#x90A3;&#x5C31;&#x662F;&#x5982;&#x679C;&#x5728;ScrollView&#x4E2D;&#x7684;&#x5B50;View&#x9AD8;&#x5EA6;&#x5927;&#x4E8E;ScrollView&#x7684;&#x9AD8;&#x5EA6;&#x65F6;&#xFF0C;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x663E;&#x793A;&#x95EE;&#x9898;&#xFF1B;&#x4F46;&#x662F;&#x5982;&#x679C;&#x5B50;View&#x7684;&#x9AD8;&#x5EA6;&#x5C0F;&#x4E8E;ScrollView&#x7684;&#x9AD8;&#x5EA6;&#x65F6;&#xFF0C;&#x5B50;View&#x60F3;&#x8981;&#x4F7F;&#x7528;match_parent &#x5C5E;&#x6027;&#x5219;&#x5FC5;&#x987B;&#x52A0;&#x5165;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x8BBE;&#x7F6E;&#xFF0C;&#x90A3;&#x5C31;&#x662F;fillViewport=true&#x3002;<br>&#x9274;&#x4E8E;&#x4E0A;&#x9762;&#x8FD9;&#x4E2A;&#x5751;&#xFF0C;&#x6211;&#x7422;&#x78E8;&#x7740;NestScrollView&#x662F;&#x4E0D;&#x662F;&#x4E5F;&#x6709;&#x540C;&#x6837;&#x7684;&#x7279;&#x6027;&#x5462;&#xFF1F;<br>&#x8BF4;&#x7684;&#x518D;&#x591A;&#x4E0D;&#x5982;&#x76F4;&#x63A5;&#x52A0;&#x4E0A;&#x53C2;&#x6570;&#x8BD5;&#x8BD5;&#x6548;&#x679C;&#xFF1A;</p>
<p><img src="/2018/03/26/&#x4F7F;&#x7528;LayoutInflator&#x53D1;&#x751F;&#x7684;&#x5B50;View&#x9AD8;&#x5EA6;&#x4E0D;&#x6B63;&#x786E;&#x89E3;&#x51B3;&#x529E;&#x6CD5;/2.png" alt="logo"></p>
<p>&#x8D77;&#x4F5C;&#x7528;&#x4E86;&#xFF0C;&#x770B;&#x6765;&#x95EE;&#x9898;&#x51FA;&#x5728;&#x4E86;&#x8FD9;&#x91CC;&#xFF0C;&#x4E8E;&#x662F;&#x5F88;&#x597D;&#x5947;&#x8FD9;&#x4E2A;fillViewPort&#x5230;&#x5E95;&#x662F;&#x505A;&#x4EC0;&#x4E48;&#x7684;&#x5462;&#xFF1F;&#x5176;&#x5B9E;&#x4ED6;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x9605;&#x8BFB;ScrollView&#x7684;&#x6E90;&#x7801;&#x6765;&#x67E5;&#x770B;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ScrollView</span><span class="params">(Context context)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>(context, <span class="keyword">null</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ScrollView</span><span class="params">(Context context, AttributeSet attrs)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>(context, attrs, com.android.internal.R.attr.scrollViewStyle);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ScrollView</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>(context, attrs, defStyleAttr, <span class="number">0</span>);</span><br><span class="line">    }</span><br><span class="line"><span class="comment">//&#x8C03;&#x7528;&#x7B2C;&#x56DB;&#x4E2A;&#x6784;&#x9020;&#x65B9;&#x6CD5;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ScrollView</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr, <span class="keyword">int</span> defStyleRes)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(context, attrs, defStyleAttr, defStyleRes);</span><br><span class="line">        initScrollView();<span class="comment">//&#x521D;&#x59CB;&#x5316;ScrollView&#x7684;&#x4E00;&#x4E9B;&#x53C2;&#x6570;&#xFF0C;&#x540E;&#x9762;&#x4F1A;&#x8BB2;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> TypedArray a = context.obtainStyledAttributes(</span><br><span class="line">                attrs, com.android.internal.R.styleable.ScrollView, defStyleAttr, defStyleRes);<span class="comment">//&#x83B7;&#x53D6;&#x5C5E;&#x6027;&#x96C6;&#x5BF9;&#x8C61;</span></span><br><span class="line"></span><br><span class="line">        setFillViewport(a.getBoolean(R.styleable.ScrollView_fillViewport, <span class="keyword">false</span>));<span class="comment">//&#x6839;&#x636E;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5E03;&#x5C40;&#x662F;&#x5426;&#x6EA2;&#x51FA;&#x5F53;&#x524D;&#x7A97;&#x53E3;</span></span><br><span class="line"></span><br><span class="line">        a.recycle();<span class="comment">//TypedArray&#x5BF9;&#x8C61;&#x56DE;&#x6536;</span></span><br><span class="line">    }</span><br></pre></td></tr></table></figure></p>
<p>ScrollView&#x7684;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x4E2D;&#x6709;&#x4E00;&#x53E5;&#x6E90;&#x7801;&#x662F;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setFillViewport(a.getBoolean(R.styleable.ScrollView_fillViewport, <span class="keyword">false</span>));</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x53E5;&#x8BDD;&#x7684;&#x610F;&#x601D;&#x5C31;&#x662F;&#x4ECE;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x4E2D;&#x83B7;&#x53D6;android:fillViewport&#x5C5E;&#x6027;&#x662F;&#x5426;&#x4E3A;true,&#x9ED8;&#x8BA4;&#x503C;&#x662F;false&#xFF0C;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E3A;true&#x7684;&#x8BDD;&#xFF0C;&#x6211;&#x4EEC;&#x770B;&#x770B;ScrollView&#x4F1A;&#x505A;&#x4EC0;&#x4E48;&#xFF1F;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> mFillViewport;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFillViewport</span><span class="params">(<span class="keyword">boolean</span> fillViewport)</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (fillViewport != mFillViewport) {</span><br><span class="line">            mFillViewport = fillViewport;<span class="comment">//&#x5F53;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x6EE1;&#x8DB3;&#x6EA2;&#x51FA;&#x60C5;&#x51B5;&#x7684;&#x65F6;&#x5019;&#xFF0C;fillViewport&#x4E3A;true</span></span><br><span class="line">            requestLayout();<span class="comment">//&#x8BF7;&#x6C42;&#x5E03;&#x5C40;</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x5C31;&#x662F;&#x5224;&#x65AD;&#x4E00;&#x4E0B;fillViewport&#x5C5E;&#x6027;&#x662F;&#x5426;&#x4E3A;true,&#x5E76;&#x5C06;&#x65B0;&#x503C;&#x8D4B;&#x503C;&#x7ED9;mFillViewport&#x8FD9;&#x4E2A;&#x7C7B;&#x53D8;&#x91CF;&#xFF0C;&#x7136;&#x540E;&#x5F00;&#x59CB;&#x6267;&#x884C;requestLayout()&#x65B9;&#x6CD5;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestLayout</span><span class="params">()</span> </span>{</span><br><span class="line">      mIsLayoutDirty = <span class="keyword">true</span>;</span><br><span class="line">      <span class="keyword">super</span>.requestLayout();</span><br><span class="line">  }</span><br></pre></td></tr></table></figure></p>
<p>&#x770B;&#x5230;&#x8FD9;&#x91CC;&#x4E86;&#x89E3;&#x5230;&#x8BE5;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x4E86;&#x7236;&#x7C7B;&#x7684;requestLayout&#x65B9;&#x6CD5;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x5C31;&#x662F;View&#x7ED8;&#x5236;&#x65F6;&#x91CD;&#x65B0;&#x6267;&#x884C;&#x4E86;onMeasure&#x548C;onLayout&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x91CC;&#x5177;&#x4F53;&#x7684;&#x5C31;&#x662F;ScrollView&#x4F1A;&#x91CD;&#x65B0;&#x6267;&#x884C;onMeasure()&#x65B9;&#x6CD5;&#x65F6;&#x4F1A;&#x91CD;&#x65B0;&#x786E;&#x8BA4;&#x63A7;&#x4EF6;&#x7684;&#x5927;&#x5C0F;&#x7136;&#x540E;&#x518D;&#x786E;&#x5B9A;&#x81EA;&#x5DF1;&#x7684;&#x5BBD;&#x9AD8;,&#x6700;&#x540E;&#x5728;&#x6267;&#x884C;onLayout(),&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x662F;&#x5BF9;&#x6240;&#x6709;&#x7684;&#x5B50;&#x63A7;&#x4EF6;&#x8FDB;&#x884C;&#x5B9A;&#x4F4D;&#x3002;<br>&#x901A;&#x8FC7;onMeasure&#x7684;&#x6E90;&#x7801;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Override</span></span><br><span class="line"> <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onMeasure</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec, <span class="keyword">int</span> heightMeasureSpec)</span> </span>{<span class="comment">//&#x6EA2;&#x51FA;&#x4E0E;&#x5426;&#xFF0C;&#x5C31;&#x8981;&#x901A;&#x8FC7;&#x4E4B;&#x524D;&#x6211;&#x4EEC;&#x7684;TypedArray&#x91CC;&#x9762;&#x7684;getBoolean&#x91CC;&#x53C2;&#x6570;&#x7684;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x6765;&#x5224;&#x65AD;&#x4E86;&#x3002;</span></span><br><span class="line">     <span class="keyword">super</span>.onMeasure(widthMeasureSpec, heightMeasureSpec);</span><br><span class="line"></span><br><span class="line">     <span class="keyword">if</span> (!mFillViewport) {<span class="comment">//&#x5982;&#x679C;mFillViewport&#x4E3A;true&#xFF0C;&#x5219;&#x5B50;&#x5E03;&#x5C40;&#x5145;&#x6EE1;&#x5F53;&#x524D;&#x53EF;&#x89C1;&#x533A;&#x57DF;&#xFF0C;&#x5BBD;&#x9AD8;&#x5373;&#x4E0D;&#x9700;&#x8981;&#x91CD;&#x65B0;&#x6D4B;&#x91CF;&#x3002;</span></span><br><span class="line">         <span class="keyword">return</span>;</span><br><span class="line">     }</span><br><span class="line"></span><br><span class="line">     <span class="keyword">final</span> <span class="keyword">int</span> heightMode = MeasureSpec.getMode(heightMeasureSpec);</span><br><span class="line">     <span class="keyword">if</span> (heightMode == MeasureSpec.UNSPECIFIED) {</span><br><span class="line">         <span class="keyword">return</span>;</span><br><span class="line">     }</span><br><span class="line"></span><br><span class="line">     <span class="keyword">if</span> (getChildCount() &gt; <span class="number">0</span>) {</span><br><span class="line">         <span class="keyword">final</span> View child = getChildAt(<span class="number">0</span>);</span><br><span class="line">         <span class="keyword">final</span> <span class="keyword">int</span> widthPadding;</span><br><span class="line">         <span class="keyword">final</span> <span class="keyword">int</span> heightPadding;</span><br><span class="line">         <span class="keyword">final</span> <span class="keyword">int</span> targetSdkVersion = getContext().getApplicationInfo().targetSdkVersion;</span><br><span class="line">         <span class="keyword">final</span> FrameLayout.LayoutParams lp = (LayoutParams) child.getLayoutParams();</span><br><span class="line">         <span class="keyword">if</span> (targetSdkVersion &gt;= VERSION_CODES.M) {</span><br><span class="line">             widthPadding = mPaddingLeft + mPaddingRight + lp.leftMargin + lp.rightMargin;</span><br><span class="line">             heightPadding = mPaddingTop + mPaddingBottom + lp.topMargin + lp.bottomMargin;</span><br><span class="line">         } <span class="keyword">else</span> {</span><br><span class="line">             widthPadding = mPaddingLeft + mPaddingRight;</span><br><span class="line">             heightPadding = mPaddingTop + mPaddingBottom;</span><br><span class="line">         }</span><br><span class="line"></span><br><span class="line">         <span class="keyword">final</span> <span class="keyword">int</span> desiredHeight = getMeasuredHeight() - heightPadding;</span><br><span class="line">         <span class="keyword">if</span> (child.getMeasuredHeight() &lt; desiredHeight) {</span><br><span class="line">             <span class="keyword">final</span> <span class="keyword">int</span> childWidthMeasureSpec = getChildMeasureSpec(</span><br><span class="line">                     widthMeasureSpec, widthPadding, lp.width);</span><br><span class="line">             <span class="keyword">final</span> <span class="keyword">int</span> childHeightMeasureSpec = MeasureSpec.makeMeasureSpec(</span><br><span class="line">                     desiredHeight, MeasureSpec.EXACTLY);</span><br><span class="line">             child.measure(childWidthMeasureSpec, childHeightMeasureSpec);</span><br><span class="line">         }</span><br><span class="line">     }</span><br><span class="line"> }</span><br></pre></td></tr></table></figure></p>
<p>&#x4ECE;&#x4EE3;&#x7801;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5C06;mFillViewport&#x8BBE;&#x7F6E;&#x4E3A;false&#x7684;&#x8BDD;&#x5C06;&#x4F1A;&#x76F4;&#x63A5;return&#x6574;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x4E0B;&#x9762;&#x7684;&#x6D4B;&#x91CF;&#x4EE3;&#x7801;&#x5C06;&#x4E0D;&#x4F1A;&#x6267;&#x884C;&#x3002;&#x53EA;&#x6709;&#x5F53;mFillViewport&#x8BBE;&#x7F6E;&#x4E3A;true&#x65F6;&#xFF0C;&#x624D;&#x4F1A;&#x6839;&#x636E;&#x5B50;View&#x7684;&#x9AD8;&#x5EA6;&#x548C;ScrollView&#x672C;&#x8EAB;&#x7684;&#x9AD8;&#x5EA6;&#x51B3;&#x5B9A;&#x662F;&#x5426;&#x91CD;&#x65B0;&#x6D4B;&#x91CF;&#x5B50;View&#x4F7F;&#x5176;&#x5145;&#x6EE1;ScrollView&#x3002;</p>
<h2 id="&#x7ED3;&#x8BED;">&#x7ED3;&#x8BED;</h2><p>&#x81F3;&#x6B64;&#x6211;&#x4EEC;&#x7EC8;&#x4E8E;&#x77E5;&#x9053;&#x4E86;&#x95EE;&#x9898;&#x5230;&#x5E95;&#x51FA;&#x5728;&#x54EA;&#x4E86;&#xFF0C;&#x4E5F;&#x786E;&#x5B9E;&#x660E;&#x786E;&#x4E86;&#x4E24;&#x4E2A;&#x77E5;&#x8BC6;&#x70B9;&#xFF1A;<br>1.&#x52A8;&#x6001;&#x5F15;&#x5165;&#x7684;View&#x5982;&#x679C;&#x6CA1;&#x6709;&#x7236;&#x7C7B;&#x5C06;&#x65E0;&#x6CD5;&#x5B9E;&#x73B0;&#x5E03;&#x5C40;&#x5C5E;&#x6027;&#x3002;<br>2.&#x5982;&#x679C;&#x5916;&#x5C42;&#x6709;ScrollView&#x6216;&#x8005;NestScrollView&#x7684;&#x8BDD;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x901A;&#x7528;&#x5E03;&#x5C40;&#x6700;&#x597D;&#x52A0;&#x4E0A;fillViewport&#x5C5E;&#x6027;&#x3002;</p>
<h2 id="&#x53C2;&#x8003;&#x8D44;&#x6599;">&#x53C2;&#x8003;&#x8D44;&#x6599;</h2><p><a href="https://www.jianshu.com/p/c3ed4253f87e" target="_blank" rel="external">ScrollView&#x6E90;&#x7801;&#x5206;&#x6790;</a><br><a href="https://blog.csdn.net/qq_21004057/article/details/52985299" target="_blank" rel="external">&#x9886;&#x609F;&#x81EA;&#x5B9A;&#x4E49;&#x98CE;&#x91C7;&#xFF0C;ScrollView&#x6E90;&#x7801;&#x5B8C;&#x5168;&#x89E3;&#x6790;</a><br><a href="https://blog.csdn.net/u012702547/article/details/52628453" target="_blank" rel="external">&#x4E09;&#x4E2A;&#x6848;&#x4F8B;&#x5E26;&#x4F60;&#x770B;&#x61C2;LayoutInflater&#x4E2D;inflate&#x65B9;&#x6CD5;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x548C;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x533A;&#x522B;</a><br><a href="https://www.cnblogs.com/x-bing/p/6744471.html" target="_blank" rel="external">LayoutInflate.inflate&#xFF08;&#xFF09;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#x542B;&#x4E49;</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Springboot集成Shiro和Cas实现单点登录-客户端篇]]></title>
      <url>http://jasoncool.com/2017/12/04/Springboot%E9%9B%86%E6%88%90Shiro%E5%92%8CCas%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95-%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%AF%87/</url>
      <content type="html"><![CDATA[<h2 id="&#x524D;&#x8A00;">&#x524D;&#x8A00;</h2><p>&#x8FD9;&#x91CC;&#x6211;&#x5148;&#x8981;&#x8BF4;&#x660E;&#x4E00;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x9879;&#x76EE;&#x67B6;&#x6784;&#x662F;Springboot+Shiro+Ehcache+ThymeLeaf+Mybaits,&#x5728;&#x8FD9;&#x4E2A;&#x57FA;&#x7840;&#x4E0A;&#xFF0C;&#x6211;&#x4EEC;&#x518D;&#x52A0;&#x5165;&#x4E86;CAS&#x5355;&#x70B9;&#x767B;&#x5F55;&#xFF0C;&#x867D;&#x7136;&#x524D;&#x9762;&#x7684;&#x6846;&#x67B6;&#x770B;&#x7740;&#x5F88;&#x957F;&#xFF0C;&#x4F46;&#x662F;&#x548C;&#x5355;&#x70B9;&#x767B;&#x5F55;&#x76F8;&#x5173;&#x7684;&#x6838;&#x5FC3;&#x67B6;&#x6784;&#x5176;&#x5B9E;&#x5C31;&#x662F;Springboot&#x548C;Shiro&#x800C;&#x5DF2;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x770B;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x4E4B;&#x524D;&#xFF0C;&#x9700;&#x8981;&#x4F60;&#x638C;&#x63E1;&#x7684;&#x77E5;&#x8BC6;&#x6709;Springboot&#x7684;&#x57FA;&#x7840;&#x6846;&#x67B6;&#x642D;&#x5EFA;&#x4EE5;&#x53CA;&#x96C6;&#x6210;Shiro&#x540E;&#x7684;&#x4E00;&#x4E9B;&#x64CD;&#x4F5C;&#xFF0C;&#x56E0;&#x4E3A;&#x4E4B;&#x540E;&#x7684;&#x96C6;&#x6210;CAS&#x5176;&#x5B9E;&#x4E5F;&#x662F;&#x5728;&#x8FD9;&#x4E2A;&#x57FA;&#x7840;&#x4E0A;&#x8FDB;&#x884C;&#x7684;&#x4FEE;&#x6539;&#x3002;</p>
<a id="more"></a>
<h2 id="&#x5F15;&#x5165;Shiro-cas&#x5305;">&#x5F15;&#x5165;Shiro-cas&#x5305;</h2><p>&#x9700;&#x8981;&#x96C6;&#x6210;CAS&#x90A3;&#x4E48;&#x80AF;&#x5B9A;&#x8981;&#x5F15;&#x5165;CAS&#x76F8;&#x5173;&#x7684;&#x7EC4;&#x4EF6;&#x5305;&#xFF0C;&#x5728;POM.xml&#x4E2D;&#x5F15;&#x5165;&#xFF1A;</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- shiro spring. --&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;shiro-spring&lt;/artifactId&gt;</span><br><span class="line">			&lt;version&gt;1.2.6&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">		&lt;!-- shiro ehcache --&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;shiro-ehcache&lt;/artifactId&gt;</span><br><span class="line">			&lt;version&gt;1.2.6&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;!-- shiro cas --&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;shiro-cas&lt;/artifactId&gt;</span><br><span class="line">			&lt;version&gt;1.2.6&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>&#x524D;&#x4E24;&#x4E2A;&#x4E00;&#x4E2A;&#x662F;Spring&#x548C;Shiro&#x7ED3;&#x5408;&#x7684;shiro-spring&#x5305;&#x548C;&#x4E0E;ehcache&#x7ED3;&#x5408;&#x7684;shiro-ehcache&#x5305;&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x5305;&#x5E94;&#x8BE5;&#x662F;&#x4E4B;&#x524D;&#x5C31;&#x6709;&#x7684;&#xFF0C;&#x4E4B;&#x6240;&#x4EE5;&#x4E5F;&#x628A;&#x4ED6;&#x4EEC;&#x5199;&#x8FDB;&#x6765;&#x662F;&#x56E0;&#x4E3A;&#x5982;&#x679C;&#x8981;&#x5F15;&#x5165;CAS&#x7684;&#x7EC4;&#x4EF6;&#x5305;&#xFF0C;&#x9700;&#x8981;&#x4FDD;&#x8BC1;&#x8FD9;&#x4E09;&#x4E2A;&#x5305;&#x7684;&#x7248;&#x672C;&#x53F7;&#x4E00;&#x81F4;&#xFF0C;&#x7B14;&#x8005;&#x4E4B;&#x524D;&#x5F15;&#x5165;&#x7684;&#x524D;&#x4E24;&#x4E2A;&#x5305;&#x7684;&#x7248;&#x672C;&#x53F7;&#x662F;1.2.4&#xFF0C;&#x7ED3;&#x679C;&#x5355;&#x72EC;&#x5F15;&#x5165;1.2.6&#x7684;shiro-cas&#x5305;&#x540E;&#xFF0C;&#x4E00;&#x4E9B;cas&#x5173;&#x952E;&#x7684;&#x7C7B;&#x662F;&#x627E;&#x4E0D;&#x5230;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x5C3D;&#x91CF;&#x4FDD;&#x6301;&#x8FD9;&#x4E09;&#x4E2A;&#x5F15;&#x5165;&#x5305;&#x7684;&#x7248;&#x672C;&#x53F7;&#x4E00;&#x81F4;&#x3002;</p>
<blockquote>
<p>&#x5C0F;&#x63D2;&#x66F2;<br>&#x6211;&#x5728;&#x5347;&#x7EA7;1.2.4&#x7684;shiro-spring&#x548C;shiro-ehcache&#x8FD9;&#x8FDE;&#x4E2A;&#x7EC4;&#x4EF6;&#x5305;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x662F;&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#x7684;1.2.4&#x4E3A;1.2.6&#xFF0C;&#x4F46;&#x662F;&#x5F15;&#x5165;&#x4E00;&#x76F4;&#x62A5;&#x9519;&#xFF0C;&#x5C1D;&#x8BD5;&#x4E86;&#x5404;&#x79CD;&#x529E;&#x6CD5;&#x90FD;&#x4E0D;&#x884C;&#xFF0C;&#x540E;&#x6765;&#x53D1;&#x73B0;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x526A;&#x5207;&#x8BE5;&#x5F15;&#x5165;&#x5305;&#x7684;dependency&#x518D;&#x9ECF;&#x8D34;&#x5230;pom&#x4E2D;&#x53BB;&#xFF0C;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#x7248;&#x672C;&#x53F7;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x51FA;&#x73B0;&#x5F15;&#x5165;&#x4E0D;&#x6210;&#x529F;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x5361;&#x4E86;&#x6211;&#x4E00;&#x4E0B;&#x5348;&#xFF0C;&#x5751;&#x554A;&#xFF01;</p>
</blockquote>
<h2 id="&#x52A0;&#x5165;&#x5355;&#x70B9;&#x767B;&#x5F55;&#x7684;&#x914D;&#x7F6E;">&#x52A0;&#x5165;&#x5355;&#x70B9;&#x767B;&#x5F55;&#x7684;&#x914D;&#x7F6E;</h2><p>&#x5982;&#x679C;&#x4F60;&#x5728;&#x4F60;&#x7684;Springboot&#x9879;&#x76EE;&#x4E2D;&#x96C6;&#x6210;&#x8FC7;shiro&#x6846;&#x67B6;&#xFF0C;&#x5E94;&#x8BE5;&#x5BF9;&#x4E24;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x7C7B;&#x4E0D;&#x964C;&#x751F;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;myShiroConfig&#x53E6;&#x4E00;&#x4E2A;&#x662F;myShiroRealm&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x7C7B;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x7684;Shiro&#x7684;&#x8BBE;&#x7F6E;&#x7C7B;&#x548C;&#x767B;&#x5F55;&#x9A8C;&#x8BC1;&#x83B7;&#x53D6;&#x6743;&#x9650;&#x7684;&#x7BA1;&#x7406;&#x7C7B;&#xFF0C;&#x5728;&#x8FD9;&#x91CC;&#x6211;&#x5C06;&#x4E0D;&#x518D;&#x8D58;&#x8FF0;&#x8BE5;&#x7C7B;&#x5982;&#x4F55;&#x4F7F;&#x7528;&#xFF0C;&#x76F4;&#x63A5;&#x4E0A;&#x96C6;&#x6210;&#x4E86;CAS&#x7684;&#x8FD9;&#x4E24;&#x4E2A;&#x7C7B;&#xFF1A;<br>&#x9996;&#x5148;&#x662F;&#x8BBE;&#x7F6E;&#x7C7B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import com.dhcc.pa.domain.SPermission;
import com.dhcc.pa.other.shiro.MyShiroCasRealm;
import com.dhcc.pa.service.SystemService;
import com.dhcc.pa.util.PublicMsg;
import org.apache.shiro.cache.ehcache.EhCacheManager;
import org.apache.shiro.cas.CasFilter;
import org.apache.shiro.cas.CasSubjectFactory;
import org.apache.shiro.spring.LifecycleBeanPostProcessor;
import org.apache.shiro.spring.security.interceptor.AuthorizationAttributeSourceAdvisor;
import org.apache.shiro.spring.web.ShiroFilterFactoryBean;
import org.apache.shiro.web.mgt.DefaultWebSecurityManager;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.aop.framework.autoproxy.DefaultAdvisorAutoProxyCreator;
import org.springframework.boot.web.servlet.FilterRegistrationBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.util.StringUtils;
import org.springframework.web.filter.DelegatingFilterProxy;

import javax.servlet.Filter;
import java.util.HashMap;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;

/**
 * @Author:&#x8D3E;&#x771F;
 * @Description:
 * @Date:&#x521B;&#x5EFA;&#x4E8E;&#x4E0A;&#x5348; 10:02 2017/11/29
 * @Modified:
 */
@Configuration
public class ShiroConfig {

    private static final Logger logger = LoggerFactory.getLogger(ShiroConfig.class);

    // Cas&#x767B;&#x5F55;&#x9875;&#x9762;&#x5730;&#x5740;
    public static final String casLoginUrl = PublicMsg.CASServerUrlPrefix + &quot;/login&quot;;
    // Cas&#x767B;&#x51FA;&#x9875;&#x9762;&#x5730;&#x5740;
    public static final String casLogoutUrl = PublicMsg.CASServerUrlPrefix  + &quot;/logout&quot;;

    // casFilter UrlPattern
    public static final String casFilterUrlPattern = &quot;/&quot;;
    // &#x767B;&#x5F55;&#x5730;&#x5740;
    public static final String loginUrl = casLoginUrl + &quot;?service=&quot; + PublicMsg.SHIROServerUrlPrefix + casFilterUrlPattern;
    // &#x767B;&#x51FA;&#x5730;&#x5740;&#xFF08;casserver&#x542F;&#x7528;service&#x8DF3;&#x8F6C;&#x529F;&#x80FD;&#xFF0C;&#x9700;&#x5728;webapps\cas\WEB-INF\cas.properties&#x6587;&#x4EF6;&#x4E2D;&#x542F;&#x7528;cas.logout.followServiceRedirects=true&#xFF09;
    public static final String logoutUrl = casLogoutUrl+&quot;?service=&quot;+loginUrl;

    @Bean
    public EhCacheManager getEhCacheManager() {
        EhCacheManager em = new EhCacheManager();
        em.setCacheManagerConfigFile(&quot;classpath:config/ehcache-shiro.xml&quot;);
        return em;
    }

    @Bean(name = &quot;myShiroCasRealm&quot;)
    public MyShiroCasRealm myShiroCasRealm(EhCacheManager cacheManager) {
        MyShiroCasRealm realm = new MyShiroCasRealm();
        realm.setCacheManager(cacheManager);
        return realm;
    }

    /**
     * &#x6CE8;&#x518C;DelegatingFilterProxy&#xFF08;Shiro&#xFF09;
     *
     * @param
     * @return
     * @author &#x8D3E;&#x771F;
     * @create  2016&#x5E74;1&#x6708;13&#x65E5;
     */
    @Bean
    public FilterRegistrationBean filterRegistrationBean() {
        FilterRegistrationBean filterRegistration = new FilterRegistrationBean();
        filterRegistration.setFilter(new DelegatingFilterProxy(&quot;shiroFilter&quot;));
        //  &#x8BE5;&#x503C;&#x7F3A;&#x7701;&#x4E3A;false,&#x8868;&#x793A;&#x751F;&#x547D;&#x5468;&#x671F;&#x7531;SpringApplicationContext&#x7BA1;&#x7406;,&#x8BBE;&#x7F6E;&#x4E3A;true&#x5219;&#x8868;&#x793A;&#x7531;ServletContainer&#x7BA1;&#x7406;
        filterRegistration.addInitParameter(&quot;targetFilterLifecycle&quot;, &quot;true&quot;);
        filterRegistration.setEnabled(true);
        filterRegistration.addUrlPatterns(&quot;/*&quot;);
        return filterRegistration;
    }

    @Bean(name = &quot;lifecycleBeanPostProcessor&quot;)
    public LifecycleBeanPostProcessor getLifecycleBeanPostProcessor() {
        return new LifecycleBeanPostProcessor();
    }

    @Bean
    public DefaultAdvisorAutoProxyCreator getDefaultAdvisorAutoProxyCreator() {
        DefaultAdvisorAutoProxyCreator daap = new DefaultAdvisorAutoProxyCreator();
        daap.setProxyTargetClass(true);
        return daap;
    }

    @Bean(name = &quot;securityManager&quot;)
    public DefaultWebSecurityManager getDefaultWebSecurityManager(MyShiroCasRealm myShiroCasRealm) {
        DefaultWebSecurityManager dwsm = new DefaultWebSecurityManager();
        dwsm.setRealm(myShiroCasRealm);
//      &lt;!-- &#x7528;&#x6237;&#x6388;&#x6743;/&#x8BA4;&#x8BC1;&#x4FE1;&#x606F;Cache, &#x91C7;&#x7528;EhCache &#x7F13;&#x5B58; --&gt;
        dwsm.setCacheManager(getEhCacheManager());
        // &#x6307;&#x5B9A; SubjectFactory
        dwsm.setSubjectFactory(new CasSubjectFactory());
        return dwsm;
    }

    @Bean
    public AuthorizationAttributeSourceAdvisor getAuthorizationAttributeSourceAdvisor(DefaultWebSecurityManager securityManager) {
        AuthorizationAttributeSourceAdvisor aasa = new AuthorizationAttributeSourceAdvisor();
        aasa.setSecurityManager(securityManager);
        return aasa;
    }


    /**
     * CAS&#x8FC7;&#x6EE4;&#x5668;
     *
     * @return
     * @author SHANHY
     * @Date:&#x521B;&#x5EFA;&#x4E8E;&#x4E0A;&#x5348; 10:02 2017/11/29
     */
    @Bean(name = &quot;casFilter&quot;)
    public CasFilter getCasFilter() {
        CasFilter casFilter = new CasFilter();
        casFilter.setName(&quot;casFilter&quot;);
        casFilter.setEnabled(true);
        // &#x767B;&#x5F55;&#x5931;&#x8D25;&#x540E;&#x8DF3;&#x8F6C;&#x7684;URL&#xFF0C;&#x4E5F;&#x5C31;&#x662F; Shiro &#x6267;&#x884C; CasRealm &#x7684; doGetAuthenticationInfo &#x65B9;&#x6CD5;&#x5411;CasServer&#x9A8C;&#x8BC1;tiket
        casFilter.setFailureUrl(loginUrl);// &#x6211;&#x4EEC;&#x9009;&#x62E9;&#x8BA4;&#x8BC1;&#x5931;&#x8D25;&#x540E;&#x518D;&#x6253;&#x5F00;&#x767B;&#x5F55;&#x9875;&#x9762;
        return casFilter;
    }

    /**
     * ShiroFilter&lt;br/&gt;
     * &#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x53C2;&#x6570;&#x4E2D;&#x7684; StudentService &#x548C; IScoreDao &#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x5728;&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x7528;&#x8FD9;&#x6837;&#x7684;&#x65B9;&#x5F0F;&#x83B7;&#x53D6;&#x5230;&#x76F8;&#x5173;&#x8BBF;&#x95EE;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;
     * &#x7136;&#x540E;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x5E93;&#x76F8;&#x5173;&#x914D;&#x7F6E;&#xFF0C;&#x914D;&#x7F6E;&#x5230; shiroFilterFactoryBean &#x7684;&#x8BBF;&#x95EE;&#x89C4;&#x5219;&#x4E2D;&#x3002;&#x5B9E;&#x9645;&#x9879;&#x76EE;&#x4E2D;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;&#x81EA;&#x5DF1;&#x7684;Service&#x6765;&#x5904;&#x7406;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x3002;
     *
     * @param
     * @param
     * @param
     * @return
     * @author &#x8D3E;&#x771F;
     * @Date:&#x521B;&#x5EFA;&#x4E8E;&#x4E0A;&#x5348; 10:02 2017/11/29
     */
    @Bean
    public ShiroFilterFactoryBean shiroFilter(DefaultWebSecurityManager securityManager, CasFilter casFilter,SystemService sysPermissionInitService) {
        ShiroFilterFactoryBean shiroFilterFactoryBean = new ShiroFilterFactoryBean();
        // &#x5FC5;&#x987B;&#x8BBE;&#x7F6E; SecurityManager
        shiroFilterFactoryBean.setSecurityManager(securityManager);
        // &#x5982;&#x679C;&#x4E0D;&#x8BBE;&#x7F6E;&#x9ED8;&#x8BA4;&#x4F1A;&#x81EA;&#x52A8;&#x5BFB;&#x627E;Web&#x5DE5;&#x7A0B;&#x6839;&#x76EE;&#x5F55;&#x4E0B;&#x7684;&quot;/login.jsp&quot;&#x9875;&#x9762;
        shiroFilterFactoryBean.setLoginUrl(loginUrl);
        // &#x767B;&#x5F55;&#x6210;&#x529F;&#x540E;&#x8981;&#x8DF3;&#x8F6C;&#x7684;&#x8FDE;&#x63A5;
        shiroFilterFactoryBean.setSuccessUrl(&quot;/templete&quot;);
        shiroFilterFactoryBean.setUnauthorizedUrl(&quot;/403&quot;);

        // &#x6DFB;&#x52A0;casFilter&#x5230;shiroFilter&#x4E2D;
        Map&lt;String, Filter&gt; filters = new HashMap&lt;&gt;();
        filters.put(&quot;casFilter&quot;, casFilter);
        shiroFilterFactoryBean.setFilters(filters);
        /////////////////////// &#x4E0B;&#x9762;&#x8FD9;&#x4E9B;&#x89C4;&#x5219;&#x914D;&#x7F6E;&#x6700;&#x597D;&#x914D;&#x7F6E;&#x5230;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D; ///////////////////////
        Map&lt;String, String&gt; filterChainDefinitionMap = new LinkedHashMap&lt;&gt;();

        filterChainDefinitionMap.put(casFilterUrlPattern, &quot;casFilter&quot;);// shiro&#x96C6;&#x6210;cas&#x540E;&#xFF0C;&#x9996;&#x5148;&#x6DFB;&#x52A0;&#x8BE5;&#x89C4;&#x5219;

        // authc&#xFF1A;&#x8BE5;&#x8FC7;&#x6EE4;&#x5668;&#x4E0B;&#x7684;&#x9875;&#x9762;&#x5FC5;&#x987B;&#x9A8C;&#x8BC1;&#x540E;&#x624D;&#x80FD;&#x8BBF;&#x95EE;&#xFF0C;&#x5B83;&#x662F;Shiro&#x5185;&#x7F6E;&#x7684;&#x4E00;&#x4E2A;&#x62E6;&#x622A;&#x5668;org.apache.shiro.web.filter.authc.FormAuthenticationFilter
        // anon&#xFF1A;&#x5B83;&#x5BF9;&#x5E94;&#x7684;&#x8FC7;&#x6EE4;&#x5668;&#x91CC;&#x9762;&#x662F;&#x7A7A;&#x7684;,&#x4EC0;&#x4E48;&#x90FD;&#x6CA1;&#x505A;
        logger.info(&quot;##################&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x8BFB;&#x53D6;&#x6743;&#x9650;&#x89C4;&#x5219;&#xFF0C;&#x52A0;&#x8F7D;&#x5230;shiroFilter&#x4E2D;##################&quot;);
        filterChainDefinitionMap.put(&quot;/js/**&quot;, &quot;anon&quot;);
        filterChainDefinitionMap.put(&quot;/css/**&quot;, &quot;anon&quot;);
        filterChainDefinitionMap.put(&quot;/bootstrapDatePicker/**&quot;, &quot;anon&quot;);
        //&#x963B;&#x6B62;&#x767B;&#x5F55;&#x6210;&#x529F;&#x540E;&#x4E0B;&#x8F7D;favicon
        filterChainDefinitionMap.put(&quot;/favicon.ico&quot;, &quot;anon&quot;);

        //&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x83B7;&#x53D6;
        List&lt;SPermission&gt; list = sysPermissionInitService.menuGetAll();

        for (SPermission sysPermissionInit : list) {
            if(!StringUtils.isEmpty(sysPermissionInit.getUrl())){
                filterChainDefinitionMap.put(sysPermissionInit.getUrl(),
                        &quot;perms[&quot;+sysPermissionInit.getPermission()+&quot;]&quot;);
            }
        }
        //&#x914D;&#x7F6E;&#x9000;&#x51FA;&#x8FC7;&#x6EE4;&#x5668;,&#x5176;&#x4E2D;&#x7684;&#x5177;&#x4F53;&#x7684;&#x9000;&#x51FA;&#x4EE3;&#x7801;Shiro&#x5DF2;&#x7ECF;&#x66FF;&#x6211;&#x4EEC;&#x5B9E;&#x73B0;&#x4E86;
        filterChainDefinitionMap.put(logoutUrl, &quot;logout&quot;);
        filterChainDefinitionMap.put(&quot;/**&quot;, &quot;authc&quot;);
        shiroFilterFactoryBean.setFilterChainDefinitionMap(filterChainDefinitionMap);
        return shiroFilterFactoryBean;
    }

}</span><br></pre></td></tr></table></figure>
<p>&#x6CE8;&#x91CA;&#x5199;&#x7684;&#x90FD;&#x6BD4;&#x8F83;&#x6E05;&#x695A;&#x4E86;&#xFF0C; &#x6211;&#x8FD9;&#x91CC;&#x5C06;&#x4E0D;&#x518D;&#x8D58;&#x8FF0;&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x77E5;&#x8BC6;&#x70B9;&#x9700;&#x8981;&#x5F3A;&#x8C03;&#x4E00;&#x4E0B;&#xFF1A;</p>
<blockquote>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x8BBE;&#x7F6E;&#x7C7B;&#x4E2D;&#x5982;&#x679C;&#x9700;&#x8981;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x83B7;&#x53D6;&#x7528;&#x6237;&#x7684;&#x6743;&#x9650;&#x5217;&#x8868;&#xFF0C;&#x4E00;&#x5B9A;&#x8981;&#x5C06;&#x5BF9;&#x5E94;&#x7684;Service&#x5199;&#x5728;shiroFilter&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x91CC;&#x5F53;&#x4F5C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x6765;&#x4F7F;&#x7528;&#xFF0C;&#x800C;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x7528;@AutoWired&#x5C06;&#x8BE5;&#x7C7B;&#x5F15;&#x5165;&#xFF0C;&#x5426;&#x5219;&#x4F7F;&#x7528;&#x65F6;&#x4F1A;&#x62A5;&#x8BE5;Service&#x7A7A;&#x6307;&#x9488;&#x7684;&#x5F02;&#x5E38;&#xFF0C;&#x81F3;&#x4E8E;&#x539F;&#x56E0;&#x6211;&#x4E5F;&#x4E0D;&#x662F;&#x5F88;&#x6E05;&#x695A;&#x2026;.&#x5F85;&#x67E5;</p>
</blockquote>
<p>&#x4E4B;&#x540E;&#x662F;&#x767B;&#x5F55;&#x9A8C;&#x8BC1;&#x548C;&#x6743;&#x9650;&#x83B7;&#x53D6;&#x7C7B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import com.dhcc.pa.domain.Role;
import com.dhcc.pa.domain.SUser;
import com.dhcc.pa.other.config.ShiroConfig;
import com.dhcc.pa.service.UserService;
import com.dhcc.pa.util.PublicMsg;
import org.apache.shiro.authz.AuthorizationInfo;
import org.apache.shiro.authz.SimpleAuthorizationInfo;
import org.apache.shiro.cas.CasRealm;
import org.apache.shiro.subject.PrincipalCollection;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.util.StringUtils;

import javax.annotation.PostConstruct;
import java.util.List;

/**
 * @Author:&#x8D3E;&#x771F;
 * @Description:
 * @Date:&#x521B;&#x5EFA;&#x4E8E;&#x4E0A;&#x5348; 10:03 2017/11/29
 * @Modified:
 */
public class MyShiroCasRealm extends CasRealm {

    private static final Logger logger = LoggerFactory.getLogger(MyShiroCasRealm.class);

    @Autowired
    private UserService userService;

    @PostConstruct
    public void initProperty(){
//      setDefaultRoles(&quot;ROLE_USER&quot;);
        setCasServerUrlPrefix(PublicMsg.CASServerUrlPrefix);
        // &#x5BA2;&#x6237;&#x7AEF;&#x56DE;&#x8C03;&#x5730;&#x5740;
        setCasService(PublicMsg.SHIROServerUrlPrefix + ShiroConfig.casFilterUrlPattern);
    }

    /**
     * &#x6743;&#x9650;&#x8BA4;&#x8BC1;&#xFF0C;&#x4E3A;&#x5F53;&#x524D;&#x767B;&#x5F55;&#x7684;Subject&#x6388;&#x4E88;&#x89D2;&#x8272;&#x548C;&#x6743;&#x9650;
     * @see &#xFF1A;&#x672C;&#x4F8B;&#x4E2D;&#x8BE5;&#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;&#x65F6;&#x673A;&#x4E3A;&#x9700;&#x6388;&#x6743;&#x8D44;&#x6E90;&#x88AB;&#x8BBF;&#x95EE;&#x65F6;
     * @see &#xFF1A;&#x5E76;&#x4E14;&#x6BCF;&#x6B21;&#x8BBF;&#x95EE;&#x9700;&#x6388;&#x6743;&#x8D44;&#x6E90;&#x65F6;&#x90FD;&#x4F1A;&#x6267;&#x884C;&#x8BE5;&#x65B9;&#x6CD5;&#x4E2D;&#x7684;&#x903B;&#x8F91;&#xFF0C;&#x8FD9;&#x8868;&#x660E;&#x672C;&#x4F8B;&#x4E2D;&#x9ED8;&#x8BA4;&#x5E76;&#x672A;&#x542F;&#x7528;AuthorizationCache
     * @see &#xFF1A;&#x5982;&#x679C;&#x8FDE;&#x7EED;&#x8BBF;&#x95EE;&#x540C;&#x4E00;&#x4E2A;URL&#xFF08;&#x6BD4;&#x5982;&#x5237;&#x65B0;&#xFF09;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x4E0D;&#x4F1A;&#x88AB;&#x91CD;&#x590D;&#x8C03;&#x7528;&#xFF0C;Shiro&#x6709;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;&#x95F4;&#x9694;&#xFF08;&#x4E5F;&#x5C31;&#x662F;cache&#x65F6;&#x95F4;&#xFF0C;&#x5728;ehcache-shiro.xml&#x4E2D;&#x914D;&#x7F6E;&#xFF09;&#xFF0C;&#x8D85;&#x8FC7;&#x8FD9;&#x4E2A;&#x65F6;&#x95F4;&#x95F4;&#x9694;&#x518D;&#x5237;&#x65B0;&#x9875;&#x9762;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x4F1A;&#x88AB;&#x6267;&#x884C;
     */
    @Override
    protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principalCollection) {
        logger.info(&quot;##################&#x6267;&#x884C;Shiro&#x6743;&#x9650;&#x8BA4;&#x8BC1;##################&quot;);
        //&#x83B7;&#x53D6;&#x7528;&#x6237;&#x7684;&#x8F93;&#x5165;&#x7684;&#x8D26;&#x53F7;.
        //&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x767B;&#x5F55;&#x8F93;&#x5165;&#x7684;&#x7528;&#x6237;&#x540D;&#xFF0C;&#x7B49;&#x4EF7;&#x4E8E;(String) principalCollection.fromRealm(getName()).iterator().next();
        String username = (String)super.getAvailablePrincipal(principalCollection);
        //&#x5230;&#x6570;&#x636E;&#x5E93;&#x67E5;&#x662F;&#x5426;&#x6709;&#x6B64;&#x5BF9;&#x8C61;
        List&lt;SUser&gt; userList = userService.findByUsername(username);
        System.out.println(&quot;-----&gt;&gt;userInfo=&quot; + userList.size());
        if (userList.size()==0) {
            return null;
        }

        //&#x8D26;&#x53F7;&#x5224;&#x65AD;;
        //&#x51CC;&#x6D77;&#x5929;2017 -11-14 &#x4FEE;&#x6539;
        SUser user= userList.get(0);
        if(user!=null){
            //&#x6743;&#x9650;&#x4FE1;&#x606F;&#x5BF9;&#x8C61;info,&#x7528;&#x6765;&#x5B58;&#x653E;&#x67E5;&#x51FA;&#x7684;&#x7528;&#x6237;&#x7684;&#x6240;&#x6709;&#x7684;&#x89D2;&#x8272;&#xFF08;role&#xFF09;&#x53CA;&#x6743;&#x9650;&#xFF08;permission&#xFF09;
            SimpleAuthorizationInfo info=new SimpleAuthorizationInfo();
            int id  = user.getId().intValue();
            //&#x51CC;&#x6D77;&#x5929;2017 -11-14 &#x4FEE;&#x6539;
            List&lt;Role&gt; role = userService.findByUserid(id);
            for (Role r :role){
                //&#x7528;&#x6237;&#x7684;&#x89D2;&#x8272;&#x96C6;&#x5408;
                if(!StringUtils.isEmpty(r.getRole())){
                    info.addRole(r.getRole());
                }
                //&#x7528;&#x6237;&#x7684;&#x89D2;&#x8272;&#x5BF9;&#x5E94;&#x7684;&#x6240;&#x6709;&#x6743;&#x9650;&#xFF0C;&#x5982;&#x679C;&#x53EA;&#x4F7F;&#x7528;&#x89D2;&#x8272;&#x5B9A;&#x4E49;&#x8BBF;&#x95EE;&#x6743;&#x9650;
                if(!StringUtils.isEmpty(r.getPermission())){
                    info.addStringPermission(r.getPermission());
                }
            }
            // &#x6216;&#x8005;&#x6309;&#x4E0B;&#x9762;&#x8FD9;&#x6837;&#x6DFB;&#x52A0;
            //&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x89D2;&#x8272;,&#x4E0D;&#x662F;&#x914D;&#x7F6E;&#x610F;&#x4E49;&#x4E0A;&#x7684;&#x6DFB;&#x52A0;,&#x800C;&#x662F;&#x8BC1;&#x660E;&#x8BE5;&#x7528;&#x6237;&#x62E5;&#x6709;admin&#x89D2;&#x8272;
//            simpleAuthorInfo.addRole(&quot;admin&quot;);
            //&#x6DFB;&#x52A0;&#x6743;&#x9650;
//            simpleAuthorInfo.addStringPermission(&quot;admin:manage&quot;);
//            logger.info(&quot;&#x5DF2;&#x4E3A;&#x7528;&#x6237;[mike]&#x8D4B;&#x4E88;&#x4E86;[admin]&#x89D2;&#x8272;&#x548C;[admin:manage]&#x6743;&#x9650;&quot;);
            return info;
        }
        // &#x8FD4;&#x56DE;null&#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x4EFB;&#x4F55;&#x7528;&#x6237;&#x8BBF;&#x95EE;&#x88AB;&#x62E6;&#x622A;&#x7684;&#x8BF7;&#x6C42;&#x65F6;&#xFF0C;&#x90FD;&#x4F1A;&#x81EA;&#x52A8;&#x8DF3;&#x8F6C;&#x5230;unauthorizedUrl&#x6307;&#x5B9A;&#x7684;&#x5730;&#x5740;
        return null;
    }


}</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x4E24;&#x4E2A;&#x7C7B;&#x4E2D;&#x90FD;&#x7528;&#x5230;&#x4E86;PublicMsg&#x7C7B;&#xFF0C;&#x8FD9;&#x4E2A;&#x7C7B;&#x91CC;&#x4E3B;&#x8981;&#x8BBE;&#x7F6E;&#x7684;&#x662F;CAS&#x7684;&#x670D;&#x52A1;&#x7AEF;&#x8DEF;&#x5F84;&#x548C;&#x672C;&#x9879;&#x76EE;&#x7684;&#x5BF9;&#x5916;&#x8DEF;&#x5F84;&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//CAS&#x670D;&#x52A1;&#x5668;&#x5730;&#x5740;
public static final String CASServerUrlPrefix = &quot;http://xxx.xx.xx.xxx:9092/cas&quot;;
// &#x5F53;&#x524D;&#x5DE5;&#x7A0B;&#x5BF9;&#x5916;&#x63D0;&#x4F9B;&#x7684;&#x670D;&#x52A1;&#x5730;&#x5740;
public static final String SHIROServerUrlPrefix = &quot;http://127.0.0.1:9091&quot;;</span><br></pre></td></tr></table></figure>
<p>&#x8BFB;&#x8005;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x653E;&#x7F6E;&#x5230;&#x8BBE;&#x7F6E;&#x7C7B;&#x4E2D;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x5355;&#x72EC;&#x63D0;&#x51FA;&#x6765;&#x662F;&#x56E0;&#x4E3A;&#x6211;&#x7684;&#x9879;&#x76EE;&#x4E13;&#x95E8;&#x6709;&#x4E00;&#x4E2A;&#x7C7B;&#x7BA1;&#x7406;&#x8FD9;&#x4E9B;&#x53C2;&#x6570;&#x800C;&#x5DF2;&#x3002;</p>
<h2 id="&#x67E5;&#x770B;&#x6548;&#x679C;">&#x67E5;&#x770B;&#x6548;&#x679C;</h2><p>&#x5728;&#x542F;&#x52A8;CAS&#x670D;&#x52A1;&#x7AEF;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x542F;&#x52A8;&#x672C;&#x9879;&#x76EE;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x6D4F;&#x89C8;&#x5668;&#x4E2D;&#x8F93;&#x5165;&#xFF1A;<br><a href="http://localhost:9091" target="_blank" rel="external">http://localhost:9091</a><br>&#x6D4F;&#x89C8;&#x5668;&#x7684;url&#x8DEF;&#x5F84;&#x4F1A;&#x81EA;&#x52A8;&#x8F6C;&#x5316;&#x4E3A;&#xFF1A;<br><a href="http://172.18.18.25:9092/cas/login?service=http://127.0.0.1:9091/" target="_blank" rel="external">http://172.18.18.25:9092/cas/login?service=http://127.0.0.1:9091/</a><br>&#x8FD9;&#x662F;&#x4E00;&#x4E2A;CAS&#x7279;&#x6709;&#x7684;URL&#x8DEF;&#x5F84;&#xFF0C;&#x5B83;&#x7684;&#x754C;&#x9762;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><img src="/2017/12/04/Springboot&#x96C6;&#x6210;Shiro&#x548C;Cas&#x5B9E;&#x73B0;&#x5355;&#x70B9;&#x767B;&#x5F55;-&#x5BA2;&#x6237;&#x7AEF;&#x7BC7;/1.png" alt="logo"></p>
<p>&#x4E4B;&#x540E;&#x5728;&#x8FD9;&#x4E2A;&#x754C;&#x9762;&#x767B;&#x5F55;&#x6B63;&#x786E;&#x7684;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x7801;&#x540E;&#xFF0C;&#x7CFB;&#x7EDF;&#x4F1A;&#x81EA;&#x52A8;&#x8DF3;&#x8F6C;&#x5230;&#x9879;&#x76EE;&#x7684;&#x4E3B;&#x9875;&#x4E2D;&#x53BB;&#x3002;</p>
<h2 id="&#x83B7;&#x53D6;&#x7528;&#x6237;&#x4FE1;&#x606F;">&#x83B7;&#x53D6;&#x7528;&#x6237;&#x4FE1;&#x606F;</h2><p>&#x5728;&#x4F60;&#x4E0D;&#x5728;&#x670D;&#x52A1;&#x7AEF;&#x505A;&#x4EFB;&#x4F55;&#x8BBE;&#x7F6E;&#x7684;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;CAS&#x670D;&#x52A1;&#x7AEF;&#x53EA;&#x4F1A;&#x7ED9;&#x5BA2;&#x6237;&#x7AEF;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x540D;&#xFF0C;&#x6BD4;&#x5982;&#x4F60;&#x7684;&#x670D;&#x52A1;&#x7AEF;&#x7684;&#x7528;&#x6237;&#x540D;&#x662F;admin&#xFF0C;&#x53EA;&#x8981;&#x4F60;&#x767B;&#x5F55;&#x6210;&#x529F;&#xFF0C;&#x5C31;&#x4F1A;&#x628A;&#x670D;&#x52A1;&#x7AEF;&#x7684;&#x7528;&#x6237;&#x540D;&#x4F20;&#x9012;&#x7ED9;&#x5BA2;&#x6237;&#x7AEF;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x901A;&#x8FC7;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Subject currentUser = SecurityUtils.getSubject();
String username = currentUser.getPrincipal().toString();</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x4E24;&#x884C;&#x4EE3;&#x7801;&#x5C31;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5230;&#x767B;&#x5F55;&#x7528;&#x6237;&#x7684;&#x7528;&#x6237;&#x540D;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x901A;&#x8FC7;&#x81EA;&#x5DF1;&#x5199;&#x7684;&#x901A;&#x8FC7;&#x7528;&#x6237;&#x540D;&#x83B7;&#x53D6;&#x7528;&#x6237;&#x4FE1;&#x606F;&#x7684;Service&#x5C31;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5230;&#x76F8;&#x5173;&#x7684;&#x7528;&#x6237;&#x4FE1;&#x606F;&#x4E86;&#xFF0C;&#x8FD9;&#x91CC;&#x5E94;&#x8BE5;&#x4E0D;&#x96BE;&#x7406;&#x89E3;&#x3002;</p>
<p>&#x81F3;&#x4E8E;&#x83B7;&#x53D6;&#x7528;&#x6237;&#x7684;&#x591A;&#x5C5E;&#x6027;&#xFF0C;&#x5C31;&#x8981;&#x7ED3;&#x5408;&#x5230;&#x4E4B;&#x524D;&#x7684;&#x670D;&#x52A1;&#x7AEF;&#x7684;&#x8BBE;&#x7F6E;&#x4E86;&#xFF0C;&#x9996;&#x5148;&#x4F60;&#x8981;&#x5728;&#x670D;&#x52A1;&#x7AEF;&#x8BBE;&#x7F6E;&#x5982;&#x4E0B;&#x53C2;&#x6570;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&#x591A;&#x5C5E;&#x6027;
cas.authn.attributeRepository.jdbc[0].singleRow=true
cas.authn.attributeRepository.jdbc[0].order=0
cas.authn.attributeRepository.jdbc[0].url=jdbc:mysql://172.18.18.25:3306/pa_db?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect=true&amp;useSSL=false
cas.authn.attributeRepository.jdbc[0].username=username
cas.authn.attributeRepository.jdbc[0].user=root
cas.authn.attributeRepository.jdbc[0].password=1234
cas.authn.attributeRepository.jdbc[0].sql=select * from s_user where {0}
cas.authn.attributeRepository.jdbc[0].dialect=org.hibernate.dialect.MySQLDialect
cas.authn.attributeRepository.jdbc[0].ddlAuto=none
cas.authn.attributeRepository.jdbc[0].driverClass=com.mysql.jdbc.Driver
cas.authn.attributeRepository.jdbc[0].leakThreshold=10
cas.authn.attributeRepository.jdbc[0].propagationBehaviorName=PROPAGATION_REQUIRED
cas.authn.attributeRepository.jdbc[0].batchSize=1
cas.authn.attributeRepository.jdbc[0].healthQuery=SELECT 1
cas.authn.attributeRepository.jdbc[0].failFast=trueyeshi</span><br></pre></td></tr></table></figure>
<p>&#x4EE5;&#x4E0A;&#x4EE3;&#x7801;&#x5C31;&#x5141;&#x8BB8;&#x7528;&#x6237;&#x8FD4;&#x56DE;&#x670D;&#x52A1;&#x7AEF;&#x7684;s_user &#x6570;&#x636E;&#x5E93;&#x8868;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5B57;&#x6BB5;&#xFF0C;&#x5F53;&#x7136;&#x4F60;&#x518D;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x5199;&#x6CD5;&#x4E5F;&#x8981;&#x8DDF;&#x7740;&#x6539;&#x53D8;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x3000;AttributePrincipal principal = (AttributePrincipal) request.getUserPrincipal();

&#x3000;final Map attributes = principal.getAttributes();</span><br></pre></td></tr></table></figure>
<h2 id="&#x540E;&#x8BB0;">&#x540E;&#x8BB0;</h2><p>CAS&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x914D;&#x7F6E;&#x5DEE;&#x4E0D;&#x591A;&#x5C31;&#x662F;&#x8FD9;&#x6837;&#x4E86;&#xFF0C;&#x6CE8;&#x91CA;&#x5199;&#x7684;&#x90FD;&#x6BD4;&#x8F83;&#x660E;&#x767D;&#x4E86;&#xFF0C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x5751;&#x6709;&#x4EE5;&#x4E0B;&#x4E24;&#x70B9;&#xFF1A;</p>
<ol>
<li>&#x8BBE;&#x7F6E;&#x7C7B;&#x4E2D;&#x7684;Service&#x5F15;&#x5165;&#x65B9;&#x5F0F;</li>
<li>POM.xml&#x4E2D;&#x66F4;&#x6539;&#x7EC4;&#x4EF6;&#x7248;&#x672C;&#x53F7;&#x4E00;&#x5B9A;&#x8981;&#x526A;&#x5207;&#x9ECF;&#x8D34;&#xFF0C;&#x4E0D;&#x8981;&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#x7248;&#x672C;&#x53F7;</li>
</ol>
<p>&#x5269;&#x4E0B;&#x7684;&#x5927;&#x5BB6;&#x770B;&#x7740;&#x6587;&#x7AE0;&#x4E00;&#x6B65;&#x4E00;&#x6B65;&#x7684;&#x8D70;&#x51FA;&#x6765;&#x5E94;&#x8BE5;&#x95EE;&#x9898;&#x5C31;&#x4E0D;&#x5927;&#x4E86;&#xFF0C;&#x4E0B;&#x4E00;&#x7BC7;&#x6211;&#x4EEC;&#x8BB2;&#x4E24;&#x4E2A;&#x5C0F;&#x7684;&#x5185;&#x5BB9;&#xFF1A;</p>
<ol>
<li>&#x4FEE;&#x6539;CAS&#x670D;&#x52A1;&#x7AEF;&#x7684;&#x9ED8;&#x8BA4;&#x767B;&#x5F55;&#x9875;</li>
<li>&#x5982;&#x4F55;&#x767B;&#x51FA;CAS&#x5BA2;&#x6237;&#x7AEF;</li>
</ol>
<p>&#x656C;&#x8BF7;&#x671F;&#x5F85;</p>
<h2 id="&#x76F8;&#x5173;&#x8D44;&#x6599;">&#x76F8;&#x5173;&#x8D44;&#x6599;</h2><ol>
<li><a href="http://blog.csdn.net/liuchuanhong1/article/details/76850181" target="_blank" rel="external">spring boot&#x6574;&#x5408;Shiro&#x5B9E;&#x73B0;&#x5355;&#x70B9;&#x767B;&#x5F55;</a></li>
<li><a href="http://blog.csdn.net/catoop/article/details/50534006" target="_blank" rel="external">Spring Boot &#x96C6;&#x6210;Shiro&#x548C;CAS</a></li>
</ol>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Springboot集成Shiro和Cas实现单点登录(服务端篇CAS5)]]></title>
      <url>http://jasoncool.com/2017/11/29/Springboot%E9%9B%86%E6%88%90Shiro%E5%92%8CCas%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%AF%87CAS5/</url>
      <content type="html"><![CDATA[<h2 id="&#x4EC0;&#x4E48;&#x662F;&#x5355;&#x70B9;&#x767B;&#x5F55;&#xFF1F;">&#x4EC0;&#x4E48;&#x662F;&#x5355;&#x70B9;&#x767B;&#x5F55;&#xFF1F;</h2><p>&#x5148;&#x8BF4;&#x4E00;&#x4E2A;&#x9700;&#x6C42;&#x573A;&#x666F;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;&#x4E00;&#x4E2A;&#x4F01;&#x4E1A;&#x7684;&#x5185;&#x90E8;&#x6709;N&#x591A;&#x4E2A;&#x5B50;&#x7CFB;&#x7EDF;&#xFF0C;&#x6BCF;&#x4E2A;&#x5B50;&#x7CFB;&#x7EDF;&#x90FD;&#x6709;&#x4E00;&#x5957;&#x81EA;&#x5DF1;&#x7684;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x7801;&#xFF0C;&#x90A3;&#x4E48;&#x4F01;&#x4E1A;&#x7684;&#x5458;&#x5DE5;&#x8981;&#x767B;&#x5F55;N&#x4E2A;&#x5B50;&#x7CFB;&#x7EDF;&#xFF0C;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x5458;&#x5DE5; &#x5C31;&#x8981;&#x8BB0;&#x4F4F;N&#x4E2A;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x7801;&#xFF0C;&#x5C31;&#x7B97;&#x5404;&#x4E2A;&#x5B50;&#x7CFB;&#x7EDF;&#x7684;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x7801;&#x90FD;&#x662F;&#x7EDF;&#x4E00;&#x7684;&#xFF0C;&#x767B;&#x5F55;&#x6BCF;&#x4E2A;&#x5B50;&#x7CFB;&#x7EDF;&#x90FD;&#x8981;&#x8F93;&#x5165;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x7801;&#x8FDB;&#x884C;&#x767B;&#x5F55;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x7E41;&#x7410;&#x7684;&#x64CD;&#x4F5C;&#x8FC7;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x5355;&#x70B9;&#x767B;&#x5F55;&#x529F;&#x80FD;&#x7531;&#x6B64;&#x4FBF;&#x5E94;&#x8FD0;&#x800C;&#x751F;&#x4E86;&#x3002;<br><strong>&#x5355;&#x70B9;&#x767B;&#x5F55;</strong>&#xFF08;Single Sign On&#xFF09;&#xFF0C;&#x7B80;&#x79F0;&#x4E3A; SSO&#xFF0C;&#x662F;&#x76EE;&#x524D;&#x6BD4;&#x8F83;&#x6D41;&#x884C;&#x7684;&#x4F01;&#x4E1A;&#x4E1A;&#x52A1;&#x6574;&#x5408;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x4E4B;&#x4E00;&#x3002;SSO&#x7684;&#x5B9A;&#x4E49;&#x662F;&#x5728;&#x591A;&#x4E2A;&#x5E94;&#x7528;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x7528;&#x6237;&#x53EA;&#x9700;&#x8981;&#x767B;&#x5F55;&#x4E00;&#x6B21;&#x5C31;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x6240;&#x6709;&#x76F8;&#x4E92;&#x4FE1;&#x4EFB;&#x7684;&#x5E94;&#x7528;&#x7CFB;&#x7EDF;&#x3002;<br><a id="more"></a></p>
<h2 id="CAS&#x67B6;&#x6784;&#x56FE;">CAS&#x67B6;&#x6784;&#x56FE;</h2><p>&#x8FD9;&#x91CC;&#x76F4;&#x63A5;&#x8BF4;CAS&#x6574;&#x4F53;&#x67B6;&#x6784;&#x662F;&#x56E0;&#x4E3A;&#x8FD9;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x5165;&#x95E8;&#x6559;&#x7A0B;&#xFF0C;&#x6211;&#x5DF2;&#x7ECF;&#x9ED8;&#x8BA4;&#x4F60;&#x77E5;&#x9053;&#x4EC0;&#x4E48;&#x662F;SSO&#x3001;&#x4EC0;&#x4E48;&#x662F;CAS&#xFF0C;&#x4EE5;&#x53CA;&#x4F60;&#x5DF2;&#x7ECF;&#x88C5;&#x597D;&#x4E86;&#x5F00;&#x53D1;&#x5DE5;&#x5177;IDEA&#x548C;Java&#x73AF;&#x5883;Jdk1.8&#xFF0C;&#x5E76;&#x4E14;&#x4F60;&#x4E5F;&#x77E5;&#x9053;&#x4EC0;&#x4E48;&#x662F;Web&#x5BB9;&#x5668;&#xFF0C;&#x77E5;&#x9053;Tomcat8.5+&#x8BE5;&#x4ECE;&#x54EA;&#x4E0B;&#x8F7D;&#x5E76;&#x542F;&#x52A8;&#x90E8;&#x7F72;&#xFF0C;&#x4F60;&#x4E5F;&#x77E5;&#x9053;&#x4EC0;&#x4E48;&#x662F;Maven&#x9879;&#x76EE;&#x8BE5;&#x600E;&#x4E48;&#x5F15;&#x5165;&#x76F8;&#x5173;&#x7684;jar&#x5305;&#x7B49;&#x7B49;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x4F60;&#x4E0D;&#x5177;&#x5907;&#x4EE5;&#x4E0A;&#x8FD9;&#x4E9B;&#x77E5;&#x8BC6;&#xFF0C;&#x90A3;&#x4E48;CAS&#x670D;&#x52A1;&#x7AEF;&#x7684;&#x5B66;&#x4E60;&#x6211;&#x5EFA;&#x8BAE;&#x4F60;&#x8FD8;&#x662F;&#x5148;&#x4E0D;&#x8981;&#x5F00;&#x59CB;&#xFF0C;&#x5F04;&#x6E05;&#x695A;&#x524D;&#x9762;&#x7684;&#x77E5;&#x8BC6;&#x70B9;&#xFF0C;&#x624D;&#x80FD;&#x7545;&#x901A;&#x65E0;&#x963B;&#x7684;&#x5B66;&#x4E60;CAS&#x670D;&#x52A1;&#x7AEF;&#x3002;<br>&#x597D;&#x4E86;&#xFF0C;&#x8FD9;&#x91CC;&#x5148;&#x653E;&#x67B6;&#x6784;&#x56FE;&#xFF1A;</p>
<p> <img src="/2017/11/29/Springboot&#x96C6;&#x6210;Shiro&#x548C;Cas&#x5B9E;&#x73B0;&#x5355;&#x70B9;&#x767B;&#x5F55;-&#x670D;&#x52A1;&#x7AEF;&#x7BC7;CAS5/2.png" alt="logo"></p>
<p>&#x73B0;&#x5728;&#x6765;&#x8BB2;&#x89E3;&#x8FD9;&#x4E2A;&#x67B6;&#x6784;&#x56FE;&#xFF1A;<br>&#x9996;&#x5148;&#x642D;&#x5EFA;&#x597D;CAS&#x670D;&#x52A1;&#x7AEF;&#x540E;&#xFF0C;&#x670D;&#x52A1;&#x7AEF;&#x4F1A;&#x81EA;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x548C;&#x7528;&#x6237;&#x8868;&#xFF0C;&#x7528;&#x6237;&#x8868;&#x4E2D;&#x5B58;&#x653E;&#x7684;&#x662F;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x7801;&#xFF0C;&#x901A;&#x8FC7;&#x8BBF;&#x95EE;&#x5B50;&#x7CFB;&#x7EDF;&#x7684;URL&#x5730;&#x5740;&#xFF0C;&#x5982;&#x679C;CAS&#x7CFB;&#x7EDF;&#x5224;&#x5B9A;&#x4F60;&#x6CA1;&#x6709;&#x767B;&#x5F55;&#xFF0C;&#x5C31;&#x4F1A;&#x5C06;URL&#x91CD;&#x5B9A;&#x5411;&#x5230;CAS&#x7684;&#x670D;&#x52A1;&#x7AEF;&#x767B;&#x5F55;&#x754C;&#x9762;&#xFF0C;&#x7528;&#x6237;&#x901A;&#x8FC7;&#x8F93;&#x5165;&#x7528;&#x6237;&#x6570;&#x636E;&#x5E93;&#x7684;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x7801;&#x6765;&#x8FDB;&#x884C;&#x767B;&#x5F55;&#xFF0C;&#x5F85;&#x767B;&#x5F55;&#x6210;&#x529F;&#x540E;&#xFF0C;CAS&#x670D;&#x52A1;&#x7AEF;&#x4F1A;&#x7ED9;CAS&#x5BA2;&#x6237;&#x7AEF;(&#x5B50;&#x7CFB;&#x7EDF;)&#x53D1;&#x9001;&#x767B;&#x5F55;&#x7684;&#x7528;&#x6237;&#x540D;&#xFF0C;CAS&#x5BA2;&#x6237;&#x7AEF;&#x63A5;&#x5230;&#x7528;&#x6237;&#x540D;&#x540E;&#xFF0C;&#x4F1A;&#x4ECE;CAS&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x7528;&#x6237;&#x8868;&#x4E2D;&#x5BFB;&#x627E;&#x5BF9;&#x5E94;&#x7528;&#x6237;&#x540D;&#x7684;userid,&#x5E76;&#x901A;&#x8FC7;&#x8BE5;userid&#x83B7;&#x53D6;&#x5230;&#x8BE5;&#x540D;&#x7528;&#x6237;&#x5728;CAS&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x76F8;&#x5173;&#x6743;&#x9650;&#x3002;<br>&#x6211;&#x4EEC;&#x8FD8;&#x53EF;&#x4EE5;&#x57FA;&#x4E8E;CAS&#x670D;&#x52A1;&#x7AEF;&#x914D;&#x7F6E;&#x7684;&#x7528;&#x6237;&#x6570;&#x636E;&#x5E93;&#x505A;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x7BA1;&#x7406;&#x754C;&#x9762;&#xFF0C;&#x8BE5;&#x754C;&#x9762;&#x53EF;&#x4EE5;&#x5BF9;CAS&#x670D;&#x52A1;&#x7AEF;&#x7684;&#x7528;&#x6237;&#x8FDB;&#x884C;&#x4E00;&#x4E9B;&#x57FA;&#x672C;&#x7684;&#x4E1A;&#x52A1;&#x64CD;&#x4F5C;&#xFF0C;&#x6BD4;&#x5982;&#x65B0;&#x589E;&#x3001;&#x4FEE;&#x6539;&#x3001;&#x5220;&#x9664;&#x7B49;&#xFF0C;&#x65B0;&#x589E;&#x7528;&#x6237;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x9700;&#x8981;&#x540C;&#x65F6;&#x5728;&#x5404;&#x4E2A;&#x5B50;&#x7CFB;&#x7EDF;&#x7684;&#x7528;&#x6237;&#x8868;&#x4E2D;&#x63D2;&#x5165;&#x8BE5;&#x7528;&#x6237;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#xFF0C;&#x7136;&#x540E;&#x5404;&#x4E2A;&#x5B50;&#x7CFB;&#x7EDF;&#x7684;&#x7BA1;&#x7406;&#x5458;&#x5C31;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5B50;&#x7CFB;&#x7EDF;&#x7684;&#x89D2;&#x8272;&#x6743;&#x9650;&#x8BBE;&#x7F6E;&#xFF0C;&#x7ED9;&#x8BE5;&#x7528;&#x6237;&#x914D;&#x7F6E;&#x76F8;&#x5173;&#x7684;&#x89D2;&#x8272;&#x6743;&#x9650;&#x4E86;&#x3002;</p>
<h2 id="&#x5B89;&#x88C5;CAS&#x670D;&#x52A1;&#x7AEF;">&#x5B89;&#x88C5;CAS&#x670D;&#x52A1;&#x7AEF;</h2><p>&#x8BB2;&#x4E86;&#x8FD9;&#x4E48;&#x591A;&#xFF0C;&#x73B0;&#x5728;&#x5F00;&#x59CB;&#x8FDB;&#x5165;&#x6B63;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x5B9E;&#x73B0;&#x6211;&#x4EEC;&#x7684;&#x76EE;&#x7684;&#x9996;&#x5148;&#x8981;&#x505A;&#x7684;&#x5C31;&#x662F;&#x5B89;&#x88C5;CAS&#x670D;&#x52A1;&#x7AEF;&#xFF0C;&#x73B0;&#x5728;&#x7F51;&#x4E0A;&#x7684;&#x5F88;&#x591A;Springboot&#x6574;&#x5408;CAS&#x7684;&#x6559;&#x7A0B;&#x57FA;&#x672C;&#x4E0A;&#x90FD;&#x662F;&#x53EA;&#x8BB2;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x914D;&#x7F6E;&#xFF0C;&#x770B;&#x5B8C;&#x4E4B;&#x540E;&#x4E91;&#x91CC;&#x96FE;&#x91CC;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x8FD9;&#x4E2A;&#x6559;&#x7A0B;&#x8981;&#x4ECE;CAS&#x7684;&#x670D;&#x52A1;&#x7AEF;&#x5F00;&#x59CB;&#x8BB2;&#x8D77;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x4EEC;&#x516C;&#x53F8;&#x6709;&#x4EBA;&#x4E13;&#x95E8;&#x642D;&#x5EFA;CAS&#x670D;&#x52A1;&#x7AEF;&#xFF0C;&#x90A3;&#x5C31;&#x53EF;&#x4EE5;&#x8DF3;&#x8FC7;&#x672C;&#x7BC7;&#x6559;&#x7A0B;&#x7EE7;&#x7EED;&#x4E0B;&#x4E00;&#x7BC7;&#x4E86;&#x3002;</p>
<ol>
<li>&#x4E0B;&#x8F7D;Overlay<br>&#x901A;&#x8FC7;&#x9605;&#x8BFB;&#x5B98;&#x7F51;&#x6587;&#x6863;&#xFF08;<a href="https://apereo.github.io/cas/5.1.x/planning/Getting-Started.html" target="_blank" rel="external">https://apereo.github.io/cas/5.1.x/planning/Getting-Started.html</a>&#xFF09;&#x4E86;&#x89E3;&#x5230;&#x5B98;&#x65B9;&#x5EFA;&#x8BAE;&#x6211;&#x4EEC;&#xFF1A;<br>&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x540D;&#x53EB;Overlay&#x7684;&#x9879;&#x76EE;&#x6765;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x7528;&#x7684;war&#x5305;&#xFF0C;&#x6765;&#x90E8;&#x7F72;&#x670D;&#x52A1;&#x7AEF;&#xFF0C;&#x4E8E;&#x662F;&#x6211;&#x4EEC;&#x5148;&#x4E0B;&#x8F7D;&#x8FD9;&#x4E2A;&#x9879;<br>&#x76EE;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;Maven&#x7684;&#xFF0C;&#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/apereo/cas-overlay-template" target="_blank" rel="external">https://github.com/apereo/cas-overlay-template</a>&#x3002;</li>
<li><p>&#x642D;&#x5EFA;Overlay&#x9879;&#x76EE;<br>&#x5C06;&#x9879;&#x76EE;&#x4E0B;&#x597D;&#x540E;&#x89E3;&#x538B;&#x7F29;&#x5E76;&#x653E;&#x5165;&#x6211;&#x4EEC;&#x7684;&#x5DE5;&#x4F5C;&#x7A7A;&#x95F4;&#xFF0C;&#x7136;&#x540E;&#x6253;&#x5F00;IDEA&#xFF0C;&#x7136;&#x540E;&#x9009;&#x62E9;File&#x2013;Open&#x6253;&#x5F00;&#x6211;&#x4EEC;&#x9879;&#x76EE;&#x6240;&#x5728;&#x8DEF;&#x5F84;&#xFF0C;&#x7136;&#x540E;&#x6211;&#x4EEC;&#x53EA;&#x8981;&#x9759;&#x9759;&#x7684;&#x7B49;&#x5F85;Maven&#x5C06;&#x9879;&#x76EE;&#x6784;&#x7B51;&#x597D;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;&#x8FD9;&#x65F6;&#x4F60;&#x770B;&#x5230;&#x7684;&#x9879;&#x76EE;&#x662F;&#x8FD9;&#x4E2A;&#x6837;&#x5B50;&#x7684;&#xFF1A;</p>
<p><img src="/2017/11/29/Springboot&#x96C6;&#x6210;Shiro&#x548C;Cas&#x5B9E;&#x73B0;&#x5355;&#x70B9;&#x767B;&#x5F55;-&#x670D;&#x52A1;&#x7AEF;&#x7BC7;CAS5/3.png" alt="logo"></p>
</li>
</ol>
<p>&#x8FD9;&#x662F;&#x6211;&#x7684;&#x9879;&#x76EE;&#xFF0C;&#x4F60;&#x7684;&#x9879;&#x76EE;&#x4E2D;&#x5E76;&#x6CA1;&#x6709;src&#x76EE;&#x5F55;&#x548C;target&#x76EE;&#x5F55;&#xFF0C;src&#x76EE;&#x5F55;&#x662F;&#x7528;&#x6237;&#x81EA;&#x5DF1;&#x5EFA;&#x7ACB;&#x7684;&#xFF0C;&#x81F3;&#x4E8E;&#x4E3A;&#x4EC0;&#x4E48;&#x540E;&#x8FB9;&#x4F1A;&#x8BB2;&#xFF0C;target&#x76EE;&#x5F55;&#x662F;&#x5BFC;&#x51FA;war&#x65F6;&#x624D;&#x51FA;&#x73B0;&#x7684;&#xFF0C;&#x65B0;&#x5BFC;&#x5165;&#x7684;&#x9879;&#x76EE;&#x662F;&#x6CA1;&#x6709;&#x7684;&#x3002;</p>
<ol>
<li><p>&#x5236;&#x6210;&#x53EF;&#x7528;&#x7684;CAS&#x670D;&#x52A1;&#x7AEF;<br>&#x73B0;&#x5728;&#x7684;CAS&#x670D;&#x52A1;&#x7AEF;&#x57FA;&#x672C;&#x4E0A;&#x662F;&#x4E0D;&#x53EF;&#x7528;&#x7684;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x8BF4;&#x57FA;&#x672C;&#x4E0A;&#x5462;&#xFF1F;&#x56E0;&#x4E3A;&#x5982;&#x679C;&#x4F60;&#x73B0;&#x5728;&#x8BB2;&#x9879;&#x76EE;&#x6253;&#x6210;war&#x5305;,&#x5E76;&#x5C06;&#x5B83;&#x90E8;&#x7F72;&#x5230;Tomcat&#x4E2D;&#x53BB;&#x540E;&#x662F;&#x53EF;&#x4EE5;&#x542F;&#x52A8;&#x670D;&#x52A1;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x8BBF;&#x95EE;&#x672C;&#x5730;&#x5730;&#x5740;&#xFF1A;<a href="http://localhost:8080/cas/login" target="_blank" rel="external">http://localhost:8080/cas/login</a>&#x8FD8;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5982;&#x4E0B;&#x754C;&#x9762;&#xFF1A;</p>
<p><img src="/2017/11/29/Springboot&#x96C6;&#x6210;Shiro&#x548C;Cas&#x5B9E;&#x73B0;&#x5355;&#x70B9;&#x767B;&#x5F55;-&#x670D;&#x52A1;&#x7AEF;&#x7BC7;CAS5/4.png" alt="logo"></p>
</li>
</ol>
<p>&#x4F7F;&#x7528; &#x9ED8;&#x8BA4;&#x8D26;&#x53F7;&#xFF1A;casuser  &#x9ED8;&#x8BA4;&#x5BC6;&#x7801;&#xFF1A;Mellon&#x8FD8;&#x53EF;&#x4EE5;&#x767B;&#x5F55;&#x6210;&#x529F;&#xFF0C;&#x4E0D;&#x8FC7;&#x8FD9;&#x4E2A;CAS&#x670D;&#x52A1;&#x7AEF;&#x76EE;&#x524D;&#x5E76;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x5375;&#x7528;&#xFF0C;&#x53EA;&#x662F;&#x53EF;&#x4EE5;&#x770B;&#x770B;&#x800C;&#x5DF2;&#x3002;<br>&#x8FD9;&#x4E24;&#x4E2A;&#x7EA2;&#x8272;&#x8B66;&#x544A;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;&#x8BF4;&#x6CA1;&#x6709;&#x4F7F;&#x7528;Https&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x662F;&#x8BF4;&#x4F60;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x7684;&#x6743;&#x9650;&#xFF0C;&#x4E00;&#x4E2A;&#x5199;&#x6B7B;&#x7684;&#x7528;&#x6237;&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x544A;&#x8BC9;&#x4F60;&#x73B0;&#x5728;&#x7684;&#x670D;&#x52A1;&#x7AEF;&#x662F;&#x4E0D;&#x5B89;&#x5168;&#x7684;&#x3002;</p>
<ul>
<li>&#x7B2C;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF1A;&#x5173;&#x4E8E;https&#x8BF7;&#x6C42;<br>&#x670D;&#x52A1;&#x7AEF;&#x662F;http&#x7684;&#x5176;&#x5B9E;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#xFF0C;&#x6211;&#x5728;&#x8FD9;&#x4E2A;&#x6559;&#x7A0B;&#x4E2D;&#x4E0D;&#x4F1A;&#x8BB2;&#x89E3;&#x5982;&#x4F55;&#x642D;&#x5EFA;https&#x8BF7;&#x6C42;&#x7684;&#x670D;&#x52A1;&#x7AEF;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x7684;&#x5B50;&#x9879;&#x76EE;&#x90FD;&#x662F;http&#x8BF7;&#x6C42;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x670D;&#x52A1;&#x7AEF;&#x6211;&#x4E5F;&#x4E0D;&#x6253;&#x7B97;&#x7528;https&#x8BF7;&#x6C42;&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x5B66;&#x4E60;https&#x8BF7;&#x6C42;&#xFF0C;&#x8BF7;&#x53C2;&#x770B;&#x522B;&#x4EBA;&#x7684;&#x53C2;&#x8003;&#x6559;&#x7A0B;&#xFF0C;&#x8FD9;&#x91CC;&#x4E0D;&#x505A;&#x8BB2;&#x89E3;&#x3002;</li>
<li>&#x7B2C;&#x4E8C;&#x4E2A;&#x95EE;&#x9898;&#xFF1A;&#x5173;&#x4E8E;&#x9759;&#x6001;&#x7528;&#x6237;</li>
</ul>
<ol>
<li>&#x6211;&#x4EEC;&#x5148;&#x6253;&#x5F00;&#x9879;&#x76EE;&#x7684;pom.xml&#x6587;&#x4EF6;&#xFF0C;&#x5F15;&#x5165;&#x76F8;&#x5173;&#x7684;jar&#x5305;&#xFF0C;&#x6CE8;&#x91CA;&#x6389;&#x7528;&#x4E0D;&#x5230;&#x7684;jar&#x5305;&#xFF0C;&#x6211;&#x7684;&#x6570;&#x636E;&#x5E93;&#x662F;mysql&#x7684;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x7684;&#x6570;&#x636E;&#x5E93;&#x4E0D;&#x662F;&#xFF0C;&#x8BF7;&#x627E;&#x5230;&#x5BF9;&#x5E94;&#x7684;jar&#x5305;&#x8FDB;&#x884C;&#x5F15;&#x5165;&#x5373;&#x53EF;&#xFF1A;</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">project</span> <span class="attribute">xmlns</span>=<span class="value">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attribute">xmlns:xsi</span>=<span class="value">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="attribute">xsi:schemaLocation</span>=<span class="value">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd &quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="title">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apereo.cas<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>cas-overlay<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="title">packaging</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">plugins</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&#x7B2C;&#x4E00;&#x6B65;&#xFF1A;&#x6CE8;&#x91CA;&#x65E0;&#x7528;&#x7EC4;&#x4EF6;</span><br><span class="line">			 &lt;plugin&gt;</span><br><span class="line">                &lt;groupId&gt;com.rimerosolutions.maven.plugins&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;wrapper-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">                &lt;version&gt;0.0.4&lt;/version&gt;</span><br><span class="line">                &lt;configuration&gt;</span><br><span class="line">                    &lt;verifyDownload&gt;true&lt;/verifyDownload&gt;</span><br><span class="line">                    &lt;checksumAlgorithm&gt;MD5&lt;/checksumAlgorithm&gt;</span><br><span class="line">                &lt;/configuration&gt;</span><br><span class="line">            &lt;/plugin&gt;--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">version</span>&gt;</span>${springboot.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="title">mainClass</span>&gt;</span>org.springframework.boot.loader.WarLauncher<span class="tag">&lt;/<span class="title">mainClass</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="title">addResources</span>&gt;</span>true<span class="tag">&lt;/<span class="title">addResources</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>maven-war-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.6<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="title">warName</span>&gt;</span>cas<span class="tag">&lt;/<span class="title">warName</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="title">failOnMissingWebXml</span>&gt;</span>false<span class="tag">&lt;/<span class="title">failOnMissingWebXml</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="title">recompressZippedFiles</span>&gt;</span>false<span class="tag">&lt;/<span class="title">recompressZippedFiles</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="title">archive</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="title">compress</span>&gt;</span>false<span class="tag">&lt;/<span class="title">compress</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="title">manifestFile</span>&gt;</span>${project.build.directory}/war/work/org.apereo.cas/cas-server-webapp${app.server}/META-INF/MANIFEST.MF</span><br><span class="line">                        <span class="tag">&lt;/<span class="title">manifestFile</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="title">archive</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="title">overlays</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="title">overlay</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apereo.cas<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>cas-server-webapp${app.server}<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="title">overlay</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="title">overlays</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">version</span>&gt;</span>3.3<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">finalName</span>&gt;</span>cas<span class="tag">&lt;/<span class="title">finalName</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apereo.cas<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>cas-server-webapp${app.server}<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">version</span>&gt;</span>${cas.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">type</span>&gt;</span>war<span class="tag">&lt;/<span class="title">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="title">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--&#x7B2C;&#x4E8C;&#x6B65;:&#x5F15;&#x5165;&#x6570;&#x636E;&#x5E93;&#x8BA4;&#x8BC1;&#x76F8;&#x5173; start--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apereo.cas<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>cas-server-support-jdbc<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">version</span>&gt;</span>${cas.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apereo.cas<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>cas-server-support-jdbc-drivers<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">version</span>&gt;</span>${cas.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">version</span>&gt;</span>5.1.36<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">cas.version</span>&gt;</span>5.1.4<span class="tag">&lt;/<span class="title">cas.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">springboot.version</span>&gt;</span>1.5.3.RELEASE<span class="tag">&lt;/<span class="title">springboot.version</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- app.server could be -jetty, -undertow, -tomcat, or blank if you plan to provide appserver --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">app.server</span>&gt;</span>-tomcat<span class="tag">&lt;/<span class="title">app.server</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="title">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="title">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="title">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">repositories</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">repository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">id</span>&gt;</span>sonatype-releases<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">url</span>&gt;</span>http://oss.sonatype.org/content/repositories/releases/<span class="tag">&lt;/<span class="title">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">snapshots</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="title">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">snapshots</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">releases</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="title">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">releases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">repository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">id</span>&gt;</span>sonatype-snapshots<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">url</span>&gt;</span>https://oss.sonatype.org/content/repositories/snapshots/<span class="tag">&lt;/<span class="title">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">snapshots</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="title">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">snapshots</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">releases</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="title">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">releases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">repository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">id</span>&gt;</span>shibboleth-releases<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">url</span>&gt;</span>https://build.shibboleth.net/nexus/content/repositories/releases<span class="tag">&lt;/<span class="title">url</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">repository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">id</span>&gt;</span>spring-milestones<span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">url</span>&gt;</span>https://repo.spring.io/milestone<span class="tag">&lt;/<span class="title">url</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">repository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">repositories</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--&#x7B2C;&#x4E09;&#x6B65;&#xFF1A;&#x6CE8;&#x91CA;&#x6389;&#x65E0;&#x7528;&#x7684;&#x7EC4;&#x4EF6;</span><br><span class="line">	&lt;profiles&gt;</span><br><span class="line">        &lt;profile&gt;</span><br><span class="line">            &lt;activation&gt;</span><br><span class="line">                &lt;activeByDefault&gt;false&lt;/activeByDefault&gt;</span><br><span class="line">            &lt;/activation&gt;</span><br><span class="line">            &lt;id&gt;pgp&lt;/id&gt;</span><br><span class="line">            &lt;build&gt;</span><br><span class="line">                &lt;plugins&gt;</span><br><span class="line">                    &lt;plugin&gt;</span><br><span class="line">                        &lt;groupId&gt;com.github.s4u.plugins&lt;/groupId&gt;</span><br><span class="line">                        &lt;artifactId&gt;pgpverify-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">                        &lt;version&gt;1.1.0&lt;/version&gt;</span><br><span class="line">                        &lt;executions&gt;</span><br><span class="line">                            &lt;execution&gt;</span><br><span class="line">                                &lt;goals&gt;</span><br><span class="line">                                    &lt;goal&gt;check&lt;/goal&gt;</span><br><span class="line">                                &lt;/goals&gt;</span><br><span class="line">                            &lt;/execution&gt;</span><br><span class="line">                        &lt;/executions&gt;</span><br><span class="line">                        &lt;configuration&gt;</span><br><span class="line">                            &lt;pgpKeyServer&gt;hkp://pool.sks-keyservers.net&lt;/pgpKeyServer&gt;</span><br><span class="line">                            &lt;pgpKeysCachePath&gt;${settings.localRepository}/pgpkeys-cache&lt;/pgpKeysCachePath&gt;</span><br><span class="line">                            &lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">                            &lt;verifyPomFiles&gt;true&lt;/verifyPomFiles&gt;</span><br><span class="line">                            &lt;failNoSignature&gt;false&lt;/failNoSignature&gt;</span><br><span class="line">                        &lt;/configuration&gt;</span><br><span class="line">                    &lt;/plugin&gt;</span><br><span class="line">                &lt;/plugins&gt;</span><br><span class="line">            &lt;/build&gt;</span><br><span class="line">        &lt;/profile&gt;</span><br><span class="line">    &lt;/profiles&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol>
<li>&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;<br>&#x6211;&#x4EEC;&#x5728;cas-overly&#x8FD9;&#x4E2A;&#x9879;&#x76EE;&#x7684;&#x6839;&#x76EE;&#x5F55;&#x4E0B;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;src&#x76EE;&#x5F55;&#xFF0C;&#x5E76;&#x5728;src&#x76EE;&#x5F55;&#x4E0B;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;resource&#x76EE;&#x5F55;&#xFF0C;&#x5728;resource&#x76EE;&#x5F55;&#x4E0B;&#x518D;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;application.properties&#x6587;&#x4EF6;&#xFF0C;&#x8BE5;&#x6587;&#x4EF6;&#x4E2D;&#x8981;&#x5199;&#x7684;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x4E86;&#xFF1A;</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#STEP 3 &#x5728;TOMCAT8.5&#x4E2D;&#x8DD1;&#x4E00;&#x4E2A;&#x6A21;&#x677F;&#x7136;&#x540E;&#x5C06;&#x5176;war&#x5305;&#x4E2D;&#x89E3;&#x538B;&#x51FA;&#x6765;&#x7684;&#x7684;application.properties&#x590D;&#x5236;&#x51FA;&#x6765;&#xFF0C;&#x653E;&#x5230;&#x624B;&#x52A8;&#x521B;&#x5EFA;&#x7684;src&#x4E0B;&#x7684;resources&#x91CC;&#x9762;

##
# CAS Server Context Configuration
#z
server.context-path=/cas
server.port=9092

#STEP 5&#x6DFB;&#x52A0;&#x8BA4;&#x8BC1;&#x670D;&#x52A1;
cas.serviceRegistry.initFromJson=true

#STEP 4&#x7B7E;&#x53D1;&#x8BC1;&#x4E66;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x7528;spring boot&#x4E4B;&#x7C7B;&#x5D4C;&#x5165;&#x5F0F;&#x7684;&#x5BB9;&#x5668;&#xFF0C;&#x5219;&#x9700;&#x8981;&#x6539;&#x8FD9;&#x91CC;&#x7684;&#x914D;&#x7F6E;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x76F4;&#x63A5;&#x90E8;&#x5728;tomcat&#x4E2D;&#xFF0C;&#x5219;&#x9700;&#x8981;&#x628A;tomcat&#x6539;&#x6210;https&#x7684;
#server.ssl.key-store=file:/etc/cas/thekeystore
#server.ssl.key-store-password=changeit
#server.ssl.key-password=changeit
# server.ssl.ciphers=
# server.ssl.client-auth=
# server.ssl.enabled=
# server.ssl.key-alias=
# server.ssl.key-store-provider=
# server.ssl.key-store-type=
# server.ssl.protocol=
# server.ssl.trust-store=
# server.ssl.trust-store-password=
# server.ssl.trust-store-provider=
# server.ssl.trust-store-type=

#server.max-http-header-size=2097152
#server.use-forward-headers=true
#server.connection-timeout=20000
#server.error.include-stacktrace=NEVER

#server.tomcat.max-http-post-size=2097152
#server.tomcat.basedir=build/tomcat
#server.tomcat.accesslog.enabled=true
#server.tomcat.accesslog.pattern=%t %a &quot;%r&quot; %s (%D ms)
#server.tomcat.accesslog.suffix=.log
#server.tomcat.max-threads=10
#server.tomcat.port-header=X-Forwarded-Port
#server.tomcat.protocol-header=X-Forwarded-Proto
#server.tomcat.protocol-header-https-value=https
#server.tomcat.remote-ip-header=X-FORWARDED-FOR
#server.tomcat.uri-encoding=UTF-8

spring.http.encoding.charset=UTF-8
spring.http.encoding.enabled=true
spring.http.encoding.force=true

##
# CAS Cloud Bus Configuration
#
spring.cloud.bus.enabled=false
# spring.cloud.bus.refresh.enabled=true
# spring.cloud.bus.env.enabled=true
# spring.cloud.bus.destination=CasCloudBus
# spring.cloud.bus.ack.enabled=true

endpoints.enabled=false
endpoints.sensitive=true

endpoints.restart.enabled=false
endpoints.shutdown.enabled=false

management.security.enabled=true
management.security.roles=ACTUATOR,ADMIN
management.security.sessions=if_required
management.context-path=/status
management.add-application-context-header=false

security.basic.authorize-mode=role
security.basic.enabled=false
security.basic.path=/cas/status/**

##
# CAS Web Application Session Configuration
#
server.session.timeout=300
server.session.cookie.http-only=true
server.session.tracking-modes=COOKIE

##
# CAS Thymeleaf View Configuration
#
spring.thymeleaf.encoding=UTF-8
spring.thymeleaf.cache=false
spring.thymeleaf.mode=HTML
##
# CAS Log4j Configuration
#
# logging.config=file:/etc/cas/log4j2.xml
server.context-parameters.isLog4jAutoInitializationDisabled=true

##
# CAS AspectJ Configuration
#
spring.aop.auto=true
spring.aop.proxy-target-class=true

##
# CAS Authentication Credentials
#
#STEP4 &#x6CE8;&#x91CA;&#x6389;&#x5199;&#x6B7B;&#x7684;&#x7528;&#x6237; &#x6539;&#x7528;jdbc&#x7684;&#x7528;&#x6237; START
#cas.authn.accept.users=casuser::Mellon

cas.authn.jdbc.query[0].sql=select * from s_user where username=?
cas.authn.jdbc.query[0].healthQuery=
cas.authn.jdbc.query[0].isolateInternalQueries=false
cas.authn.jdbc.query[0].url=jdbc:mysql://172.18.18.25:3306/pa_db?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect=true&amp;useSSL=false
cas.authn.jdbc.query[0].failFast=true
cas.authn.jdbc.query[0].isolationLevelName=ISOLATION_READ_COMMITTED
cas.authn.jdbc.query[0].dialect=org.hibernate.dialect.MySQLDialect
cas.authn.jdbc.query[0].leakThreshold=10
cas.authn.jdbc.query[0].propagationBehaviorName=PROPAGATION_REQUIRED
cas.authn.jdbc.query[0].batchSize=1
cas.authn.jdbc.query[0].user=root
#cas.authn.jdbc.query[0].ddlAuto=create-drop
cas.authn.jdbc.query[0].maxAgeDays=180
cas.authn.jdbc.query[0].password=dhcc
cas.authn.jdbc.query[0].autocommit=false
cas.authn.jdbc.query[0].driverClass=com.mysql.jdbc.Driver
cas.authn.jdbc.query[0].idleTimeout=5000
# cas.authn.jdbc.query[0].credentialCriteria=
# cas.authn.jdbc.query[0].name=
# cas.authn.jdbc.query[0].order=0
# cas.authn.jdbc.query[0].dataSourceName=
# cas.authn.jdbc.query[0].dataSourceProxy=false
cas.authn.jdbc.query[0].fieldPassword=password

# cas.authn.jdbc.query[0].fieldExpired=
# cas.authn.jdbc.query[0].fieldDisabled=
# cas.authn.jdbc.query[0].principalAttributeList=sn,cn:commonName,givenName

#cas.authn.jdbc.query[0].passwordEncoder.type=DEFAULT
#cas.authn.jdbc.query[0].passwordEncoder.type=com.example.CustomPasswordEncoder
#cas.authn.jdbc.query[0].passwordEncoder.characterEncoding=UTF-8
#cas.authn.jdbc.query[0].passwordEncoder.encodingAlgorithm=MD5

#cas.authn.jdbc.query[0].passwordEncoder.secret=
#cas.authn.jdbc.query[0].passwordEncoder.strength=16

# cas.authn.jdbc.query[0].principalTransformation.suffix=
# cas.authn.jdbc.query[0].principalTransformation.caseConversion=NONE|UPPERCASE|LOWERCASE
# cas.authn.jdbc.query[0].principalTransformation.prefix=
# STEP4 END


##
# CAS Delegated Authentication
#
#cas.authn.pac4j.bitbucket.clientName=Bitbucket
#cas.authn.pac4j.dropbox.clientName=Dropbox
#cas.authn.pac4j.facebook.clientName=Facebook
#cas.authn.pac4j.foursquare.clientName=Foursquare
#cas.authn.pac4j.github.clientName=Github
#cas.authn.pac4j.google.clientName=Google
#cas.authn.pac4j.linkedIn.clientName=LinkedIn
#cas.authn.pac4j.paypal.clientName=PayPal
#cas.authn.pac4j.twitter.clientName=Twitter
#cas.authn.pac4j.yahoo.clientName=Yahoo
#cas.authn.pac4j.windowsLive.clientName=Windows Live
#cas.authn.pac4j.wordpress.clientName=WordPress

#&#x591A;&#x5C5E;&#x6027;
cas.authn.attributeRepository.jdbc[0].singleRow=true
cas.authn.attributeRepository.jdbc[0].order=0
cas.authn.attributeRepository.jdbc[0].url=jdbc:mysql://172.18.18.25:3306/pa_db?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect=true&amp;useSSL=false
cas.authn.attributeRepository.jdbc[0].username=username
cas.authn.attributeRepository.jdbc[0].user=root
cas.authn.attributeRepository.jdbc[0].password=dhcc
cas.authn.attributeRepository.jdbc[0].sql=select * from s_user where {0}
cas.authn.attributeRepository.jdbc[0].dialect=org.hibernate.dialect.MySQLDialect
cas.authn.attributeRepository.jdbc[0].ddlAuto=none
cas.authn.attributeRepository.jdbc[0].driverClass=com.mysql.jdbc.Driver
cas.authn.attributeRepository.jdbc[0].leakThreshold=10
cas.authn.attributeRepository.jdbc[0].propagationBehaviorName=PROPAGATION_REQUIRED
cas.authn.attributeRepository.jdbc[0].batchSize=1
cas.authn.attributeRepository.jdbc[0].healthQuery=SELECT 1
cas.authn.attributeRepository.jdbc[0].failFast=trueyeshi
#http&#x8BBF;&#x95EE;
cas.tgc.secure=false</span><br></pre></td></tr></table></figure>
<p>&#x770B;&#x4E0A;&#x9762;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4F60;&#x4F1A;&#x53D1;&#x73B0;&#x6211;&#x914D;&#x7F6E;&#x4E86;mysql&#x7684;jdbc&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x7ED9;CAS&#x670D;&#x52A1;&#x7AEF;&#x914D;&#x7F6E;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x7801;&#x9A8C;&#x8BC1;&#x7684;&#xFF0C;&#x4F60;&#x81EA;&#x5DF1;&#x505A;&#x7684;&#x8BDD;&#xFF0C;&#x9700;&#x8981;&#x5728;&#x4F60;&#x7684;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x7A7A;&#x95F4;&#x548C;&#x4E00;&#x5F20;&#x7528;&#x6237;&#x8868;&#xFF0C;&#x5E76;&#x4E14;&#x4FDD;&#x8BC1;&#x8BE5;&#x8868;&#x4E2D;&#x6700;&#x5C11;&#x6709;&#x4E09;&#x4E2A;&#x5B57;&#x6BB5;&#xFF1A;id,username&#x548C;password&#xFF0C;&#x8FD9;&#x4E2A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x5199;&#x7684;&#x662F;&#x6211;&#x7684;&#x6D4B;&#x8BD5;&#x670D;&#x52A1;&#x5668;&#x7684;&#x914D;&#x7F6E;&#xFF0C;&#x4F60;&#x8981;&#x6539;&#x6210;&#x81EA;&#x5DF1;&#x7684;&#x54E6;&#x3002;<br>&#x8FD9;&#x91CC;&#x6709;&#x51E0;&#x4E2A;&#x70B9;&#x8981;&#x6CE8;&#x610F;&#x4E0B;&#xFF1A;<br><strong>cas.authn.accept.users=casuser::Mellon&#x8FD9;&#x4E2A;&#x914D;&#x7F6E;&#x8BB0;&#x5F97;&#x5220;&#x6389;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x90A3;&#x4E2A;&#x5199;&#x6B7B;&#x7684;&#x7528;&#x6237;</strong><br> cas.authn.jdbc.query[0]&#x8FD9;&#x4E9B;&#x914D;&#x7F6E;&#x5C31;&#x662F;&#x6570;&#x636E;&#x5E93;&#x9A8C;&#x8BC1;&#x76F8;&#x5173;&#x7684;&#x5185;&#x5BB9;<br> &#x5728;cas.authn.jdbc.query[0].sql&#x4E2D;&#xFF0C;&#x7A0B;&#x5E8F;&#x4F1A;&#x628A;&#x4F60;&#x767B;&#x5F55;&#x65F6;&#x8F93;&#x5165;&#x7684;&#x7528;&#x6237;&#x540D;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x8FDB;&#x53BB;<br><strong>cas.authn.jdbc.query[0].fieldPassword&#x5219;&#x662F;&#x6307;&#x660E;&#x90A3;&#x4E00;&#x5217;&#x5BF9;&#x5E94;&#x7684;&#x662F;&#x4F60;&#x8F93;&#x5165;&#x7684;&#x5BC6;&#x7801;&#xFF0C;&#x76EE;&#x524D;&#x6CA1;&#x6709;&#x505A;MD5</strong><br>&#x5982;&#x679C;&#x4F7F;&#x7528;http&#x8BBF;&#x95EE; &#x5FC5;&#x987B;&#x52A0;&#x5165; <strong>cas.tgc.secure=false</strong> &#x5426;&#x5219;&#x767B;&#x5F55;&#x72B6;&#x6001;&#x4E0D;&#x80FD;&#x5171;&#x4EAB;&#x3002;</p>
<ol>
<li>&#x52A0;&#x5165;http&#x8BBF;&#x95EE;&#x670D;&#x52A1;</li>
</ol>
<blockquote>
<p>&#x8BF7;&#x5728;&#x7CFB;&#x7EDF;&#x7684;C:\WINDOWS\System32\drivers\etc\hosts &#x6587;&#x4EF6;&#x4E2D;&#x52A0;&#x5165;&#xFF1A;<br>127.0.0.1       com.dhcc.cas<br>&#x8FD9;&#x4E48;&#x505A;&#x7684;&#x76EE;&#x7684;&#x662F;&#x5C06;&#x8FD9;&#x4E2A;IP&#x5730;&#x5740;&#x6307;&#x5411;&#x8FD9;&#x4E2A;&#x57DF;&#x540D;&#xFF0C;&#x5176;&#x5B9E;&#x672C;&#x610F;&#x662F;&#x4E3A;&#x4E86;https&#x8BBF;&#x95EE;&#x505A;&#x7684;&#x5DE5;&#x4F5C;&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x77E5;&#x9053;&#x5176;&#x76EE;&#x7684;&#x53EF;&#x4EE5;&#x67E5;&#x770B;cas https&#x8BBF;&#x95EE;&#x76F8;&#x5173;&#x7684;&#x8D44;&#x6599;&#xFF0C;&#x672C;&#x6559;&#x7A0B;&#x91CC;&#x5C31;&#x4E0D;&#x518D;&#x7EC6;&#x8BF4;&#x4E86;&#x3002;</p>
</blockquote>
<p>&#x8FD9;&#x91CC;&#x53EF;&#x80FD;&#x4E0D;&#x597D;&#x7406;&#x89E3;&#xFF0C;&#x6211;&#x5148;&#x6765;&#x8BB2;&#x4E00;&#x4E2A;&#x6211;&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4F60;&#x5C31;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E86;&#xFF1A;<br>&#x914D;&#x7F6E;&#x597D;CAS&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x540E;&#xFF0C;&#x6211;&#x5C31;&#x5F00;&#x59CB;&#x6D4B;&#x8BD5;&#x6211;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x5B50;&#x7CFB;&#x7EDF;&#xFF0C;&#x5728;&#x6D4F;&#x89C8;&#x5668;&#x4E2D;&#x8F93;&#x5165;&#x6211;&#x7684;&#x5B50;&#x7CFB;&#x7EDF;&#x9879;&#x76EE;&#x5730;&#x5740;&#xFF1A;<br><a href="http://com.dhcc.cas:9093" target="_blank" rel="external">http://com.dhcc.cas:9093</a><br>&#x540E;&#x7531;&#x4E8E;&#x6211;&#x7684;&#x5B50;&#x7CFB;&#x7EDF;&#x7684;&#x914D;&#x7F6E;&#xFF0C;&#x8BBF;&#x95EE;&#x754C;&#x9762;&#x4F1A;&#x91CD;&#x5B9A;&#x5411;&#x5230;<br><a href="http://com.dhcc.cas:9092/cas/login?service:http://com.dhcc.cas:9093/" target="_blank" rel="external">http://com.dhcc.cas:9092/cas/login?service:http://com.dhcc.cas:9093/</a><br>&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x754C;&#x9762;&#x7406;&#x8BBA;&#x4E0A;&#x6765;&#x8BF4;&#x5E94;&#x8BE5;&#x662F;&#x8DF3;&#x8F6C;&#x5230;CAS&#x670D;&#x52A1;&#x7AEF;&#x7684;&#x767B;&#x5F55;&#x754C;&#x9762;&#x7684;&#xFF0C;&#x53EF;&#x662F;&#x6211;&#x7684;&#x8FD9;&#x4E2A;&#x8DEF;&#x5F84;&#x5374;&#x65E0;&#x6CD5;&#x8DF3;&#x8F6C;&#xFF0C;<br>&#x5E76;&#x5C55;&#x793A;&#x5982;&#x4E0B;&#x754C;&#x9762;&#xFF1A;</p>
<p> <img src="/2017/11/29/Springboot&#x96C6;&#x6210;Shiro&#x548C;Cas&#x5B9E;&#x73B0;&#x5355;&#x70B9;&#x767B;&#x5F55;-&#x670D;&#x52A1;&#x7AEF;&#x7BC7;CAS5/5.png" alt="logo"></p>
<p>&#x6211;&#x767E;&#x601D;&#x4E0D;&#x5F97;&#x5176;&#x89E3;&#xFF0C;&#x5C1D;&#x8BD5;&#x4E86;&#x5404;&#x79CD;&#x65B9;&#x6CD5;&#x4E5F;&#x4E0D;&#x884C;&#xFF0C;&#x76F4;&#x5230;&#x6211;&#x53D1;&#x73B0;&#x4E86;&#x5C06;&#x8DEF;&#x5F84;&#x6539;&#x4E3A;&#xFF1A;<br><a href="http://com.dhcc.cas:9092/cas/login?service=https://com.dhcc.cas:9093/" target="_blank" rel="external">http://com.dhcc.cas:9092/cas/login?service=https://com.dhcc.cas:9093/</a><br>&#x754C;&#x9762;&#x4F1A;&#x81EA;&#x52A8;&#x8DF3;&#x8F6C;&#x5230;CAS&#x670D;&#x52A1;&#x7AEF;&#x7684;&#x767B;&#x5F55;&#x754C;&#x9762;&#xFF0C;&#x8FD9;&#x65F6;&#x6211;&#x624D;&#x5F00;&#x59CB;&#x56DE;&#x5FC6;&#x8D77;CAS&#x670D;&#x52A1;&#x7AEF;&#x662F;&#x4E0D;&#x662F;&#x54EA;&#x91CC;&#x6211;&#x6CA1;&#x6709;&#x914D;&#x7F6E;&#x5BF9;&#xFF0C;&#x4E8E;&#x662F;&#x6211;&#x5728;&#x7F51;&#x4E0A;&#x67E5;&#x8D44;&#x6599;&#x624D;&#x77E5;&#x9053;CAS4.2&#x4EE5;&#x4E0A;&#x5149;&#x52A0;&#x5165;cas.tgc.secure=false &#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x914D;&#x7F6E;&#x662F;&#x4E0D;&#x591F;&#x7684;&#xFF0C;&#x8FD8;&#x8981;&#x5BF9;<strong>HTTPSandIMAPS-10000001.json</strong>&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x4E2D;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#xFF0C;&#x5927;&#x5BB6;&#x53EF;&#x80FD;&#x4F1A;&#x95EE;&#x4E86;&#xFF0C;&#x6211;&#x600E;&#x4E48;&#x6CA1;&#x770B;&#x5230;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#xFF1F;<br>&#x56E0;&#x4E3A;&#x9ED8;&#x8BA4;&#x7684;&#x9879;&#x76EE;&#x67B6;&#x6784;&#x662F;&#x6CA1;&#x6709;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x5C06;&#x5BFC;&#x51FA;&#x7684;war&#x5305;&#x89E3;&#x538B;&#xFF0C;&#x7136;&#x540E;&#x5728;WEB-INF\classes\services&#x8FD9;&#x4E2A;&#x8DEF;&#x5F84;&#x4E0B;&#x627E;&#x5230;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x6211;&#x4EEC;&#x7684;&#x9879;&#x76EE;&#x4E2D;&#x7684;resources&#x76EE;&#x5F55;&#x4E0B;&#x518D;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;services&#x76EE;&#x5F55;&#xFF0C;&#x5E76;&#x5C06;&#x8BE5;&#x6587;&#x4EF6;&#x62F7;&#x8D1D;&#x5230;&#x8FD9;&#x4E2A;&#x8DEF;&#x5F84;&#x4E0B;&#x5373;&#x53EF;&#x3002;<br>&#x73B0;&#x5728;&#x4F60;&#x7684;&#x9879;&#x76EE;&#x67B6;&#x6784;&#x5E94;&#x8BE5;&#x662F;&#x8FD9;&#x4E2A;&#x6837;&#x5B50;&#x7684;&#xFF1A;</p>
<p> <img src="/2017/11/29/Springboot&#x96C6;&#x6210;Shiro&#x548C;Cas&#x5B9E;&#x73B0;&#x5355;&#x70B9;&#x767B;&#x5F55;-&#x670D;&#x52A1;&#x7AEF;&#x7BC7;CAS5/6.png" alt="logo"></p>
<p>&#x5F15;&#x5165;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x80AF;&#x5B9A;&#x662F;&#x4E3A;&#x4E86;&#x4FEE;&#x6539;&#x5B83;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8FD9;&#x4E2A;json&#x4E2D;&#x6709;&#x884C;&#x4EE3;&#x7801;&#xFF0C;&#x5176;&#x5B9E;&#x662F;&#x4E2A;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#xFF1A;<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;serviceId&quot; : &quot;^(https|imaps)://.*&quot;</span><br></pre></td></tr></table></figure></p>
<p>&#x4E86;&#x89E3;json&#x7684;&#x90FD;&#x77E5;&#x9053;&#xFF0C;&#x8FD9;&#x91CC;&#x5176;&#x5B9E;&#x662F;&#x8BF4;serviceId&#x7684;&#x503C;&#x662F;&#x6240;&#x6709;&#x5E26;https&#x548C;imaps&#x7684;url&#x8BF7;&#x6C42;&#x90FD;&#x4F1A;&#x88AB;&#x5F53;&#x6210;&#x5DF2;&#x7ECF;&#x6CE8;&#x518C;&#x7684;&#x670D;&#x52A1;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x8981;&#x5C06;&#x5B83;&#x6539;&#x6210;&#x4E0B;&#x9762;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF1A;<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;serviceId&quot; : &quot;^(https|imaps|http)://.*&quot;</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x6837;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x5B89;&#x5FC3;&#x7684;&#x4F7F;&#x7528;CAS&#x7684;http&#x8BF7;&#x6C42;&#x670D;&#x52A1;&#x4E86;&#x3002;</p>
<h2 id="&#x7ED3;&#x8BED;">&#x7ED3;&#x8BED;</h2><p>&#x81F3;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x7684;CAS&#x670D;&#x52A1;&#x7AEF;&#x57FA;&#x672C;&#x4E0A;&#x5C31;&#x642D;&#x5EFA;&#x597D;&#x4E86;&#xFF0C;&#x53EA;&#x8981;&#x5C06;&#x5B83;&#x6253;&#x6210;war&#x5305;&#xFF0C;&#x5E76;&#x653E;&#x5230;tomcat&#x4E2D;&#x542F;&#x52A8;&#x8D77;&#x6765;&#xFF0C;&#x4FBF;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x4EEC;&#x7684;&#x5355;&#x70B9;&#x767B;&#x5F55;&#x7684;&#x670D;&#x52A1;&#x7AEF;&#x4F7F;&#x7528;&#x4E86;&#x3002;<br>&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x4E00;&#x4E0B;&#x51E0;&#x70B9;&#xFF1A;</p>
<ol>
<li>&#x6CE8;&#x610F;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x5199;&#x5BF9;&#x4E86;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x6570;&#x636E;&#x5E93;&#x7684;&#x914D;&#x7F6E;&#x3002;</li>
<li>&#x4E00;&#x5B9A;&#x8981;&#x52A0;&#x5165;&#x5E76;&#x4FEE;&#x6539;HTTPSandIMAPS-10000001.json&#x6587;&#x4EF6;&#xFF0C;&#x5426;&#x5219;&#x540E;&#x671F;&#x4F60;&#x7684;CAS&#x5BA2;&#x6237;&#x7AEF;&#x80AF;&#x5B9A;&#x4E0D;&#x4F1A;&#x81EA;&#x52A8;&#x8DF3;&#x8F6C;&#x5230;&#x767B;&#x5F55;&#x754C;&#x9762;&#x3002;</li>
</ol>
<p>&#x53EA;&#x8981;&#x4F60;&#x7684;&#x670D;&#x52A1;&#x7AEF;&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x542F;&#x7528;&#xFF0C;&#x4F60;&#x5C31;&#x6210;&#x529F;&#x4E86;&#x4E00;&#x534A;&#x4E86;&#xFF0C;&#x4E0B;&#x4E00;&#x7BC7;&#x6211;&#x4EEC;&#x5C31;&#x5F00;&#x59CB;&#x8BB2;&#x89E3;CAS&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x914D;&#x7F6E;&#x4E86;&#x3002;</p>
<h2 id="&#x76F8;&#x5173;&#x8D44;&#x6599;">&#x76F8;&#x5173;&#x8D44;&#x6599;</h2><ol>
<li><a href="http://www.cnblogs.com/flying607/p/7598248.html" target="_blank" rel="external">CAS 5.1.x &#x7684;&#x642D;&#x5EFA;&#x548C;&#x4F7F;&#x7528;&#xFF08;&#x4E00;&#xFF09;&#x2014;&#x2014; &#x901A;&#x8FC7;Overlay&#x642D;&#x5EFA;&#x670D;&#x52A1;&#x7AEF;</a></li>
<li><a href="http://blog.csdn.net/zzq900503/article/details/54910609" target="_blank" rel="external">&#x5355;&#x70B9;&#x767B;&#x5F55;(&#x4E03;)&#x2014;&#x2013;&#x5B9E;&#x6218;&#x2014;&#x2013;cas server&#x53BB;&#x6389;https&#x9A8C;&#x8BC1;</a></li>
</ol>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[SpringBoot中实现Shiro控制ThymeLeaf界面按钮级权限控制]]></title>
      <url>http://jasoncool.com/2017/11/15/SpringBoot%E4%B8%AD%E5%AE%9E%E7%8E%B0Shiro%E6%8E%A7%E5%88%B6ThymeLeaf%E7%95%8C%E9%9D%A2%E6%8C%89%E9%92%AE%E7%BA%A7%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6/</url>
      <content type="html"><![CDATA[<h2 id="&#x9700;&#x6C42;&#x7B80;&#x8FF0;">&#x9700;&#x6C42;&#x7B80;&#x8FF0;</h2><p>&#x5728;&#x4E1A;&#x7EE9;&#x6838;&#x7B97;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E86;SpringBoot&#x4F5C;&#x4E3A;&#x9879;&#x76EE;&#x7684;&#x6574;&#x4F53;&#x67B6;&#x6784;&#xFF0C;&#x4F7F;&#x7528;ThymeLeaf&#x4F5C;&#x4E3A;&#x524D;&#x7AEF;&#x754C;&#x9762;&#x6846;&#x67B6;&#xFF0C;&#x4F7F;&#x7528;Shiro&#x4F5C;&#x4E3A;&#x6211;&#x4EEC;&#x7684;&#x6743;&#x9650;&#x63A7;&#x5236;&#x6846;&#x67B6;&#xFF0C;Shiro&#x4F5C;&#x4E3A;&#x8F7B;&#x91CF;&#x7EA7;&#x7684;&#x6743;&#x9650;&#x6846;&#x67B6;&#xFF0C;&#x4F7F;&#x7528;&#x8D77;&#x6765;&#x975E;&#x5E38;&#x65B9;&#x4FBF;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x6211;&#x53D1;&#x73B0;&#xFF0C;Shiro&#x4F5C;&#x4E3A;&#x9875;&#x9762;&#x7EA7;&#x7684;&#x6743;&#x9650;&#x63A7;&#x5236;&#x6846;&#x67B6;&#x975E;&#x5E38;&#x597D;&#x7528;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x6CE8;&#x5165;&#x5230;Controller&#x4E2D;&#x5BF9;&#x9875;&#x9762;&#x7EA7;&#x7684;&#x8BBF;&#x95EE;&#x6743;&#x9650;&#x505A;&#x63A7;&#x5236;&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x5B9E;&#x73B0;&#x9875;&#x9762;&#x4E2D;&#x67D0;&#x4E2A;&#x6309;&#x94AE;&#x6216;&#x8005;&#x5217;&#x8868;&#x7684;&#x6743;&#x9650;&#x663E;&#x793A;&#xFF0C;&#x5355;&#x7EAF;&#x7684;&#x5728;Controller&#x4E2D;&#x6DFB;&#x52A0;&#x6CE8;&#x89E3;&#x5C31;&#x663E;&#x5F97;&#x6349;&#x895F;&#x89C1;&#x8098;&#x4E86;&#x3002;<br><a id="more"></a></p>
<h2 id="&#x89E3;&#x51B3;&#x65B9;&#x6848;">&#x89E3;&#x51B3;&#x65B9;&#x6848;</h2><p>&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x4E0A;&#x8FF0;&#x7684;&#x9700;&#x6C42;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5F15;&#x5165;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x7EC4;&#x4EF6;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;Thymeleaf Extras Shiro ,&#x8FD9;&#x4E2A;&#x7EC4;&#x4EF6;&#x7684;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x53EF;&#x4EE5;&#x5728;thymeleaf&#x4E2D;&#x4F7F;&#x7528;&#x81EA;&#x5B9A;&#x4E49;&#x6807;&#x7B7E;&#x5E76;&#x914D;&#x5408;&#x6743;&#x9650;&#x7075;&#x6D3B;&#x7684;&#x63A7;&#x5236;&#x7F51;&#x9875;&#x4E0A;&#x7684;&#x7EC4;&#x4EF6;&#x663E;&#x793A;&#x4E0E;&#x5426;&#x3002;<br>&#x4ED6;&#x7684;&#x5B98;&#x65B9;&#x7F51;&#x7AD9;&#x662F;&#xFF1A;<a href="https://github.com/theborakompanioni/thymeleaf-extras-shiro" title="thymeleaf-extras-shiro" target="_blank" rel="external">Github</a></p>
<h2 id="&#x96C6;&#x6210;&#x65B9;&#x6CD5;">&#x96C6;&#x6210;&#x65B9;&#x6CD5;</h2><p>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5728;Pom.xml&#x4E2D;&#x5F15;&#x5165;&#x8FD9;&#x4E2A;&#x7EC4;&#x4EF6;&#x7684;dependency</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.github.theborakompanioni/thymeleaf-extras-shiro --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>com.github.theborakompanioni<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>thymeleaf-extras-shiro<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>&#x5F15;&#x5165;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x76F4;&#x63A5;&#x542F;&#x52A8;&#x5E94;&#x7528;&#x4F1A;&#x62A5;&#x9519;&#xFF0C;&#x56E0;&#x4E3A;thymeleaf-extras-shiro&#x8FD9;&#x4E2A;&#x7EC4;&#x4EF6;&#x9700;&#x8981;thymeleaf3.0&#x652F;&#x6301;&#xFF0C;&#x800C;Springboot 1.58&#x7248;&#x672C;&#x9ED8;&#x8BA4;&#x7684;thymeleaf&#x7684;&#x7248;&#x672C;&#x662F;2.X&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8FD8;&#x8981;&#x5C06;thymeleaf&#x8BBE;&#x7F6E;&#x6210;3.0&#x7248;&#x672C;&#xFF0C;&#x5177;&#x4F53;&#x4EE3;&#x7801;&#x5982;&#x4E0B;,&#x8FD8;&#x662F;&#x5728;pom.xml&#x91CC;&#xFF1A;</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">properties</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="title">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="title">project.reporting.outputEncoding</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="title">java.version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">thymeleaf.version</span>&gt;</span>3.0.0.RELEASE<span class="tag">&lt;/<span class="title">thymeleaf.version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="title">thymeleaf-layout-dialect.version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="title">thymeleaf-layout-dialect.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>&#x6B64;&#x5904;&#x8BBE;&#x7F6E;&#x5B8C;&#x6BD5;&#x540E;&#x6211;&#x4EEC;&#x624D;&#x662F;&#x771F;&#x6B63;&#x7684;&#x5C06;thymeleaf-extras-shiro&#x5F15;&#x5165;&#x8FDB;&#x6765;&#x4E86;&#xFF0C;&#x4E4B;&#x540E;&#x6211;&#x4EEC;&#x8FD8;&#x8981;&#x5728;Shiro&#x7684;Config&#x6587;&#x4EF6;&#x4E2D;&#x5BF9;&#x8BBE;&#x7F6E;&#x8FDB;&#x884C;&#x76F8;&#x5E94;&#x7684;&#x4FEE;&#x6539;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Bean</span>(name = <span class="string">&quot;shiroDialect&quot;</span>)</span><br><span class="line">   <span class="function"><span class="keyword">public</span> ShiroDialect <span class="title">shiroDialect</span><span class="params">()</span></span>{</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> ShiroDialect();</span><br><span class="line">   }</span><br></pre></td></tr></table></figure>
<p>&#x6DFB;&#x52A0;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x7684;&#x76EE;&#x7684;&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x5728;thymeleaf&#x4E2D;&#x4F7F;&#x7528;shiro&#x7684;&#x81EA;&#x5B9A;&#x4E49;tag&#x3002;<br>&#x597D;&#x4E86;&#xFF0C;&#x73B0;&#x5728;&#x57FA;&#x672C;&#x4E0A;&#x6240;&#x6709;&#x4F7F;&#x7528;shiro-tag&#x7684;&#x6761;&#x4EF6;&#x90FD;&#x5177;&#x5907;&#x4E86;&#xFF0C;&#x73B0;&#x5728;&#x7ED9;&#x51FA;&#x524D;&#x7AEF;&#x7684;&#x4EE3;&#x7801;&#x793A;&#x4F8B;&#xFF1A;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">xmlns</span>=<span class="value">&quot;http://www.w3.org/1999/xhtml&quot;</span> <span class="attribute">xmlns:th</span>=<span class="value">&quot;http://www.thymeleaf.org&quot;</span></span><br><span class="line">      <span class="attribute">xmlns:shiro</span>=<span class="value">&quot;http://www.pollix.at/thymeleaf/shiro&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">title</span>&gt;</span>Insert title here<span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">h3</span>&gt;</span>index<span class="tag">&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &#x9A8C;&#x8BC1;&#x5F53;&#x524D;&#x7528;&#x6237;&#x662F;&#x5426;&#x4E3A;&#x201C;&#x8BBF;&#x5BA2;&#x201D;&#xFF0C;&#x5373;&#x672A;&#x8BA4;&#x8BC1;&#xFF08;&#x5305;&#x542B;&#x672A;&#x8BB0;&#x4F4F;&#xFF09;&#x7684;&#x7528;&#x6237;&#x3002; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span> <span class="attribute">shiro:guest</span>=<span class="value">&quot;&quot;</span>&gt;</span>Please <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">&quot;login.html&quot;</span>&gt;</span>login<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#x8BA4;&#x8BC1;&#x901A;&#x8FC7;&#x6216;&#x5DF2;&#x8BB0;&#x4F4F;&#x7684;&#x7528;&#x6237;&#x3002; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span> <span class="attribute">shiro:user</span>=<span class="value">&quot;&quot;</span>&gt;</span></span><br><span class="line">    Welcome back John! Not John? Click <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">&quot;login.html&quot;</span>&gt;</span>here<span class="tag">&lt;/<span class="title">a</span>&gt;</span> to login.</span><br><span class="line"><span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#x5DF2;&#x8BA4;&#x8BC1;&#x901A;&#x8FC7;&#x7684;&#x7528;&#x6237;&#x3002;&#x4E0D;&#x5305;&#x542B;&#x5DF2;&#x8BB0;&#x4F4F;&#x7684;&#x7528;&#x6237;&#xFF0C;&#x8FD9;&#x662F;&#x4E0E;user&#x6807;&#x7B7E;&#x7684;&#x533A;&#x522B;&#x6240;&#x5728;&#x3002; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span> <span class="attribute">shiro:authenticated</span>=<span class="value">&quot;&quot;</span>&gt;</span></span><br><span class="line">    Hello, <span class="tag">&lt;<span class="title">span</span> <span class="attribute">shiro:principal</span>=<span class="value">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="title">span</span>&gt;</span>, how are you today?</span><br><span class="line"><span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">shiro:authenticated</span>=<span class="value">&quot;&quot;</span> <span class="attribute">href</span>=<span class="value">&quot;updateAccount.html&quot;</span>&gt;</span>Update your contact information<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#x8F93;&#x51FA;&#x5F53;&#x524D;&#x7528;&#x6237;&#x4FE1;&#x606F;&#xFF0C;&#x901A;&#x5E38;&#x4E3A;&#x767B;&#x5F55;&#x5E10;&#x53F7;&#x4FE1;&#x606F;&#x3002; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span>&gt;</span>Hello, <span class="tag">&lt;<span class="title">shiro:principal</span>/&gt;</span>, how are you today?<span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#x672A;&#x8BA4;&#x8BC1;&#x901A;&#x8FC7;&#x7528;&#x6237;&#xFF0C;&#x4E0E;authenticated&#x6807;&#x7B7E;&#x76F8;&#x5BF9;&#x5E94;&#x3002;&#x4E0E;guest&#x6807;&#x7B7E;&#x7684;&#x533A;&#x522B;&#x662F;&#xFF0C;&#x8BE5;&#x6807;&#x7B7E;&#x5305;&#x542B;&#x5DF2;&#x8BB0;&#x4F4F;&#x7528;&#x6237;&#x3002; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span> <span class="attribute">shiro:notAuthenticated</span>=<span class="value">&quot;&quot;</span>&gt;</span></span><br><span class="line">    Please <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">&quot;login.html&quot;</span>&gt;</span>login<span class="tag">&lt;/<span class="title">a</span>&gt;</span> in order to update your credit card information.</span><br><span class="line"><span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#x9A8C;&#x8BC1;&#x5F53;&#x524D;&#x7528;&#x6237;&#x662F;&#x5426;&#x5C5E;&#x4E8E;&#x8BE5;&#x89D2;&#x8272;&#x3002; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">shiro:hasRole</span>=<span class="value">&quot;admin&quot;</span> <span class="attribute">href</span>=<span class="value">&quot;admin.html&quot;</span>&gt;</span>Administer the system<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="comment">&lt;!-- &#x62E5;&#x6709;&#x8BE5;&#x89D2;&#x8272; --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#x4E0E;hasRole&#x6807;&#x7B7E;&#x903B;&#x8F91;&#x76F8;&#x53CD;&#xFF0C;&#x5F53;&#x7528;&#x6237;&#x4E0D;&#x5C5E;&#x4E8E;&#x8BE5;&#x89D2;&#x8272;&#x65F6;&#x9A8C;&#x8BC1;&#x901A;&#x8FC7;&#x3002; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span> <span class="attribute">shiro:lacksRole</span>=<span class="value">&quot;developer&quot;</span>&gt;</span><span class="comment">&lt;!-- &#x6CA1;&#x6709;&#x8BE5;&#x89D2;&#x8272; --&gt;</span></span><br><span class="line">    Sorry, you are not allowed to developer the system.</span><br><span class="line"><span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#x9A8C;&#x8BC1;&#x5F53;&#x524D;&#x7528;&#x6237;&#x662F;&#x5426;&#x5C5E;&#x4E8E;&#x4EE5;&#x4E0B;&#x6240;&#x6709;&#x89D2;&#x8272;&#x3002; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span> <span class="attribute">shiro:hasAllRoles</span>=<span class="value">&quot;developer, 2&quot;</span>&gt;</span><span class="comment">&lt;!-- &#x89D2;&#x8272;&#x4E0E;&#x5224;&#x65AD; --&gt;</span></span><br><span class="line">    You are a developer and a admin.</span><br><span class="line"><span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#x9A8C;&#x8BC1;&#x5F53;&#x524D;&#x7528;&#x6237;&#x662F;&#x5426;&#x5C5E;&#x4E8E;&#x4EE5;&#x4E0B;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x89D2;&#x8272;&#x3002;  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span> <span class="attribute">shiro:hasAnyRoles</span>=<span class="value">&quot;admin, vip, developer,1&quot;</span>&gt;</span><span class="comment">&lt;!-- &#x89D2;&#x8272;&#x6216;&#x5224;&#x65AD; --&gt;</span></span><br><span class="line">    You are a admin, vip, or developer.</span><br><span class="line"><span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--&#x9A8C;&#x8BC1;&#x5F53;&#x524D;&#x7528;&#x6237;&#x662F;&#x5426;&#x62E5;&#x6709;&#x6307;&#x5B9A;&#x6743;&#x9650;&#x3002;  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">shiro:hasPermission</span>=<span class="value">&quot;userInfo:add&quot;</span> <span class="attribute">href</span>=<span class="value">&quot;createUser.html&quot;</span>&gt;</span>&#x6DFB;&#x52A0;&#x7528;&#x6237;<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="comment">&lt;!-- &#x62E5;&#x6709;&#x6743;&#x9650; --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#x4E0E;hasPermission&#x6807;&#x7B7E;&#x903B;&#x8F91;&#x76F8;&#x53CD;&#xFF0C;&#x5F53;&#x524D;&#x7528;&#x6237;&#x6CA1;&#x6709;&#x5236;&#x5B9A;&#x6743;&#x9650;&#x65F6;&#xFF0C;&#x9A8C;&#x8BC1;&#x901A;&#x8FC7;&#x3002; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span> <span class="attribute">shiro:lacksPermission</span>=<span class="value">&quot;userInfo:del&quot;</span>&gt;</span><span class="comment">&lt;!-- &#x6CA1;&#x6709;&#x6743;&#x9650; --&gt;</span></span><br><span class="line">    Sorry, you are not allowed to delete user accounts.</span><br><span class="line"><span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#x9A8C;&#x8BC1;&#x5F53;&#x524D;&#x7528;&#x6237;&#x662F;&#x5426;&#x62E5;&#x6709;&#x4EE5;&#x4E0B;&#x6240;&#x6709;&#x89D2;&#x8272;&#x3002; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span> <span class="attribute">shiro:hasAllPermissions</span>=<span class="value">&quot;userInfo:view, userInfo:add&quot;</span>&gt;</span><span class="comment">&lt;!-- &#x6743;&#x9650;&#x4E0E;&#x5224;&#x65AD; --&gt;</span></span><br><span class="line">    You can see or add users.</span><br><span class="line"><span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#x9A8C;&#x8BC1;&#x5F53;&#x524D;&#x7528;&#x6237;&#x662F;&#x5426;&#x62E5;&#x6709;&#x4EE5;&#x4E0B;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x6743;&#x9650;&#x3002;  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span> <span class="attribute">shiro:hasAnyPermissions</span>=<span class="value">&quot;userInfo:view, userInfo:del&quot;</span>&gt;</span><span class="comment">&lt;!-- &#x6743;&#x9650;&#x6216;&#x5224;&#x65AD; --&gt;</span></span><br><span class="line">    You can see or delete users.</span><br><span class="line"><span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">shiro:hasPermission</span>=<span class="value">&quot;pp&quot;</span> <span class="attribute">href</span>=<span class="value">&quot;createUser.html&quot;</span>&gt;</span>Create a new User<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x91CC;&#x6CE8;&#x610F;&#x4E00;&#x4E2A;&#x7EC6;&#x8282;&#xFF0C;&#x5728;html&#x754C;&#x9762;&#x7684;&#x9876;&#x90E8;&#x52A0;&#x4E00;&#x4E2A;tag&#x6807;&#x7B7E;&#x5F15;&#x5165;&#xFF1A;xmlns:shiro=&#x201D;<a href="http://www.pollix.at/thymeleaf/shiro" target="_blank" rel="external">http://www.pollix.at/thymeleaf/shiro</a>&#x201C;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[SpringBoot1.5以上版本自定义配置文件]]></title>
      <url>http://jasoncool.com/2017/11/06/SpringBoot1.5%E4%BB%A5%E4%B8%8A%E7%89%88%E6%9C%AC%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/</url>
      <content type="html"><![CDATA[<p>&#x6700;&#x8FD1;&#x5728;&#x5B66;&#x4E60;SpringBoot&#x65B9;&#x9762;&#x7684;&#x77E5;&#x8BC6;&#xFF0C;&#x57FA;&#x672C;&#x7684;&#x6846;&#x67B6;&#x5DF2;&#x7ECF;&#x4E86;&#x89E3;&#x7684;&#x5DEE;&#x4E0D;&#x591A;&#x4E86;&#xFF0C;&#x4ECA;&#x5929;&#x5728;&#x642D;&#x6846;&#x67B6;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x60F3;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x4F7F;&#x7528;&#x573A;&#x666F;&#xFF1A;&#x5728;&#x4E00;&#x4E2A;Web&#x5E73;&#x53F0;&#x4E0A;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x767B;&#x5F55;&#x8BE5;&#x5E73;&#x53F0;&#xFF0C;&#x90A3;&#x4E48;&#x8BBF;&#x95EE;&#x7684;&#x754C;&#x9762;&#x662F;&#x6709;&#x9650;&#x7684;&#xFF0C;&#x8FD9;&#x6837;&#x6211;&#x5C31;&#x9700;&#x8981;&#x505A;&#x4E00;&#x4E2A;&#x767D;&#x540D;&#x5355;&#xFF0C;&#x672A;&#x767B;&#x5F55;&#x7684;&#x7528;&#x6237;&#x5982;&#x679C;&#x8BBF;&#x95EE;&#x7684;&#x662F;&#x767D;&#x540D;&#x5355;&#x4E2D;&#x7684;&#x9875;&#x9762;&#xFF0C;&#x662F;&#x53EF;&#x4EE5;&#x4E0D;&#x9700;&#x8981;&#x9A8C;&#x8BC1;&#x5176;&#x767B;&#x9646;&#x7684;&#x3002;<br>&#x8FD9;&#x6837;&#x95EE;&#x9898;&#x7684;&#x89E3;&#x51B3;&#x601D;&#x8DEF;&#x662F;&#x6211;&#x9700;&#x8981;&#x4E00;&#x4E2A;List&#x6765;&#x653E;&#x7F6E;&#x6211;&#x7684;&#x767D;&#x540D;&#x5355;&#x8DEF;&#x5F84;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x6709;&#x53C8;&#x4E0D;&#x60F3;&#x5C06;&#x8FD9;&#x4E2A;&#x767D;&#x540D;&#x5355;&#x653E;&#x7F6E;&#x5728;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x4E2D;&#xFF0C;&#x6240;&#x4EE5;&#x60F3;&#x5230;&#x4E86;SpringBoot&#x652F;&#x6301;&#x81EA;&#x5B9A;&#x4E49;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x800C;&#x6211;&#x53EA;&#x8981;&#x7EF4;&#x62A4;&#x4E00;&#x4E2A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x5728;&#x6BCF;&#x6B21;&#x8FC7;&#x6EE4;&#x5668;&#x8C03;&#x7528;&#x7684;&#x65F6;&#x5019;&#x5C06;&#x767D;&#x540D;&#x5355;&#x8BFB;&#x51FA;&#x6765;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF0C;&#x8FD9;&#x6837;&#x9879;&#x76EE;&#x4E2D;&#x7684;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x53EA;&#x8981;&#x7EF4;&#x62A4;&#x4E00;&#x4E2A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5373;&#x53EF;&#xFF0C;&#x65E2;&#x7136;&#x6709;&#x4E86;&#x601D;&#x8DEF;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x53EF;&#x4EE5;&#x5F00;&#x59CB;&#x5B9E;&#x73B0;&#x4E86;&#x3002;<br><a id="more"></a></p>
<h2 id="&#x8BFB;&#x53D6;&#x81EA;&#x5B9A;&#x4E49;&#x914D;&#x7F6E;&#x6587;&#x4EF6;">&#x8BFB;&#x53D6;&#x81EA;&#x5B9A;&#x4E49;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</h2><p>&#x5B66;&#x4E60;&#x8FC7;SpringBoot&#x7684;&#x670B;&#x53CB;&#x4EEC;&#x5E94;&#x8BE5;&#x90FD;&#x77E5;&#x9053;&#xFF0C;Spb&#x7684;&#x9879;&#x76EE;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E3B;&#x8981;&#x662F;application.properties&#xFF0C;&#x5F53;&#x7136;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x548C;&#x5F00;&#x53D1;&#x73AF;&#x5883;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x5177;&#x4F53;&#x7684;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x767E;&#x5EA6;&#xFF0C;&#x8FD9;&#x91CC;&#x4E0D;&#x662F;&#x8BA8;&#x8BBA;&#x7684;&#x91CD;&#x70B9;&#xFF0C;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x8BA8;&#x8BBA;&#x7684;&#x662F;&#x5728;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x8BFB;&#x53D6;&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#x7684;&#x65B9;&#x6CD5;&#xFF1A;</p>
<ol>
<li>&#x521B;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6;<br>&#x5728;resources/&#x76EE;&#x5F55;&#x4E0B;&#x521B;&#x5EFA;config&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x5E76;&#x5728;&#x8BE5;&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x521B;&#x5EFA;&#x201D;visit_white_list.properties&#x201D;&#x6587;&#x4EF6;&#x3002;</li>
<li>&#x586B;&#x5199;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5185;&#x5BB9;<br>&#x65E2;&#x7136;&#x662F;&#x4E00;&#x4E2A;&#x767D;&#x540D;&#x5355;&#xFF0C;&#x90A3;&#x80AF;&#x5B9A;&#x7528;List&#x6765;&#x5B58;&#x653E;&#x6570;&#x636E;&#x662F;&#x6700;&#x5408;&#x9002;&#x4E0D;&#x8FC7;&#x5F97;&#x4E86;&#xFF0C;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x521B;&#x5EFA;List&#x7684;&#x65B9;&#x6CD5;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x5176;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF1A;</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">web.whitelist[<span class="number">0</span>]=/hello </span><br><span class="line">web.whitelist[<span class="number">1</span>]=/hello1</span><br><span class="line">web.whitelist[<span class="number">2</span>]=/hello2</span><br></pre></td></tr></table></figure>
<p>&#x5148;&#x4E0D;&#x8BF4;&#x5177;&#x4F53;&#x7684;&#x610F;&#x4E49;&#xFF0C;&#x5355;&#x4ECE;&#x8BED;&#x6CD5;&#x6765;&#x770B;&#xFF0C;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#x5F62;&#x5F0F;&#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x5F53;&#x7136;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x5B57;&#x7B26;&#x4E32;&#x7C7B;&#x578B;&#x6216;&#x8005;&#x6570;&#x5B57;&#x7C7B;&#x578B;&#x7684;&#x5C5E;&#x6027;&#x503C;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x5C31;&#x4E0D;&#x591A;&#x505A;&#x8D58;&#x8FF0;&#x4E86;&#xFF0C;&#x73B0;&#x5728;&#x8FDB;&#x5165;&#x4E0B;&#x4E00;&#x6B65;&#x3002;</p>
<ol>
<li>&#x521B;&#x5EFA;&#x7BA1;&#x7406;&#x914D;&#x7F6E;&#x7684;&#x5B9E;&#x4F53;&#x7C7B;<br>&#x5176;&#x5B9E;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x5B58;&#x5728;&#x7684;&#x610F;&#x4E49;&#x5C31;&#x5728;&#x4E8E;&#xFF0C;1.5&#x4E4B;&#x540E;&#x548C;1.5&#x4E4B;&#x524D;&#xFF0C;&#x7BA1;&#x7406;&#x914D;&#x7F6E;&#x7684;&#x5B9E;&#x4F53;&#x7C7B;&#x662F;&#x6709;&#x53D8;&#x5316;&#x7684;<br>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x770B;1.5&#x4E4B;&#x524D;&#x5B9E;&#x4F53;&#x7C7B;&#x7684;&#x5199;&#x6CD5;&#xFF1A;<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@ConfigurationProperties</span>(locations = <span class="string">&quot;classpath:config/visit_white_list.properties&quot;</span>, prefix = <span class="string">&quot;web&quot;</span>)</span><br><span class="line"><span class="annotation">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WhiteListConfig</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getWhitelist</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> whitelist;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWhitelist</span><span class="params">(List&lt;String&gt; whitelist)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.whitelist = whitelist;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt;  whitelist;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>&#x518D;&#x770B;&#x770B;1.5&#x4E4B;&#x540E;&#x7684;&#x5199;&#x6CD5;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="annotation">@Component</span></span><br><span class="line"><span class="annotation">@PropertySource</span>(value = <span class="string">&quot;classpath:config/visit_white_list.properties&quot;</span>)</span><br><span class="line"><span class="annotation">@ConfigurationProperties</span>(prefix = <span class="string">&quot;web&quot;</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WhiteListConfig</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getWhitelist</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> whitelist;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWhitelist</span><span class="params">(List&lt;String&gt; whitelist)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.whitelist = whitelist;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt;  whitelist;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x5728;@ConfigurationProperties&#x6CE8;&#x91CA;&#x4E2D;&#x6709;&#x4E24;&#x4E2A;&#x5C5E;&#x6027;&#xFF1A;</p>
<blockquote>
<p>locations&#xFF1A;&#x6307;&#x5B9A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x7684;&#x6240;&#x5728;&#x4F4D;&#x7F6E;<br>prefix&#xFF1A;&#x6307;&#x5B9A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x952E;&#x540D;&#x79F0;&#x7684;&#x524D;&#x7F00;&#xFF08;&#x6211;&#x8FD9;&#x91CC;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x6240;&#x6709;&#x952E;&#x540D;&#x90FD;&#x662F;&#x4EE5;web.&#x5F00;&#x5934;&#xFF09;</p>
</blockquote>
<p>&#x4F7F;&#x7528;@Component&#x662F;&#x8BA9;&#x8BE5;&#x7C7B;&#x80FD;&#x591F;&#x5728;&#x5176;&#x4ED6;&#x5730;&#x65B9;&#x88AB;&#x4F9D;&#x8D56;&#x4F7F;&#x7528;&#xFF0C;&#x5373;&#x4F7F;&#x7528;@Autowired&#x6CE8;&#x91CA;&#x6765;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#x3002;<br>&#x4F46;&#x662F;1.5&#x4E4B;&#x540E;&#x53D6;&#x6D88;&#x4E86; @ConfigurationProperties &#x7684; locations&#x5C5E;&#x6027;&#xFF0C;&#x6240;&#x4EE5;&#x5728;1.5&#x4E4B;&#x540E; &#x9700;&#x8981;&#x52A0;&#x5165;@PropertySource &#x5C5E;&#x6027;&#x6765;&#x6307;&#x5B9A;&#x81EA;&#x5B9A;&#x4E49;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x7684;&#x76F8;&#x5BF9;&#x8DEF;&#x5F84;&#xFF0C;&#x4EE5;&#x4FBF;&#x7CFB;&#x7EDF;&#x52A0;&#x8F7D;&#x3002;</p>
<ol>
<li>&#x521B;&#x5EFA;&#x8FC7;&#x6EE4;&#x5668;<br>&#x8FC7;&#x6EE4;&#x5668;&#x7684;&#x5185;&#x5BB9;&#xFF1A;<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * &#x4F7F;&#x7528;&#x6CE8;&#x89E3;&#x6807;&#x6CE8;&#x8FC7;&#x6EE4;&#x5668;</span><br><span class="line"> *</span><br><span class="line"> * <span class="doctag">@version</span> v.0.1</span><br><span class="line"> * <span class="doctag">@WebFilter</span>&#x5C06;&#x4E00;&#x4E2A;&#x5B9E;&#x73B0;&#x4E86;javax.servlet.Filter&#x63A5;&#x53E3;&#x7684;&#x7C7B;&#x5B9A;&#x4E49;&#x4E3A;&#x8FC7;&#x6EE4;&#x5668; &#x5C5E;&#x6027;filterName&#x58F0;&#x660E;&#x8FC7;&#x6EE4;&#x5668;&#x7684;&#x540D;&#x79F0;, &#x53EF;&#x9009;</span><br><span class="line"> * &#x5C5E;&#x6027;urlPatterns&#x6307;&#x5B9A;&#x8981;&#x8FC7;&#x6EE4;&#x7684;URL&#x6A21;&#x5F0F;,&#x4E5F;&#x53EF;&#x4F7F;&#x7528;&#x5C5E;&#x6027;value&#x6765;&#x58F0;&#x660E;.(&#x6307;&#x5B9A;&#x8981;&#x8FC7;&#x6EE4;&#x7684;URL&#x6A21;&#x5F0F;&#x662F;&#x5FC5;&#x9009;&#x5C5E;&#x6027;)</span><br><span class="line"> */</span></span><br><span class="line"><span class="annotation">@WebFilter</span>(filterName = <span class="string">&quot;AuthFilter&quot;</span>, urlPatterns = <span class="string">&quot;/*&quot;</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>{</span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> WhiteListConfig myWebConfig;</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>{</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;&#x8BBF;&#x95EE;&#x8DEF;&#x5F84;&#x6743;&#x9650;&#x8FC7;&#x6EE4;&#x5668;&#x521D;&#x59CB;&#x5316;&quot;</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>{</span><br><span class="line">        System.out.println(<span class="string">&quot;&#x8BBF;&#x95EE;&#x8DEF;&#x5F84;&#x6743;&#x9650;&#x5F00;&#x59CB;&#x6267;&#x884C;&#x8FC7;&#x6EE4;&#x5668;&quot;</span>);</span><br><span class="line">        HttpServletRequest request = (HttpServletRequest) servletRequest;</span><br><span class="line">        HttpServletResponse response = (HttpServletResponse) servletResponse;</span><br><span class="line">        HttpSession session = request.getSession(<span class="keyword">true</span>);</span><br><span class="line">        String usercode = (String) request.getRemoteUser();<span class="comment">// &#x767B;&#x5F55;&#x4EBA;</span></span><br><span class="line">        String user_role = (String) session.getAttribute(<span class="string">&quot;role&quot;</span>);<span class="comment">//&#x767B;&#x5F55;&#x4EBA;&#x89D2;&#x8272;</span></span><br><span class="line">        String url = request.getRequestURI();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (usercode == <span class="keyword">null</span> || <span class="string">&quot;&quot;</span>.equals(usercode) || user_role == <span class="keyword">null</span> || <span class="string">&quot;&quot;</span>.equals(user_role)) {</span><br><span class="line">            <span class="comment">//&#x5224;&#x65AD;&#x83B7;&#x53D6;&#x7684;&#x8DEF;&#x5F84;&#x4E0D;&#x4E3A;&#x7A7A;&#x4E14;&#x4E0D;&#x662F;&#x8BBF;&#x95EE;&#x767B;&#x5F55;&#x9875;&#x9762;&#x6216;&#x6267;&#x884C;&#x767B;&#x5F55;&#x64CD;&#x4F5C;&#x65F6;&#x8DF3;&#x8F6C;</span></span><br><span class="line">            <span class="keyword">if</span> (!myWebConfig.getWhitelist().contains(url) &amp;&amp;url != <span class="keyword">null</span> &amp;&amp; !url.equals(<span class="string">&quot;&quot;</span>) &amp;&amp; (url.indexOf(<span class="string">&quot;Login&quot;</span>) &lt; <span class="number">0</span> &amp;&amp; url.indexOf(<span class="string">&quot;login&quot;</span>) &lt; <span class="number">0</span>)) {</span><br><span class="line">                <span class="comment">//&#x65E0;&#x6743;&#x9650;&#x65F6;&#x8DF3;&#x8F6C;&#x5230;&#x767B;&#x5F55;&#x754C;&#x9762;</span></span><br><span class="line">                response.sendRedirect(request.getContextPath() + <span class="string">&quot;/login.dhcc&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">&quot;&#x8BBF;&#x95EE;&#x8DEF;&#x5F84;&#x6743;&#x9650;&#x8FC7;&#x6EE4;&#x5668;&#x9500;&#x6BC1;&quot;</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>&#x4F7F;&#x7528;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Autowired</span></span><br><span class="line">   <span class="keyword">private</span> WhiteListConfig myWebConfig;</span><br></pre></td></tr></table></figure></p>
<p> &#x83B7;&#x53D6;&#x5230;&#x767D;&#x540D;&#x5355;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5E76;&#x83B7;&#x53D6;&#x5176;list&#x5BF9;&#x8C61;&#x6765;&#x5224;&#x65AD;&#x5F53;&#x524D;Url&#x662F;&#x5426;&#x5728;&#x767D;&#x540D;&#x5355;&#x8303;&#x56F4;&#x5185;&#x5373;&#x53EF;&#x3002;</p>
<h2 id="&#x603B;&#x7ED3;">&#x603B;&#x7ED3;</h2><p> &#x7F51;&#x4E0A;&#x67E5;&#x4E86;&#x5F88;&#x591A;&#x8D44;&#x6599;&#xFF0C;&#x5173;&#x4E8E;SpringBoot&#x8BFB;&#x53D6;&#x81EA;&#x5B9A;&#x4E49;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x7684;&#x65B9;&#x6CD5;&#x90FD;&#x662F;&#x5C5E;&#x4E8E;1.5&#x4E4B;&#x524D;&#x7684;&#x8BFB;&#x53D6;&#x65B9;&#x5F0F;&#xFF0C;&#x800C;&#x6211;&#x7684;&#x9879;&#x76EE;&#x5C5E;&#x4E8E;1.5&#x4E4B;&#x540E;&#x7684;&#xFF0C;&#x4E8E;&#x662F;&#x641C;&#x4E86;&#x5F88;&#x591A;&#x8D44;&#x6599;&#x624D;&#x627E;&#x5230;1.5&#x4E4B;&#x540E;&#x7684;&#x914D;&#x7F6E;&#x65B9;&#x5F0F;&#xFF0C;&#x5728;&#x6B64;&#x5206;&#x4EAB;&#x7ED9;&#x5927;&#x5BB6;&#xFF0C;&#x5E0C;&#x671B;&#x5927;&#x5BB6;&#x5C11;&#x8D70;&#x5F2F;&#x8DEF;&#x5427;&#x3002;</p>
<h2 id="&#x76F8;&#x5173;&#x8D44;&#x6599;">&#x76F8;&#x5173;&#x8D44;&#x6599;</h2><ol>
<li><a href="http://www.zslin.com/web/article/detail/12" target="_blank" rel="external">Springboot &#x4E4B; &#x81EA;&#x5B9A;&#x4E49;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x53CA;&#x8BFB;&#x53D6;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</a></li>
<li><a href="http://www.cnblogs.com/sxdcgaq8080/p/7651697.html" target="_blank" rel="external">spring boot1.5&#x4EE5;&#x4E0A;&#x7248;&#x672C;@ConfigurationProperties&#x53D6;&#x6D88;location&#x6CE8;&#x89E3;&#x540E;&#x7684;&#x66FF;&#x4EE3;&#x65B9;&#x6848;</a></li>
</ol>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Android自定义View的测量过程详解]]></title>
      <url>http://jasoncool.com/2017/06/15/Android%E8%87%AA%E5%AE%9A%E4%B9%89View%E7%9A%84%E6%B5%8B%E9%87%8F%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3/</url>
      <content type="html"><![CDATA[<blockquote>
<p>&#x5728;Android&#x5F00;&#x53D1;&#x4E2D;&#xFF0C;&#x81EA;&#x5B9A;&#x4E49;View&#x53EF;&#x4EE5;&#x8BF4;&#x662F;&#x4ECE;&#x4E1A;&#x4EBA;&#x5458;&#x4ECE;&#x521D;&#x7EA7;&#x5230;&#x4E2D;&#x7EA7;&#x7684;&#x4E00;&#x4E2A;&#x6807;&#x5FD7;&#x6027;&#x8FC7;&#x6E21;&#xFF0C;&#x4E0D;&#x8BBA;&#x4F60;&#x662F;&#x8001;&#x9E1F;&#x8FD8;&#x662F;&#x65B0;&#x4EBA;&#xFF0C;&#x4E0D;&#x8BBA;&#x4F60;&#x662F;&#x5DE5;&#x4F5C;&#x8FD8;&#x662F;&#x9762;&#x8BD5;&#xFF0C;&#x81EA;&#x5B9A;&#x4E49;View&#x90FD;&#x5982;&#x540C;&#x4E00;&#x4E2A;&#x5B88;&#x5173;&#x7684;BOSS&#x4E00;&#x6837;&#xFF0C;&#x65E0;&#x6CD5;&#x56DE;&#x907F;&#xFF0C;&#x300A;&#x5FC3;&#x82B1;&#x8DEF;&#x653E;&#x300B;&#x91CC;&#x5F20;&#x4FEA;( &#x90A3;&#x4E2A;&#x5927;&#x957F;&#x817F;)&#x8BF4;&#x8FC7;&#xFF0C;&#x201C;&#x9047;&#x5230;&#x95EE;&#x9898;&#xFF0C;&#x6B63;&#x9762;&#x9762;&#x5BF9;&#x3002;&#x201D;&#xFF0C;&#x597D;&#x5427;&#xFF0C;&#x8EB2;&#x4E0D;&#x8D77;&#x6211;&#x8FD8;&#x6253;&#x4E0D;&#x8FC7;&#x4E48;&#x6211;&#xFF1F;&#x64B8;&#x8D77;&#x8896;&#x5B50;&#xFF0C;&#x5E72;&#xFF01;<br><a id="more"></a></p>
<h2 id="Activity&#x7684;&#x7EC4;&#x6210;&#x7ED3;&#x6784;&#x7C97;&#x8BB2;">Activity&#x7684;&#x7EC4;&#x6210;&#x7ED3;&#x6784;&#x7C97;&#x8BB2;</h2><p>&#x9996;&#x5148;&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x4E00;&#x4E2A;Activity&#x5305;&#x542B;&#x54EA;&#x4E9B;&#x7EC4;&#x4EF6;&#x7ED3;&#x6784;&#xFF1A;<br><img src="/2017/06/15/Android&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x8BE6;&#x89E3;/1.png" alt="logo"><br>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x6BCF;&#x4E00;&#x4E2A;Activity&#x90FD;&#x5305;&#x542B;&#x4E86;PhoneWindow&#xFF0C;PhoneWindow&#x53C8;&#x5305;&#x542B;&#x4E86;&#x4E00;&#x4E2A;DecorView&#xFF0C;&#x800C;DecorView&#x4E2D;&#x5305;&#x542B;&#x4E86;TitleView&#x548C;&#x4E00;&#x4E2A;ContentView&#xFF0C;TitleView&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x5F00;&#x53D1;&#x8FC7;&#x7A0B;&#x4E2D;&#x9700;&#x8981;&#x8BBE;&#x7F6E;&#x7684;ActionBar&#x548C;StatusBar&#x76F8;&#x5173;&#xFF0C;&#x800C;&#x754C;&#x9762;&#x7684;&#x4E3B;&#x4F53;&#x7ED3;&#x6784;&#x90FD;&#x5728;&#x8FD9;&#x4E2A;ContentView&#x4E2D;&#x8BBE;&#x7F6E;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x6BCF;&#x6B21;&#x7ED9;Activity&#x8BBE;&#x7F6E;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x7684;&#x5FC5;&#x987B;&#x8C03;&#x7528;<br>setContentVIew(int layoutResID)&#x65B9;&#x6CD5;&#x6765;&#x8BBE;&#x7F6E;&#x3002;<br>&#x800C;ContentView&#x4E2D;&#x5C31;&#x5305;&#x542B;&#x4E86;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;ViewGroup&#x548C;View,&#x5173;&#x4E8E;ViewGroup&#x548C;View&#xFF0C;&#x6574;&#x4E2A;ContentView&#x7684;&#x89C6;&#x56FE;&#x7ED3;&#x6784;&#xFF1A;&#x6700;&#x9876;&#x5C42;&#x662F;ViewGroup&#xFF0C;ViewGroup&#x4E0B;&#x53EF;&#x80FD;&#x6709;&#x591A;&#x4E2A;ViewGroup&#x548C;View,&#x5C31;&#x597D;&#x50CF;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x6765;&#x8BF4;&#xFF0C;&#x6211;&#x4EEC;&#x5199;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6700;&#x5916;&#x5C42;&#x4E00;&#x822C;&#x90FD;&#x662F;&#x4E00;&#x4E2A;ViewGroup(LinearLayout&#x6216;&#x8005;&#x662F;RelativeLayout&#x7B49;)&#xFF0C;&#x4E4B;&#x540E;&#x8FD9;&#x4E2A;ViewGroup&#x5185;&#x90E8;&#x53EF;&#x80FD;&#x8FD8;&#x662F;&#x4E00;&#x4E2A;ViewGroup(LinearLayout&#x6216;&#x8005;&#x662F;RelativeLayout&#x7B49;)&#x6216;&#x8005;&#x76F4;&#x63A5;&#x653E;&#x7F6E;&#x4E86;&#x4E00;&#x4E2A;&#x6216;&#x8005;&#x591A;&#x4E2A;View(&#x5982;TextView&#x6216;&#x8005;&#x662F;Button&#x7B49;)&#x3002;</p>
</blockquote>
<p>&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x8BF4;&#x660E;&#x4E00;&#x4E0B;&#xFF0C;&#x8FD9;&#x91CC;&#x6240;&#x8BF4;&#x7684;ViewGroup&#x5305;&#x542B;&#x5F88;&#x591A;View&#x662F;&#x8BF4;&#x7684;View&#x7684;&#x89C6;&#x56FE;&#x7ED3;&#x6784;&#xFF0C;&#x800C;&#x4ECE;View&#x7684;&#x67B6;&#x6784;&#x6765;&#x8BF4;&#xFF0C;&#x6240;&#x6709;&#x7684;ViewGroup&#x5176;&#x672C;&#x8D28;&#x8FD8;&#x662F;View&#x7684;&#x5B50;&#x7C7B;,&#x8FD9;&#x91CC;&#x8981;&#x9762;&#x8BD5;&#x7684;&#x670B;&#x53CB;&#x4E00;&#x5B9A;&#x8981;&#x6CE8;&#x610F;&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x95EE;&#x5230;&#x4F60;View&#x7684;&#x67B6;&#x6784;&#xFF0C;&#x5343;&#x4E07;&#x4E0D;&#x8981;&#x548C;View&#x7684;&#x89C6;&#x56FE;&#x7ED3;&#x6784;&#x5F04;&#x6DF7;&#xFF0C;&#x5426;&#x5219;&#x4F60;&#x6765;&#x4E00;&#x53E5;View&#x7EE7;&#x627F;&#x81EA;ViewGroup&#x90A3;&#x4F60;&#x8FD9;&#x6B21;&#x9762;&#x8BD5;&#x57FA;&#x672C;&#x4E0A;&#x5C31;&#x4F1A;&#x4EE5;&#x5931;&#x8D25;&#x544A;&#x7EC8;&#x4E86;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x7EC6;&#x8BB2;&#x6574;&#x4E2A;&#x5E03;&#x5C40;&#x662F;&#x5982;&#x4F55;&#x8BDE;&#x751F;&#x7684;&#x4E86;&#xFF0C;&#x5173;&#x952E;&#x662F;&#x5927;&#x5BB6;&#x8981;&#x5BF9;Activity&#x6709;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x7684;&#x8BA4;&#x8BC6;&#xFF0C;&#x4ECE;&#x800C;&#x77E5;&#x9053;&#x6211;&#x4EEC;&#x81EA;&#x5B9A;&#x4E49;View&#x5728;Activity&#x4E2D;&#x7684;&#x5177;&#x4F53;&#x5B9A;&#x4F4D;&#x3002;</p>
<h2 id="&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;">&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;</h2><pre><code>&#x81EA;&#x5B9A;&#x4E49;<span class="keyword">View</span>&#x7684;&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;&#x4E3B;&#x8981;&#x6307;&#x7684;&#x662F;Mesusre&#xFF0C;Layout&#x548C;Draw,Measure&#x7528;&#x6765;&#x6D4B;&#x91CF;<span class="keyword">View</span>&#x7684;&#x5BBD;&#x9AD8;&#xFF0C;Layout&#x7528;&#x6765;&#x786E;&#x5B9A;<span class="keyword">View</span>&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;Draw&#x5219;&#x7528;&#x6765;&#x7ED8;&#x5236;<span class="keyword">View</span>&#x3002;
</code></pre><p>&#x867D;&#x7136;&#x8BDD;&#x662F;&#x8FD9;&#x4E48;&#x8BF4;&#xFF0C;&#x4F46;&#x662F;&#x5C31;&#x597D;&#x50CF;&#x4E00;&#x4E2A;&#x7C7B;&#x8981;&#x8FD0;&#x884C;&#x4E00;&#x5B9A;&#x8981;&#x6709;&#x4E00;&#x4E2A;Main&#x65B9;&#x6CD5;&#x4E00;&#x6837;&#xFF0C;&#x4E00;&#x4E2A;View&#x7684;&#x7ED8;&#x5236;&#x4E5F;&#x4E00;&#x5B9A;&#x8981;&#x6709;&#x4E00;&#x4E2A;&#x5F00;&#x59CB;&#x8C03;&#x7528;&#x7684;&#x5730;&#x65B9;&#x624D;&#x662F;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x5F00;&#x59CB;&#x8C03;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#x5C31;&#x662F;ViewRootImpl&#x7C7B;&#x7684;performTraversales()&#x65B9;&#x6CD5;&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4F1A;&#x901A;&#x8FC7;&#x5224;&#x65AD;&#x6765;&#x5206;&#x6790;&#x8FD9;&#x4E2A;View&#x662F;&#x5426;&#x8981;&#x6267;&#x884C;&#x76F8;&#x5173;&#x7684;&#x7ED8;&#x5236;&#x6D41;&#x7A0B;&#x3002;</p>
<h3 id="&#x5355;&#x4E00;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x7B80;&#x8FF0;">&#x5355;&#x4E00;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x7B80;&#x8FF0;</h3><p>View&#x7684;Measure&#x8FC7;&#x7A0B;&#x6839;&#x636E;View&#x7684;&#x7C7B;&#x578B;&#x5206;&#x4E3A;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x4E00;&#x79CD;&#x662F;&#x5355;&#x4E00;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x662F;ViewGroup&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#xFF0C;&#x8FD9;&#x4E24;&#x79CD;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x3002;<br>&#x9996;&#x5148;&#x5148;&#x770B;&#x5355;&#x4E00;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#xFF1A;<br><img src="/2017/06/15/Android&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x8BE6;&#x89E3;/2.png" alt="logo"><br>&#x6574;&#x4E2A;&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x57FA;&#x672C;&#x5982;&#x4E0A;&#x56FE;&#x6240;&#x793A;&#xFF0C;&#x7528;&#x6587;&#x5B57;&#x63CF;&#x8FF0;&#x4E00;&#x904D;&#x5C31;&#x662F;&#xFF1A;<br>ViewRootImpl&#x8C03;&#x7528;performMeasure&#x65B9;&#x6CD5;&#x540E;&#x8BE5;&#x65B9;&#x6CD5;&#x4E2D;&#x7684;DecorView&#x53C8;&#x8C03;&#x7528;&#x4E86;measure&#x65B9;&#x6CD5;&#xFF0C;&#x800C;DecorView&#x7684;&#x672C;&#x8D28;&#x5176;&#x5B9E;&#x662F;&#x96C6;&#x6210;&#x81EA;FrameLayout&#xFF0C;&#x90A3;&#x4E48;&#x672C;&#x8D28;&#x5C31;&#x662F;&#x4E00;&#x4E2A;ViewGroup&#xFF0C;&#x4F46;&#x662F;&#x5728;FrameLayout&#x548C;ViewGroup&#x7684;&#x6E90;&#x7801;&#x4E2D;&#x90FD;&#x6CA1;&#x53D1;&#x73B0;measure&#x65B9;&#x6CD5;&#xFF0C; &#x8FD9;&#x5C31;&#x7528;&#x5230;&#x521A;&#x624D;&#x7684;&#x77E5;&#x8BC6;&#x70B9;&#x4E86;&#xFF0C;ViewGroup&#x672C;&#x8EAB;&#x4E5F;&#x662F;View&#x7684;&#x5B50;&#x7C7B;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53BB;View&#x7684;&#x6E90;&#x7801;&#x4E2D;&#x67E5;&#x770B;&#x4E00;&#x4E0B;&#xFF0C;&#x679C;&#x7136;&#xFF0C;measure&#x65B9;&#x6CD5;&#x8D6B;&#x7136;&#x5176;&#x4E2D;&#xFF0C;&#x5728;measure&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;View&#x53C8;&#x8C03;&#x7528;&#x4E86;&#x5176;&#x81EA;&#x8EAB;&#x7684;&#x65B9;&#x6CD5;onMeasure&#xFF0C;&#x800C;&#x8D77;&#x81EA;&#x8EAB;&#x7684;onMeasure&#x65B9;&#x6CD5;&#x4E2D;&#x53C8;&#x8C03;&#x7528;setMeasureDimension&#x65B9;&#x6CD5;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x6709;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x5206;&#x522B;&#x4EE3;&#x8868;&#x8981;&#x8BBE;&#x7F6E;&#x7684;&#x5BBD;&#x548C;&#x9AD8;&#xFF0C;&#x800C;&#x8FD9;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x90FD;&#x662F;&#x662F;&#x901A;&#x8FC7;getDefaultSize&#x65B9;&#x6CD5;&#x6765;&#x8BA1;&#x7B97;&#x7684;&#xFF0C;&#x800C;getDefaultSize&#x65B9;&#x6CD5;&#x4E2D;&#x6709;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x6839;&#x636E;getSuggestedMinimumWidth&#x6216;getSuggestedMinimumHeight&#x83B7;&#x5F97;&#x7684;&#x3002;</p>
<blockquote>
<p>&#x4E4B;&#x6240;&#x4EE5;&#x6CA1;&#x8D34;&#x6E90;&#x7801;&#x5C31;&#x76F4;&#x63A5;&#x5148;&#x8BF4;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#xFF0C;&#x662F;&#x5E0C;&#x671B;&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x5148;&#x4E86;&#x89E3;&#x4E00;&#x4E0B;View&#x7684;&#x52A0;&#x8F7D;&#x8FC7;&#x7A0B;&#xFF0C;&#x4E0D;&#x7BA1;&#x662F;&#x5728;&#x5DE5;&#x4F5C;&#x4E2D;&#x9047;&#x5230;&#x4E86;&#x95EE;&#x9898;&#xFF0C;&#x6216;&#x8005;&#x662F;&#x9762;&#x8BD5;&#x7684;&#x65F6;&#x5019;&#x88AB;&#x4EBA;&#x63D0;&#x95EE;&#xFF0C;&#x6839;&#x636E;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x4F60;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x5206;&#x6790;&#x95EE;&#x9898;&#x7684;&#x5207;&#x5165;&#x70B9;&#x6216;&#x8005;&#x662F;&#x7ED9;&#x9762;&#x8BD5;&#x5B98;&#x63CF;&#x8FF0;&#x4E00;&#x4E0B;&#x5927;&#x4F53;&#x7684;&#x6D41;&#x7A0B;&#xFF0C;&#x544A;&#x8BC9;&#x4ED6;&#x4F60;&#x5DF2;&#x7ECF;&#x5BF9;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x6709;&#x4E86;&#x4E00;&#x4E2A;&#x5927;&#x4F53;&#x7684;&#x8BA4;&#x77E5;&#x4E86;&#xFF0C;&#x6700;&#x8D77;&#x7801;&#x4E0D;&#x4F1A;&#x8BA9;&#x4EBA;&#x5BB6;&#x89C9;&#x5F97;&#x4F60;&#x5B8C;&#x5168;&#x6CA1;&#x4E86;&#x89E3;&#x8FD9;&#x91CC;&#x7684;&#x77E5;&#x8BC6;&#x3002;</p>
</blockquote>
<h3 id="ViewGroup&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x7B80;&#x8FF0;">ViewGroup&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x7B80;&#x8FF0;</h3><p>&#x5148;&#x770B;ViewGroup&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;:<br><img src="/2017/06/15/Android&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x8BE6;&#x89E3;/6.png" alt="logo"><br>&#x6574;&#x4E2A;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x57FA;&#x672C;&#x5982;&#x4E0A;&#x56FE;&#x6240;&#x793A;&#xFF0C;&#x5176;&#x539F;&#x7406;&#x5C31;&#x662F;&#xFF1A;<br>&#x901A;&#x8FC7;&#x904D;&#x5386;&#x6240;&#x6709;&#x7684;&#x5B50;View&#x8FDB;&#x884C;&#x5B50;View&#x7684;&#x6D4B;&#x91CF;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x6240;&#x6709;&#x5B50;View&#x7684;&#x5C3A;&#x5BF8;&#x8FDB;&#x884C;&#x5408;&#x5E76;&#xFF0C;&#x6700;&#x7EC8;&#x5F97;&#x5230;ViewGroup&#x7236;&#x89C6;&#x56FE;&#x7684;&#x6D4B;&#x91CF;&#x503C;&#x3002;</p>
<h2 id="&#x6D4B;&#x91CF;&#x4E2D;&#x7684;&#x8D85;&#x7EA7;&#x5C3A;&#x5B50;&#x2014;&#x2014;MeasureSpec">&#x6D4B;&#x91CF;&#x4E2D;&#x7684;&#x8D85;&#x7EA7;&#x5C3A;&#x5B50;&#x2014;&#x2014;MeasureSpec</h2><p>&#x5728;&#x770B;&#x6574;&#x4E2A;view&#x7684;&#x52A0;&#x8F7D;&#x8FC7;&#x7A0B;&#x7684;&#x6E90;&#x7801;&#x524D;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x6765;&#x4E86;&#x89E3;&#x4E00;&#x4E0B;View&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;MeasureSpec,&#x6709;&#x4EBA;&#x53EB;&#x5B83;&#x6D4B;&#x91CF;&#x89C4;&#x683C;&#xFF0C;&#x6211;&#x66F4;&#x559C;&#x6B22;&#x628A;&#x5B83;&#x63CF;&#x8FF0;&#x6210;&#x4E3A;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x4E2D;&#x5FC5;&#x4E0D;&#x53EF;&#x5C11;&#x7684;&#x5DE5;&#x5177;&#x2014;&#x2014;&#x5C3A;&#x5B50;&#x3002;<br>&#x8FD9;&#x4E2A;&#x5C3A;&#x5B50;&#x6709;&#x4E24;&#x79CD;&#x7528;&#x6CD5;&#xFF0C;&#x6A2A;&#x7740;&#x7528;&#x5C31;&#x53EB;&#x505A;widthMeasureSpec&#xFF0C;&#x7528;&#x6765;&#x6D4B;&#x91CF;&#x5BBD;&#x5EA6;&#xFF0C;&#x7AD6;&#x7740;&#x7528;&#x5C31;&#x53EB;&#x505A;heightMeasureSpec,&#x7528;&#x6765;&#x6D4B;&#x91CF;&#x9AD8;&#x5EA6;&#x7684;&#xFF0C;&#x4E0D;&#x7BA1;&#x4F60;&#x7684;&#x81EA;&#x5B9A;&#x4E49;View&#x662F;&#x4EC0;&#x4E48;&#x5343;&#x5947;&#x767E;&#x602A;&#x7684;&#x5F62;&#x72B6;&#xFF0C;&#x4ED6;&#x90FD;&#x662F;&#x8981;&#x653E;&#x5728;&#x4E00;&#x4E2A;&#x77E9;&#x5F62;&#x4E2D;&#x8FDB;&#x884C;&#x5305;&#x88F9;&#x5C55;&#x793A;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x4E3A;&#x4EC0;&#x4E48;&#x4F1A;&#x6709;&#x8FD9;&#x4E24;&#x4E2A;&#x6D4B;&#x91CF;&#x65B9;&#x5F0F;&#x4E5F;&#x5C31;&#x4E0D;&#x96BE;&#x7406;&#x89E3;&#x4E86;&#x3002;<br>&#x8FD9;&#x4E2A;&#x5C3A;&#x5B50;&#x6709;&#x4E24;&#x4E2A;&#x91CD;&#x8981;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x529F;&#x80FD;&#x81EA;&#x7136;&#x662F;&#x6D4B;&#x91CF;&#x503C;&#x4E86;(Size)&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x529F;&#x80FD;&#x662F;&#x6D4B;&#x91CF;&#x7684;&#x6A21;&#x5F0F;(Mode),&#x8FD9;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x901A;&#x8FC7;&#x4E8C;&#x8FDB;&#x5236;&#x5C06;&#x5176;&#x6253;&#x5305;&#x6210;&#x4E00;&#x4E2A;int(32&#x4F4D;)&#x503C;&#x6765;&#x51CF;&#x5C11;&#x5BF9;&#x5185;&#x5B58;&#x7684;&#x5206;&#x914D;&#xFF0C;&#x5176;&#x9AD8;2&#x4F4D;(31,32&#x4F4D;)&#x5B58;&#x653E;&#x7684;&#x662F;&#x6D4B;&#x91CF;&#x6A21;&#x5F0F;&#xFF0C;&#x800C;&#x4F4E;30&#x4F4D;&#x5219;&#x5B58;&#x50A8;&#x7684;&#x662F;&#x5176;&#x6D4B;&#x91CF;&#x503C;&#x3002;</p>
<h3 id="&#x6D4B;&#x91CF;&#x6A21;&#x5F0F;(specMode)">&#x6D4B;&#x91CF;&#x6A21;&#x5F0F;(specMode)</h3><p>&#x6D4B;&#x91CF;&#x6A21;&#x5F0F;&#x5206;&#x4E3A;&#x4E09;&#x79CD;&#xFF1A;</p>
<ul>
<li>UNSPECIFIED&#x6A21;&#x5F0F;&#xFF1A;&#x672C;&#x8D28;&#x5C31;&#x662F;&#x4E0D;&#x9650;&#x5236;&#x6A21;&#x5F0F;&#xFF0C;&#x7236;&#x89C6;&#x56FE;&#x4E0D;&#x5BF9;&#x5B50;View&#x8FDB;&#x884C;&#x4EFB;&#x4F55;&#x7EA6;&#x675F;&#xFF0C;View&#x60F3;&#x8981;&#x591A;&#x5927;&#x8981;&#x591A;&#x5927;&#xFF0C;&#x60F3;&#x8981;&#x591A;&#x957F;&#x8981;&#x591A;&#x957F;&#xFF0C;&#x8FD9;&#x4E2A;&#x5728;&#x6211;&#x4EEC;&#x5199;&#x81EA;&#x5B9A;&#x4E49;View&#x4E2D;&#x7684;&#x65F6;&#x5019;&#x975E;&#x5E38;&#x5C11;&#x89C1;&#xFF0C;&#x4E00;&#x822C;&#x90FD;&#x662F;&#x7CFB;&#x7EDF;&#x5185;&#x90E8;&#x5728;&#x8BBE;&#x7F6E;ListView&#x6216;&#x8005;&#x662F;ScrollView&#x7684;&#x65F6;&#x5019;&#x624D;&#x4F1A;&#x7528;&#x5230;&#x3002;</li>
<li>EXACTLY&#x6A21;&#x5F0F;&#xFF1A;&#x8BE5;&#x6A21;&#x5F0F;&#x5176;&#x5B9E;&#x5BF9;&#x5E94;&#x7684;&#x573A;&#x666F;&#x5C31;&#x662F;match_parent&#x6216;&#x8005;&#x662F;&#x4E00;&#x4E2A;&#x5177;&#x4F53;&#x7684;&#x6570;&#x636E;(50dp&#x6216;80px)&#xFF0C;&#x7236;&#x89C6;&#x56FE;&#x4E3A;&#x5B50;View&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x786E;&#x5207;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x65E0;&#x8BBA;&#x5B50;View&#x7684;&#x503C;&#x8BBE;&#x7F6E;&#x591A;&#x5927;&#xFF0C;&#x90FD;&#x4E0D;&#x80FD;&#x8D85;&#x51FA;&#x7236;&#x89C6;&#x56FE;&#x7684;&#x8303;&#x56F4;&#x3002;</li>
<li>AT_MOST&#x6A21;&#x5F0F;&#xFF1A;&#x8FD9;&#x4E2A;&#x6A21;&#x5F0F;&#x5BF9;&#x5E94;&#x7684;&#x573A;&#x666F;&#x5C31;&#x662F;wrap_content&#xFF0C;&#x5176;&#x5185;&#x5BB9;&#x5C31;&#x662F;&#x7236;&#x89C6;&#x56FE;&#x7ED9;&#x5B50;View&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x6700;&#x5927;&#x5C3A;&#x5BF8;&#xFF0C;&#x5B50;View&#x53EA;&#x8981;&#x4E0D;&#x8D85;&#x8FC7;&#x8FD9;&#x4E2A;&#x5C3A;&#x5BF8;&#x5373;&#x53EF;&#x3002;</li>
</ul>
<p>&#x770B;&#x5B8C;&#x8FD9;&#x4E09;&#x4E2A;&#x6A21;&#x5F0F;&#xFF0C;&#x5927;&#x5BB6;&#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x4E00;&#x4E2A;&#x7591;&#x95EE;&#xFF0C;AT_MOST&#x6A21;&#x5F0F;&#x4E0D;&#x662F;&#x548C;EXACTLY&#x6A21;&#x5F0F;&#x4E00;&#x6837;&#x4E86;&#x5417;&#xFF0C;&#x90FD;&#x662F;&#x7ED9;&#x4E2A;&#x6700;&#x5927;&#x503C;&#x6765;&#x9650;&#x5236;View&#x7684;&#x8303;&#x56F4;&#xFF1F;&#x5176;&#x5B9E;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;EXACTLY&#x6A21;&#x5F0F;&#x662F;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x7684;&#x6A21;&#x5F0F;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5B83;&#x662F;&#x6CA1;&#x5F97;&#x5546;&#x91CF;&#x7684;&#xFF0C;&#x4F60;&#x53EA;&#x80FD;&#x6309;&#x7167;&#x8FD9;&#x4E2A;&#x6A21;&#x5F0F;&#x65E2;&#x6709;&#x7684;&#x89C4;&#x5F8B;&#x6765;&#x6267;&#x884C;&#x800C;AT_MOST&#x6A21;&#x5F0F;&#x662F;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x5F00;&#x53D1;&#x8005;&#x81EA;&#x5DF1;&#x7684;&#x9700;&#x6C42;&#x6765;&#x5B9A;&#x5236;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x5199;&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x65F6;&#x5019;&#x6240;&#x5199;&#x7684;&#x6D4B;&#x91CF;&#x5176;&#x5B9E;&#x4E5F;&#x5C31;&#x662F;&#x5728;&#x5199;&#x8FD9;&#x4E2A;&#x6A21;&#x5F0F;&#x7684;&#x6D4B;&#x91CF;&#x903B;&#x8F91;&#xFF0C;&#x4ED6;&#x662F;&#x6839;&#x636E;&#x5B50;&#x63A7;&#x4EF6;&#x6765;&#x7075;&#x6D3B;&#x7684;&#x6D4B;&#x91CF;&#x5C3A;&#x5BF8;&#x7684;&#x3002;<br>&#x53EF;&#x80FD;&#x4F60;&#x8FD8;&#x662F;&#x61F5;&#x903C;&#xFF0C;&#x90A3;&#x8BF7;&#x4F60;&#x8DDF;&#x6211;&#x4E00;&#x8D77;&#x6253;&#x5F00;IDE&#xFF0C;&#x505A;&#x8FD9;&#x4E48;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x6D4B;&#x8BD5;&#xFF1A;<br>&#x8BF7;&#x5148;&#x5199;&#x4E00;&#x4E2A;TestView&#xFF0C;&#x7EE7;&#x627F;View:<br><img src="/2017/06/15/Android&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x8BE6;&#x89E3;/3.png" alt="logo"><br>&#x4E0D;&#x7528;&#x91CD;&#x5199;&#x4EFB;&#x4F55;&#x7236;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x53EA;&#x8981;&#x968F;&#x4FBF;&#x5F04;&#x4E24;&#x4E2A;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x5373;&#x53EF;&#x3002;<br>&#x7136;&#x540E;&#x5728;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x4E2D;&#x5199;&#x5165;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A;<br><img src="/2017/06/15/Android&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x8BE6;&#x89E3;/4.png" alt="logo"><br>&#x8FD9;&#x4EE3;&#x7801;&#x592A;&#x7B80;&#x5355;&#x4E86;&#xFF0C;&#x4F60;&#x60F3;&#x8C61;&#x4E2D;&#x7684;&#x8FD0;&#x884C;&#x6548;&#x679C;&#x80AF;&#x5B9A;&#x662F;&#x8FD9;&#x4E2A;&#x6837;&#x5B50;&#x7684;&#xFF1A;<br><img src="/2017/06/15/Android&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x8BE6;&#x89E3;/5.png" alt="logo"><br>&#x6CA1;&#x9519;&#xFF0C;&#x5B9E;&#x9645;&#x6548;&#x679C;&#x548C;&#x4F60;&#x60F3;&#x7684;&#x4E00;&#x6837;&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5C06;match_parent&#x6539;&#x6210;wrap_content&#x4F1A;&#x600E;&#x6837;&#x5462;&#xFF1F;<br>&#x597D;&#x4E86;&#x4E0D;&#x7528;&#x60F3;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x5B9E;&#x9645;&#x6548;&#x679C;&#xFF1A;<br><img src="/2017/06/15/Android&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x8BE6;&#x89E3;/5.png" alt="logo"><br>&#x6548;&#x679C;&#x6CA1;&#x6709;&#x53D8;&#x5316;&#xFF01;&#x662F;&#x7684;&#xFF0C;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x6D4B;&#x8BD5;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#x4E00;&#x4E2A;&#x539F;&#x7406;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x91CD;&#x5199;onMeasure&#x7684;AT_MOST&#x6A21;&#x5F0F;&#x7684;&#x6D4B;&#x91CF;&#x903B;&#x8F91;&#xFF0C;&#x90A3;&#x4E48;match_parent&#x548C;wrap_content&#x7684;&#x6548;&#x679C;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;<br>&#x8BF7;&#x5E26;&#x7740;&#x8FD9;&#x4E2A;&#x7591;&#x95EE;&#x7EE7;&#x7EED;&#x770B;&#x4E0B;&#x53BB;&#x3002;</p>
<h3 id="MeasureSpec&#x786E;&#x5B9A;&#x503C;">MeasureSpec&#x786E;&#x5B9A;&#x503C;</h3><p>&#x5B50;View&#x7684;MeasureSpec&#x503C;&#x662F;&#x6839;&#x636E;&#x5B50;View&#x7684;&#x5E03;&#x5C40;&#x53C2;&#x6570;(LayoutParams)&#x548C;&#x7236;&#x5BB9;&#x5668;&#x7684;MeasureSpec&#x81F3;&#x8BA1;&#x7B97;&#x800C;&#x6765;&#x7684;&#xFF0C;&#x5176;&#x5177;&#x4F53;&#x903B;&#x8F91;&#x5C01;&#x88C5;&#x5728;&#x4E86;getChildMeasureSpec()&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x73B0;&#x5728;&#x6765;&#x5206;&#x6790;&#x4E00;&#x4E0B;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//&#x4ECE;&#x4E0A;&#x9762;&#x6211;&#x4EEC;&#x77E5;&#x9053;spec &#x662F;parent&#x7684;MeasureSpec&#xFF0C;padding&#x662F;</span></span><br><span class="line"><span class="comment">//&#x5DF2;&#x88AB;&#x4F7F;&#x7528;&#x7684;&#x5927;&#x5C0F;&#xFF0C;childDimension&#x4E3A;child&#x7684;&#x5927;&#x5C0F;</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getChildMeasureSpec</span><span class="params">(</span><br><span class="line"><span class="keyword">int</span> spec, <span class="keyword">int</span> padding, <span class="keyword">int</span> childDimension)</span> </span>{</span><br><span class="line"></span><br><span class="line"><span class="comment">//1&#x3001;&#x83B7;&#x53D6;parent&#x7684;specMode</span></span><br><span class="line">  <span class="keyword">int</span> specMode = MeasureSpec.getMode(spec);</span><br><span class="line"></span><br><span class="line"><span class="comment">//2&#x3001;&#x83B7;&#x53D6;parent&#x7684;specSize</span></span><br><span class="line">  <span class="keyword">int</span> specSize = MeasureSpec.getSize(spec);</span><br><span class="line"><span class="comment">//3&#x3001;size=&#x5269;&#x4F59;&#x7684;&#x53EF;&#x7528;&#x5927;&#x5C0F;</span></span><br><span class="line">  <span class="keyword">int</span> size = Math.max(<span class="number">0</span>, specSize - padding);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> resultSize = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span> resultMode = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//4&#x3001;&#x901A;&#x8FC7;switch&#x8BED;&#x53E5;&#x5224;&#x65AD;parent&#x7684;&#x96C6;&#x4E2D;mode&#xFF0C;&#x5206;&#x522B;&#x5904;&#x7406;</span></span><br><span class="line">  <span class="keyword">switch</span> (specMode) {</span><br><span class="line">  <span class="comment">// 5&#x3001;parent&#x4E3A;MeasureSpec.EXACTLY&#x65F6;</span></span><br><span class="line">  <span class="keyword">case</span> MeasureSpec.EXACTLY:</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (childDimension &gt;= <span class="number">0</span>) {</span><br><span class="line">    <span class="comment">//5.1&#x3001;&#x5F53;childDimension&#x5927;&#x4E8E;0&#x65F6;&#xFF0C;&#x8868;&#x793A;child&#x7684;&#x5927;&#x5C0F;&#x662F;</span></span><br><span class="line">        <span class="comment">//&#x660E;&#x786E;&#x6307;&#x51FA;&#x7684;&#xFF0C;&#x5982;layout_width= &quot;100dp&quot;;</span></span><br><span class="line">          <span class="comment">// &#x6B64;&#x65F6;child&#x7684;&#x5927;&#x5C0F;= childDimension&#xFF0C;</span></span><br><span class="line">          resultSize = childDimension;</span><br><span class="line"></span><br><span class="line">          <span class="comment">//child&#x7684;&#x6D4B;&#x91CF;&#x6A21;&#x5F0F;= MeasureSpec.EXACTLY</span></span><br><span class="line">          resultMode = MeasureSpec.EXACTLY;</span><br><span class="line"></span><br><span class="line">      } <span class="keyword">else</span> <span class="keyword">if</span> (childDimension == LayoutParams.MATCH_PARENT) {</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.2&#x3001;&#x6B64;&#x65F6;&#x4E3A;LayoutParams.MATCH_PARENT</span></span><br><span class="line">    <span class="comment">//&#x4E5F;&#x5C31;&#x662F;    android:layout_width=&quot;match_parent&quot;</span></span><br><span class="line">      <span class="comment">//&#x56E0;&#x4E3A;parent&#x7684;&#x5927;&#x5C0F;&#x662F;&#x660E;&#x786E;&#x7684;&#xFF0C;child&#x8981;&#x5339;&#x914D;parent&#x7684;&#x5927;&#x5C0F;</span></span><br><span class="line">      <span class="comment">//&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5C31;&#x76F4;&#x63A5;&#x8BA9;child=parent&#x7684;&#x5927;&#x5C0F;&#x5C31;&#x597D;</span></span><br><span class="line">          resultSize = size;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//&#x540C;&#x6837;&#xFF0C;child&#x7684;&#x6D4B;&#x91CF;&#x6A21;&#x5F0F;= MeasureSpec.EXACTLY</span></span><br><span class="line">          resultMode = MeasureSpec.EXACTLY;</span><br><span class="line"></span><br><span class="line">      } <span class="keyword">else</span> <span class="keyword">if</span> (childDimension == LayoutParams.WRAP_CONTENT) {</span><br><span class="line">  <span class="comment">//5.3&#x3001;&#x6B64;&#x65F6;&#x4E3A;LayoutParams.WRAP_CONTENT</span></span><br><span class="line">    <span class="comment">//&#x4E5F;&#x5C31;&#x662F;   android:layout_width=&quot;wrap_content&quot;  </span></span><br><span class="line">    <span class="comment">// &#x8FD9;&#x4E2A;&#x6A21;&#x5F0F;&#x9700;&#x8981;&#x7279;&#x522B;&#x5BF9;&#x5F85;&#xFF0C;child&#x8BF4;&#x6211;&#x8981;&#x7684;&#x5927;&#x5C0F;&#x521A;&#x597D;&#x591F;&#x653E;</span></span><br><span class="line">    <span class="comment">//&#x9700;&#x8981;&#x5C55;&#x793A;&#x7684;&#x5185;&#x5BB9;&#x5C31;&#x597D;&#xFF0C;&#x800C;&#x6B64;&#x65F6;&#x6211;&#x4EEC;&#x5E76;&#x4E0D;&#x77E5;&#x9053;child&#x7684;&#x5185;&#x5BB9;</span></span><br><span class="line">    <span class="comment">//&#x9700;&#x8981;&#x591A;&#x5927;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x6682;&#x65F6;&#x5148;&#x628A;parent&#x7684;size&#x7ED9;&#x4ED6;</span></span><br><span class="line"></span><br><span class="line">          resultSize = size;</span><br><span class="line">      <span class="comment">//&#x81EA;&#x7136;&#xFF0C;child&#x7684;mode&#x5C31;&#x662F;MeasureSpec.AT_MOST&#x7684;&#x4E86;</span></span><br><span class="line">          resultMode = MeasureSpec.AT_MOST;</span><br><span class="line">      }</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 5&#x3001;parent&#x4E3A;AT_MOST&#xFF0C;&#x6B64;&#x65F6;child&#x6700;&#x5927;&#x4E0D;&#x80FD;&#x8D85;&#x8FC7;parent</span></span><br><span class="line">  <span class="keyword">case</span> MeasureSpec.AT_MOST:</span><br><span class="line">      <span class="keyword">if</span> (childDimension &gt;= <span class="number">0</span>) {</span><br><span class="line">          <span class="comment">//&#x540C;&#x6837;child&#x5927;&#x5C0F;&#x660E;&#x786E;&#x65F6;&#xFF0C;</span></span><br><span class="line">          <span class="comment">//&#x5927;&#x5C0F;&#x76F4;&#x63A5;&#x65F6;&#x6307;&#x5B9A;&#x7684;childDimension</span></span><br><span class="line">          resultSize = childDimension;</span><br><span class="line">          resultMode = MeasureSpec.EXACTLY;</span><br><span class="line">      } <span class="keyword">else</span> <span class="keyword">if</span> (childDimension == LayoutParams.MATCH_PARENT) {</span><br><span class="line">          <span class="comment">// child&#x8981;&#x8DDF;parent&#x4E00;&#x6837;&#x5927;&#xFF0C;resultSize=&#x53EF;&#x7528;&#x5927;&#x5C0F;</span></span><br><span class="line">          resultSize = size;</span><br><span class="line">        <span class="comment">//&#x56E0;&#x4E3A;parent&#x662F;AT_MOST&#xFF0C;child&#x7684;&#x5927;&#x5C0F;&#x4E5F;&#x8FD8;&#x662F;&#x672A;&#x5B9A;&#x7684;&#xFF0C;</span></span><br><span class="line">        <span class="comment">//&#x6240;&#x4EE5;&#x4E5F;&#x662F;MeasureSpec.AT_MOST</span></span><br><span class="line">          resultMode = MeasureSpec.AT_MOST;</span><br><span class="line">      } <span class="keyword">else</span> <span class="keyword">if</span> (childDimension == LayoutParams.WRAP_CONTENT) {</span><br><span class="line">          <span class="comment">//&#x53C8;&#x662F;&#x7279;&#x6B8A;&#x60C5;&#x51B5;&#xFF0C;&#x5148;&#x7ED9;child&#x53EF;&#x7528;&#x7684;&#x5927;&#x5C0F;</span></span><br><span class="line">          resultSize = size;</span><br><span class="line">          resultMode = MeasureSpec.AT_MOST;</span><br><span class="line">      }</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// &#x8FD9;&#x79CD;&#x6A21;&#x5F0F;&#x662F;&#x5F88;&#x5C11;&#x7528;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x4E5F;&#x770B;&#x4E0B;&#x5427;</span></span><br><span class="line">  <span class="keyword">case</span> MeasureSpec.UNSPECIFIED:</span><br><span class="line">      <span class="keyword">if</span> (childDimension &gt;= <span class="number">0</span>) {</span><br><span class="line">          <span class="comment">// &#x4E0E;&#x524D;&#x9762;&#x540C;&#x6837;&#x7684;&#x5904;&#x7406;</span></span><br><span class="line">          resultSize = childDimension;</span><br><span class="line">          resultMode = MeasureSpec.EXACTLY;</span><br><span class="line">      } <span class="keyword">else</span> <span class="keyword">if</span> (childDimension == LayoutParams.MATCH_PARENT) {</span><br><span class="line">          <span class="comment">// Child wants to be our size... find out how big it should</span></span><br><span class="line">          <span class="comment">// be</span></span><br><span class="line">          resultSize = View.sUseZeroUnspecifiedMeasureSpec ? <span class="number">0</span> : size;</span><br><span class="line">          resultMode = MeasureSpec.UNSPECIFIED;</span><br><span class="line">      } <span class="keyword">else</span> <span class="keyword">if</span> (childDimension == LayoutParams.WRAP_CONTENT) {</span><br><span class="line">          <span class="comment">// Child wants to determine its own size.... find out how</span></span><br><span class="line">          <span class="comment">// big it should be</span></span><br><span class="line">          resultSize = View.sUseZeroUnspecifiedMeasureSpec ? <span class="number">0</span> : size;</span><br><span class="line">          resultMode = MeasureSpec.UNSPECIFIED;</span><br><span class="line">      }</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">//&#x901A;&#x8FC7;&#x4F20;&#x5165;resultSize&#x548C;resultMode&#x751F;&#x6210;&#x4E00;&#x4E2A;MeasureSpec.&#x8FD4;&#x56DE;</span></span><br><span class="line">  <span class="keyword">return</span> MeasureSpec.makeMeasureSpec(resultSize, resultMode);</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x4EE3;&#x7801;&#x633A;&#x957F;&#x7684; &#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#xFF1A;</p>
<ul>
<li>&#x5F53;&#x5B50;View&#x91C7;&#x7528;&#x5177;&#x4F53;&#x6570;&#x503C;&#xFF08;dp / px&#xFF09;&#x65F6;<br>&#x65E0;&#x8BBA;&#x7236;&#x5BB9;&#x5668;&#x7684;&#x6D4B;&#x91CF;&#x6A21;&#x5F0F;&#x662F;&#x4EC0;&#x4E48;&#xFF0C;&#x5B50;View&#x7684;&#x6D4B;&#x91CF;&#x6A21;&#x5F0F;&#x90FD;&#x662F;EXACTLY&#x4E14;&#x5927;&#x5C0F;&#x7B49;&#x4E8E;&#x8BBE;&#x7F6E;&#x7684;&#x5177;&#x4F53;&#x6570;&#x503C;&#xFF1B;</li>
<li>&#x5F53;&#x5B50;View&#x91C7;&#x7528;match_parent&#x65F6;<ul>
<li>&#x5B50;View&#x7684;&#x6D4B;&#x91CF;&#x6A21;&#x5F0F;&#x4E0E;&#x7236;&#x5BB9;&#x5668;&#x7684;&#x6D4B;&#x91CF;&#x6A21;&#x5F0F;&#x4E00;&#x81F4;</li>
<li>&#x82E5;&#x6D4B;&#x91CF;&#x6A21;&#x5F0F;&#x4E3A;EXACTLY&#xFF0C;&#x5219;&#x5B50;View&#x7684;&#x5927;&#x5C0F;&#x4E3A;&#x7236;&#x5BB9;&#x5668;&#x7684;&#x5269;&#x4F59;&#x7A7A;&#x95F4;&#xFF1B;&#x82E5;&#x6D4B;&#x91CF;&#x6A21;&#x5F0F;&#x4E3A;AT_MOST&#xFF0C;&#x5219;&#x5B50;View&#x7684;&#x5927;&#x5C0F;&#x4E0D;&#x8D85;&#x8FC7;&#x7236;&#x5BB9;&#x5668;&#x7684;&#x5269;&#x4F59;&#x7A7A;&#x95F4;</li>
</ul>
</li>
<li>&#x5F53;&#x5B50;View&#x91C7;&#x7528;wrap_parent&#x65F6;<br>&#x65E0;&#x8BBA;&#x7236;&#x5BB9;&#x5668;&#x7684;&#x6D4B;&#x91CF;&#x6A21;&#x5F0F;&#x662F;&#x4EC0;&#x4E48;&#xFF0C;&#x5B50;View&#x7684;&#x6D4B;&#x91CF;&#x6A21;&#x5F0F;&#x90FD;&#x662F;AT_MOST&#x4E14;&#x5927;&#x5C0F;&#x4E0D;&#x8D85;&#x8FC7;&#x7236;&#x5BB9;&#x5668;&#x7684;&#x5269;&#x4F59;&#x7A7A;&#x95F4;&#x3002;</li>
</ul>
<h2 id="&#x5355;&#x4E00;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x8BE6;&#x89E3;">&#x5355;&#x4E00;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x8BE6;&#x89E3;</h2><p><img src="/2017/06/15/Android&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x8BE6;&#x89E3;/2.png" alt="logo"><br>&#x8FD8;&#x662F;&#x56DE;&#x987E;&#x4E00;&#x4E0B;&#x521A;&#x624D;&#x8FD9;&#x5F20;&#x56FE;&#xFF0C;&#x6211;&#x4EEC;&#x4E00;&#x4E2A;&#x6B65;&#x9AA4;&#x4E00;&#x4E2A;&#x6B65;&#x9AA4;&#x7684;&#x6765;&#x770B;&#xFF1A;</p>
<h3 id="performMeasure()">performMeasure()</h3><p>&#x8FD9;&#x4E2A;&#x56FE;&#x5176;&#x5B9E;&#x4E0D;&#x662F;&#x90A3;&#x4E48;&#x4E25;&#x8C28;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x52A0;&#x8F7D;&#x597D;&#x7CFB;&#x7EDF;&#x5E03;&#x5C40;&#x8D44;&#x6E90;&#x540E;&#xFF0C;&#x4F1A;&#x89E6;&#x53D1;ViewRootImpl&#x7684;performTraversals()&#x65B9;&#x6CD5;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x5185;&#x5BB9;&#x4F1A;&#x5F00;&#x59CB;&#x6267;&#x884C;&#x6D4B;&#x91CF;&#x3001;&#x5E03;&#x5C40;&#x548C;&#x7ED8;&#x5236;&#x7684;&#x5DE5;&#x4F5C;&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x6E90;&#x7801;&#x5173;&#x952E;&#x90E8;&#x5206;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">performTraversals</span><span class="params">()</span> </span>{</span><br><span class="line">      ...</span><br><span class="line">  <span class="keyword">if</span> (!mStopped) {</span><br><span class="line">    <span class="comment">//1&#x3001;&#x83B7;&#x53D6;&#x9876;&#x5C42;&#x5E03;&#x5C40;&#x7684;childWidthMeasureSpec</span></span><br><span class="line">      <span class="keyword">int</span> childWidthMeasureSpec = getRootMeasureSpec(mWidth, lp.width);  </span><br><span class="line">    <span class="comment">//2&#x3001;&#x83B7;&#x53D6;&#x9876;&#x5C42;&#x5E03;&#x5C40;&#x7684;childHeightMeasureSpec</span></span><br><span class="line">      <span class="keyword">int</span> childHeightMeasureSpec = getRootMeasureSpec(mHeight, lp.height);</span><br><span class="line">      <span class="comment">//3&#x3001;&#x6D4B;&#x91CF;&#x5F00;&#x59CB;&#x6D4B;&#x91CF;</span></span><br><span class="line">      performMeasure(childWidthMeasureSpec, childHeightMeasureSpec);       </span><br><span class="line">      }</span><br><span class="line">  } </span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (didLayout) {</span><br><span class="line">    <span class="comment">//4&#x3001;&#x6267;&#x884C;&#x5E03;&#x5C40;&#x65B9;&#x6CD5;</span></span><br><span class="line">      performLayout(lp, desiredWindowWidth, desiredWindowHeight);</span><br><span class="line">      ...</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span> (!cancelDraw &amp;&amp; !newSurface) {</span><br><span class="line">   ...</span><br><span class="line">    <span class="comment">//5&#x3001;&#x5F00;&#x59CB;&#x7ED8;&#x5236;&#x4E86;&#x54E6;</span></span><br><span class="line">          performDraw();</span><br><span class="line">      }</span><br><span class="line">  } </span><br><span class="line">  ...</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x6574;&#x4E2A;&#x65B9;&#x6CD5;&#x5185;&#x90E8;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x505A;&#x4E86;&#x4E00;&#x4E9B;&#x57FA;&#x7840;&#x7684;&#x5224;&#x65AD;&#x540E;&#xFF0C;&#x518D;&#x987A;&#x5E8F;&#x7684;&#x8C03;&#x7528;&#x6D4B;&#x91CF;&#x3001;&#x5E03;&#x5C40;&#x548C;&#x7ED8;&#x5236;&#x7684;&#x76F8;&#x5173;&#x65B9;&#x6CD5;&#xFF0C;&#x4ECE;&#x800C;&#x5B8C;&#x6210;&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x6574;&#x4E2A;&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;&#x3002;<br>&#x73B0;&#x5728;&#x770B;performTraversals&#x65B9;&#x6CD5;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x6CE8;&#x91CA;&#x548C;&#x7B2C;&#x4E8C;&#x4E2A;&#x6CE8;&#x91CA;&#x5904;&#xFF0C;&#x4F7F;&#x7528;&#x7684;&#x662F;getRootMeasureSpec&#x65B9;&#x6CD5;&#x6765;&#x83B7;&#x53D6;&#x5B50;View&#x7684;MeasureSpec&#xFF0C;&#x6839;&#x636E;&#x4E00;&#x5F00;&#x59CB;&#x6211;&#x4EEC;&#x4E86;&#x89E3;&#x7684;&#x77E5;&#x8BC6;&#xFF0C;&#x6574;&#x4E2A;Activity&#x7684;&#x9876;&#x5C42;View&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x4E00;&#x4E2A;DecorView&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x83B7;&#x53D6;&#x7684;&#x5176;&#x5B9E;&#x662F;DeorView&#x7684;MeasureSpec&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x5176;&#x4F20;&#x5165;performMeasure&#x65B9;&#x6CD5;&#x4E2D;&#x53BB;&#x5F00;&#x59CB;&#x6D4B;&#x91CF;&#xFF0C;&#x73B0;&#x5728;&#x770B;&#x770B;PerformMeasure&#x65B9;&#x6CD5;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">performMeasure</span><span class="params">(<span class="keyword">int</span> childWidthMeasureSpec, </span><br><span class="line">  <span class="keyword">int</span> childHeightMeasureSpec)</span> </span>{</span><br><span class="line">Trace.traceBegin(Trace.TRACE_TAG_VIEW, <span class="string">&quot;measure&quot;</span>);</span><br><span class="line"><span class="keyword">try</span> {</span><br><span class="line">  <span class="comment">//1&#x3001;mView&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x7684;&#x9876;&#x5C42;DecorView&#xFF0C;&#x4ECE;DecorView&#x5F00;&#x59CB;&#x6D4B;&#x91CF;</span></span><br><span class="line">  mView.measure(childWidthMeasureSpec, childHeightMeasureSpec);</span><br><span class="line">} <span class="keyword">finally</span> {</span><br><span class="line">  Trace.traceEnd(Trace.TRACE_TAG_VIEW);</span><br><span class="line">}</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h3 id="measure()">measure()</h3><p>&#x6839;&#x636E;&#x521A;&#x624D;&#x63CF;&#x8FF0;&#x7684;&#x5355;&#x4E00;View&#x7684;&#x52A0;&#x8F7D;&#x8FC7;&#x7A0B;&#xFF0C;&#x6211;&#x4EEC;&#x5728;View&#x7684;&#x6E90;&#x7801;&#x4E2D;&#x627E;&#x5230;&#x4E86;measure&#x65B9;&#x6CD5;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">measure</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec,</span><br><span class="line"> <span class="keyword">int</span>  heightMeasureSpec)</span> </span>{</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">onMeasure(widthMeasureSpec, heightMeasureSpec);</span><br><span class="line">...</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x6709;&#x4E00;&#x4E2A;&#x7EC6;&#x8282;&#x8981;&#x6CE8;&#x610F;&#x4EE5;&#x4E0B;<br>&#x9996;&#x5148;&#xFF0C;ViewGroup&#x4E2D;&#x5E76;&#x6CA1;&#x6709;&#x91CD;&#x5199;View&#x7684;onMeasure&#x65B9;&#x6CD5;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x7684;&#x56DB;&#x5927;&#x5E03;&#x5C40;FrameLayout LinearLayout RelativeLayout AbsoluteLayout&#x90FD;&#x662F;&#x901A;&#x8FC7;&#x7EE7;&#x627F;ViewGroup&#x6765;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x800C;&#x4E14;&#x91CC;&#x9762;&#x4E5F;&#x91CD;&#x5199;onMeasure&#x65B9;&#x6CD5;&#xFF0C;&#x6240;&#x4EE5;onMeasure&#x65B9;&#x6CD5;&#x662F;&#x5206;&#x4E3A;&#x4E24;&#x4E2A;&#x65B9;&#x5411;&#x7684;&#xFF0C;&#x5355;&#x4E00;View&#x7684;&#x6D4B;&#x91CF;&#x662F;View.onMeasure&#x800C;ViewGroup&#x7684;&#x6D4B;&#x91CF;&#x5219;&#x662F;XXLayout.onMeasure&#xFF0C;&#x8FD9;&#x4E24;&#x79CD;onMeasure&#x65B9;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x3002;</p>
</blockquote>
<h3 id="View-onMeasure()">View.onMeasure()</h3><p>&#x5176;&#x5B9E;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x5173;&#x952E;&#x4F5C;&#x7528;&#x6709;&#x4E09;&#x4E2A;&#xFF1A;<br>&#x7B2C;&#x4E00;&#xFF0C;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x5EFA;&#x8BAE;&#x6700;&#x5C0F;&#x503C;&#x3002;<br>&#x7B2C;&#x4E8C;&#xFF0C;&#x8C03;&#x7528;getDefaultSize&#x65B9;&#x6CD5;&#x5B9A;&#x4E49;&#x5BF9;View&#x5C3A;&#x5BF8;&#x7684;&#x6D4B;&#x91CF;&#x903B;&#x8F91;&#x3002;<br>&#x7B2C;&#x4E09;&#xFF0C;&#x8C03;&#x7528;setMeasureDimension()&#x50A8;&#x5B58;&#x6D4B;&#x91CF;&#x540E;&#x7684;View&#x5BBD;/&#x9AD8;&#x3002;</p>
<p>&#x6E90;&#x7801;&#x5982;&#x4E0B;:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onMeasure</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec, </span><br><span class="line"><span class="keyword">int</span> heightMeasureSpec)</span> </span>{</span><br><span class="line"> setMeasuredDimension(</span><br><span class="line">    getDefaultSize(getSuggestedMinimumWidth(),</span><br><span class="line">                                widthMeasureSpec),</span><br><span class="line">    getDefaultSize(getSuggestedMinimumHeight(),</span><br><span class="line">                                 heightMeasureSpec));</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x9006;&#x5411;&#x601D;&#x7EF4;&#xFF0C;&#x4ECE;&#x6700;&#x5185;&#x5C42;&#x5F00;&#x59CB;&#x8BF4;&#x8D77;&#xFF1A;</p>
<h3 id="getSuggestedMinimumWidth()_/_getSuggestedMinimumHeight()">getSuggestedMinimumWidth() / getSuggestedMinimumHeight()</h3><p>&#x6E90;&#x7801;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">int</span> <span class="title">getSuggestedMinimumWidth</span><span class="params">()</span> </span>{</span><br><span class="line">  <span class="keyword">return</span> (mBackground == <span class="keyword">null</span>) ? mMinWidth : max(mMinWidth, mBackground.getMinimumWidth());</span><br><span class="line">  }</span><br></pre></td></tr></table></figure></p>
<p>&#x4EE3;&#x7801;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x662F;&#x4E00;&#x4E2A;&#x4E09;&#x76EE;&#x8FD0;&#x7B97;&#xFF0C;&#x610F;&#x601D;&#x5C31;&#x662F;&#x5F53;&#x524D;View&#x662F;&#x5426;&#x6709;&#x80CC;&#x666F;?&#x6CA1;&#x6709;&#x5C31;&#x8FD4;&#x56DE;android:minWidth&#x8BBE;&#x7F6E;&#x7684;&#x503C;:&#x6709;&#x5C31;&#x8FD4;&#x56DE;android:minWidth&#x548C;mBackground.getMinimumWidth()&#x4E2D;&#x8F83;&#x5927;&#x7684;&#x90A3;&#x4E2A;&#x503C;&#x3002;<br>&#x90A3;&#x4E48;&#xFF0C;mBackground.getMinimumWidth()&#x65B9;&#x6CD5;&#x6709;&#x662F;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMinimumWidth</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> intrinsicWidth = getIntrinsicWidth();</span><br><span class="line">    <span class="comment">//&#x8FD4;&#x56DE;&#x80CC;&#x666F;&#x56FE;Drawable&#x7684;&#x539F;&#x59CB;&#x5BBD;&#x5EA6;</span></span><br><span class="line">    <span class="keyword">return</span> intrinsicWidth &gt; <span class="number">0</span> ? intrinsicWidth :<span class="number">0</span> ;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8BE5;&#x5904;&#x903B;&#x8F91;&#x4E00;&#x6837;&#x662F;&#x4E09;&#x76EE;&#x8FD0;&#x7B97;&#xFF0C;getIntrinsicWidth()&#x83B7;&#x53D6;&#x7684;&#x662F;&#x80CC;&#x666F;&#x56FE;&#x7684;&#x539F;&#x59CB;&#x5BBD;&#x5EA6;&#xFF0C;&#x80CC;&#x666F;&#x56FE;&#x662F;BitmapDrawable&#x5219;&#x6709;&#x539F;&#x59CB;&#x5BBD;&#x5EA6;&#xFF0C;&#x5728;&#x6CA1;&#x6709;&#x539F;&#x59CB;&#x5BBD;&#x5EA6;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x5219;&#x8FD4;&#x56DE;0&#x3002;</p>
<h3 id="getDefaultSize()">getDefaultSize()</h3><p>&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x5176;&#x5B9E;&#x662F;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x5DE5;&#x5177;&#x65B9;&#x6CD5;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getDefaultSize</span><span class="params">(<span class="keyword">int</span> size, <span class="keyword">int</span> measureSpec)</span> </span>{</span><br><span class="line">  <span class="keyword">int</span> result = size;</span><br><span class="line"> <span class="comment">//1&#x3001;&#x83B7;&#x5F97;MeasureSpec&#x7684;mode</span></span><br><span class="line">  <span class="keyword">int</span> specMode = MeasureSpec.getMode(measureSpec);</span><br><span class="line"> <span class="comment">//2&#x3001;&#x83B7;&#x5F97;MeasureSpec&#x7684;specSize</span></span><br><span class="line">  <span class="keyword">int</span> specSize = MeasureSpec.getSize(measureSpec);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> (specMode) {</span><br><span class="line">  <span class="keyword">case</span> MeasureSpec.UNSPECIFIED:</span><br><span class="line">    <span class="comment">//&#x8FD9;&#x4E2A;&#x6211;&#x4EEC;&#x5148;&#x4E0D;&#x770B;&#x4ED6;</span></span><br><span class="line">      result = size;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> MeasureSpec.AT_MOST:</span><br><span class="line">  <span class="keyword">case</span> MeasureSpec.EXACTLY:</span><br><span class="line">  <span class="comment">//3&#x3001;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x6700;&#x7EC8;&#x8FD4;&#x56DE;&#x7684;size&#x5C31;&#x662F;&#x6211;&#x4EEC;MeasureSpec&#x4E2D;&#x6D4B;&#x91CF;&#x5F97;&#x5230;&#x7684;size</span></span><br><span class="line">      result = specSize;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x5927;&#x5BB6;&#x5E94;&#x8BE5;&#x6CE8;&#x610F;&#x5230;&#x4E86;&#xFF0C;&#x4E0D;&#x8BBA;&#x6D4B;&#x91CF;&#x6A21;&#x5F0F;&#x662F;AT_MOST&#x8FD8;&#x662F;EXACTLY&#xFF0C;&#x6700;&#x7EC8;&#x8FD4;&#x56DE;&#x7684;Size&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x518D;&#x56DE;&#x60F3;&#x4E4B;&#x524D;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x6211;&#x4EEC;&#x8BBE;&#x7F6E;wrap_content&#x65F6;match_parent&#x6548;&#x679C;&#x4E00;&#x6837;&#x5462;&#xFF1F;</p>
<p>&#x539F;&#x56E0;&#x5176;&#x5B9E;&#x5C31;&#x5728;&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x5E76;&#x6CA1;&#x6709;&#x91CD;&#x5199;&#x5B50;View&#x91C7;&#x7528;wrap_content&#x65F6;&#x7684;&#x6D4B;&#x91CF;&#x65B9;&#x6CD5;&#xFF0C;&#x6240;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;View&#x4E0D;&#x8BBA;&#x7236;&#x89C6;&#x56FE;&#x7684;&#x5E03;&#x5C40;&#x6A21;&#x5F0F;&#x662F;EXACTLY(&#x975E;&#x56FA;&#x5B9A;&#x503C;&#x6A21;&#x5F0F;)&#x8FD8;&#x662F;AT_MOST&#x4E5F;&#x4E0D;&#x8BBA;&#x5B50;&#x89C6;&#x56FE;&#x7684;&#x5E03;&#x5C40;&#x6A21;&#x5F0F;&#x662F;match_parent&#x8FD8;&#x662F;wrap_content&#xFF08;&#x53EA;&#x8981;&#x4E0D;&#x662F;&#x5177;&#x4F53;&#x7684;&#x503C;&#xFF09;&#xFF0C;&#x7CFB;&#x7EDF;&#x90FD;&#x4F1A;&#x5C06;&#x5B50;View&#x7684;&#x5927;&#x5C0F;(&#x5BBD;&#x6216;&#x9AD8;)&#x90FD;&#x4E34;&#x65F6;&#x6216;&#x6C38;&#x4E45;&#x8BBE;&#x7F6E;&#x6210;Size(&#x5269;&#x4F59;&#x7684;&#x53EF;&#x7528;&#x5927;&#x5C0F;)&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8FD9;&#x4E24;&#x79CD;&#x6A21;&#x5F0F;&#x6240;&#x5F62;&#x6210;&#x7684;&#x6548;&#x679C;&#x5C31;&#x4F1A;&#x4E00;&#x6837;&#x4E86;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x5728;&#x5B9E;&#x9645;&#x5F00;&#x53D1;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x8981;&#x5904;&#x7406;wrap_content&#x8FD9;&#x4E2A;&#x60C5;&#x51B5;&#xFF0C;&#x5426;&#x5219;wrap_content&#x548C;match_parent&#x7684;&#x6548;&#x679C;&#x5C31;&#x662F;&#x4E00;&#x6837;&#x7684;&#x4E86;&#x3002;</p>
<h3 id="setMeasureDimension">setMeasureDimension</h3><p>&#x8BE5;&#x65B9;&#x6CD5;&#x662F;&#x50A8;&#x5B58;&#x6D4B;&#x91CF;&#x540E;&#x7684;View&#x7684;&#x5BBD;&#x548C;&#x9AD8;&#x7684;&#xFF0C;&#x5728;&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x4EEC;&#x81EA;&#x5DF1;&#x91CD;&#x5199;&#x7684;onMeasure&#x65B9;&#x6CD5;&#x6700;&#x540E;&#x4E00;&#x5B9A;&#x8981;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x62A5;&#x9519;&#x3002;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setMeasuredDimension</span><span class="params">(<span class="keyword">int</span> measuredWidth, <span class="keyword">int</span> measuredHeight)</span> </span>{</span><br><span class="line">    <span class="comment">//1&#x3001;&#x5224;&#x65AD;&#x662F;&#x5426;&#x4F7F;&#x7528;&#x89C6;&#x89C9;&#x8FB9;&#x754C;&#x5E03;&#x5C40;</span></span><br><span class="line">  <span class="keyword">boolean</span> optical = isLayoutModeOptical(<span class="keyword">this</span>);</span><br><span class="line">  <span class="comment">//2&#x3001;&#x5224;&#x65AD;view&#x548C;parentView&#x4F7F;&#x7528;&#x7684;&#x89C6;&#x89C9;&#x8FB9;&#x754C;&#x5E03;&#x5C40;&#x662F;&#x5426;&#x4E00;&#x81F4;</span></span><br><span class="line">  <span class="keyword">if</span> (optical != isLayoutModeOptical(mParent)) {</span><br><span class="line">      <span class="comment">//&#x4E0D;&#x4E00;&#x81F4;&#x65F6;&#x8981;&#x505A;&#x4E00;&#x4E9B;&#x8FB9;&#x754C;&#x7684;&#x5904;&#x7406;</span></span><br><span class="line">      Insets insets = getOpticalInsets();</span><br><span class="line">      <span class="keyword">int</span> opticalWidth  = insets.left + insets.right;</span><br><span class="line">      <span class="keyword">int</span> opticalHeight = insets.top  + insets.bottom;</span><br><span class="line"></span><br><span class="line">      measuredWidth  += optical ? opticalWidth  : -opticalWidth;</span><br><span class="line">      measuredHeight += optical ? opticalHeight : -opticalHeight;</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">//3&#x3001;&#x91CD;&#x70B9;&#x6765;&#x4E86;&#xFF0C;&#x7ECF;&#x8FC7;&#x8FC7;&#x6EE4;&#x4E4B;&#x540E;&#x8C03;&#x7528;&#x4E86;setMeasuredDimensionRaw&#x65B9;&#x6CD5;&#xFF0C;&#x770B;&#x6765;&#x5E94;&#x8BE5;&#x662F;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x8BBE;&#x7F6E;&#x6211;&#x4EEC;&#x7684;view&#x7684;&#x5927;&#x5C0F;</span></span><br><span class="line">  setMeasuredDimensionRaw(measuredWidth, measuredHeight);</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x7EE7;&#x7EED;&#x770B;setMeasureDimensionRaw&#x65B9;&#x6CD5;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setMeasuredDimensionRaw</span><span class="params">(<span class="keyword">int</span> measuredWidth, <span class="keyword">int</span> measuredHeight)</span> </span>{</span><br><span class="line">  <span class="comment">//&#x6700;&#x7EC8;&#x5C06;&#x6D4B;&#x91CF;&#x597D;&#x7684;&#x5927;&#x5C0F;&#x5B58;&#x50A8;&#x5230;mMeasuredWidth&#x548C;mMeasuredHeight&#x4E0A;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x6D4B;&#x91CF;&#x4E4B;&#x540E;</span></span><br><span class="line">  <span class="comment">//&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528;getMeasuredWidth&#x83B7;&#x5F97;&#x6D4B;&#x91CF;&#x7684;&#x5BBD;&#x3001;getMeasuredHeight&#x83B7;&#x5F97;&#x9AD8;</span></span><br><span class="line">  mMeasuredWidth = measuredWidth;</span><br><span class="line">  mMeasuredHeight = measuredHeight;</span><br><span class="line"></span><br><span class="line">  mPrivateFlags |= PFLAG_MEASURED_DIMENSION_SET;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x4EE5;&#x4E0A;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x5355;&#x4E00;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x4E86;&#xFF0C;&#x5176;&#x987A;&#x5E8F;&#x4E3A;&#xFF1A;<br>performTraversals-&gt;performMeasure-&gt;measure-&gt;onMeasure-&gt; setMeasuredDimension-&gt; setMeasuredDimensionRaw&#xFF0C;&#x7531;setMeasuredDimensionRaw&#x6700;&#x7EC8;&#x4FDD;&#x5B58;&#x6D4B;&#x91CF;&#x7684;&#x6570;&#x636E;&#x3002;</p>
<h2 id="ViewGroup&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x8BE6;&#x89E3;">ViewGroup&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x8BE6;&#x89E3;</h2><p><img src="/2017/06/15/Android&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x8BE6;&#x89E3;/6.png" alt="logo"><br>&#x6839;&#x636E;&#x4E0A;&#x56FE;&#xFF0C;&#x6211;&#x4EEC;&#x8FD8;&#x662F;&#x4E00;&#x4E2A;&#x6B65;&#x9AA4;&#x4E00;&#x4E2A;&#x6B65;&#x9AA4;&#x7684;&#x8FDB;&#x884C;&#x5206;&#x6790;&#xFF1A;</p>
<h3 id="measureChildren()">measureChildren()</h3><p>&#x5176;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x904D;&#x5386;&#x5B50;View&#x5E76;&#x8C03;&#x7528;measureChild()&#x8FDB;&#x884C;&#x4E0B;&#x4E00;&#x6B65;&#x6D4B;&#x91CF;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">measureChildren</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec, <span class="keyword">int</span> heightMeasureSpec)</span> </span>{</span><br><span class="line"><span class="comment">//&#x53C2;&#x6570;&#x8BF4;&#x660E;&#xFF1A;&#x7236;&#x89C6;&#x56FE;&#x7684;&#x6D4B;&#x91CF;&#x89C4;&#x683C;&#xFF08;MeasureSpec&#xFF09;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> size = mChildrenCount;</span><br><span class="line">        <span class="keyword">final</span> View[] children = mChildren;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//&#x904D;&#x5386;&#x6240;&#x6709;&#x7684;&#x5B50;view</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; ++i) {</span><br><span class="line">            <span class="keyword">final</span> View child = children[i];</span><br><span class="line">        <span class="comment">//&#x5982;&#x679C;View&#x7684;&#x72B6;&#x6001;&#x4E0D;&#x662F;GONE&#x5C31;&#x8C03;&#x7528;measureChild()&#x53BB;&#x8FDB;&#x884C;&#x4E0B;&#x4E00;&#x6B65;&#x7684;&#x6D4B;&#x91CF;</span></span><br><span class="line">            <span class="keyword">if</span> ((child.mViewFlags &amp; VISIBILITY_MASK) != GONE) {</span><br><span class="line">                measureChild(child, widthMeasureSpec, heightMeasureSpec);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure></p>
<h3 id="measureChild()">measureChild()</h3><p>&#x5176;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x8BA1;&#x7B97;&#x5355;&#x4E2A;&#x5B50;View&#x7684;MeasureSpec&#xFF0C;&#x8C03;&#x7528;&#x5B50;View&#x7684;measure&#x8FDB;&#x884C;&#x6BCF;&#x4E2A;&#x5B50;View&#x6700;&#x540E;&#x7684;&#x5BBD;&#x3001;&#x9AD8;&#x7684;&#x6D4B;&#x91CF;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">measureChild</span><span class="params">(View child, <span class="keyword">int</span> parentWidthMeasureSpec,</span><br><span class="line">            <span class="keyword">int</span> parentHeightMeasureSpec)</span> </span>{</span><br><span class="line"></span><br><span class="line">        <span class="comment">// &#x83B7;&#x53D6;&#x5B50;&#x89C6;&#x56FE;&#x7684;&#x5E03;&#x5C40;&#x53C2;&#x6570;</span></span><br><span class="line">        <span class="keyword">final</span> LayoutParams lp = child.getLayoutParams();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// &#x8C03;&#x7528;getChildMeasureSpec()&#xFF0C;&#x6839;&#x636E;&#x7236;&#x89C6;&#x56FE;&#x7684;MeasureSpec &amp; &#x5E03;&#x5C40;&#x53C2;&#x6570;LayoutParams&#xFF0C;&#x8BA1;&#x7B97;&#x5355;&#x4E2A;&#x5B50;View&#x7684;MeasureSpec</span></span><br><span class="line">         <span class="comment">// getChildMeasureSpec()&#x8BF7;&#x56DE;&#x770B;&#x4E0A;&#x9762;&#x7684;&#x89E3;&#x6790;</span></span><br><span class="line">         <span class="comment">// &#x83B7;&#x53D6; ChildView &#x7684; widthMeasureSpec</span></span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> childWidthMeasureSpec = getChildMeasureSpec(parentWidthMeasureSpec,</span><br><span class="line">                mPaddingLeft + mPaddingRight, lp.width);</span><br><span class="line">		<span class="comment">// &#x83B7;&#x53D6; ChildView &#x7684; heightMeasureSpec</span></span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> childHeightMeasureSpec = getChildMeasureSpec(parentHeightMeasureSpec,</span><br><span class="line">                mPaddingTop + mPaddingBottom, lp.height);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// &#x5C06;&#x8BA1;&#x7B97;&#x597D;&#x7684;&#x5B50;View&#x7684;MeasureSpec&#x503C;&#x4F20;&#x5165;measure()&#xFF0C;&#x8FDB;&#x884C;&#x6700;&#x540E;&#x7684;&#x6D4B;&#x91CF;</span></span><br><span class="line">        child.measure(childWidthMeasureSpec, childHeightMeasureSpec);</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>
<h3 id="measure()-1">measure()</h3><p>&#x4E0E;&#x5355;&#x4E00;View&#x7684;measure&#x4E00;&#x81F4;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">measure</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec, <span class="keyword">int</span> heightMeasureSpec)</span> </span>{</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">int</span> cacheIndex = (mPrivateFlags &amp; PFLAG_FORCE_LAYOUT) == PFLAG_FORCE_LAYOUT ? -<span class="number">1</span> :</span><br><span class="line">            mMeasureCache.indexOfKey(key);</span><br><span class="line">    <span class="keyword">if</span> (cacheIndex &lt; <span class="number">0</span> || sIgnoreMeasureCache) {</span><br><span class="line"></span><br><span class="line">        <span class="comment">// &#x8C03;&#x7528;onMeasure()&#x8BA1;&#x7B97;&#x89C6;&#x56FE;&#x5927;&#x5C0F;</span></span><br><span class="line">        onMeasure(widthMeasureSpec, heightMeasureSpec);</span><br><span class="line">        mPrivateFlags3 &amp;= ~PFLAG3_MEASURE_NEEDED_BEFORE_LAYOUT;</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="XXXLayout-onMeasure()">XXXLayout.onMeasure()</h3><p>&#x4ED4;&#x7EC6;&#x770B;&#x8FC7;&#x6587;&#x7AE0;&#x524D;&#x9762;&#x7684;&#x670B;&#x53CB;&#x5E94;&#x8BE5;&#x8BB0;&#x5F97;&#x6211;&#x5728;4.2 measure() &#x4E2D;&#x63D0;&#x5230;&#x8FC7;&#xFF0C;ViewGroup&#x7684;onMeasure&#x548C;View&#x7684;onMeasure&#x662F;&#x4E0D;&#x540C;&#x7684;&#xFF0C;&#x7A76;&#x5176;&#x539F;&#x56E0;&#x5176;&#x5B9E;&#x662F;&#x56E0;&#x4E3A;ViewGroup&#x662F;&#x4E00;&#x4E2A;&#x62BD;&#x8C61;&#x7C7B;&#xFF0C;&#x6240;&#x4EE5;&#x5373;&#x4FBF;&#x5B83;&#x7EE7;&#x627F;&#x4E86;View&#x4E5F;&#x4E0D;&#x7528;&#x5FC5;&#x987B;&#x5B9E;&#x73B0;View&#x4E2D;&#x7684;onMeasure&#x65B9;&#x6CD5;&#xFF0C;&#x800C;&#x5B83;&#x7684;&#x5B50;&#x7C7B;&#x4E0D;&#x5177;&#x5907;&#x901A;&#x7528;&#x7684;&#x5E03;&#x5C40;&#x7279;&#x6027;&#xFF0C;&#x8FD9;&#x5BFC;&#x81F4;&#x4ED6;&#x4EEC;&#x7684;&#x5B50;View&#x7684;&#x6D4B;&#x91CF;&#x65B9;&#x6CD5;&#x5404;&#x4E0D;&#x76F8;&#x540C;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;ViewGroup&#x65E0;&#x6CD5;&#x5BF9;onMeasure()&#x505A;&#x7EDF;&#x4E00;&#x7684;&#x5B9E;&#x73B0;&#x3002;<br>&#x8FD9;&#x91CC;&#x4EE5;FrameLayout&#x4E3A;&#x4F8B;&#xFF0C;&#x770B;&#x770B;&#x5B83;&#x7684;onMeasure&#x662F;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x7684;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//&#x8FD9;&#x91CC;&#x7684;widthMeasureSpec&#x3001;heightMeasureSpec</span></span><br><span class="line"><span class="comment">//&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x6211;&#x4EEC;frameLayout&#x53EF;&#x7528;&#x7684;widthMeasureSpec &#x3001;</span></span><br><span class="line"><span class="comment">//heightMeasureSpec</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onMeasure</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec, <span class="keyword">int</span> heightMeasureSpec)</span> </span>{</span><br><span class="line">  <span class="comment">//1&#x3001;&#x83B7;&#x5F97;frameLayout&#x4E0B;childView&#x7684;&#x4E2A;&#x6570;</span></span><br><span class="line">  <span class="keyword">int</span> count = getChildCount();</span><br><span class="line"><span class="comment">//2&#x3001;&#x770B;&#x8FD9;&#x91CC;&#x7684;&#x4EE3;&#x7801;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x524D;&#x9762;&#x7684;Measure&#x56FE;&#x6765;&#x8FDB;&#x884C;&#x5206;&#x6790;&#xFF0C;&#x56E0;&#x4E3A;&#x53EA;&#x8981;parent</span></span><br><span class="line"><span class="comment">//&#x4E0D;&#x662F;EXACTLY&#x6A21;&#x5F0F;&#xFF0C;&#x4EE5;frameLayout&#x4E3A;&#x4F8B;&#xFF0C;&#x5047;&#x8BBE;frameLayout&#x672C;&#x8EAB;&#x8FD8;&#x4E0D;&#x662F;EXACTL&#x6A21;&#x5F0F;&#xFF0C;</span></span><br><span class="line"> <span class="comment">// &#x90A3;&#x4E48;&#x8868;&#x793A;&#x4ED6;&#x7684;&#x5927;&#x5C0F;&#x6B64;&#x65F6;&#x8FD8;&#x662F;&#x4E0D;&#x786E;&#x5B9A;&#x7684;&#xFF0C;&#x4ECE;&#x8868;&#x5F97;&#x77E5;&#xFF0C;&#x6B64;&#x65F6;frameLayout&#x7684;&#x5927;&#x5C0F;&#x662F;&#x6839;&#x636E;</span></span><br><span class="line"> <span class="comment">//childView&#x7684;&#x6700;&#x5927;&#x503C;&#x6765;&#x8BBE;&#x7F6E;&#x7684;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x5F88;&#x597D;&#x7406;&#x89E3;&#x4E86;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;childView&#x6D4B;&#x91CF;&#x597D;&#x540E;&#x8FD8;&#x8981;&#x518D;</span></span><br><span class="line"><span class="comment">//&#x6D4B;&#x91CF;&#x4E00;&#x6B21;&#xFF0C;&#x56E0;&#x4E3A;&#x6B64;&#x65F6;frameLayout&#x7684;&#x503C;&#x5DF2;&#x7ECF;&#x53EF;&#x4EE5;&#x7B97;&#x51FA;&#x6765;&#x4E86;&#xFF0C;&#x5BF9;&#x4E8E;child&#x4E3A;MATCH_PARENT</span></span><br><span class="line"><span class="comment">//&#x7684;&#xFF0C;child&#x7684;&#x5927;&#x5C0F;&#x4E5F;&#x5C31;&#x786E;&#x5B9A;&#x4E86;&#xFF0C;&#x7406;&#x89E3;&#x4E86;&#x8FD9;&#x91CC;&#xFF0C;&#x540E;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x5C31;&#x5F88; &#x5BB9;&#x6613;&#x770B;&#x61C2;&#x4E86;</span></span><br><span class="line">  <span class="keyword">final</span> <span class="keyword">boolean</span> measureMatchParentChildren =</span><br><span class="line">          MeasureSpec.getMode(widthMeasureSpec) != MeasureSpec.EXACTLY ||</span><br><span class="line">          MeasureSpec.getMode(heightMeasureSpec) != MeasureSpec.EXACTLY;</span><br><span class="line">   <span class="comment">//3&#x3001;&#x6E05;&#x7406;&#x5B58;&#x50A8;&#x6A21;&#x5F0F;&#x4E3A;MATCH_PARENT&#x7684;child&#x7684;&#x961F;&#x5217;</span></span><br><span class="line">  mMatchParentChildren.clear();</span><br><span class="line">  <span class="comment">//4&#x3001;&#x4E0B;&#x9762;&#x4E09;&#x4E2A;&#x503C;&#x6700;&#x7EC8;&#x4F1A;&#x7528;&#x6765;&#x8BBE;&#x7F6E;frameLayout&#x7684;&#x5927;&#x5C0F;</span></span><br><span class="line">  <span class="keyword">int</span> maxHeight = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span> maxWidth = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span> childState = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">//5&#x3001;&#x5F00;&#x59CB;&#x4FBF;&#x5229;frameLayout&#x4E0B;&#x7684;&#x6240;&#x6709;child</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++) {</span><br><span class="line">      <span class="keyword">final</span> View child = getChildAt(i);</span><br><span class="line">      <span class="comment">//6&#x3001;&#x5C0F;&#x53D1;&#x73B0;&#x54E6;&#xFF0C;&#x53EA;&#x8981;mMeasureAllChildren&#x662F;true&#xFF0C;&#x5C31;&#x7B97;child&#x662F;GONE&#x4E5F;&#x4F1A;&#x88AB;&#x6D4B;&#x91CF;&#x54E6;&#xFF0C;</span></span><br><span class="line">      <span class="keyword">if</span> (mMeasureAllChildren || child.getVisibility() != GONE) {</span><br><span class="line">          <span class="comment">//7&#x3001;&#x5F00;&#x59CB;&#x6D4B;&#x91CF;childView </span></span><br><span class="line">          measureChildWithMargins(child, widthMeasureSpec, <span class="number">0</span>, heightMeasureSpec, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">          <span class="comment">//8&#x3001;&#x4E0B;&#x9762;&#x4EE3;&#x7801;&#x662F;&#x83B7;&#x53D6;child&#x4E2D;&#x7684;width &#x548C;height&#x7684;&#x6700;&#x5927;&#x503C;&#xFF0C;&#x540E;&#x9762;&#x7528;&#x6765;&#x91CD;&#x65B0;&#x8BBE;&#x7F6E;frameLayout&#xFF0C;&#x6709;&#x9700;&#x8981;&#x7684;&#x8BDD;</span></span><br><span class="line">          <span class="keyword">final</span> LayoutParams lp = (LayoutParams) child.getLayoutParams();</span><br><span class="line">          maxWidth = Math.max(maxWidth,</span><br><span class="line">                  child.getMeasuredWidth() + lp.leftMargin + lp.rightMargin);</span><br><span class="line">          maxHeight = Math.max(maxHeight,</span><br><span class="line">                  child.getMeasuredHeight() + lp.topMargin + lp.bottomMargin);</span><br><span class="line">          childState = combineMeasuredStates(childState, child.getMeasuredState());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//9&#x3001;&#x5982;&#x679C;frameLayout&#x4E0D;&#x662F;EXACTLY&#xFF0C;</span></span><br><span class="line">          <span class="keyword">if</span> (measureMatchParentChildren) {</span><br><span class="line">              <span class="keyword">if</span> (lp.width == LayoutParams.MATCH_PARENT ||</span><br><span class="line">                      lp.height == LayoutParams.MATCH_PARENT) {</span><br><span class="line"><span class="comment">//10&#x3001;&#x5B58;&#x50A8;LayoutParams.MATCH_PARENT&#x7684;child&#xFF0C;&#x56E0;&#x4E3A;&#x73B0;&#x5728;&#x8FD8;&#x4E0D;&#x77E5;&#x9053;frameLayout&#x5927;&#x5C0F;&#xFF0C;</span></span><br><span class="line"><span class="comment">//&#x4E5F;&#x5C31;&#x65E0;&#x6CD5;&#x8BBE;&#x7F6E;child&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x540E;&#x9762;&#x9700;&#x91CD;&#x65B0;&#x6D4B;&#x91CF;</span></span><br><span class="line">                  mMatchParentChildren.add(child);</span><br><span class="line">              }</span><br><span class="line">          }</span><br><span class="line">      }</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">    ....</span><br><span class="line">  <span class="comment">//11&#x3001;&#x8FD9;&#x91CC;&#x5F00;&#x59CB;&#x8BBE;&#x7F6E;frameLayout&#x7684;&#x5927;&#x5C0F;</span></span><br><span class="line">  setMeasuredDimension(resolveSizeAndState(maxWidth, widthMeasureSpec, childState),</span><br><span class="line">          resolveSizeAndState(maxHeight, heightMeasureSpec,</span><br><span class="line">                  childState &lt;&lt; MEASURED_HEIGHT_STATE_SHIFT));</span><br><span class="line"></span><br><span class="line"><span class="comment">//12&#x3001;frameLayout&#x5927;&#x5C0F;&#x786E;&#x8BA4;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x9700;&#x8981;&#x5BF9;&#x5BBD;&#x6216;&#x9AD8;&#x4E3A;LayoutParams.MATCH_PARENTchild&#x91CD;&#x65B0;&#x6D4B;&#x91CF;&#xFF0C;&#x8BBE;&#x7F6E;&#x5927;&#x5C0F;</span></span><br><span class="line">  count = mMatchParentChildren.size();</span><br><span class="line">  <span class="keyword">if</span> (count &gt; <span class="number">1</span>) {</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++) {</span><br><span class="line">          <span class="keyword">final</span> View child = mMatchParentChildren.get(i);</span><br><span class="line">          <span class="keyword">final</span> MarginLayoutParams lp = (MarginLayoutParams) child.getLayoutParams();</span><br><span class="line">          <span class="keyword">final</span> <span class="keyword">int</span> childWidthMeasureSpec;</span><br><span class="line">          <span class="keyword">if</span> (lp.width == LayoutParams.MATCH_PARENT) {</span><br><span class="line">              <span class="keyword">final</span> <span class="keyword">int</span> width = Math.max(<span class="number">0</span>, getMeasuredWidth()</span><br><span class="line">                      - getPaddingLeftWithForeground() - getPaddingRightWithForeground()</span><br><span class="line">                      - lp.leftMargin - lp.rightMargin);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//13&#x3001;&#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#xFF0C;&#x4E3A;child&#x662F;EXACTLY&#x7C7B;&#x578B;&#x7684;childWidthMeasureSpec&#xFF0C;</span></span><br><span class="line">  <span class="comment">//&#x4E5F;&#x5C31;&#x662F;&#x5927;&#x5C0F;&#x5DF2;&#x7ECF;&#x6D4B;&#x91CF;&#x51FA;&#x6765;&#x4E86;&#x4E0D;&#x9700;&#x8981;&#x518D;&#x6D4B;&#x91CF;&#x4E86;</span></span><br><span class="line">  <span class="comment">//&#x901A;&#x8FC7;MeasureSpec.makeMeasureSpec&#x751F;&#x6210;&#x76F8;&#x5E94;&#x7684;MeasureSpec</span></span><br><span class="line">              childWidthMeasureSpec = MeasureSpec.makeMeasureSpec(</span><br><span class="line">                      width, MeasureSpec.EXACTLY);</span><br><span class="line">          } <span class="keyword">else</span> {</span><br><span class="line"></span><br><span class="line">  <span class="comment">//14&#x3001;&#x5982;&#x679C;&#x4E0D;&#x662F;&#xFF0C;&#x8BF4;&#x660E;&#x6B64;&#x65F6;&#x7684;child&#x7684;MeasureSpec&#x662F;EXACTLY&#x7684;&#xFF0C;&#x76F4;&#x63A5;&#x83B7;&#x53D6;child&#x7684;MeasureSpec&#xFF0C;</span></span><br><span class="line">              childWidthMeasureSpec = getChildMeasureSpec(widthMeasureSpec,</span><br><span class="line">                      getPaddingLeftWithForeground() + getPaddingRightWithForeground() +</span><br><span class="line">                      lp.leftMargin + lp.rightMargin,</span><br><span class="line">                      lp.width);</span><br><span class="line">          }</span><br><span class="line"></span><br><span class="line">  <span class="comment">// &#x8FD9;&#x91CC;&#x662F;&#x5BF9;&#x9AD8;&#x505A;&#x5904;&#x7406;&#xFF0C;&#x4E0E;&#x5BBD;&#x7C7B;&#x4F3C;</span></span><br><span class="line">          <span class="keyword">final</span> <span class="keyword">int</span> childHeightMeasureSpec;</span><br><span class="line">          <span class="keyword">if</span> (lp.height == LayoutParams.MATCH_PARENT) {</span><br><span class="line">              <span class="keyword">final</span> <span class="keyword">int</span> height = Math.max(<span class="number">0</span>, getMeasuredHeight()</span><br><span class="line">                      - getPaddingTopWithForeground() - getPaddingBottomWithForeground()</span><br><span class="line">                      - lp.topMargin - lp.bottomMargin);</span><br><span class="line">              childHeightMeasureSpec = MeasureSpec.makeMeasureSpec(</span><br><span class="line">                      height, MeasureSpec.EXACTLY);</span><br><span class="line">          } <span class="keyword">else</span> {</span><br><span class="line">              childHeightMeasureSpec = getChildMeasureSpec(heightMeasureSpec,</span><br><span class="line">                      getPaddingTopWithForeground() + getPaddingBottomWithForeground() +</span><br><span class="line">                      lp.topMargin + lp.bottomMargin,</span><br><span class="line">                      lp.height);</span><br><span class="line">          }</span><br><span class="line"></span><br><span class="line">  <span class="comment">//&#x6700;&#x7EC8;&#xFF0C;&#x518D;&#x6B21;&#x6D4B;&#x91CF;child</span></span><br><span class="line">          child.measure(childWidthMeasureSpec, childHeightMeasureSpec);</span><br><span class="line">      }</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h2 id="&#x603B;&#x7ED3;">&#x603B;&#x7ED3;</h2><p>&#x901A;&#x8FC7;&#x672C;&#x6587;&#x7684;&#x8BB2;&#x89E3;&#xFF0C;&#x4E0D;&#x77E5;&#x9053;&#x4F60;&#x5BF9;&#x81EA;&#x5B9A;&#x4E49;View&#x548C;ViewGroup&#x7684;&#x6D4B;&#x91CF;&#x8FC7;&#x7A0B;&#x6709;&#x6CA1;&#x6709;&#x4E00;&#x4E2A;&#x6E05;&#x695A;&#x7684;&#x8BA4;&#x8BC6;&#x5462;&#xFF1F;&#x5176;&#x5B9E;&#x6211;&#x4EEC;&#x5728;&#x5B66;&#x4E60;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x4E0D;&#x5FC5;&#x8981;&#x5B8C;&#x5168;&#x4E86;&#x89E3;&#x6E90;&#x7801;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x7EC6;&#x8282;&#xFF0C;&#x800C;&#x662F;&#x5E94;&#x5F53;&#x4E86;&#x89E3;&#x6E90;&#x7801;&#x7684;&#x903B;&#x8F91;&#x987A;&#x5E8F;&#x5E76;&#x5C06;&#x5176;&#x5927;&#x81F4;&#x8FC7;&#x7A0B;&#x8BB0;&#x5F55;&#x4E0B;&#x6765;&#xFF0C;&#x8FD9;&#x6837;&#x4E0D;&#x8BBA;&#x662F;&#x5728;&#x5DE5;&#x4F5C;&#x8FD8;&#x662F;&#x9762;&#x8BD5;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x6839;&#x636E;&#x5927;&#x81F4;&#x7684;&#x903B;&#x8F91;&#x6D41;&#x7A0B;&#x6765;&#x5206;&#x6790;&#x95EE;&#x9898;&#xFF0C;&#x4ECE;&#x800C;&#x8FBE;&#x5230;&#x5B66;&#x4EE5;&#x81F4;&#x7528;&#x7684;&#x76EE;&#x7684;&#x3002;<br>&#x6700;&#x540E;&#x6211;&#x4ED8;&#x4E00;&#x4E2A;Android&#x81EA;&#x5B9A;&#x4E49;View&#x7684;&#x9762;&#x8BD5;&#x9898;&#x7B54;&#x6848;&#xFF0C;&#x6211;&#x8BA4;&#x4E3A;&#x8BB2;&#x7684;&#x8FD8;&#x662F;&#x6BD4;&#x8F83;&#x4E0D;&#x9519;&#x7684;&#xFF0C;&#x5E0C;&#x671B;&#x5927;&#x5BB6;&#x770B;&#x5B8C;&#x540E;&#x518D;&#x7ED3;&#x5408;&#x4E4B;&#x524D;&#x6587;&#x7AE0;&#x4E2D;&#x63D0;&#x5230;&#x7684;&#x5185;&#x5BB9;&#x8FDB;&#x884C;&#x8BB0;&#x5FC6;&#x6574;&#x7406;&#x3002;</p>
<blockquote>
<ol>
<li>ViewRootImpl &#x4F1A;&#x8C03;&#x7528; performTraversals(), &#x5176;&#x5185;&#x90E8;&#x4F1A;&#x8C03;&#x7528;performMeasure()&#x3001;performLayout&#x3001;performDraw()&#x3002;</li>
<li>performMeasure() &#x4F1A;&#x8C03;&#x7528;&#x6700;&#x5916;&#x5C42;&#x7684; ViewGroup&#x7684;measure()&#x2013;&gt;onMeasure(), ViewGroup &#x7684; onMeasure() &#x662F;&#x62BD;&#x8C61;&#x65B9;&#x6CD5;&#xFF0C;&#x4F46;&#x5176;&#x63D0;&#x4F9B;&#x4E86;measureChildren()&#xFF0C;&#x8FD9;&#x4E4B;&#x4E2D;&#x4F1A;&#x904D;&#x5386;&#x5B50;View&#x7136;&#x540E;&#x5FAA;&#x73AF;&#x8C03;&#x7528;measureChild()  &#x8FD9;&#x4E4B;&#x4E2D;&#x4F1A;&#x7528;  getChildMeasureSpec()+&#x7236;View&#x7684;MeasureSpec+&#x5B50;View&#x7684;LayoutParam&#x4E00;&#x8D77;&#x83B7;&#x53D6;&#x672C;View&#x7684;MeasureSpec&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;&#x5B50;View&#x7684;measure()&#x5230;View&#x7684;onMeasure()&#x2013;&gt;setMeasureDimension(getDefaultSize(),getDefaultSize()),getDefaultSize()&#x9ED8;&#x8BA4;&#x8FD4;&#x56DE;measureSpec&#x7684;&#x6D4B;&#x91CF;&#x6570;&#x503C;&#xFF0C;&#x6240;&#x4EE5;&#x7EE7;&#x627F;View&#x8FDB;&#x884C;&#x81EA;&#x5B9A;&#x4E49;&#x7684;wrap_content&#x9700;&#x8981;&#x91CD;&#x5199;&#x3002;<br>3  .performLayout()&#x4F1A;&#x8C03;&#x7528;&#x6700;&#x5916;&#x5C42;&#x7684;ViewGroup&#x7684;layout(l,t,r,b),&#x672C;View&#x5728;&#x5176;&#x4E2D;&#x4F7F;&#x7528;setFrame()&#x8BBE;&#x7F6E;&#x672C;View&#x7684;&#x56DB;&#x4E2A;&#x9876;&#x70B9;&#x4F4D;&#x7F6E;&#x3002;&#x5728;onLayout(&#x62BD;&#x8C61;&#x65B9;&#x6CD5;)&#x4E2D;&#x786E;&#x5B9A;&#x5B50;View&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x5982;LinearLayout&#x4F1A;&#x904D;&#x5386;&#x5B50;View&#xFF0C;&#x5FAA;&#x73AF;&#x8C03;&#x7528;setChildFrame()&#x2013;&gt;&#x5B50;View.layout()&#x3002;</li>
<li>performDraw()  &#x4F1A;&#x8C03;&#x7528;&#x6700;&#x5916;&#x5C42; ViewGroup&#x7684;draw():&#x5176;&#x4E2D;&#x4F1A;&#x5148;&#x540E;&#x8C03;&#x7528;background.draw()(&#x7ED8;&#x5236;&#x80CC;&#x666F;)&#x3001;onDraw()(&#x7ED8;&#x5236;&#x81EA;&#x5DF1;)&#x3001;dispatchDraw()(&#x7ED8;&#x5236;&#x5B50;View)&#x3001;onDrawScrollBars()(&#x7ED8;&#x5236;&#x88C5;&#x9970;)&#x3002;</li>
<li>MeasureSpec&#x7531;2&#x4F4D;SpecMode(UNSPECIFIED&#x3001;EXACTLY(&#x5BF9;&#x5E94;&#x7CBE;&#x786E;&#x503C;&#x548C;match_parent)&#x3001;AT_MOST(&#x5BF9;&#x5E94;warp_content))&#x548C;30&#x4F4D;SpecSize&#x7EC4;&#x6210;&#x4E00;&#x4E2A;int,DecorView&#x7684;MeasureSpec&#x7531;&#x7A97;&#x53E3;&#x5927;&#x5C0F;&#x548C;&#x5176;LayoutParams&#x51B3;&#x5B9A;&#xFF0C;&#x5176;&#x4ED6;View&#x7531;&#x7236;View&#x7684;MeasureSpec&#x548C;&#x672C;View&#x7684;LayoutParams&#x51B3;&#x5B9A;&#x3002;ViewGroup&#x4E2D;&#x6709;getChildMeasureSpec()&#x6765;&#x83B7;&#x53D6;&#x5B50;View&#x7684;MeasureSpec&#x3002;</li>
<li>&#x4E09;&#x79CD;&#x65B9;&#x5F0F;&#x83B7;&#x53D6;measure()&#x540E;&#x7684;&#x5BBD;&#x9AD8;&#xFF1A;<br>1.Activity#onWindowFocusChange()&#x4E2D;&#x8C03;&#x7528;&#x83B7;&#x53D6;<br>2.view.post(Runnable)&#x5C06;&#x83B7;&#x53D6;&#x7684;&#x4EE3;&#x7801;&#x6295;&#x9012;&#x5230;&#x6D88;&#x606F;&#x961F;&#x5217;&#x7684;&#x5C3E;&#x90E8;&#x3002;<br>3.ViewTreeObservable.</li>
</ol>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[跟我走，你也可以实现一个Android路由器]]></title>
      <url>http://jasoncool.com/2017/03/15/%E8%B7%9F%E6%88%91%E8%B5%B0%EF%BC%8C%E4%BD%A0%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAAndroid%E8%B7%AF%E7%94%B1%E5%99%A8/</url>
      <content type="html"><![CDATA[<h2 id="&#x4EC0;&#x4E48;&#x662F;&#x8DEF;&#x7531;&#xFF1F;">&#x4EC0;&#x4E48;&#x662F;&#x8DEF;&#x7531;&#xFF1F;</h2><blockquote>
<p>&#x8DEF;&#x7531;&#x5668;&#xFF08;Router&#xFF09;&#xFF0C;&#x662F;&#x8FDE;&#x63A5;&#x56E0;&#x7279;&#x7F51;&#x4E2D;&#x5404;&#x5C40;&#x57DF;&#x7F51;&#x3001;&#x5E7F;&#x57DF;&#x7F51;&#x7684;&#x8BBE;&#x5907;&#xFF0C;&#x5B83;&#x4F1A;&#x6839;&#x636E;&#x4FE1;&#x9053;&#x7684;&#x60C5;&#x51B5;&#x81EA;&#x52A8;&#x9009;&#x62E9;&#x548C;&#x8BBE;&#x5B9A;&#x8DEF;&#x7531;&#xFF0C;&#x4EE5;&#x6700;&#x4F73;&#x8DEF;&#x5F84;&#xFF0C;&#x6309;&#x524D;&#x540E;&#x987A;&#x5E8F;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x3002; &#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x767E;&#x5EA6;&#x767E;&#x79D1;</p>
</blockquote>
<p>&#x4EE5;&#x4E0A;&#x8FD9;&#x6BB5;&#x8BDD;&#x662F;&#x767E;&#x5EA6;&#x767E;&#x79D1;&#x5BF9;&#x4E8E;&#x8DEF;&#x7531;&#x5668;&#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x8DEF;&#x7531;&#x5668;&#x51E0;&#x4E4E;&#x4EBA;&#x4EBA;&#x90FD;&#x5728;&#x7528;&#xFF0C;&#x4F46;&#x662F;&#x4E86;&#x89E3;&#x5176;&#x539F;&#x7406;&#x7684;&#x5176;&#x5B9E;&#x5E76;&#x4E0D;&#x591A;&#xFF0C;&#x6211;&#x4EEC;&#x4F5C;&#x4E3A;&#x8F6F;&#x4EF6;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#xFF0C;&#x4E5F;&#x8BB8;&#x5E76;&#x4E0D;&#x9700;&#x8981;&#x77E5;&#x9053;&#x8DEF;&#x7531;&#x5668;&#x7684;&#x786C;&#x4EF6;&#x77E5;&#x8BC6;&#xFF0C;&#x4F46;&#x662F;&#x5B83;&#x7684;&#x8F6F;&#x4EF6;&#x5B9E;&#x73B0;&#x5176;&#x5B9E;&#x7ED9;&#x6211;&#x4EEC;&#x5728;&#x5F00;&#x53D1;&#x5DE5;&#x4F5C;&#x4E2D;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x5F88;&#x597D;&#x7684;&#x601D;&#x8DEF;&#x3002;&#x5176;&#x5B9E;&#x8BF4;&#x767D;&#x4E86;&#xFF0C;&#x8DEF;&#x7531;&#x5668;&#x5C31;&#x662F;&#x628A;&#x4E00;&#x5806;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x7684;URL&#x8DEF;&#x5F84;&#x7EDF;&#x4E00;&#x7BA1;&#x7406;&#xFF0C;&#x5904;&#x7406;&#x548C;&#x5206;&#x53D1;&#x7ED9;&#x76F8;&#x5E94;&#x7684;&#x63A7;&#x5236;&#x5668;&#x5904;&#x7406;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;&#x8FD9;&#x4E2A;&#x5206;&#x53D1;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x5BF9;&#x6211;&#x4EEC;&#x7684;URL&#x8BF7;&#x6C42;&#x505A;&#x4E00;&#x4E9B;&#x5904;&#x7406;&#xFF0C;&#x5C31;&#x597D;&#x50CF;&#x4F60;&#x4E3A;&#x4E86;&#x7FFB;&#x5899;&#x6302;VPN&#x4E00;&#x6837;&#xFF0C;&#x8FD9;&#x4E9B;&#x5DE5;&#x4F5C;&#x5176;&#x5B9E;&#x90FD;&#x662F;&#x5728;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x524D;&#x6216;&#x8005;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x540E;&#x505A;&#x4E00;&#x4E9B;&#x5904;&#x7406;&#x800C;&#x8FBE;&#x5230;&#x7684;&#x76EE;&#x7684;&#x3002;</p>
<h2 id="Android&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x7528;&#x8DEF;&#x7531;&#x5668;&#xFF1F;">Android&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x7528;&#x8DEF;&#x7531;&#x5668;&#xFF1F;</h2><p>Android&#x5176;&#x5B9E;&#x5DF2;&#x7ECF;&#x7ED9;&#x6211;&#x4EEC;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x7EC4;&#x4EF6;&#x6765;&#x8FDB;&#x884C;&#x8DF3;&#x8F6C;&#x4E86;&#xFF0C;&#x90A3;&#x5C31;&#x662F;Intent,&#x81F3;&#x4E8E;Intent&#x7684;&#x4E00;&#x4E9B;&#x76F8;&#x5173;&#x77E5;&#x8BC6;&#x5982;&#x679C;&#x94FA;&#x5F00;&#x6765;&#x8BF4;&#x53EF;&#x80FD;&#x8FD9;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x90FD;&#x6253;&#x4E0D;&#x4F4F;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EA;&#x8981;&#x77E5;&#x9053;Intent&#x542F;&#x52A8;Activity&#x6709;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x4E00;&#x79CD;&#x662F;&#x663E;&#x5F0F;&#x542F;&#x52A8;&#xFF0C;&#x4E00;&#x79CD;&#x662F;&#x9690;&#x5F0F;&#x542F;&#x52A8;&#xFF0C;&#x800C;&#x8FD9;&#x79CD;&#x539F;&#x751F;&#x7684;&#x8DEF;&#x7531;&#x65B9;&#x6848;&#x90FD;&#x6216;&#x591A;&#x6216;&#x5C11;&#x7684;&#x5B58;&#x5728;&#x7740;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#xFF1A;<br>1.&#x663E;&#x5F0F;&#x542F;&#x52A8;&#xFF1A;&#x76F4;&#x63A5;&#x7684;&#x7C7B;&#x4F9D;&#x8D56;&#xFF0C;&#x8026;&#x5408;&#x4E25;&#x91CD;&#x3002;<br>2.&#x9690;&#x5F0F;&#x542F;&#x52A8;&#xFF1A;&#x89C4;&#x5219;&#x96C6;&#x4E2D;&#x7BA1;&#x7406;&#xFF0C;&#x534F;&#x4F5C;&#x56F0;&#x96BE;&#x3002;<br>3.Manifest&#x6269;&#x5C55;&#x6027;&#x8F83;&#x5DEE;&#x3002;<br>4.&#x8DF3;&#x8F6C;&#x8FC7;&#x7A0B;&#x4E2D;&#x65E0;&#x6CD5;&#x63A7;&#x5236;&#x3002;<br>&#x800C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x81EA;&#x5DF1;&#x7F16;&#x5199;&#x7684;&#x8DEF;&#x7531;&#x5668;&#x5219;&#x4F1A;&#x5E26;&#x6765;&#x4E00;&#x4E9B;&#x4EE5;&#x4E0B;&#x4E00;&#x4E9B;&#x4F18;&#x52BF;&#xFF1A;<br>1.&#x901A;&#x8FC7;Uri&#x7D22;&#x5F15;&#xFF0C;&#x4E0D;&#x5B58;&#x5728;&#x7C7B;&#x7684;&#x4F9D;&#x8D56;&#x3002;<br>2.&#x5206;&#x5E03;&#x5F0F;&#x7BA1;&#x7406;&#x9875;&#x9762;&#x914D;&#x7F6E;<br>3.&#x826F;&#x597D;&#x7684;&#x53EF;&#x6269;&#x5C55;&#x6027;<br>4.&#x53EF;&#x4EE5;&#x52A0;&#x5165;&#x62E6;&#x622A;&#x5668;&#x81EA;&#x5B9A;&#x4E49;&#x8DEF;&#x7531;&#x89C4;&#x5219;&#x3002;<br><a id="more"></a><br>&#x4ECE;&#x6280;&#x672F;&#x5C42;&#x9762;&#x8BF4;&#x4E86;&#x534A;&#x5929;&#x81EA;&#x5B9A;&#x4E49;&#x8DEF;&#x7531;&#x5668;&#x7684;&#x4F18;&#x52BF;&#xFF0C;&#x4F46;&#x662F;&#x4F60;&#x53EF;&#x80FD;&#x8FD8;&#x662F;&#x60F3;&#x4E0D;&#x901A;&#xFF0C;&#x4E3A;&#x5565;&#x8981;&#x7528;&#x8DEF;&#x7531;&#x5668;&#x5462;&#xFF1F;&#x90A3;&#x6211;&#x4EEC;&#x5C31;&#x4ECE;&#x4E1A;&#x52A1;&#x5C42;&#x9762;&#x6765;&#x7B80;&#x5355;&#x7684;&#x8BF4;&#x4E00;&#x4E0B;&#x5427;&#x3002;<br>&#x8BF4;&#x5230;&#x4E1A;&#x52A1;&#x5C42;&#x9762;&#x5C31;&#x4E0D;&#x5F97;&#x4E0D;&#x63D0;&#x7EC4;&#x4EF6;&#x5316;&#x5F00;&#x53D1;&#x4E86;&#xFF0C;&#x968F;&#x7740;&#x9879;&#x76EE;&#x7684;&#x53D1;&#x5C55;&#xFF0C;&#x4E1A;&#x52A1;&#x4E0D;&#x65AD;&#x7684;&#x58EE;&#x5927;&#xFF0C;&#x4E1A;&#x52A1;&#x6A21;&#x5757;&#x8D8A;&#x6765;&#x8D8A;&#x591A;&#xFF0C;&#x539F;&#x6765;&#x53EF;&#x80FD;&#x4E00;&#x4E2A;&#x5C0F;&#x4F19;&#x4F34;&#x5C31;&#x53EF;&#x4EE5;&#x5F00;&#x53D1;&#x7684;&#x9879;&#x76EE;&#xFF0C;&#x73B0;&#x5728;&#x5FC5;&#x987B;&#x8981;2-3&#x4E2A;&#x5C0F;&#x4F19;&#x4F34;&#x4E00;&#x8D77;&#x534F;&#x540C;&#x5F00;&#x53D1;&#x624D;&#x80FD;&#x826F;&#x597D;&#x7684;&#x8FD0;&#x8F6C;&#x4E0B;&#x53BB;&#xFF0C;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x4E00;&#x65E6;&#x591A;&#x8D77;&#x6765;&#xFF0C;&#x4E0D;&#x53EF;&#x907F;&#x514D;&#x7684;&#x8026;&#x5408;&#x95EE;&#x9898;&#x5C31;&#x4F1A;&#x8D8A;&#x6765;&#x8D8A;&#x4E25;&#x91CD;&#xFF0C;&#x6BD4;&#x5982;&#x5404;&#x4E2A;&#x6A21;&#x5757;&#x95F4;&#x4E92;&#x76F8;&#x8C03;&#x7528;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x8026;&#x5408;&#x7684;&#x91CD;&#x707E;&#x533A;&#x3002;<br>&#x4E3A;&#x4E86;&#x4FBF;&#x4E8E;&#x5F00;&#x53D1;&#x4E2D;&#x7684;&#x4EFB;&#x52A1;&#x5212;&#x5206;&#xFF0C;&#x4E5F;&#x4E3A;&#x4E86;&#x5404;&#x4E2A;&#x529F;&#x80FD;&#x6A21;&#x5757;&#x4E4B;&#x95F4;&#x7684;&#x529F;&#x80FD;&#x72EC;&#x7ACB;&#xFF0C;&#x73B0;&#x5728;&#x666E;&#x904D;&#x7684;&#x534F;&#x4F5C;&#x65B9;&#x5F0F;&#x662F;&#x6BCF;&#x4E2A;&#x5F00;&#x53D1;&#x8005;&#x8D1F;&#x8D23;&#x4E00;&#x4E2A;Android Library,&#x7136;&#x540E;&#x5404;&#x4E2A;Library&#x90FD;&#x88AB;&#x4E00;&#x4E2A;&#x58F3;Moudle&#x5F15;&#x7528;&#xFF0C;&#x4ECE;&#x800C;&#x8FBE;&#x5230;&#x76F8;&#x4E92;&#x534F;&#x4F5C;&#x53C8;&#x53EF;&#x4EE5;&#x72EC;&#x7ACB;&#x5F00;&#x53D1;&#x7684;&#x76EE;&#x7684;&#x3002;&#xFF08;&#x5982;&#x679C;&#x4E0D;&#x660E;&#x767D;&#x5C31;&#x628A;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x60F3;&#x8C61;&#x6210;&#x4E00;&#x4E2A;&#x4E3B;&#x7A0B;&#x5E8F;&#x5F15;&#x5165;&#x4E86;&#x5404;&#x79CD;jar&#x5305;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x662F;&#x4E3B;&#x7A0B;&#x5E8F;&#x7684;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x4E5F;&#x53EF;&#x80FD;&#x662F;Jar&#x5305;&#x7684;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#xFF09;<br>&#x90A3;&#x4E48;&#x5728;&#x8FD9;&#x79CD;&#x5F00;&#x53D1;&#x7684;&#x67B6;&#x6784;&#x4E0B;&#xFF0C;&#x754C;&#x9762;&#x8DF3;&#x8F6C;&#x5C31;&#x6210;&#x4E86;&#x4E00;&#x4E2A;&#x96BE;&#x9898;&#xFF0C;&#x56E0;&#x4E3A;&#x5C31;&#x7B97;&#x6709;&#x5F00;&#x53D1;&#x89C4;&#x8303;&#xFF0C;&#x4F46;&#x662F;&#x6BCF;&#x6B21;&#x8DF3;&#x8F6C;&#x90FD;&#x8981;&#x4FDD;&#x8BC1;&#x7C7B;&#x540D;&#x6B63;&#x786E;&#x4E14;&#x76EE;&#x6807;&#x754C;&#x9762;&#x5982;&#x679C;&#x4FEE;&#x6539;&#x4E86;&#x7C7B;&#x540D;&#xFF0C;&#x8DF3;&#x8F6C;&#x754C;&#x9762;&#x4E5F;&#x8981;&#x8DDF;&#x7740;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#xFF0C;&#x8FD9;&#x79CD;&#x5F3A;&#x8026;&#x5408;&#x5B9E;&#x5728;&#x662F;&#x592A;&#x4E0D;&#x6781;&#x5BA2;&#x4E86;&#x3002;<br>&#x73B0;&#x5728;&#x5927;&#x5BB6;&#x660E;&#x767D;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x5F15;&#x5165;&#x81EA;&#x5B9A;&#x4E49;&#x8DEF;&#x7531;&#x529F;&#x80FD;&#x4E86;&#x5427;&#xFF1F;<br>&#x8BF4;&#x767D;&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x7684;&#x9879;&#x76EE;&#x5C0F;&#xFF0C;1-2&#x4E2A;&#x4EBA;&#x5F00;&#x53D1;&#x5C31;OK&#xFF0C;&#x90A3;&#x4F60;&#x5F15;&#x5165;&#x4E0D;&#x5F15;&#x5165;&#x8DEF;&#x7531;&#x5668;&#x529F;&#x80FD;&#x5176;&#x5B9E;&#x6548;&#x679C;&#x5E76;&#x4E0D;&#x660E;&#x663E;&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;&#x4F60;&#x7684;&#x9879;&#x76EE;&#x5C5E;&#x4E8E;&#x4E2D;&#x5927;&#x578B;&#x7684;&#xFF0C;&#x5F00;&#x53D1;&#x4EBA;&#x5458;3&#x4E2A;&#x4EE5;&#x4E0A;&#xFF0C;&#x90A3;&#x6211;&#x7684;&#x5EFA;&#x8BAE;&#x8FD8;&#x662F;&#x4E00;&#x5B9A;&#x8981;&#x5F15;&#x5165;&#x81EA;&#x5B9A;&#x4E49;&#x8DEF;&#x7531;&#x5668;&#x7684;&#xFF0C;&#x5B83;&#x7684;&#x4F18;&#x70B9;&#xFF0C;&#x524D;&#x9762;&#x5DF2;&#x7ECF;&#x8BF4;&#x8FC7;&#x4E86;&#x3002;</p>
<h2 id="&#x81EA;&#x5B9A;&#x4E49;&#x8DEF;&#x7531;&#x5668;&#x7684;&#x539F;&#x7406;">&#x81EA;&#x5B9A;&#x4E49;&#x8DEF;&#x7531;&#x5668;&#x7684;&#x539F;&#x7406;</h2><p>&#x4E3A;&#x4E86;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x8DEF;&#x7531;&#xFF0C;&#x9996;&#x5148;&#x4E00;&#x70B9;&#x5C31;&#x662F;&#x5F04;&#x6E05;&#x695A;&#xFF0C;&#x6211;&#x4EEC;&#x8DF3;&#x8F6C;&#x5230;&#x5E95;&#x9700;&#x8981;&#x4EC0;&#x4E48;&#x53C2;&#x6570;&#xFF0C;&#x5176;&#x5B9E;&#x8BF4;&#x5230;&#x5E95;&#xFF0C;&#x81EA;&#x5B9A;&#x4E49;&#x8DEF;&#x7531;&#x4E5F;&#x53EA;&#x4E0D;&#x8FC7;&#x662F;&#x5C01;&#x88C5;&#x4E86;Android&#x7684;&#x539F;&#x751F;&#x8DEF;&#x7531;&#xFF0C;&#x4E0D;&#x4F1A;&#x81EA;&#x5DF1;&#x53E6;&#x884C;&#x5B9E;&#x73B0;&#x8DF3;&#x8F6C;&#x65B9;&#x5F0F;&#x7684;&#x3002;<br>&#x6240;&#x4EE5;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x5F04;&#x6E05;&#x695A;&#x539F;&#x751F;&#x8DEF;&#x7531;&#x662F;&#x5982;&#x4F55;&#x8DF3;&#x8F6C;&#x7684;&#x5C31;&#x6BD4;&#x8F83;&#x91CD;&#x8981;&#x4E86;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line">intent.setClass(FirstActivity.<span class="keyword">this</span>, SecondActivity.class);</span><br><span class="line">FirstActivity.<span class="keyword">this</span>.startActivity(intent);</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x6700;&#x6700;&#x57FA;&#x672C;&#x7684;&#x663E;&#x5F0F;&#x8DF3;&#x8F6C;&#x7684;&#x4EE3;&#x7801;&#x4E86;&#xFF0C;&#x770B;&#x4E0A;&#x8FB9;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5206;&#x6790;&#x51FA;&#x6765;&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x8BA9;&#x4E00;&#x4E2A;&#x754C;&#x9762;&#x8DF3;&#x8F6C;&#x7684;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x754C;&#x9762;&#xFF0C;&#x6700;&#x9700;&#x8981;&#x7684;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;&#x4EE3;&#x8868;&#x5F53;&#x524D;&#x9875;&#x9762;&#x7684;&#x4E0A;&#x4E0B;&#x6587;FirstActivity.this&#xFF0C;&#x5B83;&#x7684;&#x672C;&#x8D28;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x4E00;&#x4E2A;Context,&#x800C;&#x53E6;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x5C31;&#x662F;&#x76EE;&#x6807;&#x9875;&#x9762;&#x7684;class&#x4E86;&#x3002;<br>&#x597D;&#x4E86; &#x77E5;&#x9053;&#x6211;&#x4EEC;&#x8DF3;&#x8F6C;&#x9700;&#x8981;&#x7684;&#x53C2;&#x6570;&#x4E86;&#xFF0C;&#x73B0;&#x5728;&#x5C31;&#x8981;&#x8003;&#x8651;&#x5982;&#x4F55;&#x5B58;&#x653E;&#x6211;&#x4EEC;&#x6CE8;&#x518C;&#x5728;&#x8DEF;&#x7531;&#x5668;&#x7684;&#x754C;&#x9762;&#x4E86;&#xFF0C;&#x5176;&#x5B9E;&#x4E5F;&#x4E0D;&#x7528;&#x591A;&#x60F3;&#xFF0C;&#x4E00;&#x4E2A;Map&#x662F;&#x6700;&#x4F73;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF0C;&#x8FD9;&#x4E2A;Map&#x7684;key&#x6211;&#x4EEC;&#x653E;&#x7F6E;&#x7684;&#x662F;&#x81EA;&#x5B9A;&#x4E49;&#x754C;&#x9762;&#x7684;&#x8DF3;&#x8F6C;&#x8DEF;&#x5F84;&#xFF0C;&#x800C;&#x8FD9;&#x4E2A;Map&#x7684;value&#x6211;&#x4EEC;&#x5B58;&#x653E;&#x7684;&#x5C31;&#x662F;&#x76EE;&#x6807;&#x754C;&#x9762;&#x7684;class&#x6587;&#x4EF6;&#x3002;<br>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x6765;&#x601D;&#x8003;&#x4E00;&#x4E0B;&#x8F6F;&#x4EF6;&#x7684;&#x6700;&#x7B80;&#x5355;&#x7684;&#x67B6;&#x6784;&#xFF1A;<br><img src="/2017/03/15/&#x8DDF;&#x6211;&#x8D70;&#xFF0C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;Android&#x8DEF;&#x7531;&#x5668;/1.png" alt="logo"><br>&#x770B;&#x56FE;&#x8BF4;&#x8BDD;&#xFF1A;&#x8C03;&#x7528;Router,&#x7136;&#x540E;&#x4F20;&#x5165;&#x4F60;&#x4E4B;&#x524D;&#x521D;&#x59CB;&#x5316;&#x5230;&#x5B58;&#x50A8;&#x5668;&#x91CC;&#x7684;Uri&#x5730;&#x5740;&#xFF0C;&#x4E4B;&#x540E;&#x4ECE;&#x5BB9;&#x5668;&#xFF08;ArrayMap&#xFF09;&#x4E2D;&#x83B7;&#x53D6;&#x5BF9;&#x5E94;&#x7684;&#x76EE;&#x6807;&#x754C;&#x9762;&#x7684;class&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x5229;&#x7528;&#x4F20;&#x5165;&#x7684;Context&#x5BF9;&#x8C61;&#x8C03;&#x7528;&#x8DF3;&#x8F6C;&#x65B9;&#x6CD5;&#xFF08;StartActivity&#xFF09;&#x8DF3;&#x8F6C;&#x5230;&#x76EE;&#x6807;&#x754C;&#x9762;&#x3002;<br>&#x8FD9;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x6700;&#x7B80;&#x5355;&#x7684;&#x8DEF;&#x7531;&#x5668;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x95EE;&#xFF0C;Intent&#x4E0D;&#x6B62;&#x53EF;&#x4EE5;&#x8DF3;&#x8F6C;Activity&#x8FD8;&#x53EF;&#x4EE5;&#x542F;&#x52A8;Service&#x548C;Recevier&#x554A;&#xFF0C;&#x662F;&#x4E0D;&#x662F;&#x4E5F;&#x53EF;&#x4EE5;&#x5C01;&#x88C5;&#x8D77;&#x6765;&#x5462;&#xFF1F;&#x5F53;&#x7136;&#x53EF;&#x4EE5;&#xFF1A;<br><img src="/2017/03/15/&#x8DDF;&#x6211;&#x8D70;&#xFF0C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;Android&#x8DEF;&#x7531;&#x5668;/2.png" alt="logo"><br>&#x8FD9;&#x91CC;&#x5229;&#x7528;&#x4E86;Uri&#x7684;Scheme&#x6765;&#x5BF9;&#x6211;&#x4EEC;&#x8981;&#x8C03;&#x7528;&#x7684;&#x5BB9;&#x5668;&#x8FDB;&#x884C;&#x5206;&#x7C7B;&#xFF0C;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x65B9;&#x5F0F;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5EF6;&#x4F38;&#x51FA;&#x6211;&#x4EEC;&#x81EA;&#x5DF1;&#x7684;&#x81EA;&#x5B9A;&#x4E49;&#x8DF3;&#x8F6C;&#x7C7B;&#x578B;&#xFF0C;&#x4F46;&#x662F;&#x4E3A;&#x4E86;&#x4FBF;&#x4E8E;&#x6269;&#x5C55;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5C06;&#x8FD9;&#x4E9B;&#x4E0D;&#x540C;&#x7684;ArrayMap&#x5BB9;&#x5668;&#x90FD;&#x5C01;&#x88C5;&#x5230;&#x4E00;&#x4E2A;ArrayMap&#x5BB9;&#x5668;&#x4E2D;&#x8FDB;&#x884C;&#x7EDF;&#x4E00;&#x7BA1;&#x7406;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x65B0;&#x7684;&#x8DEF;&#x7531;&#x7C7B;&#x578B;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x8981;&#x7ED9;&#x8FD9;&#x4E2A;&#x6700;&#x5916;&#x90E8;&#x7684;ArrayMap&#x52A0;&#x4E00;&#x4E2A;key(scheme&#x5934;)&#x548C;&#x4E00;&#x4E2A;value(&#x5B58;&#x653E;&#x8FD9;&#x4E2A;&#x8DEF;&#x7531;&#x89C4;&#x5219;&#x5BF9;&#x5E94;&#x5185;&#x5BB9;&#x7684;ArrayMap&#x5C31;&#x53EF;&#x4EE5;&#x4E86;)<br>OK&#xFF0C;&#x5230;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x57FA;&#x672C;&#x4E0A;&#x5C31;&#x5F04;&#x6E05;&#x695A;&#x6211;&#x4EEC;&#x7684;&#x8DEF;&#x7531;&#x5BB9;&#x5668;&#x7684;&#x57FA;&#x672C;&#x6846;&#x67B6;&#x4E86;&#xFF0C;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x4E00;&#x4E0B;&#xFF0C;&#x8DEF;&#x7531;&#x5668;&#x7ED9;&#x6211;&#x4EEC;&#x8FD4;&#x56DE;&#x4EC0;&#x4E48;&#x4E86;&#xFF0C;&#x5176;&#x5B9E;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x95EE;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x8FD4;&#x56DE;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;&#x53EA;&#x8981;&#x80FD;&#x76F4;&#x63A5;&#x8DF3;&#x8F6C;&#x6216;&#x8005;&#x76F4;&#x63A5;&#x542F;&#x52A8;&#x4E00;&#x4E2A;Service&#x5C31;&#x53EF;&#x4EE5;&#x5566;&#x3002;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x5F97;&#x8003;&#x8651;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x9879;&#x76EE;&#x7EC4;&#x91CC;&#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x65B0;&#x4EBA;&#xFF0C;&#x8FD9;&#x4E9B;&#x65B0;&#x4EBA;&#x53EF;&#x80FD;&#x4E00;&#x5F00;&#x59CB;&#x4E0A;&#x624B;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x8DEF;&#x7531;&#x5668;&#x4F1A;&#x6709;&#x4E00;&#x5B9A;&#x7684;&#x5B66;&#x4E60;&#x6210;&#x672C;&#x548C;&#x9519;&#x8BEF;&#x6982;&#x7387;&#xFF0C;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x8FD9;&#x79CD;&#x56E0;&#x4E3A;&#x4E0D;&#x719F;&#x6089;&#x6216;&#x8005;&#x7C97;&#x5FC3;&#x800C;&#x5BFC;&#x81F4;&#x7684;Bug&#x4EA7;&#x751F;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5C3D;&#x91CF;&#x7684;&#x8BA9;&#x6211;&#x4EEC;&#x7684;&#x8DEF;&#x7531;&#x5668;&#x66F4;&#x52A0;&#x504F;&#x5411;&#x4E8E;&#x539F;&#x751F;&#x5316;&#x64CD;&#x4F5C;&#x4E00;&#x4E9B;&#xFF0C;&#x81F3;&#x4E8E;&#x600E;&#x4E48;&#x504F;&#x5411;&#x539F;&#x751F;&#x5316;&#x64CD;&#x4F5C;&#x5462;&#xFF1F;<br>&#x90A3;&#x5F53;&#x7136;&#x5C31;&#x662F;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;Intent&#x4E86;&#xFF0C;&#x4E4B;&#x540E;&#x4F60;&#x62FF;&#x5DF2;&#x7ECF;&#x505A;&#x597D;&#x5904;&#x7406;&#x7684;Intent&#x60F3;&#x5E72;&#x561B;&#x5C31;&#x5E72;&#x561B;&#xFF0C;&#x548C;&#x539F;&#x751F;&#x64CD;&#x4F5C;&#x4E00;&#x6BDB;&#x4E00;&#x6837;&#xFF01;</p>
<h2 id="&#x81EA;&#x5B9A;&#x4E49;&#x8DEF;&#x7531;&#x5668;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;">&#x81EA;&#x5B9A;&#x4E49;&#x8DEF;&#x7531;&#x5668;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;</h2><p>&#x5728;&#x8BF4;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#x524D;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x6765;&#x770B;&#x770B;&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x8DEF;&#x7531;&#x5668;&#x5427;&#x3002;<br>&#x9996;&#x5148;&#xFF0C;&#x5728;&#x4F60;&#x7684;&#x58F3;App&#x7684;&#x81EA;&#x5B9A;&#x4E49;Application&#x4E2D;&#x8FDB;&#x884C;Uri&#x7684;&#x6CE8;&#x518C;&#xFF0C;&#x8FD9;&#x91CC;&#x8003;&#x8651;&#x5230;&#x591A;&#x4EBA;&#x534F;&#x4F5C;&#x90FD;&#x4FEE;&#x6539;&#x4E00;&#x4E2A;Application&#x4E0D;&#x592A;&#x5B89;&#x5168;&#xFF0C;&#x6211;&#x7684;&#x5EFA;&#x8BAE;&#x662F;&#x6BCF;&#x4E2A;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x53EF;&#x4EE5;&#x5199;&#x81EA;&#x5DF1;&#x7684;&#x6CE8;&#x518C;&#x7C7B;&#xFF0C;&#x4E4B;&#x540E;&#x518D;&#x7531;Applicaiton&#x4E2D;&#x901A;&#x8FC7;&#x5F15;&#x5165;&#x5404;&#x81EA;&#x7684;&#x6CE8;&#x518C;&#x7C7B;&#x6765;&#x5B9E;&#x73B0;&#x9875;&#x9762;&#x7684;&#x6CE8;&#x518C;&#xFF0C;&#x907F;&#x514D;&#x4E00;&#x4E9B;&#x5C0F;&#x4F19;&#x4F34;&#x5148;&#x63D0;&#x4EA4;&#x518D;&#x66F4;&#x65B0;&#x800C;&#x51FA;&#x73B0;&#x7684;&#x6587;&#x4EF6;&#x51B2;&#x7A81;&#x3002;<br>&#x597D;&#x4E86;&#x73B0;&#x5728;&#x5F00;&#x59CB;&#x770B;&#x4EE3;&#x7801;&#x5427;&#xFF1A;<br>1.&#x6CE8;&#x518C;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyApplication</span> <span class="keyword">extends</span> <span class="title">Application</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onCreate();</span><br><span class="line">        <span class="keyword">if</span>(KeyPathConfig.DEBUG){</span><br><span class="line"></span><br><span class="line">            CoolRouterTool.openLog();</span><br><span class="line">        }</span><br><span class="line">        setUpPaths();</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setUpPaths</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">       CoolRouterTool.addPath(KeyPathConfig.ACTIVITY_SCHEME+<span class="string">&quot;bbs.ac&quot;</span>,BBSActivity.class);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>2.&#x8DF3;&#x8F6C;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>{</span><br><span class="line"></span><br><span class="line">    TextView hello;</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        hello=(TextView) <span class="keyword">this</span>.findViewById(R.id.hello);</span><br><span class="line">        hello.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() {</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>{</span><br><span class="line"></span><br><span class="line">             <span class="comment">/*  Intent intent=CoolRouterTool.dispatchPath(MainActivity.this, KeyPathConfig.ACTIVITY_SCHEME+&quot;bbs.ac&quot;);</span><br><span class="line">                startActivity(intent);*/</span></span><br><span class="line">                CoolRouterTool.build(KeyPathConfig.ACTIVITY_SCHEME+<span class="string">&quot;bbs.ac&quot;</span>).go(MainActivity.<span class="keyword">this</span>);</span><br><span class="line">            }</span><br><span class="line">        });</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6CE8;&#x91CA;&#x7684;&#x90E8;&#x5206;&#x5C31;&#x662F;&#x8FD4;&#x56DE;Intent&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x800C;&#x540E;&#x8FB9;&#x7684;&#x8DF3;&#x8F6C;&#x65B9;&#x5F0F;&#x5C31;&#x662F;&#x5C01;&#x88C5;&#x597D;&#x7684;&#xFF0C;&#x5404;&#x6709;&#x4F18;&#x52BF;&#xFF0C;&#x53EF;&#x4EE5;&#x7075;&#x6D3B;&#x4F7F;&#x7528;&#x3002;<br>3.&#x8DF3;&#x8F6C;&#x5230;Web&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BBSActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(@Nullable Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        TextView tv = <span class="keyword">new</span> TextView(<span class="keyword">this</span>);</span><br><span class="line">        tv.setTextSize(<span class="number">50</span>);</span><br><span class="line">        tv.setText(<span class="string">&quot;BBS!!!&quot;</span>);</span><br><span class="line">        setContentView(tv);</span><br><span class="line"></span><br><span class="line">        tv.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() {</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>{</span><br><span class="line">                Toast.makeText(BBSActivity.<span class="keyword">this</span>,<span class="string">&quot;&#x70B9;&#x6211;&#x5E72;&#x5565;&#xFF1F;&quot;</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                Intent intent=CoolRouterTool.dispatchPath(BBSActivity.<span class="keyword">this</span>,<span class="string">&quot;http://w121@@1&amp;&amp;&#x2026;&#x2026;ASD&amp;&amp;sS*@!@(&quot;</span>);</span><br><span class="line">               startActivity(intent);</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line">        });</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x6CE8;&#x610F;&#x770B;&#x4E00;&#x4E0B;&#xFF0C;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;&#x8DF3;&#x8F6C;&#x7684;Url&#x8DEF;&#x5F84;&#x5176;&#x5B9E;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x7F51;&#x5740;&#xFF0C;&#x7531;&#x4E8E;&#x52A0;&#x5165;&#x4E86;Web&#x8DEF;&#x5F84;&#x68C0;&#x67E5;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x7B26;&#x5408;&#x89C4;&#x8303;&#x7684;Url&#x8DEF;&#x5F84;&#x662F;&#x4E0D;&#x4F1A;&#x8DF3;&#x8F6C;&#x7684;&#xFF0C;&#x800C;&#x662F;&#x4F1A;&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x5F02;&#x5E38;&#xFF0C;&#x6240;&#x4EE5;&#x4F60;&#x5728;&#x6D4B;&#x8BD5;&#x7684;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x6362;&#x6210;&#x4E00;&#x4E2A;&#x6B63;&#x89C4;&#x7684;Url&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;<br>&#x4F7F;&#x7528;&#x8D77;&#x6765;&#x662F;&#x4E0D;&#x662F;&#x5F88;&#x7B80;&#x5355;&#x5462;&#xFF1F;&#x56E0;&#x4E3A;&#x672C;&#x8EAB;&#x4E5F;&#x6CA1;&#x6709;&#x591A;&#x96BE;&#x3002;</p>
<h2 id="&#x81EA;&#x5B9A;&#x4E49;&#x8DEF;&#x7531;&#x7684;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;">&#x81EA;&#x5B9A;&#x4E49;&#x8DEF;&#x7531;&#x7684;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;</h2><p>&#x8DEF;&#x7531;&#x8DEF;&#x5F84;&#x63A5;&#x53E3;&#x7684;&#x5B9A;&#x4E49;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">iPath</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>{</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6DFB;&#x52A0;&#x8DEF;&#x7531;&#x8DEF;&#x5F84;</span><br><span class="line">     * <span class="doctag">@param</span> keyPath &#x5173;&#x952E;&#x8DEF;&#x5F84;</span><br><span class="line">     * <span class="doctag">@param</span> tClass &#x8DEF;&#x5F84;&#x5BF9;&#x5E94;&#x7684;Class</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addPath</span><span class="params">(String keyPath, Class&lt;K&gt; tClass)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x5206;&#x53D1;&#x8DEF;&#x7531;&#x8DEF;&#x5F84;</span><br><span class="line">     * <span class="doctag">@param</span> context &#x8DF3;&#x8F6C;&#x53D1;&#x8D77;&#x754C;&#x9762;&#x7684;Context</span><br><span class="line">     * <span class="doctag">@param</span> keyPath &#x8DEF;&#x7531;&#x8DEF;&#x5F84;</span><br><span class="line">     * <span class="doctag">@return</span> &#x8FD4;&#x56DE;&#x5BF9;&#x5E94;&#x7684;&#x8FD4;&#x56DE;&#x503C;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function">V <span class="title">dispatchPath</span><span class="params">(Context context, String keyPath)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6E05;&#x7406;&#x8DEF;&#x7531;&#x8DEF;&#x5F84;</span><br><span class="line">     * <span class="doctag">@param</span> keyPath &#x8DEF;&#x7531;&#x8DEF;&#x5F84;</span><br><span class="line">     * <span class="doctag">@return</span> &#x8FD4;&#x56DE;&#x64CD;&#x4F5C;&#x7ED3;&#x679C; &#x5E03;&#x5C14;&#x503C;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">clearPath</span><span class="params">(String keyPath)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x5224;&#x65AD;&#x8DEF;&#x7531;&#x8DEF;&#x5F84;&#x662F;&#x5426;&#x5B58;&#x5728;</span><br><span class="line">     * <span class="doctag">@param</span> keyPath &#x8DEF;&#x7531;&#x8DEF;&#x5F84;</span><br><span class="line">     * <span class="doctag">@return</span> &#x8FD4;&#x56DE;&#x662F;&#x5426;&#x5B58;&#x5728;&#x7684;&#x8FD4;&#x56DE;&#x503C;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isExistPath</span><span class="params">(String keyPath)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x5206;&#x53D1;Web&#x8DEF;&#x5F84;</span><br><span class="line">     * <span class="doctag">@param</span> keyPath &#x8DEF;&#x7531;&#x8DEF;&#x5F84;</span><br><span class="line">     * <span class="doctag">@return</span> &#x8FD4;&#x56DE;&#x5BF9;&#x5E94;&#x7684;&#x8FD4;&#x56DE;&#x503C;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function">V <span class="title">dispatchWebPath</span><span class="params">(Uri keyPath)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x7B80;&#x5355;&#x8BB2;&#x89E3;&#x4E00;&#x4E0B;&#xFF0C;&#x9996;&#x5148;&#x662F;iPath&#x63A5;&#x53E3;&#x4E2D;&#x7684;&#x4E24;&#x4E2A;&#x6CDB;&#x578B;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x6CDB;&#x578B;K&#x662F;&#x6211;&#x4EEC;&#x6CE8;&#x518C;&#x7684;&#x8DEF;&#x7531;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x6BD4;&#x5982;Activity,Service&#x7B49;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x6CDB;&#x578B;V&#x662F;&#x6211;&#x4EEC;&#x7684;&#x8FD4;&#x56DE;&#x7C7B;&#x578B;&#xFF0C;&#x6BD4;&#x5982;&#x6211;&#x4EEC;&#x521A;&#x624D;&#x8BF4;&#x5230;&#x7684;Intent,&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;V&#xFF0C;&#x53EA;&#x4E0D;&#x8FC7;&#x4E3A;&#x4E86;&#x66F4;&#x52A0;&#x7075;&#x6D3B;&#x4FBF;&#x4E8E;&#x6269;&#x5C55;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x8FD4;&#x56DE;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;&#x6210;&#x4E86;&#x6CDB;&#x578B;&#x3002;<br>&#x5B9A;&#x4E49;&#x597D;&#x8DEF;&#x5F84;&#x63A5;&#x53E3;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x57FA;&#x7C7B;&#x6765;&#x7EDF;&#x4E00;&#x8FD9;&#x4E9B;&#x8DEF;&#x5F84;&#x63A5;&#x53E3;&#x7684;&#x4E00;&#x4E9B;&#x901A;&#x7528;&#x578B;&#x64CD;&#x4F5C;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CommonIpath</span>&lt;<span class="title">K</span>&gt; <span class="keyword">implements</span> <span class="title">iPath</span>&lt;<span class="title">K</span>,<span class="title">Intent</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ArrayMap&lt;String,Class&lt;K&gt;&gt; mPaths;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CommonIpath</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">        CoolLog.i(<span class="string">&quot;add a path to router&quot;</span>);</span><br><span class="line">        mPaths=<span class="keyword">new</span> ArrayMap&lt;&gt;();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addPath</span><span class="params">(String keyPath, Class&lt;K&gt; tClass)</span></span>{</span><br><span class="line"></span><br><span class="line">        mPaths.put(keyPath,tClass);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Intent <span class="title">dispatchPath</span><span class="params">(Context context, String keyPath)</span></span>{</span><br><span class="line"></span><br><span class="line">        Class&lt;K&gt; tClass=mPaths.get(keyPath);</span><br><span class="line">        <span class="keyword">if</span>(tClass==<span class="keyword">null</span>){</span><br><span class="line">            CoolLog.w(<span class="string">&quot;target class is null&quot;</span>);</span><br><span class="line">            throwExceptions(keyPath);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Intent(context,tClass);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">clearPath</span><span class="params">(String keyPath)</span></span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(mPaths.get(keyPath)!=<span class="keyword">null</span>){</span><br><span class="line"></span><br><span class="line">            mPaths.remove(keyPath);</span><br><span class="line">        }</span><br><span class="line">            <span class="keyword">return</span> isExistPath(keyPath);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isExistPath</span><span class="params">(String keyPath)</span></span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> mPaths.get(keyPath) != <span class="keyword">null</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">throwExceptions</span><span class="params">(String keyPath)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Intent <span class="title">dispatchWebPath</span><span class="params">(Uri keyPath)</span></span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!URLUtil.checkUrl(keyPath.toString())){</span><br><span class="line">            throwExceptions(keyPath.toString());</span><br><span class="line">        }</span><br><span class="line">            Intent intent=<span class="keyword">new</span> Intent();</span><br><span class="line">            intent.setAction(Intent.ACTION_VIEW);</span><br><span class="line">            intent.setData(keyPath);</span><br><span class="line">            <span class="keyword">return</span> intent;</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x6E90;&#x7801;&#x975E;&#x5E38;&#x7B80;&#x5355;&#xFF0C;&#x5C31;&#x662F;&#x5BF9;ArrayMap&#x7684;&#x4E00;&#x5806;&#x64CD;&#x4F5C;&#x800C;&#x5DF2;&#xFF0C;&#x8FD9;&#x91CC;&#x5176;&#x5B9E;&#x662F;&#x8981;&#x6CE8;&#x610F;&#x7C7B;&#x540D;&#x5B9A;&#x4E49;&#x90A3;&#x884C;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;iPath&#x7684;V&#x503C;&#x5B9A;&#x4E49;&#x6210;&#x4E86;Intent,&#x5E76;&#x4E14;&#x7ED9;CommonIPath&#x5B9A;&#x4E49;&#x4E86;&#x6CDB;&#x578B;K,&#x8FD9;&#x6837;&#x6211;&#x4EEC;&#x7684;ArrayMap&#x5B58;&#x653E;&#x7684;&#x53EA;&#x80FD;&#x662F;&#x6211;&#x4EEC;&#x5728;&#x8C03;&#x7528;&#x754C;&#x9762;&#x5B9A;&#x4E49;&#x597D;&#x7684;&#x7C7B;&#x578B;&#x4E86;&#x3002;<br>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6CE8;&#x610F;&#x5230;CommonIPath&#x662F;&#x4E00;&#x4E2A;&#x62BD;&#x8C61;&#x7C7B;&#xFF0C;&#x90A3;&#x4E48;&#x65E2;&#x7136;&#x662F;&#x62BD;&#x8C61;&#x7C7B;&#xFF0C;&#x5C31;&#x80AF;&#x5B9A;&#x6709;&#x4ED6;&#x7684;&#x5B50;&#x7C7B;&#x7EE7;&#x627F;&#x5B83;&#x5E76;&#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x4E9B;&#x7279;&#x6709;&#x7684;&#x65B9;&#x6CD5;&#x5C06;iPath&#x5DEE;&#x5F02;&#x5316;&#xFF0C;&#x5176;&#x5B9E;&#x8DEF;&#x7531;&#x6846;&#x67B6;&#x9ED8;&#x8BA4;&#x63D0;&#x4F9B;&#x7684;&#x5C31;&#x662F;Activity&#xFF0C;Service&#x548C;BroadcastReceiver&#x8FD9;&#x4E09;&#x79CD;&#x8DEF;&#x7531;&#x7C7B;&#x578B;&#xFF0C;&#x90A3;&#x4E48;&#x8981;&#x5B9E;&#x73B0;CommonIpath&#x7684;&#x5B50;&#x7C7B;&#x7C7B;&#x578B;&#x5C31;&#x5F88;&#x6E05;&#x695A;&#x4E86;&#xFF0C;&#x770B;&#x4EE3;&#x7801;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActivityIPath</span> <span class="keyword">extends</span> <span class="title">CommonIpath</span>&lt;<span class="title">Activity</span>&gt; </span>{</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">throwExceptions</span><span class="params">(String keyPath)</span> </span>{</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RouterNullWithActivityException(keyPath);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServiceIPath</span> <span class="keyword">extends</span> <span class="title">CommonIpath</span>&lt;<span class="title">Activity</span>&gt; </span>{</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">throwExceptions</span><span class="params">(String keyPath)</span> </span>{</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RouterNullWithServiceException(keyPath);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReceiverIPath</span> <span class="keyword">extends</span> <span class="title">CommonIpath</span>&lt;<span class="title">Activity</span>&gt; </span>{</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">throwExceptions</span><span class="params">(String keyPath)</span> </span>{</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RouterNullWithReciverException(keyPath);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x4E09;&#x4E2A;&#x7C7B;&#x90FD;&#x7EE7;&#x627F;&#x4E86;CommonIPath,&#x5E76;&#x4E14;&#x5C06;&#x5176;&#x6CDB;&#x578B;&#x8BBE;&#x7F6E;&#x6210;&#x4E86;&#x81EA;&#x5DF1;&#x5BF9;&#x5E94;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x65E2;&#x7136;&#x7EE7;&#x627F;&#x4E86;CommonIPath,&#x90A3;&#x4E48;&#x5C31;&#x8981;&#x5B9E;&#x73B0;&#x5176;&#x62BD;&#x8C61;&#x65B9;&#x6CD5; throwExceptions()&#xFF0C;&#x5176;&#x76EE;&#x7684;&#x4E5F;&#x662F;&#x4E3A;&#x4E86;&#x5728;&#x4E0D;&#x89C4;&#x8303;&#x64CD;&#x4F5C;&#x8DEF;&#x7531;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x53EF;&#x4EE5;&#x5FEB;&#x901F;&#x7684;&#x5B9A;&#x4F4D;&#x5F02;&#x5E38;&#x800C;&#x8BBE;&#x8BA1;&#x7684;&#xFF0C;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x770B;&#x5F02;&#x5E38;&#x8BBE;&#x8BA1;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseAndroidException</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BaseAndroidException</span><span class="params">(String name, String pattern)</span> </span>{</span><br><span class="line"> <span class="keyword">super</span>(String.format(<span class="string">&quot;%s:%s&#xFF08;&#x65E0;&#x6CD5;&#x89E3;&#x6790;&#x8FD9;&#x4E2A;&#x8DEF;&#x7531;&#x8DEF;&#x5F84;&#xFF0C;&#x4F60;&#x786E;&#x5B9A;&#x5DF2;&#x7ECF;&#x52A0;&#x5165;&#x5230;&#x516C;&#x7528;&#x8DEF;&#x7531;&#x5668;&#x4E2D;&#x4E86;&#x5417;?&#xFF09;&quot;</span>, name, pattern));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x4E00;&#x4E2A;&#x5F02;&#x5E38;&#x57FA;&#x7C7B;&#xFF0C;&#x8D77;&#x5230;&#x7684;&#x4F5C;&#x7528;&#x662F;&#x89C4;&#x8303;&#x5316;&#x5F02;&#x5E38;&#x64CD;&#x4F5C;&#x8FD4;&#x56DE;&#x7684;&#x5F02;&#x5E38;&#x65E5;&#x5FD7;&#x3002;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RouterNullWithActivityException</span> <span class="keyword">extends</span> <span class="title">BaseAndroidException</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RouterNullWithActivityException</span><span class="params">(String pattern)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(<span class="string">&quot;Activity&quot;</span>, pattern);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RouterNullWithServiceException</span> <span class="keyword">extends</span> <span class="title">BaseAndroidException</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RouterNullWithServiceException</span><span class="params">(String pattern)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(<span class="string">&quot;Service&quot;</span>, pattern);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RouterNullWithReciverException</span> <span class="keyword">extends</span> <span class="title">BaseAndroidException</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RouterNullWithReciverException</span><span class="params">(String pattern)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(<span class="string">&quot;Reciver&quot;</span>, pattern);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x8DF3;&#x8F6C;Web&#x754C;&#x9762;&#x65F6;&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x7684;&#x5F02;&#x5E38;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseWebException</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BaseWebException</span><span class="params">(String name, String pattern)</span> </span>{</span><br><span class="line">	<span class="keyword">super</span>(String.format(<span class="string">&quot;%s:%s &#xFF08;&#x7F51;&#x7EDC;&#x8DEF;&#x5F84;&#x4E0D;&#x89C4;&#x8303;&#xFF0C;&#x8BF7;&#x89C4;&#x8303;&#x8DEF;&#x5F84;&#x540E;&#x518D;&#x6B21;&#x8BF7;&#x6C42;&#x3002;&#xFF09;&quot;</span>, name, pattern));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RouterUrlException</span> <span class="keyword">extends</span> <span class="title">BaseWebException</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RouterUrlException</span><span class="params">( String pattern)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(<span class="string">&quot;HTTP&quot;</span>, pattern);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x5F02;&#x5E38;&#x7684;&#x8BBE;&#x8BA1;&#x57FA;&#x672C;&#x4E0A;&#x6CA1;&#x4EC0;&#x4E48;&#x53EF;&#x8BF4;&#x7684;&#x548C;iPath&#x7684;&#x7C7B;&#x578B;&#x8BBE;&#x8BA1;&#x57FA;&#x672C;&#x4E0A;&#x662F;&#x5BF9;&#x5E94;&#x7684;&#xFF0C;&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x770B;&#x6838;&#x5FC3;&#x7684;&#x8DEF;&#x7531;&#x7C7B;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoolRouter</span> </span>{</span><br><span class="line"></span><br><span class="line">    String keyPath;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * scheme-&gt;&#x8DEF;&#x7531;&#x89C4;&#x5219;&#x5185;&#x5BB9;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> ArrayMap&lt;String,iPath&gt; mPathFilters;</span><br><span class="line">    <span class="keyword">private</span> CoolRouterOptions routerOptions=<span class="keyword">new</span> CoolRouterOptions();</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">CoolRouter</span><span class="params">()</span> </span>{</span><br><span class="line">        mPathFilters = <span class="keyword">new</span> ArrayMap&lt;&gt;();</span><br><span class="line">        initDefault();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initDefault</span><span class="params">()</span></span>{</span><br><span class="line">        addPathFilter(KeyPathConfig.ACTIVITY_SCHEME,<span class="keyword">new</span> ActivityIPath());</span><br><span class="line">        addPathFilter(KeyPathConfig.RECEIVER_SCHEME,<span class="keyword">new</span> ReceiverIPath());</span><br><span class="line">        addPathFilter(KeyPathConfig.SERVICE_SCHEME,<span class="keyword">new</span> ServiceIPath());</span><br><span class="line">        addPathFilter(KeyPathConfig.HTTP_SCHEME,<span class="keyword">new</span> HttpIPath());</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Holder</span></span>{</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> CoolRouter INSTANCE = <span class="keyword">new</span> CoolRouter();</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> CoolRouter <span class="title">getIns</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> Holder.INSTANCE;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span>  &lt;K,V&gt;iPath&lt;K,V&gt; getPath(String keyPath){</span><br><span class="line"></span><br><span class="line">        ArrayMap&lt;String,iPath&gt; pathFilters=mPathFilters;</span><br><span class="line">        Set&lt;String&gt; keySet = pathFilters.keySet();</span><br><span class="line">        iPath&lt;K, V&gt; rule = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">for</span> (String scheme : keySet) {</span><br><span class="line">            <span class="keyword">if</span> (keyPath.startsWith(scheme)) {</span><br><span class="line">                rule = pathFilters.get(scheme);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> rule;</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6DFB;&#x52A0;&#x8DF3;&#x8F6C;&#x52A8;&#x753B;</span><br><span class="line">     * <span class="doctag">@param</span> enterAnim &#x8FDB;&#x5165;&#x52A8;&#x753B;</span><br><span class="line">     * <span class="doctag">@param</span> exitAnim &#x9000;&#x51FA;&#x52A8;&#x753B;</span><br><span class="line">     * <span class="doctag">@return</span></span><br><span class="line">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CoolRouter <span class="title">setAnim</span><span class="params">(@AnimRes <span class="keyword">int</span> enterAnim,@AnimRes <span class="keyword">int</span> exitAnim)</span></span>{</span><br><span class="line">        routerOptions.setAnim(enterAnim,exitAnim);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CoolRouter <span class="title">setRequestCode</span><span class="params">(<span class="keyword">int</span> requestCode)</span></span>{</span><br><span class="line"></span><br><span class="line">        routerOptions.setRequestCode(requestCode);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CoolRouter <span class="title">setBundle</span><span class="params">(Bundle bundle)</span></span>{</span><br><span class="line"></span><br><span class="line">        routerOptions.setBundle(bundle);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6DFB;&#x52A0;&#x81EA;&#x5B9A;&#x4E49;&#x8DEF;&#x5F84;&#x8FC7;&#x6EE4;&#x5668;</span><br><span class="line">     * <span class="doctag">@param</span> key</span><br><span class="line">     * <span class="doctag">@param</span> iPath</span><br><span class="line">     */</span></span><br><span class="line">     <span class="function">CoolRouter <span class="title">addPathFilter</span><span class="params">(String key,iPath iPath)</span></span>{</span><br><span class="line"></span><br><span class="line">        mPathFilters.put(key, iPath);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6DFB;&#x52A0;&#x81EA;&#x5B9A;&#x4E49;&#x8DEF;&#x5F84;</span><br><span class="line">     * <span class="doctag">@param</span> keyPath</span><br><span class="line">     * <span class="doctag">@param</span> tClass</span><br><span class="line">     * <span class="doctag">@param</span> &lt;K&gt;</span><br><span class="line">     * <span class="doctag">@return</span></span><br><span class="line">     */</span></span><br><span class="line">     <span class="keyword">final</span>  &lt;K&gt; <span class="function">CoolRouter <span class="title">addPath</span><span class="params">(String keyPath,Class&lt;K&gt; tClass)</span></span>{</span><br><span class="line">        iPath&lt;K,?&gt; path=getPath(keyPath);</span><br><span class="line">        <span class="keyword">if</span>(path ==<span class="keyword">null</span>){</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> BaseAndroidException(<span class="string">&quot;&#x672A;&#x77E5;&quot;</span>,keyPath);</span><br><span class="line">        }</span><br><span class="line">        path.addPath(keyPath,tClass);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x53D1;&#x9001;&#x8DEF;&#x7531; &#x8DF3;&#x8F6C;</span><br><span class="line">     * <span class="doctag">@param</span> context</span><br><span class="line">     * <span class="doctag">@param</span> keyPath</span><br><span class="line">     * <span class="doctag">@param</span> &lt;V&gt;</span><br><span class="line">     * <span class="doctag">@return</span></span><br><span class="line">     */</span></span><br><span class="line">     <span class="keyword">final</span> &lt;V&gt; <span class="function">V <span class="title">dispatchPath</span><span class="params">(Context context,String keyPath)</span></span>{</span><br><span class="line">         iPath&lt;?,V&gt;  path=getPath(keyPath);</span><br><span class="line">         Uri uri=Uri.parse(keyPath);</span><br><span class="line">         <span class="keyword">if</span>(path ==<span class="keyword">null</span>){</span><br><span class="line">             <span class="keyword">throw</span> <span class="keyword">new</span> BaseAndroidException(<span class="string">&quot;&#x672A;&#x77E5;&quot;</span>,keyPath);</span><br><span class="line">         }</span><br><span class="line">         <span class="keyword">if</span>(uri.getScheme().equals(<span class="string">&quot;http&quot;</span>)||uri.getScheme().equals(<span class="string">&quot;https&quot;</span>)){</span><br><span class="line"></span><br><span class="line">             <span class="keyword">return</span>  path.dispatchWebPath(uri);</span><br><span class="line">         }<span class="keyword">else</span>{</span><br><span class="line">             <span class="keyword">return</span>  path.dispatchPath(context,keyPath);</span><br><span class="line">         }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x4F20;&#x5165;&#x8DEF;&#x7531;&#x8DEF;&#x5F84; &#x5224;&#x65AD;&#x8BE5;&#x8DEF;&#x7531;&#x662F;&#x5426;&#x5B58;&#x5728;</span><br><span class="line">     * <span class="doctag">@param</span> keyPath</span><br><span class="line">     * <span class="doctag">@return</span></span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">final</span>  <span class="keyword">boolean</span> <span class="title">routerIsExist</span><span class="params">(String keyPath)</span></span>{</span><br><span class="line"></span><br><span class="line">       iPath&lt;?,?&gt; path= getPath(keyPath);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(path!=<span class="keyword">null</span>&amp;&amp;path.isExistPath(keyPath)){</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@param</span> keyPath</span><br><span class="line">     * <span class="doctag">@return</span></span><br><span class="line">     */</span></span><br><span class="line">    <span class="function">CoolRouter <span class="title">build</span><span class="params">(String keyPath)</span></span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.keyPath=keyPath;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">go</span><span class="params">(Context context)</span></span>{</span><br><span class="line">        Intent intent =dispatchPath(context,keyPath);</span><br><span class="line">        <span class="keyword">if</span>(intent==<span class="keyword">null</span>){</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;intent is null&quot;</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(routerOptions.getRequestCode()&gt;=<span class="number">0</span>){</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(context <span class="keyword">instanceof</span> Activity){</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (context <span class="keyword">instanceof</span> Activity) {</span><br><span class="line">                    ((Activity) context).startActivityForResult(intent, routerOptions.getRequestCode());</span><br><span class="line">                } <span class="keyword">else</span> {</span><br><span class="line">                    CoolLog.w(<span class="string">&quot;Please pass an Activity context to call method &apos;startActivityForResult&apos;&quot;</span>);</span><br><span class="line">                    context.startActivity(intent);</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (routerOptions.getEnterAnim() != <span class="number">0</span> &amp;&amp; routerOptions.getExitAnim() != <span class="number">0</span></span><br><span class="line">                &amp;&amp; context <span class="keyword">instanceof</span> Activity) {</span><br><span class="line">            <span class="comment">// Add transition animation.</span></span><br><span class="line">            ((Activity) context).overridePendingTransition(</span><br><span class="line">                    routerOptions.getEnterAnim(), routerOptions.getExitAnim());</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>CoolRouter&#x5C31;&#x662F;&#x8DEF;&#x7531;&#x7684;&#x6838;&#x5FC3;&#x7C7B;&#x4E86;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x5206;&#x53D1;&#x89C4;&#x5219;&#x548C;&#x5B58;&#x50A8;&#x6A21;&#x5F0F;&#x5176;&#x5B9E;&#x90FD;&#x662F;&#x5728;&#x8FD9;&#x91CC;&#x5B9A;&#x4E49;&#x7684;&#xFF0C;&#x800C;&#x83B7;&#x53D6;CoolRouter&#x7684;&#x65B9;&#x6CD5;&#x662F;&#x4E00;&#x4E2A;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#xFF0C;&#x76EE;&#x7684;&#x5C31;&#x662F;&#x5728;&#x4E00;&#x4E2A;&#x9879;&#x76EE;&#x4E2D;&#x6211;&#x4EEC;&#x4E0D;&#x7528;&#x4E3A;&#x8FD9;&#x4E2A;&#x8DEF;&#x7531;&#x5668;&#x521B;&#x9020;&#x591A;&#x4E2A;&#x5B9E;&#x4F8B;&#x4ECE;&#x800C;&#x5F71;&#x54CD;&#x6211;&#x4EEC;&#x7684;&#x7CFB;&#x7EDF;&#x6027;&#x80FD;&#xFF0C;CoolRouter&#x5176;&#x5B9E;&#x662F;&#x88AB;&#x5206;&#x6210;&#x4E86;&#x4E24;&#x4E2A;&#x90E8;&#x5206;&#xFF0C;&#x4E00;&#x90E8;&#x5206;&#x8D1F;&#x8D23;&#x627F;&#x4E0A;&#xFF0C;&#x6BD4;&#x5982;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x8DF3;&#x8F6C;&#x53C2;&#x6570;Bundle&#xFF0C;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x8DF3;&#x8F6C;&#x52A8;&#x753B;&#x4EE5;&#x53CA;&#x8BBE;&#x7F6E;&#x56DE;&#x8C03;&#x8BF7;&#x6C42;&#x7801;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x90E8;&#x5206;&#x662F;&#x542F;&#x4E0B;&#xFF0C;&#x4E3B;&#x8981;&#x7684;&#x4F5C;&#x7528;&#x662F;&#x6DFB;&#x52A0;&#x8FC7;&#x6EE4;&#x5668;&#xFF0C;&#x6DFB;&#x52A0;&#x5206;&#x53D1;&#x89C4;&#x5219;&#xFF0C;&#x5224;&#x65AD;&#x5F53;&#x524D;&#x8DEF;&#x7531;&#x8DEF;&#x5F84;&#x662F;&#x5426;&#x5B58;&#x5728;&#x7B49;&#xFF0C;&#x8FD9;&#x4E24;&#x90E8;&#x5206;&#x529F;&#x80FD;&#x5171;&#x540C;&#x5B8C;&#x6210;&#x4E86;CoolRouter&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x4ECE;&#x800C;&#x5B9E;&#x73B0;&#x4E86;&#x8BA9;&#x6211;&#x4EEC;&#x5728;&#x4F7F;&#x7528;&#x8FC7;&#x7A0B;&#x4E2D;&#x65E2;&#x53EF;&#x4EE5;&#x8FD4;&#x56DE;Intent&#x6765;&#x8BA9;&#x6211;&#x4EEC;&#x539F;&#x751F;&#x64CD;&#x4F5C;&#x4E5F;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x7528;&#x8DEF;&#x7531;&#x5668;&#x63D0;&#x4F9B;&#x7684;&#x4EE3;&#x7801;&#x65B9;&#x4FBF;&#x7684;&#x8FDB;&#x884C;&#x8DF3;&#x8F6C;&#x3002;<br>&#x4E4B;&#x540E;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x4EE3;&#x7406;&#x7C7B;&#xFF0C;CoolRouterTool&#x4E86;&#xFF0C; &#x4EE3;&#x7801;&#x975E;&#x5E38;&#x7B80;&#x5355;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x5C31;&#x662F;&#x5BF9;CoolRouter&#x4EE3;&#x7801;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x4EE5;&#x53CA;&#x4F7F;&#x7528;&#x4E86;&#x5EFA;&#x9020;&#x8005;&#x6A21;&#x5F0F;&#xFF0C;&#x53EF;&#x4EE5;&#x94FE;&#x5F0F;&#x8C03;&#x7528;&#x6211;&#x4EEC;CoolRouter&#x7684;&#x65B9;&#x6CD5;&#x3002;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoolRouterTool</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">openLog</span><span class="params">()</span> </span>{</span><br><span class="line">        CoolLog.openLog();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x6DFB;&#x52A0;&#x8DEF;&#x7531;&#x8FC7;&#x6EE4;&#x89C4;&#x5219;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> CoolRouter <span class="title">addPathFilter</span><span class="params">(String scheme, iPath iPath)</span> </span>{</span><br><span class="line"></span><br><span class="line">        CoolRouter coolRouter = CoolRouter.getIns();</span><br><span class="line">        coolRouter.addPathFilter(scheme, iPath);</span><br><span class="line">        <span class="keyword">return</span> coolRouter;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;K&gt; <span class="function">CoolRouter <span class="title">addPath</span><span class="params">(String keyPath, Class&lt;K&gt; tClass)</span> </span>{</span><br><span class="line"></span><br><span class="line">        CoolRouter coolRouter = CoolRouter.getIns();</span><br><span class="line">        coolRouter.addPath(keyPath, tClass);</span><br><span class="line">        <span class="keyword">return</span> coolRouter;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;V&gt; <span class="function">V <span class="title">dispatchPath</span><span class="params">(Context context, String keyPath)</span> </span>{</span><br><span class="line"></span><br><span class="line">        CoolRouter coolRouter = CoolRouter.getIns();</span><br><span class="line">        V v = coolRouter.dispatchPath(context, keyPath);</span><br><span class="line">        <span class="keyword">return</span> v;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">pathIsExist</span><span class="params">(String keyPath)</span></span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> CoolRouter.getIns().routerIsExist(keyPath);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> CoolRouter <span class="title">build</span><span class="params">(String keyPath)</span></span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> CoolRouter.getIns().build(keyPath);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x5C5E;&#x6027;&#x7C7B;&#xFF0C;&#x63D0;&#x4F9B;&#x57FA;&#x7840;&#x5C5E;&#x6027;&#x7684;&#x652F;&#x6301;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;<br>CoolRouterOptions&#x4E3B;&#x8981;&#x662F;&#x63D0;&#x4F9B;CoolRouter&#x7684;&#x4E00;&#x4E9B;&#x57FA;&#x7840;&#x53C2;&#x6570;&#x7684;&#x8BBE;&#x7F6E;&#x53CA;&#x8C03;&#x7528;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoolRouterOptions</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> enterAnim;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> exitAnim;</span><br><span class="line">    <span class="keyword">private</span> Bundle bundle;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> requestCode;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRequestCode</span><span class="params">(<span class="keyword">int</span> requestCode)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.requestCode = requestCode;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBundle</span><span class="params">(Bundle bundle)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.bundle = bundle;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAnim</span><span class="params">(<span class="keyword">int</span> enterAnim,<span class="keyword">int</span> exitAnim)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.enterAnim = enterAnim;</span><br><span class="line">        <span class="keyword">this</span>.exitAnim = exitAnim;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getEnterAnim</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> enterAnim;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEnterAnim</span><span class="params">(<span class="keyword">int</span> enterAnim)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.enterAnim = enterAnim;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getExitAnim</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> exitAnim;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setExitAnim</span><span class="params">(<span class="keyword">int</span> exitAnim)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.exitAnim = exitAnim;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Bundle <span class="title">getBundle</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> bundle;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getRequestCode</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> requestCode;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>KeyPathConfig&#x4E3B;&#x8981;&#x5B58;&#x653E;&#x7684;&#x662F;CoolRouter&#x7684;&#x8DF3;&#x8F6C;&#x7EC4;&#x4EF6;Scheme&#x548C;&#x8DEF;&#x7531;&#x5668;&#x7684;&#x81EA;&#x5B9A;&#x4E49;Log&#x7684;&#x5F00;&#x5173;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">KeyPathConfig</span> </span>{</span><br><span class="line"></span><br><span class="line">      <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String  ACTIVITY_SCHEME=<span class="string">&quot;activity://&quot;</span>;</span><br><span class="line">      <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String  SERVICE_SCHEME=<span class="string">&quot;service://&quot;</span>;</span><br><span class="line">      <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String  RECEIVER_SCHEME=<span class="string">&quot;receiver://&quot;</span>;</span><br><span class="line">      <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String  HTTP_SCHEME=<span class="string">&quot;http://&quot;</span>;</span><br><span class="line">      <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> DEBUG=<span class="keyword">true</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>CoolLog&#x5C31;&#x662F;&#x8DEF;&#x7531;&#x5668;&#x7684;&#x81EA;&#x5B9A;&#x4E49;Log&#x5DE5;&#x5177;&#x7C7B;&#x4E86;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoolLog</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">&quot;CoolRouter&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> loggable = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">openLog</span><span class="params">()</span> </span>{</span><br><span class="line">        loggable = <span class="keyword">true</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">i</span><span class="params">(String msg)</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (loggable) {</span><br><span class="line">            Log.i(TAG, msg);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">i</span><span class="params">(String tag, String msg)</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (loggable) {</span><br><span class="line">            Log.i(tag, msg);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">w</span><span class="params">(String msg)</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (loggable) {</span><br><span class="line">            Log.w(TAG, msg);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">w</span><span class="params">(String msg, Throwable tr)</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (loggable) {</span><br><span class="line">            Log.w(TAG, msg, tr);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">e</span><span class="params">(String msg)</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (loggable) {</span><br><span class="line">            Log.e(TAG, msg);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">e</span><span class="params">(String msg, Throwable tr)</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (loggable) {</span><br><span class="line">            Log.e(TAG, msg, tr);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x5DE5;&#x5177;&#x7C7B;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x4E3A;&#x4E86;&#x9A8C;&#x8BC1;Url&#x8DEF;&#x5F84;&#x7684;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">URLUtil</span> </span>{</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x5224;&#x65AD;Web&#x5730;&#x5740;&#x662F;&#x5426;&#x4E3A;&#x6B63;&#x89C4;&#x7684;&#x8BF7;&#x6C42;&#x5730;&#x5740;</span><br><span class="line">     * <span class="doctag">@param</span> url &#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x5730;&#x5740;</span><br><span class="line">     * <span class="doctag">@return</span> &#x8FD4;&#x56DE;&#x5224;&#x65AD;&#x7ED3;&#x679C;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">checkUrl</span><span class="params">(String url)</span></span>{</span><br><span class="line">        String regEx = <span class="string">&quot;^(http|https|ftp)\\://([a-zA-Z0-9\\.\\-]+(\\:[a-zA-&quot;</span></span><br><span class="line">                + <span class="string">&quot;Z0-9\\.&amp;%\\$\\-]+)*@)?((25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{&quot;</span></span><br><span class="line">                + <span class="string">&quot;2}|[1-9]{1}[0-9]{1}|[1-9])\\.(25[0-5]|2[0-4][0-9]|[0-1]{1}&quot;</span></span><br><span class="line">                + <span class="string">&quot;[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\\.(25[0-5]|2[0-4][0-9]|&quot;</span></span><br><span class="line">                + <span class="string">&quot;[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\\.(25[0-5]|2[0-&quot;</span></span><br><span class="line">                + <span class="string">&quot;4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])|([a-zA-Z0&quot;</span></span><br><span class="line">                + <span class="string">&quot;-9\\-]+\\.)*[a-zA-Z0-9\\-]+\\.[a-zA-Z]{2,4})(\\:[0-9]+)?(/&quot;</span></span><br><span class="line">                + <span class="string">&quot;[^/][a-zA-Z0-9\\.\\,\\?\\&apos;\\\\/\\+&amp;%\\$\\=~_\\-@]*)*$&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> url.matches(regEx);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x5DEE;&#x4E0D;&#x591A;CoolRouter&#x7684;&#x7C7B;&#x5C31;&#x662F;&#x8FD9;&#x4E9B;&#x4E86;&#xFF0C;&#x4ED6;&#x7684;&#x5DE5;&#x7A0B;&#x67B6;&#x6784;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;<br><img src="/2017/03/15/&#x8DDF;&#x6211;&#x8D70;&#xFF0C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;Android&#x8DEF;&#x7531;&#x5668;/3.png" alt="logo"><br>&#x9879;&#x76EE;&#x7684;&#x7C7B;&#x56FE;&#x67B6;&#x6784;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;<br><img src="/2017/03/15/&#x8DDF;&#x6211;&#x8D70;&#xFF0C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;Android&#x8DEF;&#x7531;&#x5668;/4.png" alt="logo"></p>
<p>&#x597D;&#x4E86;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;CoolRouter&#x7684;&#x6574;&#x4F53;&#x5B9E;&#x73B0;&#x5C31;&#x662F;&#x8FD9;&#x6837;&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x8BA4;&#x771F;&#x9605;&#x8BFB;&#x7684;&#x8BDD;&#x4F1A;&#x53D1;&#x73B0;&#x6211;&#x53EA;&#x662F;&#x5B9E;&#x73B0;&#x4E86;Activity&#x7684;&#x8DF3;&#x8F6C;&#xFF0C;&#x800C;Service&#x7684;&#x542F;&#x52A8;&#x548C;BroadcastReceiver&#x7684;&#x542F;&#x52A8;&#x90FD;&#x6CA1;&#x6709;&#x5B9E;&#x73B0;&#xFF0C;&#x5176;&#x5B9E;&#x5982;&#x679C;&#x53EA;&#x662F;&#x8FD4;&#x56DE;Intent&#x5C31;&#x65E0;&#x6240;&#x8C13;&#x4E86;&#x4F46;&#x662F;&#x5982;&#x679C;&#x60F3;&#x5BF9;&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x5C01;&#x88C5;&#x7684;&#x8BDD;&#xFF0C;&#x8FD8;&#x662F;&#x9700;&#x8981;&#x5728;CoolRouter&#x548C;CoolRouterTool&#x4E2D;&#x6DFB;&#x52A0;&#x4E00;&#x4E9B;&#x65B9;&#x6CD5;&#x7684;&#xFF0C;&#x8FD9;&#x4E2A;&#x5C31;&#x7559;&#x7ED9;&#x5927;&#x5BB6;&#x81EA;&#x5DF1;&#x53BB;&#x505A;&#x4E86;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[仿余额宝数字滚动增长的效果实现]]></title>
      <url>http://jasoncool.com/2017/01/24/%E4%BB%BF%E4%BD%99%E9%A2%9D%E5%AE%9D%E6%95%B0%E5%AD%97%E6%BB%9A%E5%8A%A8%E5%A2%9E%E9%95%BF%E7%9A%84%E6%95%88%E6%9E%9C%E5%AE%9E%E7%8E%B0/</url>
      <content type="html"><![CDATA[<p>&#x8FD9;&#x4E2A;&#x5DF2;&#x7ECF;&#x662F;&#x88AB;&#x5927;&#x5BB6;&#x505A;&#x70C2;&#x4E86;&#x7684;&#x6548;&#x679C;&#x4E86;&#xFF0C;&#x4E4B;&#x6240;&#x4EE5;&#x6211;&#x81EA;&#x5DF1;&#x505A;&#x8FD9;&#x4E2A;&#x6548;&#x679C;&#x800C;&#x4E0D;&#x662F;&#x76F4;&#x63A5;&#x4ECE;&#x7F51;&#x4E0A;&#x62F7;&#x8D1D;&#x4E00;&#x4E2A;&#x6765;&#x7528;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x56E0;&#x4E3A;&#x7F51;&#x4E0A;&#x7684;&#x5DE5;&#x5177;&#x4E0D;&#x592A;&#x7B26;&#x5408;&#x6211;&#x7684;&#x8981;&#x6C42;&#xFF0C;&#x5927;&#x90E8;&#x5206;&#x7F51;&#x53CB;&#x5199;&#x7684;&#x5DE5;&#x5177;&#x90FD;&#x4E0D;&#x53EF;&#x4EE5;&#x5E26;&#x5355;&#x4F4D;&#x7684;&#xFF0C;&#x53EA;&#x662F;&#x6570;&#x5B57;&#x65B9;&#x9762;&#x7684;&#x589E;&#x957F;&#x6548;&#x679C;&#xFF0C;&#x800C;&#x6211;&#x7684;APP&#x4E2D;&#x9700;&#x8981;&#x5E26;&#x4E0A;&#x5355;&#x4F4D;&#xFF0C;&#x6BD4;&#x5982;&#x516C;&#x91CC;&#x3001;&#x5347;&#x4E4B;&#x7C7B;&#x7684;&#xFF0C;&#x4E0E;&#x5176;&#x6539;&#x4EBA;&#x5BB6;&#x7684;&#x6E90;&#x7801;&#x4E0D;&#x5982;&#x81EA;&#x5DF1;&#x5199;&#x4E00;&#x4E2A;&#x4E86;&#x3002;<br>&#x5148;&#x770B;&#x6548;&#x679C;&#x56FE;&#xFF1A;<br><img src="/2017/01/24/&#x4EFF;&#x4F59;&#x989D;&#x5B9D;&#x6570;&#x5B57;&#x6EDA;&#x52A8;&#x589E;&#x957F;&#x7684;&#x6548;&#x679C;&#x5B9E;&#x73B0;/1.gif" alt="logo"><br><a id="more"></a></p>
<h2 id="Android&#x4E2D;&#x7684;&#x52A8;&#x753B;">Android&#x4E2D;&#x7684;&#x52A8;&#x753B;</h2><p>&#x8FD9;&#x91CC;&#x7528;&#x5230;&#x4E86;&#x5C5E;&#x6027;&#x52A8;&#x753B;&#xFF0C;Android&#x4E2D;&#x7684;&#x52A8;&#x753B;&#x4E3B;&#x8981;&#x5206;&#x4E3A;&#x4E09;&#x5927;&#x7C7B;&#xFF0C;&#x5206;&#x522B;&#x662F;&#x89C6;&#x56FE;&#x52A8;&#x753B;&#x548C;&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x3002;<br>&#x89C6;&#x56FE;&#x52A8;&#x753B;&#x5206;&#x4E3A;Tween Animation(&#x8865;&#x95F4;&#x52A8;&#x753B;)&#x548C;Frame Animation(&#x9010;&#x5E27;&#x52A8;&#x753B;)<br>&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x5206;&#x4E3A;ValueAnimator &#x548C; ObjectAnimator;</p>
<p>&#x8FD9;&#x91CC;&#x4E00;&#x5B9A;&#x8981;&#x6CE8;&#x610F;&#x4E00;&#x4E0B;&#x5404;&#x79CD;&#x52A8;&#x753B;&#x5F15;&#x5165;&#x65F6;Android&#x7684;&#x7248;&#x672C;&#x53F7;&#xFF0C;&#x5426;&#x5219;&#x52A8;&#x753B;&#x4E0D;&#x4F1A;&#x542F;&#x7528;&#xFF0C;&#x89C6;&#x56FE;&#x52A8;&#x753B;&#x662F;API Level 1&#x5C31;&#x5F15;&#x5165;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x652F;&#x6301;&#x6240;&#x6709;Android&#x7684;&#x7248;&#x672C;&#xFF0C;&#x800C;&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x662F;API Level 11&#x5F15;&#x5165;&#x7684;&#xFF0C;&#x5373;Android 3.0&#x624D;&#x5F00;&#x59CB;&#x6709;&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x76F8;&#x5173;&#x7684;API,&#x6545;&#x800C;&#x5728;&#x4F7F;&#x7528;&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x65F6;&#x4E00;&#x5B9A;&#x8981;&#x5224;&#x65AD;API&#x7684;&#x7248;&#x672C;&#xFF0C;&#x907F;&#x514D;&#x4E00;&#x4E9B;&#x4E0D;&#x5FC5;&#x8981;&#x7684;Bug.</p>
<h2 id="&#x5B9E;&#x73B0;&#x601D;&#x8DEF;">&#x5B9E;&#x73B0;&#x601D;&#x8DEF;</h2><p>&#x6574;&#x4E2A;&#x601D;&#x8DEF;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x5728;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x7EC4;&#x4EF6;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x6709;&#x51E0;&#x4E2A;&#x70B9;&#x662F;&#x8981;&#x8003;&#x8651;&#x8FDB;&#x53BB;&#x7684;&#xFF0C;&#x7B2C;&#x4E00;&#xFF0C;&#x53EF;&#x4EE5;&#x662F;&#x6574;&#x6570;&#x7C7B;&#x578B;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x6D6E;&#x70B9;&#x578B;&#x7684;&#x6570;&#x5B57;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x8981;&#x505A;&#x6807;&#x8BC6;&#x533A;&#x5206;&#x5F00;&#xFF0C;&#x7B2C;&#x4E8C;&#xFF0C;&#x53EF;&#x4EE5;&#x52A0;&#x5165;&#x5355;&#x4F4D;&#xFF08;&#x6838;&#x5FC3;&#x9700;&#x6C42;&#xFF09;&#xFF0C;&#x7B2C;&#x4E09;&#xFF0C;&#x53EF;&#x4EE5;&#x5F00;&#x542F;&#x662F;&#x5426;&#x56DB;&#x820D;&#x4E94;&#x5165;&#xFF0C;&#x6BD4;&#x5982;&#x9700;&#x8981;&#x6574;&#x6570;&#x7C7B;&#x578B;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x800C;&#x4F20;&#x5165;&#x7684;&#x6570;&#x5B57;&#x662F;&#x6D6E;&#x70B9;&#x578B;&#xFF0C;&#x8FD9;&#x65F6;&#x4F1A;&#x81EA;&#x52A8;&#x628A;&#x4F20;&#x5165;&#x7684;&#x6D6E;&#x70B9;&#x578B;&#x8F6C;&#x5316;&#x4E3A;&#x6574;&#x6570;&#x7C7B;&#x578B;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x8981;&#x8003;&#x8651;&#x56DB;&#x820D;&#x4E94;&#x5165;&#x7684;&#x95EE;&#x9898;&#x4E86;&#x3002;</p>
<h2 id="&#x4EE3;&#x7801;&#x5B9E;&#x73B0;">&#x4EE3;&#x7801;&#x5B9E;&#x73B0;</h2><p>&#x4E0B;&#x9762;&#x6765;&#x770B;&#x662F;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x7684;<br>&#x5B9E;&#x73B0;&#x7C7B;:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.animation.ValueAnimator;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"><span class="keyword">import</span> android.view.animation.AccelerateInterpolator;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * &#x7C7B;&#x63CF;&#x8FF0;&#xFF1A; &#x521B;&#x5EFA;&#x4EBA;&#xFF1A;&#x8D3E;&#x771F;</span><br><span class="line"> * &#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2017/1/23 15:44 </span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AutoIncrementUtil</span> </span>{</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String FLOATTYPE=<span class="string">&quot;FloatType&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String INTTYPE=<span class="string">&quot;IntType&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">startAnimation</span><span class="params">(String type,<span class="keyword">final</span> TextView tvView,<span class="keyword">float</span> floatValue</span><br><span class="line">    	,<span class="keyword">boolean</span> isRoundUp,<span class="keyword">final</span> String danwei,<span class="keyword">int</span> duration)</span></span>{</span><br><span class="line">        ValueAnimator animator=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(type.equals(FLOATTYPE)){</span><br><span class="line">              animator=ValueAnimator.ofFloat(<span class="number">0</span>,floatValue);</span><br><span class="line">            animator.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() {</span><br><span class="line">                <span class="annotation">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator valueAnimator)</span> </span>{</span><br><span class="line">                    <span class="keyword">float</span> curValue = (<span class="keyword">float</span>)valueAnimator.getAnimatedValue();</span><br><span class="line">                    Log.e(<span class="string">&quot;curValue &quot;</span>,curValue+<span class="string">&quot;&quot;</span>);</span><br><span class="line">                    tvView.setText(NumUtil.FormatFloat(curValue)+danwei);</span><br><span class="line">                }</span><br><span class="line">            });</span><br><span class="line">        }<span class="keyword">else</span> <span class="keyword">if</span>(type.equals(INTTYPE)){</span><br><span class="line">            String targetValueString =NumUtil.FormatRoundUp(isRoundUp,floatValue);</span><br><span class="line">            animator=ValueAnimator.ofInt(<span class="number">0</span>,Integer.parseInt(targetValueString));</span><br><span class="line">            animator.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() {</span><br><span class="line">                <span class="annotation">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator valueAnimator)</span> </span>{</span><br><span class="line">                    <span class="keyword">int</span> curValue = (<span class="keyword">int</span>)valueAnimator.getAnimatedValue();</span><br><span class="line">                    tvView.setText(curValue+danwei);</span><br><span class="line">                }</span><br><span class="line">            });</span><br><span class="line">        }</span><br><span class="line">        animator.setDuration(duration);</span><br><span class="line">        animator.setInterpolator(<span class="keyword">new</span> AccelerateInterpolator());</span><br><span class="line">        animator.start();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x6570;&#x5B57;&#x8F6C;&#x5316;&#x5DE5;&#x5177;&#x7C7B;:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.text.DecimalFormat;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NumUtil</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">NumUtil</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">FormatFloat</span><span class="params">(<span class="keyword">float</span> value)</span></span>{</span><br><span class="line">        DecimalFormat df = <span class="keyword">new</span> DecimalFormat(<span class="string">&quot;0.00&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> df.format(value);</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">FormatRoundUp</span><span class="params">(<span class="keyword">boolean</span> isRoundUp,<span class="keyword">float</span> value)</span></span>{</span><br><span class="line">        DecimalFormat df;</span><br><span class="line">        <span class="keyword">if</span>(isRoundUp){</span><br><span class="line">            df = <span class="keyword">new</span> DecimalFormat(<span class="string">&quot;######0&quot;</span>); <span class="comment">//&#x56DB;&#x8272;&#x4E94;&#x5165;&#x8F6C;&#x6362;&#x6210;&#x6574;&#x6570;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> df.format(value);</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            Float f= <span class="keyword">new</span> Float(value);</span><br><span class="line">            <span class="keyword">int</span> i=f.intValue();</span><br><span class="line">            <span class="keyword">return</span> String.valueOf(i);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x5982;&#x4F55;&#x4F7F;&#x7528;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AutoIncrementUtil.startAnimation(AutoIncrementUtil.INTTYPE,NumView,<span class="number">153261.93f</span>,<span class="keyword">false</span>,<span class="string">&quot;&#x516C;&#x91CC;&quot;</span>,<span class="number">1500</span>);</span><br></pre></td></tr></table></figure></p>
<p>&#x5E94;&#x8BE5;&#x8BF4;&#x662F;&#x975E;&#x5E38;&#x7B80;&#x5355;&#x4E86;&#xFF0C;&#x4E3B;&#x8981;&#x7528;&#x5230;&#x4E86;&#x5C5E;&#x6027;&#x52A8;&#x753B;&#x7684;ValueAnimator&#x7684;&#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;ofInt&#x548C;ofFloat&#xFF0C;&#x5269;&#x4E0B;&#x7684;&#x90FD;&#x662F;&#x6309;&#x90E8;&#x5C31;&#x73ED;&#x7684;&#x8C03;&#x7528;&#x76F8;&#x5173;&#x7684;&#x65B9;&#x6CD5;&#x5373;&#x53EF;&#xFF0C;&#x5927;&#x5BB6;&#x7A0D;&#x5FAE;&#x9605;&#x8BFB;&#x4E00;&#x4E0B;&#x6E90;&#x7801;&#x5C31;&#x5E94;&#x8BE5;&#x61C2;&#x4E86;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[关于Netty的ByteBuff内存泄漏问题]]></title>
      <url>http://jasoncool.com/2017/01/19/%E5%85%B3%E4%BA%8ENetty%E7%9A%84ByteBuff%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<p>&#x4E4B;&#x524D;&#x505A;&#x7684;&#x4E1C;&#x534E;&#x8F66;&#x7BA1;&#x6570;&#x636E;&#x91C7;&#x96C6;&#x5E73;&#x53F0;&#x603B;&#x662F;&#x53D1;&#x751F;&#x6570;&#x636E;&#x4E22;&#x5931;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x867D;&#x7136;&#x4E0D;&#x9891;&#x7E41;&#x4F46;&#x662F;&#x8FD8;&#x662F;&#x8981;&#x5173;&#x6CE8;&#x4E00;&#x4E0B;&#x539F;&#x56E0;&#xFF0C;&#x4E8E;&#x662F;&#x4ECA;&#x5929;&#x63D0;&#x9AD8;&#x4E86;Netty&#x7684;Log&#x7EA7;&#x522B;&#xFF0C;&#x6253;&#x7B97;&#x67E5;&#x627E;&#x4E00;&#x4E0B;&#x95EE;&#x9898;&#x51FA;&#x5728;&#x54EA;&#x4E86;&#xFF0C;&#x63D0;&#x9AD8;&#x7EA7;&#x522B;&#x4EE3;&#x7801;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ServerBootstrap b =<span class="keyword">new</span> ServerBootstrap();</span><br><span class="line">b.group(bossGroup,workerGroup).channel(NioServerSocketChannel.class).option(ChannelOption.SO_BACKLOG, <span class="number">2048</span>).handler(<span class="keyword">new</span> LoggingHandler(LogLevel.DEBUG)).childHandler(<span class="keyword">new</span> ChildChannelHandler());</span><br></pre></td></tr></table></figure></p>
<p>&#x5C06;Loglevel&#x8BBE;&#x7F6E;&#x6210;DEBUG&#x6A21;&#x5F0F;&#x5C31;OK&#x4E86;&#x3002;<br>&#x4E8E;&#x662F;&#x5F00;&#x59CB;&#x5B89;&#x5FC3;&#x7684;&#x89C2;&#x5BDF;&#x65E5;&#x5FD7;&#xFF1A;<br><a id="more"></a><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">2017-01-19 10:04:46  [ nioEventLoopGroup-1-0:1625429 ] - [ INFO ]  &#x6D88;&#x606F;&#x4E3B;&#x4F53;:60160308049620860021010707190117020453395443491162627407087d081f00002e37008801008c00f9</span><br><span class="line">2017-01-19 10:04:49  [ nioEventLoopGroup-1-0:1628830 ] - [ ERROR ]  LEAK: ByteBuf.release() was not called before it&apos;s garbage-collected. Enable advanced leak reporting to find out where the leak occurred. To enable advanced leak reporting, specify the JVM option &apos;-Dio.netty.leakDetectionLevel=advanced&apos; or call ResourceLeakDetector.setLevel() See http://netty.io/wiki/reference-counted-objects.html for more information.</span><br><span class="line">2017-01-19 10:04:49  [ nioEventLoopGroup-1-0:1628845 ] - [ INFO ]  &#x5165;&#x7F13;&#x5B58;&#x961F;&#x5217;&#x64CD;&#x4F5C;&#x7ED3;&#x679C;:9</span><br><span class="line">2017-01-19 10:04:49  [ nioEventLoopGroup-1-0:1628845 ] - [ INFO ]  &#x6D88;&#x606F;&#x4E3B;&#x4F53;:601603080496208600210107071901170204573954434611626262170f88091f00002e37008801008c00fa</span><br><span class="line">2017-01-19 10:04:53  [ nioEventLoopGroup-1-0:1632839 ] - [ INFO ]  &#x5165;&#x7F13;&#x5B58;&#x961F;&#x5217;&#x64CD;&#x4F5C;&#x7ED3;&#x679C;:9</span><br><span class="line">2017-01-19 10:04:53  [ nioEventLoopGroup-1-0:1632839 ] - [ INFO ]  &#x6D88;&#x606F;&#x4E3B;&#x4F53;:60160308049620860021010707190117020501395443581162624817108a091f00002e37008801008c00fb</span><br><span class="line">2017-01-19 10:04:55  [ nioEventLoopGroup-1-0:1634196 ] - [ INFO ]  &#x5165;&#x7F13;&#x5B58;&#x961F;&#x5217;&#x64CD;&#x4F5C;&#x7ED3;&#x679C;:9</span><br><span class="line">2017-01-19 10:04:55  [ nioEventLoopGroup-1-0:1634196 ] - [ INFO ]  &#x6D88;&#x606F;&#x4E3B;&#x4F53;:601603080496208600210107071901170205023954436011626244571288091f00002e37008801008c00fc</span><br><span class="line">2017-01-19 10:04:56  [ nioEventLoopGroup-1-0:1635288 ] - [ INFO ]  &#x5165;&#x7F13;&#x5B58;&#x961F;&#x5217;&#x64CD;&#x4F5C;&#x7ED3;&#x679C;:9</span><br><span class="line">2017-01-19 10:04:56  [ nioEventLoopGroup-1-0:1635288 ] - [ INFO ]  &#x6D88;&#x606F;&#x4E3B;&#x4F53;:60160308049620860021010707190117020503395443651162624107118a091f00002e37008801008c00fd</span><br><span class="line">2017-01-19 10:04:57  [ nioEventLoopGroup-1-0:1636443 ] - [ INFO ]  &#x5165;&#x7F13;&#x5B58;&#x961F;&#x5217;&#x64CD;&#x4F5C;&#x7ED3;&#x679C;:9</span><br><span class="line">2017-01-19 10:04:57  [ nioEventLoopGroup-1-0:1636443 ] - [ INFO ]  &#x6D88;&#x606F;&#x4E3B;&#x4F53;:601603080496208600210107071901170205053954437111626234671088091f00002e37008801008c00fe</span><br></pre></td></tr></table></figure></p>
<p>&#x6CE8;&#x610F;&#x8FD9;&#x53E5;&#x8BDD;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LEAK: ByteBuf.release() was not called before it<span class="string">&apos;s garbage-collected. Enable advanced leak reporting to find out where the leak occurred. To enable advanced leak reporting, specify the JVM option &apos;</span>-Dio.netty.leakDetectionLevel=advanced<span class="string">&apos; or call ResourceLeakDetector.setLevel() See http://netty.io/wiki/reference-counted-objects.html for more information.</span></span><br></pre></td></tr></table></figure></p>
<p>&#x901A;&#x8FC7;&#x8FD9;&#x53E5;&#x8BDD;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5F97;&#x77E5;&#xFF0C;&#x53EA;&#x8981;&#x52A0;&#x5165;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ResourceLeakDetector.setLevel(ResourceLeakDetector.Level.ADVANCED);</span><br></pre></td></tr></table></figure></p>
<p>&#x5C06;&#x8B66;&#x544A;&#x7EA7;&#x522B;&#x8BBE;&#x7F6E;&#x6210;Advaced&#x5373;&#x53EF;&#x67E5;&#x5230;&#x66F4;&#x8BE6;&#x7EC6;&#x7684;&#x6CC4;&#x6F0F;&#x4FE1;&#x606F;&#xFF0C;&#x4E4B;&#x540E;&#x518D;&#x5EA6;&#x67E5;&#x770B;&#x65E5;&#x5FD7;&#xFF1A;<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line">2017-01-19 10:35:59  [ nioEventLoopGroup-1-0:665092 ] - [ ERROR ]  LEAK: ByteBuf.release() was not called before it&apos;s garbage-collected. See http://netty.io/wiki/reference-counted-objects.html for more information.</span><br><span class="line">Recent access records: 5</span><br><span class="line">#5:</span><br><span class="line">	io.netty.buffer.AdvancedLeakAwareByteBuf.readBytes(AdvancedLeakAwareByteBuf.java:435)</span><br><span class="line">	com.dhcc.ObdServer.ObdServerHandler.channelRead(ObdServerHandler.java:31)</span><br><span class="line">	io.netty.channel.ChannelHandlerInvokerUtil.invokeChannelReadNow(ChannelHandlerInvokerUtil.java:84)</span><br><span class="line">	io.netty.channel.DefaultChannelHandlerInvoker.invokeChannelRead(DefaultChannelHandlerInvoker.java:153)</span><br><span class="line">	io.netty.channel.PausableChannelEventExecutor.invokeChannelRead(PausableChannelEventExecutor.java:86)</span><br><span class="line">	io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:389)</span><br><span class="line">	io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:243)</span><br><span class="line">	io.netty.channel.ChannelHandlerInvokerUtil.invokeChannelReadNow(ChannelHandlerInvokerUtil.java:84)</span><br><span class="line">	io.netty.channel.DefaultChannelHandlerInvoker.invokeChannelRead(DefaultChannelHandlerInvoker.java:153)</span><br><span class="line">	io.netty.channel.PausableChannelEventExecutor.invokeChannelRead(PausableChannelEventExecutor.java:86)</span><br><span class="line">	io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:389)</span><br><span class="line">	io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:956)</span><br><span class="line">	io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:127)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:514)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:471)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:385)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:351)</span><br><span class="line">	io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:116)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1412)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinTask.doExec(ForkJoinTask.java:280)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:877)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool.scan(ForkJoinPool.java:1706)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool.runWorker(ForkJoinPool.java:1661)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:126)</span><br><span class="line">#4:</span><br><span class="line">	Hint: &apos;ObdServerHandler#0&apos; will handle the message from this point.</span><br><span class="line">	io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:387)</span><br><span class="line">	io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:243)</span><br><span class="line">	io.netty.channel.ChannelHandlerInvokerUtil.invokeChannelReadNow(ChannelHandlerInvokerUtil.java:84)</span><br><span class="line">	io.netty.channel.DefaultChannelHandlerInvoker.invokeChannelRead(DefaultChannelHandlerInvoker.java:153)</span><br><span class="line">	io.netty.channel.PausableChannelEventExecutor.invokeChannelRead(PausableChannelEventExecutor.java:86)</span><br><span class="line">	io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:389)</span><br><span class="line">	io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:956)</span><br><span class="line">	io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:127)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:514)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:471)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:385)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:351)</span><br><span class="line">	io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:116)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1412)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinTask.doExec(ForkJoinTask.java:280)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:877)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool.scan(ForkJoinPool.java:1706)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool.runWorker(ForkJoinPool.java:1661)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:126)</span><br><span class="line">#3:</span><br><span class="line">	io.netty.buffer.AdvancedLeakAwareByteBuf.release(AdvancedLeakAwareByteBuf.java:721)</span><br><span class="line">	io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:237)</span><br><span class="line">	io.netty.channel.ChannelHandlerInvokerUtil.invokeChannelReadNow(ChannelHandlerInvokerUtil.java:84)</span><br><span class="line">	io.netty.channel.DefaultChannelHandlerInvoker.invokeChannelRead(DefaultChannelHandlerInvoker.java:153)</span><br><span class="line">	io.netty.channel.PausableChannelEventExecutor.invokeChannelRead(PausableChannelEventExecutor.java:86)</span><br><span class="line">	io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:389)</span><br><span class="line">	io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:956)</span><br><span class="line">	io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:127)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:514)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:471)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:385)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:351)</span><br><span class="line">	io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:116)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1412)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinTask.doExec(ForkJoinTask.java:280)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:877)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool.scan(ForkJoinPool.java:1706)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool.runWorker(ForkJoinPool.java:1661)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:126)</span><br><span class="line">#2:</span><br><span class="line">	io.netty.buffer.AdvancedLeakAwareByteBuf.retain(AdvancedLeakAwareByteBuf.java:693)</span><br><span class="line">	io.netty.handler.codec.DelimiterBasedFrameDecoder.decode(DelimiterBasedFrameDecoder.java:277)</span><br><span class="line">	io.netty.handler.codec.DelimiterBasedFrameDecoder.decode(DelimiterBasedFrameDecoder.java:216)</span><br><span class="line">	io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:316)</span><br><span class="line">	io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:230)</span><br><span class="line">	io.netty.channel.ChannelHandlerInvokerUtil.invokeChannelReadNow(ChannelHandlerInvokerUtil.java:84)</span><br><span class="line">	io.netty.channel.DefaultChannelHandlerInvoker.invokeChannelRead(DefaultChannelHandlerInvoker.java:153)</span><br><span class="line">	io.netty.channel.PausableChannelEventExecutor.invokeChannelRead(PausableChannelEventExecutor.java:86)</span><br><span class="line">	io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:389)</span><br><span class="line">	io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:956)</span><br><span class="line">	io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:127)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:514)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:471)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:385)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:351)</span><br><span class="line">	io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:116)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1412)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinTask.doExec(ForkJoinTask.java:280)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:877)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool.scan(ForkJoinPool.java:1706)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool.runWorker(ForkJoinPool.java:1661)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:126)</span><br><span class="line">#1:</span><br><span class="line">	io.netty.buffer.AdvancedLeakAwareByteBuf.skipBytes(AdvancedLeakAwareByteBuf.java:465)</span><br><span class="line">	io.netty.handler.codec.DelimiterBasedFrameDecoder.decode(DelimiterBasedFrameDecoder.java:272)</span><br><span class="line">	io.netty.handler.codec.DelimiterBasedFrameDecoder.decode(DelimiterBasedFrameDecoder.java:216)</span><br><span class="line">	io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:316)</span><br><span class="line">	io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:230)</span><br><span class="line">	io.netty.channel.ChannelHandlerInvokerUtil.invokeChannelReadNow(ChannelHandlerInvokerUtil.java:84)</span><br><span class="line">	io.netty.channel.DefaultChannelHandlerInvoker.invokeChannelRead(DefaultChannelHandlerInvoker.java:153)</span><br><span class="line">	io.netty.channel.PausableChannelEventExecutor.invokeChannelRead(PausableChannelEventExecutor.java:86)</span><br><span class="line">	io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:389)</span><br><span class="line">	io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:956)</span><br><span class="line">	io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:127)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:514)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:471)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:385)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:351)</span><br><span class="line">	io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:116)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1412)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinTask.doExec(ForkJoinTask.java:280)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:877)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool.scan(ForkJoinPool.java:1706)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool.runWorker(ForkJoinPool.java:1661)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:126)</span><br><span class="line">Created at:</span><br><span class="line">	io.netty.buffer.PooledByteBufAllocator.newDirectBuffer(PooledByteBufAllocator.java:250)</span><br><span class="line">	io.netty.buffer.AbstractByteBufAllocator.directBuffer(AbstractByteBufAllocator.java:155)</span><br><span class="line">	io.netty.buffer.AbstractByteBufAllocator.directBuffer(AbstractByteBufAllocator.java:146)</span><br><span class="line">	io.netty.buffer.AbstractByteBufAllocator.ioBuffer(AbstractByteBufAllocator.java:107)</span><br><span class="line">	io.netty.channel.AdaptiveRecvByteBufAllocator$HandleImpl.allocate(AdaptiveRecvByteBufAllocator.java:104)</span><br><span class="line">	io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:113)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:514)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:471)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:385)</span><br><span class="line">	io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:351)</span><br><span class="line">	io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:116)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1412)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinTask.doExec(ForkJoinTask.java:280)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:877)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool.scan(ForkJoinPool.java:1706)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinPool.runWorker(ForkJoinPool.java:1661)</span><br><span class="line">	io.netty.util.internal.chmv8.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:126)</span><br></pre></td></tr></table></figure></p>
<p>&#x5B9A;&#x4F4D;&#x5230;&#x6211;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#x4E3A;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ByteBuf buff=(ByteBuf) msg;</span><br><span class="line"><span class="keyword">byte</span>[] req=<span class="keyword">new</span> <span class="keyword">byte</span>[buff.readableBytes()];</span><br></pre></td></tr></table></figure></p>
<p>&#x4E8E;&#x662F;&#x53EF;&#x4EE5;&#x786E;&#x5B9A;&#x662F;ByteBuff&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x5BFC;&#x81F4;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4E8E;&#x662F;&#x4ECE;&#x8FD9;&#x65B9;&#x9762;&#x7740;&#x624B;&#x8C03;&#x67E5;&#xFF0C;&#x53D1;&#x73B0;netty5&#x9ED8;&#x8BA4;&#x7684;&#x5206;&#x914D;bytebuff&#x7684;&#x65B9;&#x5F0F;&#x662F;PooledByteBufAllocator,&#x6240;&#x4EE5;&#x8981;&#x624B;&#x52A8;&#x56DE;&#x6536;&#xFF0C;&#x8981;&#x4E0D;&#x7136;&#x4F1A;&#x9020;&#x6210;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x3002;<br>&#x4E8E;&#x662F;&#x91CA;&#x653E;ByteBuff&#x5373;&#x53EF;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ReferenceCountUtil.release(buff);</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x5F15;&#x5165;&#x4E00;&#x4E2A;&#x7F51;&#x53CB;&#x5BF9;&#x4E8E;&#x8FD9;&#x884C;&#x4EE3;&#x7801;&#x7684;&#x8BF4;&#x660E;&#xFF1A;</p>
<blockquote>
<p>ReferenceCountUtil.release()&#x5176;&#x5B9E;&#x662F;ByteBuf.release()&#x65B9;&#x6CD5;&#xFF08;&#x4ECE;ReferenceCounted&#x63A5;&#x53E3;&#x7EE7;&#x627F;&#x800C;&#x6765;&#xFF09;&#x7684;&#x5305;&#x88C5;&#x3002;netty4&#x4E2D;&#x7684;ByteBuf&#x4F7F;&#x7528;&#x4E86;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#xFF08;netty4&#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x53EF;&#x9009;&#x7684;ByteBuf&#x6C60;&#xFF09;&#xFF0C;&#x6BCF;&#x4E00;&#x4E2A;&#x65B0;&#x5206;&#x914D;&#x7684;ByteBuf&gt;&gt;&#x7684;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x503C;&#x4E3A;1&#xFF0C;&#x6BCF;&#x5BF9;&#x8FD9;&#x4E2A;ByteBuf&#x5BF9;&#x8C61;&#x589E;&#x52A0;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#xFF0C;&#x9700;&#x8981;&#x8C03;&#x7528;ByteBuf.retain()&#x65B9;&#x6CD5;&#xFF0C;&#x800C;&#x6BCF;&#x51CF;&#x5C11;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#xFF0C;&#x9700;&#x8981;&#x8C03;&#x7528;ByteBuf.release()&#x65B9;&#x6CD5;&#x3002;&#x5F53;&#x8FD9;&#x4E2A;ByteBuf&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x503C;&#x4E3A;0&#x65F6;&#xFF0C;&#x8868;&#x793A;&#x6B64;&#x5BF9;&#x8C61;&#x53EF;&#x56DE;&#x6536;&#x3002;&#x6211;&#x8FD9;&#x53EA;&#x662F;&#x7528;ByteBuf&#x8BF4;&#x660E;&#xFF0C;&#x8FD8;&#x6709;&#x5176;&#x4ED6;&#x5BF9;&#x8C61;&#x5B9E;&#x73B0;&#x4E86;ReferenceCounted&#x63A5;&#x53E3;&#xFF0C;&#x6B64;&#x65F6;&#x540C;&#x7406;&#x3002;</p>
</blockquote>
<p>&#x5728;&#x68C0;&#x67E5;&#x95EE;&#x9898;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x6211;&#x8FD8;&#x6000;&#x7591;&#x662F;&#x4E0D;&#x662F;&#x6211;&#x7684;Netty&#x4F7F;&#x7528;&#x4E86;UDP&#x534F;&#x8BAE;&#x5BFC;&#x81F4;&#x7684;&#x6570;&#x636E;&#x4E22;&#x5931;&#xFF0C;&#x4E8E;&#x662F;&#x8FD9;&#x91CC;&#x9644;&#x4E0A;Netty&#x4F7F;&#x7528;&#x7684;&#x662F;TCP&#x8FD8;&#x662F;UDP&#x7684;&#x5224;&#x65AD;&#x65B9;&#x6CD5;:</p>
<blockquote>
<p>&#x5173;&#x4E8E;TCP&#x548C;UDP<br>socket&#x53EF;&#x4EE5;&#x57FA;&#x4E8E;TCP&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x57FA;&#x4E8E;UDP&#x3002;&#x533A;&#x522B;&#x5728;&#x4E8E;UDP&#x7684;&#x4E0D;&#x4FDD;&#x8BC1;&#x6570;&#x636E;&#x5305;&#x90FD;&#x6B63;&#x786E;&#x6536;&#x5230;&#xFF0C;&#x6240;&#x4EE5;&#x6027;&#x80FD;&#x66F4;&#x597D;&#xFF0C;&#x4F46;&#x5BB9;&#x9519;&#x4E0D;&#x9AD8;&#x3002;TCP&#x4FDD;&#x8BC1;&#x4E0D;&#x9519;&#xFF0C;&#x6240;&#x4EE5;&#x6027;&#x80FD;&#x6CA1;&#x90A3;&#x4E48;&#x597D;&#x3002;<br>UDP&#x57FA;&#x672C;&#x53EA;&#x9002;&#x5408;&#x505A;&#x5728;&#x7EBF;&#x89C6;&#x9891;&#x4F20;&#x8F93;&#x4E4B;&#x7C7B;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x9700;&#x6C42;&#x5E94;&#x8BE5;&#x4F1A;&#x662F;TCP&#x3002;</p>
<p>&#x90A3;&#x8FD9;2&#x79CD;&#x65B9;&#x5F0F;&#x5728;&#x5199;&#x6CD5;&#x4E0A;&#x6709;&#x4EC0;&#x4E48;&#x4E0D;&#x540C;&#xFF1F;&#x7F51;&#x4E0A;&#x641C;&#x5230;&#x8FD9;&#x6837;&#x7684;&#x8BF4;&#x6CD5;&#xFF1A;</p>
<p>&#x5728;ChannelFactory &#x7684;&#x9009;&#x62E9;&#x4E0A;&#xFF0C;UDP&#x7684;&#x901A;&#x4FE1;&#x9009;&#x62E9; NioDatagramChannelFactory&#xFF0C;TCP&#x7684;&#x901A;&#x4FE1;&#x6211;&#x4EEC;&#x9009;&#x62E9;&#x7684;&#x662F;NioServerSocketChannelFactory&#xFF1B;<br>&#x5728;Bootstrap&#x7684;&#x9009;&#x62E9;&#x4E0A;&#xFF0C;UDP&#x9009;&#x62E9;&#x7684;&#x662F;ConnectionlessBootstrap&#xFF0C;&#x800C;TCP&#x9009;&#x62E9;&#x7684;&#x662F;ServerBootstrap&#x3002; </p>
<p>&#x5BF9;&#x4E8E;&#x7F16;&#x89E3;&#x7801;&#x5668;decoder&#x548C;Encoder&#xFF0C;&#x4EE5;&#x53CA;ChannelPipelineFactory&#xFF0C;UDP&#x5F00;&#x53D1;&#x4E0E;TCP&#x5E76;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x533A;&#x522B;&#xFF0C;&#x5728;&#x6B64;&#x4E0D;&#x505A;&#x8BE6;&#x7EC6;&#x4ECB;&#x7ECD;&#x3002; </p>
<p>&#x5BF9;&#x4E8E;ChannelHandler&#xFF0C;&#x662F;UDP&#x4E0E;TCP&#x533A;&#x522B;&#x7684;&#x6838;&#x5FC3;&#x6240;&#x5728;&#x3002;&#x5927;&#x5BB6;&#x90FD;&#x77E5;&#x9053;UDP&#x662F;&#x65E0;&#x8FDE;&#x63A5;&#x7684;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x4F60;&#x901A;&#x8FC7; MessageEvent &#x53C2;&#x6570;&#x5BF9;&#x8C61;&#x7684; getChannel() &#x65B9;&#x6CD5;&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x4F1A;&#x8BDD;&#x8FDE;&#x63A5;&#xFF0C;&#x4F46;&#x662F;&#x5176; isConnected() &#x6C38;&#x8FDC;&#x90FD;&#x8FD4;&#x56DE; false&#x3002;<br>UDP &#x5F00;&#x53D1;&#x4E2D;&#x5728;&#x6D88;&#x606F;&#x83B7;&#x53D6;&#x4E8B;&#x4EF6;&#x56DE;&#x8C03;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x83B7;&#x53D6;&#x4E86;&#x5F53;&#x524D;&#x4F1A;&#x8BDD;&#x8FDE;&#x63A5; channel &#x5BF9;&#x8C61;&#x540E;&#x53EF;&#x76F4;&#x63A5;&#x901A;&#x8FC7; channel &#x7684; write &#x65B9;&#x6CD5;&#x53D1;&#x9001;&#x6570;&#x636E;&#x7ED9;&#x5BF9;&#x7AEF; channel.write(message, remoteAddress)&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4ECD;&#x7136;&#x662F;&#x8981;&#x53D1;&#x9001;&#x7684;&#x6D88;&#x606F;&#x5BF9;&#x8C61;&#xFF0C;<br>&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x5219;&#x662F;&#x8981;&#x53D1;&#x9001;&#x7684;&#x5BF9;&#x7AEF; SocketAddress &#x5730;&#x5740;&#x5BF9;&#x8C61;&#x3002;<br>&#x8FD9;&#x91CC;&#x6700;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x4E00;&#x70B9;&#x662F;SocketAddress&#xFF0C;&#x5728;TCP&#x901A;&#x4FE1;&#x4E2D;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;channel.getRemoteAddress()&#x83B7;&#x5F97;&#xFF0C;&#x4F46;&#x5728;UDP&#x901A;&#x4FE1;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x4ECE;MessageEvent&#x4E2D;&#x901A;&#x8FC7;&#x8C03;&#x7528;getRemoteAddress()&#x65B9;&#x6CD5;&#x83B7;&#x5F97;&#x5BF9;&#x7AEF;&#x7684;SocketAddress &#x5730;&#x5740;&#x3002;<br><img src="/2017/01/19/&#x5173;&#x4E8E;Netty&#x7684;ByteBuff&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x95EE;&#x9898;/&#x8DDF;&#x6211;&#x8D70;&#xFF0C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;Android&#x8DEF;&#x7531;&#x5668;/1.png" alt="logo"></p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Redis被入侵之后]]></title>
      <url>http://jasoncool.com/2017/01/09/Redis%E8%A2%AB%E5%85%A5%E4%BE%B5%E4%B9%8B%E5%90%8E/</url>
      <content type="html"><![CDATA[<p>&#x4E4B;&#x524D;&#x5F00;&#x53D1;&#x7684;&#x4E1C;&#x534E;&#x8F66;&#x7BA1;OBD&#x7684;&#x6570;&#x636E;&#x91C7;&#x96C6;&#x7AEF;&#x4E00;&#x76F4;&#x6BD4;&#x8F83;&#x7A33;&#x5B9A;&#xFF0C;&#x6240;&#x91C7;&#x7528;&#x7684;&#x6280;&#x672F;&#x65B9;&#x6848;&#x662F;&#x4EE5;Netty&#x4E3A;&#x7F51;&#x7EDC;&#x6846;&#x67B6;&#xFF0C;&#x4EE5;Redis&#x4F5C;&#x4E3A;&#x6D88;&#x606F;&#x961F;&#x5217;&#x548C;&#x5B58;&#x50A8;&#x5DE5;&#x5177;&#xFF0C;&#x8FDB;&#x884C;&#x6570;&#x636E;&#x91C7;&#x96C6;&#x3001;&#x5B58;&#x50A8;&#x548C;&#x53D1;&#x9001;&#xFF0C;&#x867D;&#x7136;&#x7ECF;&#x5386;&#x4E86;&#x4E0D;&#x5C11;&#x95EE;&#x9898;&#xFF0C;&#x4F46;&#x662F;&#x7ECF;&#x8FC7;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x7684;&#x5904;&#x7406;&#x4E4B;&#x540E;&#xFF0C;&#x76F8;&#x5BF9;&#x6765;&#x8BF4;&#x8FD8;&#x662F;&#x6BD4;&#x8F83;&#x7A33;&#x5B9A;&#x7684;&#xFF0C;&#x6700;&#x957F;&#x65F6;&#x95F4;&#x8FDE;&#x7EED;&#x8FD0;&#x884C;&#x8FD1;&#x4E00;&#x4E2A;&#x6708;&#x6CA1;&#x6709;&#x51FA;&#x73B0;&#x8FC7;&#x4EFB;&#x4F55;&#x95EE;&#x9898;&#xFF0C;&#x4E0D;&#x8FC7;&#x6700;&#x8FD1;&#x6211;&#x4EEC;&#x7684;&#x670D;&#x52A1;&#x7AEF;&#x51E0;&#x4E4E;&#x6BCF;&#x5929;&#x90FD;&#x5D29;&#x6E83;&#xFF0C;&#x8FD9;&#x8BA9;&#x6211;&#x975E;&#x5E38;&#x7684;&#x7EB3;&#x95F7;&#xFF0C;&#x5DF2;&#x7ECF;&#x7A33;&#x5B9A;&#x8FD0;&#x884C;&#x4E86;&#x597D;&#x51E0;&#x4E2A;&#x6708;&#x7684;&#x5E73;&#x53F0;&#x4ECE;&#x672A;&#x51FA;&#x73B0;&#x8FC7;&#x5982;&#x6B64;&#x4E25;&#x91CD;&#x7684;&#x7A33;&#x5B9A;&#x6027;&#x95EE;&#x9898;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4E5F;&#x975E;&#x5E38;&#x91CD;&#x89C6;&#x8FD9;&#x4E2A;Bug&#xFF0C;&#x4EE5;&#x6700;&#x5FEB;&#x7684;&#x65F6;&#x95F4;&#x5F00;&#x59CB;&#x7740;&#x624B;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x3002;<br><a id="more"></a><br>Bug&#x7684;&#x5185;&#x5BB9;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Could not get a resource from the pool</span><br><span class="line">java.lang.NullPointerException</span><br></pre></td></tr></table></figure></p>
<p>&#x7B2C;&#x4E00;&#x53E5;&#x662F;&#x8BF4;&#xFF0C;&#x6CA1;&#x529E;&#x6CD5;&#x4ECE;jedis&#x8FDE;&#x63A5;&#x6C60;&#x91CC;&#x83B7;&#x53D6;jedis&#x5BF9;&#x8C61;&#x4E86;&#xFF0C;&#x7B2C;&#x4E8C;&#x53E5;&#x662F;&#x8BF4;&#xFF0C;&#x7A7A;&#x6307;&#x9488;&#x5F02;&#x5E38;&#x4E86;&#x3002;<br>&#x4ECE;&#x9519;&#x8BEF;&#x7684;&#x672C;&#x8EAB;&#x7406;&#x89E3;&#xFF0C;&#x6211;&#x7684;&#x7B2C;&#x4E00;&#x53CD;&#x5E94;&#x662F;&#xFF0C;&#x574F;&#x4E86;&#xFF0C;&#x662F;&#x4E0D;&#x662F;&#x6211;&#x7684;Jedis&#x8FDE;&#x63A5;&#x6C60;&#x6CA1;&#x6709;&#x6B63;&#x5E38;&#x56DE;&#x6536;&#xFF0C;&#x5BFC;&#x81F4;&#x8FDE;&#x63A5;&#x6C60;&#x4E2D;&#x7684;&#x8FDE;&#x63A5;&#x6570;&#x88AB;&#x7528;&#x5B8C;&#x4E86;&#xFF1F;<br>&#x5F53;&#x7136;&#x6211;&#x662F;&#x6BD4;&#x8F83;&#x6000;&#x7591;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#xFF1A;<br>1.&#x91C7;&#x96C6;&#x7684;&#x8F66;&#x8F86;&#x6570;&#x636E;&#x5E76;&#x4E0D;&#x591A;&#xFF0C;&#x7531;&#x4E8E;&#x5E76;&#x53D1;&#x9020;&#x6210;&#x7684;&#x8FDE;&#x63A5;&#x6C60;&#x8FDE;&#x63A5;&#x6570;&#x88AB;&#x7528;&#x5B8C;&#x7684;&#x53EF;&#x80FD;&#x6027;&#x5FAE;&#x4E4E;&#x5176;&#x5FAE;&#x3002;<br>2.&#x8FD0;&#x884C;&#x4E86;&#x597D;&#x51E0;&#x4E2A;&#x6708;&#x4E86;&#x90FD;&#x6CA1;&#x6709;&#x51FA;&#x73B0;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x5728;&#x8F66;&#x8F86;&#x6CA1;&#x6709;&#x5927;&#x6279;&#x91CF;&#x589E;&#x52A0;&#x4E14;&#x8F66;&#x8F86;&#x603B;&#x6570;&#x5E76;&#x4E0D;&#x591A;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x600E;&#x4E48;&#x53EF;&#x80FD;&#x7A81;&#x7136;&#x5C31;&#x5F00;&#x59CB;&#x51FA;&#x73B0;&#x8FD9;&#x79CD;&#x95EE;&#x9898;&#x5462;&#xFF1F;<br>&#x4F46;&#x662F;&#xFF0C;Bug is Bug,&#x8BE5;&#x89E3;&#x51B3;&#x4F60;&#x5C31;&#x5F97;&#x89E3;&#x51B3;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5C31;&#x7ACB;&#x5373;&#x4ECE;&#x8FDE;&#x63A5;&#x6570;&#x56DE;&#x6536;&#x7684;&#x65B9;&#x5411;&#x53BB;&#x5165;&#x624B;&#xFF0C;&#x770B;&#x770B;&#x662F;&#x4E0D;&#x662F;&#x6211;&#x7684;Jedis&#x5199;&#x7684;&#x6709;&#x95EE;&#x9898;&#x3002;</p>
<h2 id="&#x865A;&#x60CA;&#x4E00;&#x573A;">&#x865A;&#x60CA;&#x4E00;&#x573A;</h2><p>&#x901A;&#x8FC7;&#x8C37;&#x6B4C;&#xFF0C;&#x6211;&#x627E;&#x5230;&#x4E86;&#x522B;&#x4EBA;&#x5199;&#x7684;Jedis&#x670D;&#x52A1;&#x7C7B;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &#x751F;&#x6210;&#x591A;&#x673A;&#x8FDE;&#x63A5;&#x4FE1;&#x606F;&#x5217;&#x8868;</span></span><br><span class="line">List&lt;JedisShardInfo&gt; shards = <span class="keyword">new</span> ArrayList&lt;JedisShardInfo&gt;();</span><br><span class="line">shards.add( <span class="keyword">new</span> JedisShardInfo(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>) );</span><br><span class="line">shards.add( <span class="keyword">new</span> JedisShardInfo(<span class="string">&quot;192.168.56.102&quot;</span>, <span class="number">6379</span>) );</span><br><span class="line"></span><br><span class="line"><span class="comment">// &#x751F;&#x6210;&#x8FDE;&#x63A5;&#x6C60;&#x914D;&#x7F6E;&#x4FE1;&#x606F;</span></span><br><span class="line">JedisPoolConfig config = <span class="keyword">new</span> JedisPoolConfig();</span><br><span class="line">config.setMaxIdle(<span class="number">10</span>);</span><br><span class="line">config.setMaxTotal(<span class="number">30</span>);</span><br><span class="line">config.setMaxWaitMillis(<span class="number">3</span>*<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// &#x5728;&#x5E94;&#x7528;&#x521D;&#x59CB;&#x5316;&#x7684;&#x65F6;&#x5019;&#x751F;&#x6210;&#x8FDE;&#x63A5;&#x6C60;</span></span><br><span class="line">ShardedJedisPool pool = <span class="keyword">new</span> ShardedJedisPool(config, shards);</span><br><span class="line"></span><br><span class="line"><span class="comment">// &#x5728;&#x4E1A;&#x52A1;&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x4ECE;&#x8FDE;&#x63A5;&#x6C60;&#x83B7;&#x53D6;&#x8FDE;&#x63A5;</span></span><br><span class="line">ShardedJedis client = pool.getResource();</span><br><span class="line"><span class="keyword">try</span> {</span><br><span class="line">    <span class="comment">// &#x6267;&#x884C;&#x6307;&#x4EE4;</span></span><br><span class="line">    String result = client.set(<span class="string">&quot;key-string&quot;</span>, <span class="string">&quot;Hello, Redis!&quot;</span>);</span><br><span class="line">    System.out.println( String.format(<span class="string">&quot;set&#x6307;&#x4EE4;&#x6267;&#x884C;&#x7ED3;&#x679C;:%s&quot;</span>, result) );</span><br><span class="line">    String value = client.get(<span class="string">&quot;key-string&quot;</span>);</span><br><span class="line">    System.out.println( String.format(<span class="string">&quot;get&#x6307;&#x4EE4;&#x6267;&#x884C;&#x7ED3;&#x679C;:%s&quot;</span>, value) );</span><br><span class="line">} <span class="keyword">catch</span> (Exception e) {</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">} <span class="keyword">finally</span> {</span><br><span class="line">    <span class="comment">// &#x4E1A;&#x52A1;&#x64CD;&#x4F5C;&#x5B8C;&#x6210;&#xFF0C;&#x5C06;&#x8FDE;&#x63A5;&#x8FD4;&#x56DE;&#x7ED9;&#x8FDE;&#x63A5;&#x6C60;if (null != client) {</span></span><br><span class="line">        pool.returnResource(client);</span><br><span class="line">    }</span><br><span class="line">} <span class="comment">// end of try block// &#x5E94;&#x7528;&#x5173;&#x95ED;&#x65F6;&#xFF0C;&#x91CA;&#x653E;&#x8FDE;&#x63A5;&#x6C60;&#x8D44;&#x6E90;</span></span><br><span class="line">pool.destroy();</span><br></pre></td></tr></table></figure></p>
<p>&#x6211;&#x53C8;&#x770B;&#x4E86;&#x770B;&#x6211;&#x7684;Jedis&#x56DE;&#x6536;&#x5199;&#x6CD5;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(Jedis jedis)</span> </span>{</span><br><span class="line">	<span class="keyword">try</span> {</span><br><span class="line">		jedis.close();</span><br><span class="line">	} <span class="keyword">catch</span> (Exception e) {</span><br><span class="line">		<span class="keyword">if</span> (jedis.isConnected()) {</span><br><span class="line">			jedis.quit();</span><br><span class="line">			jedis.disconnect();</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x53D1;&#x73B0;&#x4E86;&#x548C;&#x4EBA;&#x5BB6;&#x5199;&#x7684;&#x600E;&#x4E48;&#x4E0D;&#x4E00;&#x6837;&#x554A;&#xFF1F;<br>&#x8FD9;&#x53E5;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pool.returnResource(client);</span><br></pre></td></tr></table></figure></p>
<p>&#x6211;&#x600E;&#x4E48;&#x6CA1;&#x6709;&#x5199;&#x554A;&#xFF1F;<br>&#x5F53;&#x65F6;&#x5927;&#x9A82;&#x81EA;&#x5DF1;&#x7C97;&#x5FC3;&#xFF0C;&#x56DE;&#x6536;&#x65B9;&#x6CD5;&#x90FD;&#x6CA1;&#x5199;&#x5BF9;&#x600E;&#x4E48;&#x5C31;&#x80FD;&#x5FC3;&#x5B89;&#x7406;&#x5F97;&#x7684;&#x53D1;&#x5E03;&#x7A0B;&#x5E8F;&#x5462;&#xFF1F;&#x4E8E;&#x662F;&#x8D76;&#x7D27;&#x6253;&#x5F00;IDE&#x52A0;&#x4E0A;&#x8FD9;&#x53E5;&#x8BDD;&#xFF0C;&#x53EF;&#x662F;&#x5F53;&#x6211;&#x5728;&#x6211;&#x7684;&#x7A0B;&#x5E8F;&#x4E2D;&#x52A0;&#x4E0A;&#x4E0A;&#x8FB9;&#x8FD9;&#x53E5;&#x4EE3;&#x7801;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x7A81;&#x7136;&#x53D1;&#x73B0;&#x8FD9;&#x884C;&#x4EE3;&#x7801;&#x662F;&#x88AB;&#x9057;&#x5F03;&#x7684;&#x4E86;&#xFF0C;&#x65C1;&#x8FB9;&#x5199;&#x7740;&#x63D0;&#x793A;&#xFF1A;</p>
<blockquote>
<p>Deprecated. starting from Jedis 3.0 this method will not be exposed. Resource cleanup should be done using @see redis.clients.jedis.Jedis.close()<br>&#x610F;&#x601D;&#x662F;Jedis 3.0&#x4EE5;&#x540E;&#xFF0C;&#x8FD9;&#x53E5;&#x4EE3;&#x7801;&#x5DF2;&#x7ECF;&#x88AB;jedis.close()&#x65B9;&#x6CD5;&#x66FF;&#x4EE3;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x7684;&#x5199;&#x6CD5;&#x662F;&#x6CA1;&#x6709;&#x95EE;&#x9898;&#x7684;&#xFF0C;&#x4E4B;&#x524D;&#x662F;&#x865A;&#x60CA;&#x4E00;&#x573A;&#x3002;</p>
</blockquote>
<h2 id="&#x521D;&#x89C1;&#x7AEF;&#x502A;">&#x521D;&#x89C1;&#x7AEF;&#x502A;</h2><p>&#x597D;&#x4E0D;&#x5BB9;&#x6613;&#x7F13;&#x53E3;&#x6C14;&#xFF0C;&#x4F46;&#x662F;&#x4F9D;&#x65E7;&#x8FF7;&#x832B;&#xFF0C;&#x65E2;&#x7136;&#x6211;&#x7684;&#x56DE;&#x6536;&#x5199;&#x6CD5;&#x662F;&#x6B63;&#x786E;&#x7684;&#xFF0C;&#x90A3;&#x4E3A;&#x4EC0;&#x4E48;&#x6211;&#x7684;&#x670D;&#x52A1;&#x7A81;&#x7136;&#x5C31;&#x65E0;&#x6CD5;&#x4ECE;&#x8FDE;&#x63A5;&#x6C60;&#x83B7;&#x53D6;&#x8FDE;&#x63A5;&#x4E86;&#x5462;&#xFF1F;<br>&#x5E26;&#x7740;&#x4E00;&#x5934;&#x7684;&#x96FE;&#x6C34;&#xFF0C;&#x6211;&#x5F00;&#x59CB;&#x5728;&#x670D;&#x52A1;&#x5668;&#x7684;Redis&#x670D;&#x52A1;&#x4E0A;&#x627E;&#x539F;&#x56E0;&#x3002;<br>&#x5F53;&#x65F6;&#x6211;&#x6000;&#x7591;&#x7684;&#x662F;&#xFF0C;&#x662F;&#x4E0D;&#x662F;Redis&#x7684;&#x670D;&#x52A1;&#x6302;&#x4E86;&#xFF1F;&#x7B2C;&#x4E00;&#x53CD;&#x5E94;&#x53BB;WIndows&#x7684;&#x670D;&#x52A1;&#x91CC;&#x53BB;&#x770B;&#xFF0C;&#x7ED3;&#x679C;&#x53D1;&#x73B0;&#x6CA1;&#x6709;&#x6302;&#xFF0C;&#x6B63;&#x5E38;&#x8FD0;&#x884C;&#x4E2D;&#x3002;<br>&#x6211;&#x60F3;&#x65E2;&#x7136;&#x6CA1;&#x6302;&#xFF0C;&#x90A3;&#x6211;&#x8FDE;&#x63A5;&#x4E00;&#x4E0B;&#x770B;&#x770B;&#x5427;&#x3002;<br>&#x4E8E;&#x662F;&#x5C31;&#x7528;redis-cli&#x547D;&#x4EE4;&#x76F4;&#x63A5;&#x8FDE;&#x63A5;&#x670D;&#x52A1;&#xFF0C;&#x8FDE;&#x4E0A;&#x4E86;&#x6CA1;&#x95EE;&#x9898;&#x3002;<br>&#x7136;&#x540E;&#x60F3;&#x8BF4; &#x770B;&#x770B;&#x7F13;&#x5B58;&#x961F;&#x5217;&#x4E2D;&#x8FD8;&#x5B58;&#x7740;&#x54EA;&#x4E9B;&#x6570;&#x636E;&#x5427;&#xFF1F;<br>&#x4E8E;&#x662F;&#x5C31;&#x6253;&#x4E86;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lrange obdMessage <span class="number">0</span> -<span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<p>&#x7ED3;&#x679C;Redis&#x76F4;&#x63A5;&#x62A5;&#x4E86;&#x8B66;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NOAUTH Authentication required</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x7A81;&#x7136;&#x611F;&#x89C9;&#x4E0D;&#x592A;&#x5BF9;&#x52B2;&#x4E86;&#xFF0C;&#x600E;&#x4E48;&#x597D;&#x597D;&#x7684;&#x62A5;&#x4E86;&#x8FD9;&#x4E2A;&#x9519;&#x8BEF;&#x5462;&#xFF1F;&#x800C;&#x4E14;&#x6211;&#x7684;Redis&#x662F;&#x6709;&#x5BC6;&#x7801;&#x7684;&#xFF0C;&#x4E0D;&#x8FC7;&#x5F88;&#x7B80;&#x5355;&#x662F; 111111<br>&#x6211;&#x8D76;&#x7D27;&#x7528;&#x547D;&#x4EE4;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auth <span class="number">111111</span></span><br></pre></td></tr></table></figure></p>
<p>&#x6765;&#x8BBF;&#x95EE;&#x6211;&#x7684;Redis&#xFF0C;&#x7ED3;&#x679C;&#x8FD8;&#x662F;&#x62A5;&#x9519;&#xFF0C;&#x76F4;&#x5230;&#x8FD9;&#x91CC;&#x6211;&#x624D;&#x53D1;&#x73B0;&#xFF0C;&#x53EF;&#x80FD;&#x662F;&#x6211;&#x7684;Redis&#x8BBF;&#x95EE;&#x5BC6;&#x7801;&#x88AB;&#x4EBA;&#x52A8;&#x4E86;&#x624B;&#x811A;&#x3002;</p>
<h2 id="&#x7740;&#x624B;&#x89E3;&#x51B3;">&#x7740;&#x624B;&#x89E3;&#x51B3;</h2><p>&#x4E8E;&#x662F;&#x6211;&#x91CD;&#x542F;&#x4E86;Redis&#x7684;&#x670D;&#x52A1;&#xFF0C;&#x770B;&#x770B;&#x91CD;&#x542F;&#x540E;&#x80FD;&#x4E0D;&#x80FD;&#x8BBF;&#x95EE;Redis,&#x7ED3;&#x679C;&#x8FD8;&#x597D;&#xFF0C;&#x91CD;&#x542F;&#x540E;Redis&#x662F;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x4E86;&#xFF0C;&#x6211;&#x5728;&#x67E5;&#x770B;&#x5B58;&#x50A8;&#x7684;&#x6570;&#x636E;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x7A81;&#x7136;&#x53D1;&#x73B0;&#x597D;&#x50CF;&#x591A;&#x4E86;&#x4E00;&#x4E2A;&#x5B57;&#x6BB5;&#xFF1A;crackit&#x3002;<br>&#x7136;&#x540E;&#x6211;&#x53BB;&#x7F51;&#x4E0A;&#x4E00;&#x641C;&#xFF0C;&#x51FA;&#x73B0;&#x8FD9;&#x4E2A;Crakit&#x5C31;&#x8BF4;&#x660E;&#x6211;&#x7684;Redis&#x80AF;&#x5B9A;&#x662F;&#x88AB;&#x4EBA;&#x5165;&#x4FB5;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&#x5F88;&#x6709;&#x53EF;&#x80FD;&#x5C31;&#x5C31;&#x662F;&#x6211;&#x7684;Redis&#x88AB;&#x4EBA;&#x5165;&#x4FB5;&#x4E4B;&#x540E;&#xFF0C;&#x9ED1;&#x5BA2;&#x6539;&#x4E86;&#x6211;&#x7684;Redis&#x7684;&#x5BC6;&#x7801;&#xFF0C;&#x5BFC;&#x81F4;&#x6211;&#x7684;Redis&#x65E0;&#x6CD5;&#x4F7F;&#x7528;&#x3002;</p>
<p>&#x5165;&#x4FB5;&#x7684;&#x6F0F;&#x6D1E;&#xFF1A;</p>
<blockquote>
<p>Redis &#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4F1A;&#x7ED1;&#x5B9A;&#x5728; 0.0.0.0:6379&#xFF0C;&#x8FD9;&#x6837;&#x5C06;&#x4F1A;&#x5C06; Redis &#x670D;&#x52A1;&#x66B4;&#x9732;&#x5230;&#x516C;&#x7F51;&#x4E0A;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x6CA1;&#x6709;&#x5F00;&#x542F;&#x8BA4;&#x8BC1;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x5BFC;&#x81F4;&#x4EFB;&#x610F;&#x7528;&#x6237;&#x5728;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x76EE;&#x6807;&#x670D;&#x52A1;&#x5668;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x672A;&#x6388;&#x6743;&#x8BBF;&#x95EE; Redis &#x4EE5;&#x53CA;&#x8BFB;&#x53D6; Redis &#x7684;&#x6570;&#x636E;&#x3002;&#x653B;&#x51FB;&#x8005;&#x5728;&#x672A;&#x6388;&#x6743;&#x8BBF;&#x95EE; Redis &#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x53EF;&#x4EE5;&#x5229;&#x7528; Redis &#x7684;&#x76F8;&#x5173;&#x65B9;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x6210;&#x529F;&#x5728; Redis &#x670D;&#x52A1;&#x5668;&#x4E0A;&#x5199;&#x5165;&#x516C;&#x94A5;&#xFF0C;&#x8FDB;&#x800C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5BF9;&#x5E94;&#x79C1;&#x94A5;&#x76F4;&#x63A5;&#x767B;&#x5F55;&#x76EE;&#x6807;&#x670D;&#x52A1;&#x5668;&#x3002;<br>&#x5165;&#x4FB5;&#x7684;&#x7279;&#x5F81;&#xFF1A;<br>Redis &#x53EF;&#x80FD;&#x6267;&#x884C;&#x8FC7; FLUSHALL &#x65B9;&#x6CD5;&#xFF0C;&#x6574;&#x4E2A; Redis &#x6570;&#x636E;&#x5E93;&#x88AB;&#x6E05;&#x7A7A;<br>&#x5728; Redis &#x6570;&#x636E;&#x5E93;&#x4E2D;&#x65B0;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x540D;&#x4E3A; crackit&#xFF08;&#x7F51;&#x4E0A;&#x6D41;&#x4F20;&#x7684;&#x547D;&#x4EE4;&#x6307;&#x4EE4;&#xFF09; &#x7684;&#x952E;&#x503C;&#x5BF9;&#xFF0C;&#x5185;&#x5BB9;&#x4E3A;&#x4E00;&#x4E2A; SSH &#x516C;&#x94A5;&#x3002;<br>&#x5728; /root/.ssh &#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x65B0;&#x5EFA;&#x6216;&#x8005;&#x4FEE;&#x6539;&#x4E86; authorized_keys &#x6587;&#x4EF6;&#xFF0C;&#x5185;&#x5BB9;&#x4E3A; Redis &#x751F;&#x6210;&#x7684; db &#x6587;&#x4EF6;&#xFF0C;&#x5305;&#x542B;&#x4E0A;&#x8FF0;&#x516C;&#x94A5;<br>&#x4FEE;&#x590D;&#x5EFA;&#x8BAE;&#xFF1A;<br>1.&#x5F53;&#x7136;&#x5C31;&#x662F;&#x6539;&#x5BC6;&#x7801;&#x4E86;&#xFF0C;&#x4E4B;&#x524D;&#x7684;&#x5BC6;&#x7801;&#x592A;&#x5F31;&#x4E86;&#xFF0C;&#x53EF;&#x80FD;&#x662F;&#x4E0D;&#x662F;&#x88AB;&#x4EBA;&#x5BB6;&#x7ED9;&#x78B0;&#x4E0A;&#x4E86;&#xFF0C;&#x76F4;&#x63A5;&#x5C31;&#x7834;&#x89E3;&#x4E86;&#xFF0C;&#x8D76;&#x7D27;&#x6539;&#x4E00;&#x4E2A;&#x590D;&#x6742;&#x4E00;&#x70B9;&#x7684;&#x5BC6;&#x7801;&#x624D;&#x662F;&#x738B;&#x9053;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x7684;Redis&#x8FDE;&#x5BC6;&#x7801;&#x90FD;&#x6CA1;&#x6709;&#xFF0C;&#x90A3;&#x66F4;&#x4E0D;&#x884C;&#x4E86;&#xFF0C;&#x770B;&#x770B;&#x6211;&#x7684;&#x906D;&#x9047;&#xFF0C;&#x8D76;&#x7D27;&#x52A0;&#x4E0A;&#x5BC6;&#x7801;&#x5427;&#xFF01;<br> &#x5728;Redis&#x670D;&#x52A1;&#x7684;&#x914D;&#x7F6E;&#x4E2D;&#x52A0;&#x5165;&#x5BC6;&#x7801;&#x9879;&#x76EE;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;&#x6CE8;&#x91CA;&#x7684;&#xFF0C;&#x4F60;&#x8981;&#x624B;&#x52A8;&#x52A0;&#x5165;&#x5BC6;&#x7801;&#xFF0C;&#x6253;&#x5F00;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x627E;&#x5230;&#xFF1A;<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#requirepass foobared</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>&#x53BB;&#x6389;&#x4E4B;&#x524D;&#x7684;&#x6CE8;&#x91CA;&#xFF0C;&#x5E76;&#x4FEE;&#x6539;&#x4E3A;&#x6240;&#x9700;&#x8981;&#x7684;&#x5BC6;&#x7801;&#xFF0C;&#x4FDD;&#x5B58;&#x6587;&#x4EF6;&#x5E76;&#x91CD;&#x542F;Redis&#x670D;&#x52A1;&#x3002;<br>&#x542F;&#x52A8;&#x547D;&#x4EE4;&#x662F;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server --service-install redis.windows-service.conf --loglevel debug</span><br></pre></td></tr></table></figure></p>
<p>&#x6CE8;&#x610F; &#x2013;loglevel debug &#xFF0C;&#x8FD9;&#x91CC;&#x662F;&#x52A0;&#x5165;&#x4E86;&#x65E5;&#x5FD7;&#x7684;&#x542F;&#x52A8;&#x65B9;&#x5F0F;,&#x4E5F;&#x662F;&#x8981;&#x5728;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x7684;&#xFF0C;&#x6253;&#x5F00;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x627E;&#x5230;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">loglevel verbose</span><br></pre></td></tr></table></figure></p>
<p>&#x53BB;&#x6389;&#x6CE8;&#x91CA;&#x5E76;&#x6539;&#x4E3A;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">loglevel debug</span><br></pre></td></tr></table></figure></p>
<p>&#x5E76;&#x4E14;&#x7531;&#x4E8E;&#x8981;&#x5B58;&#x653E;&#x65E5;&#x5FD7;&#x7684;&#x8BDD;&#x5219;&#x8981;&#x7ED9;&#x5B58;&#x653E;&#x7684;Redis&#x65E5;&#x5FD7;&#x542F;&#x7528;&#x5B58;&#x50A8;&#x8DEF;&#x5F84;,&#x5728;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x641C;&#x7D22;&#x201D;logfile&#x201C;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x7ED9;&#x5176;&#x6307;&#x5B9A;&#x8DEF;&#x5F84;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logfile <span class="string">&quot;Logs/redis_log.txt&quot;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x6CE8;&#x610F;:&#x8FD9;&#x91CC;&#x6539;&#x5B8C;&#x540E;&#xFF0C;&#x8981;&#x542F;&#x52A8;&#x670D;&#x52A1;&#x524D;&#xFF0C;&#x5728;&#x4F60;&#x7684;Redis&#x7684;&#x5B89;&#x88C5;&#x76EE;&#x5F55;&#x7684;&#x6839;&#x76EE;&#x5F55;&#x4E0B;&#x624B;&#x52A8;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x540D;&#x4E3A;&#x201D;Logs&#x201D;&#x7684;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x5982;&#x679C;&#x7F3A;&#x5C11;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x542F;&#x52A8;&#x670D;&#x52A1;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x62A5;&#x9519;&#x3002;<br>2.&#x6539;&#x7AEF;&#x53E3;&#x53F7;&#xFF0C;&#x9ED8;&#x8BA4;&#x7684;6379&#x7AEF;&#x53E3;&#x80AF;&#x5B9A;&#x662F;&#x4E0D;&#x80FD;&#x7528;&#x4E86;&#xFF0C;&#x8D76;&#x7D27;&#x5728;redis&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x4FEE;&#x6539;&#x7AEF;&#x53E3;&#x53F7;&#x5427;&#xFF01;<br>&#x5728;Redis&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x627E;&#x5230;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">port <span class="number">6379</span></span><br></pre></td></tr></table></figure></p>
<p>&#x6539;&#x4E3A;&#x522B;&#x7684;&#x672A;&#x88AB;&#x5360;&#x7528;&#x7684;&#x7AEF;&#x53E3;&#x5373;&#x53EF;&#x3002;<br>3.&#x7981;&#x6B62;&#x4E00;&#x4E9B;&#x9AD8;&#x5371;&#x7684;&#x547D;&#x4EE4;&#xFF1A;<br>&#x4FEE;&#x6539;Redis&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;,&#x52A0;&#x5165;&#x4EE5;&#x4E0B;&#x51E0;&#x884C;&#x547D;&#x4EE4;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rename-command FLUSHALL <span class="string">&quot;&quot;</span></span><br><span class="line">rename-command FLUSHDB <span class="string">&quot;&quot;</span></span><br><span class="line">rename-command KEYS <span class="string">&quot;&quot;</span></span><br><span class="line">rename-command CONFIG <span class="string">&quot;&quot;</span></span><br><span class="line">rename-command EVAL <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure></p>
<p>&#xFE61;&#x4EE5;&#x4E0B;&#x7684;&#x4E00;&#x4E9B;&#x8BBE;&#x7F6E;&#x662F;&#x7F51;&#x4E0A;&#x7684;&#xFF0C;&#x6211;&#x6CA1;&#x7528;&#x7528;&#xFF0C;&#x56E0;&#x4E3A;&#x4E0D;&#x9002;&#x5408;&#x6211;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x4EC5;&#x4F9B;&#x53C2;&#x8003;&#xFF1A;<br>4.&#x4EE5;&#x6743;&#x9650;&#x8FD0;&#x884C;Redis&#x670D;&#x52A1;<br>&#x4E3A; Redis &#x670D;&#x52A1;&#x521B;&#x5EFA;&#x5355;&#x72EC;&#x7684;&#x7528;&#x6237;&#x548C;&#x5BB6;&#x76EE;&#x5F55;&#xFF0C;&#x5E76;&#x4E14;&#x914D;&#x7F6E;&#x7981;&#x6B62;&#x767B;&#x9646;<br>5.&#x7981;&#x6B62;&#x5916;&#x7F51;&#x8BBF;&#x95EE; Redis<br>&#x4FEE;&#x6539;Redis&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x6DFB;&#x52A0;&#x6216;&#x4FEE;&#x6539;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bind <span class="number">127.0</span>.0.1</span><br></pre></td></tr></table></figure></p>
<p>&#x4F7F;&#x5F97; Redis &#x670D;&#x52A1;&#x53EA;&#x5728;&#x5F53;&#x524D;&#x4E3B;&#x673A;&#x53EF;&#x7528;</p>
<h2 id="&#x603B;&#x7ED3;">&#x603B;&#x7ED3;</h2><p>&#x6D45;&#x8584;&#x554A;&#xFF01;&#x7C97;&#x5FC3;&#x554A;&#xFF01;&#x4E00;&#x5207;&#x7684;&#x4E00;&#x5207;&#x90FD;&#x662F;&#x56E0;&#x4E3A;&#x81EA;&#x5DF1;&#x5728;&#x670D;&#x52A1;&#x5668;&#x548C;Redis&#x5B89;&#x5168;&#x6027;&#x8FD9;&#x91CC;&#x4E0D;&#x591F;&#x91CD;&#x89C6;&#x800C;&#x5BFC;&#x81F4;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5176;&#x5B9E;&#x53EA;&#x8981;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x590D;&#x6742;&#x4E00;&#x70B9;&#x7684;&#x5BC6;&#x7801;&#xFF0C;&#x4F30;&#x8BA1;&#x4E5F;&#x4E0D;&#x4F1A;&#x8FD9;&#x4E48;&#x8F7B;&#x6613;&#x7684;&#x88AB;&#x5165;&#x4FB5;&#x4E86;&#xFF0C;&#x5E0C;&#x671B;&#x6211;&#x7684;&#x906D;&#x9047;&#x80FD;&#x7ED9;&#x4F60;&#x5E26;&#x6765;&#x4E00;&#x4E9B;&#x542F;&#x53D1;&#xFF0C;&#x5C11;&#x8D70;&#x6216;&#x8005;&#x4E0D;&#x8D70;&#x5F2F;&#x8DEF;&#xFF0C;&#x8D76;&#x7D27;&#x52A0;&#x56FA;&#x81EA;&#x5DF1;&#x7684;Redis&#x5B89;&#x5168;&#x9632;&#x5FA1;&#x5427;&#xFF01;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[NodeJs+Express 利用multiparty中间件实现文件上传功能]]></title>
      <url>http://jasoncool.com/2016/11/08/NodeJs-Express-%E5%88%A9%E7%94%A8multiparty%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%8A%9F%E8%83%BD/</url>
      <content type="html"><![CDATA[<h2 id="&#x670D;&#x52A1;&#x7AEF;JS&#x6587;&#x4EF6;&#x7684;&#x5199;&#x6CD5;">&#x670D;&#x52A1;&#x7AEF;JS&#x6587;&#x4EF6;&#x7684;&#x5199;&#x6CD5;</h2> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&apos;fs&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">&apos;path&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&apos;express&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> bodyParser = <span class="built_in">require</span>(<span class="string">&apos;body-parser&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"><span class="comment">//&#x767B;&#x5F55;</span></span><br><span class="line"><span class="keyword">var</span> Login_File = path.join(__dirname, <span class="string">&apos;demo/tongxunlu.json&apos;</span>); </span><br><span class="line"><span class="keyword">var</span> router = express.Router();</span><br><span class="line"><span class="keyword">var</span> multiparty = <span class="built_in">require</span>(<span class="string">&apos;multiparty&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> util = <span class="built_in">require</span>(<span class="string">&apos;util&apos;</span>);</span><br><span class="line"><span class="comment">// &#x56FE;&#x7247;&#x4E0A;&#x4F20;</span></span><br><span class="line">app.post(<span class="string">&apos;/demo/upload&apos;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>{</span><br><span class="line">  <span class="comment">// don&apos;t forget to delete all req.files when done </span></span><br><span class="line">  <span class="comment">//&#x751F;&#x6210;multiparty&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x914D;&#x7F6E;&#x4E0A;&#x4F20;&#x76EE;&#x6807;&#x8DEF;&#x5F84;</span></span><br><span class="line">  <span class="keyword">var</span> form = <span class="keyword">new</span> multiparty.Form({uploadDir: <span class="string">&apos;./upload/picture/&apos;</span>});</span><br><span class="line"> </span><br><span class="line">  <span class="comment">//&#x4E0A;&#x4F20;&#x5B8C;&#x6210;&#x540E;&#x5904;&#x7406;</span></span><br><span class="line">  form.parse(req, <span class="function"><span class="keyword">function</span>(<span class="params">err, fields, files</span>) </span>{</span><br><span class="line">  <span class="keyword">var</span> obj ={};</span><br><span class="line"> </span><br><span class="line">   <span class="keyword">var</span> filesTmp = <span class="built_in">JSON</span>.stringify(files,<span class="literal">null</span>,<span class="number">2</span>);</span><br><span class="line">  <span class="keyword">if</span>(err){</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">&apos;parse error: &apos;</span> + err);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">else</span> {</span><br><span class="line">      </span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&apos;parse files: &apos;</span> + filesTmp);</span><br><span class="line">      <span class="keyword">var</span> inputFile = files.inputFile[<span class="number">0</span>];</span><br><span class="line">      <span class="keyword">var</span> uploadedPath = inputFile.path;</span><br><span class="line">      <span class="keyword">var</span> dstPath = <span class="string">&apos;./upload/picture/&apos;</span> + inputFile.originalFilename;</span><br><span class="line">    <span class="comment">//&#x91CD;&#x547D;&#x540D;&#x4E3A;&#x771F;&#x5B9E;&#x6587;&#x4EF6;&#x540D;</span></span><br><span class="line">    fs.rename(uploadedPath, dstPath, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>{</span><br><span class="line">      <span class="keyword">if</span>(err){</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&apos;rename error: &apos;</span> + err);</span><br><span class="line">    res.writeHead(<span class="number">200</span>, {<span class="string">&apos;content-type&apos;</span>: <span class="string">&apos;text/plain;charset=utf-8&apos;</span>});</span><br><span class="line">    res.end(<span class="string">&quot;{&apos;status&apos;:200, &apos;message&apos;: &apos;&#x4E0A;&#x4F20;&#x5931;&#x8D25;&#xFF01;&apos;}&quot;</span>);</span><br><span class="line">      } <span class="keyword">else</span> {</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&apos;rename ok&apos;</span>);                </span><br><span class="line">    res.writeHead(<span class="number">200</span>, {<span class="string">&apos;content-type&apos;</span>: <span class="string">&apos;text/plain;charset=utf-8&apos;</span>});</span><br><span class="line">    res.end(<span class="string">&quot;{&apos;status&apos;:400, &apos;message&apos;: &apos;&#x4E0A;&#x4F20;&#x6210;&#x529F;&#xFF01;&apos;}&quot;</span>);</span><br><span class="line">      }</span><br><span class="line">    });</span><br><span class="line">    }</span><br><span class="line">  });</span><br><span class="line">});</span><br><span class="line"><span class="built_in">module</span>.exports = router;</span><br></pre></td></tr></table></figure>
 <a id="more"></a>
<h2 id="&#x8FD9;&#x4E2A;&#x670D;&#x52A1;&#x7AEF;&#x6709;&#x4E09;&#x4E2A;&#x5751;&#x9700;&#x8981;&#x6CE8;&#x610F;">&#x8FD9;&#x4E2A;&#x670D;&#x52A1;&#x7AEF;&#x6709;&#x4E09;&#x4E2A;&#x5751;&#x9700;&#x8981;&#x6CE8;&#x610F;</h2><p>1.var form = new multiparty.Form({uploadDir: &#x2018;./upload/picture/&#x2018;});<br>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x4E00;&#x4E0B;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#x5E76;&#x4E0D;&#x4F1A;&#x81EA;&#x52A8;&#x521B;&#x5EFA;&#xFF0C;&#x9700;&#x8981;&#x7528;&#x6237;&#x5728;&#x5F00;&#x53D1;&#x8FC7;&#x7A0B;&#x4E2D;&#x81EA;&#x5DF1;&#x5728;&#x9879;&#x76EE;&#x7684;&#x6839;&#x76EE;&#x5F55;&#x4E2D;&#x521B;&#x5EFA;&#x8BE5;&#x8DEF;&#x5F84;&#xFF0C;&#x5426;&#x5219;&#x5C31;&#x4F1A;&#x62A5;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x9519;&#x8BEF;&#x3002;<br>2.var inputFile = files.inputFile[0];<br>&#x8FD9;&#x884C;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;inputFile&#x662F;form&#x8868;&#x5355;&#x4E2D;&#x7684;input&#x7EC4;&#x4EF6;&#x7684;name&#x503C;&#xFF0C;&#x8FD9;&#x91CC;&#x8981;&#x5728;postman&#x4E2D;&#x5C06;&#x8BF7;&#x6C42;&#x53C2;&#x6570;&#x8C03;&#x6574;&#x6210;inputFile&#xFF0C;&#x5426;&#x5219;&#x5C31;&#x4F1A;&#x62A5;&#x53D8;&#x91CF;&#x672A;&#x5B9A;&#x4E49;&#x7684;&#x9519;&#x8BEF;&#x3002;<br>&#x770B;&#x56FE;&#xFF1A;<br><img src="/2016/11/08/NodeJs-Express-&#x5229;&#x7528;multiparty&#x4E2D;&#x95F4;&#x4EF6;&#x5B9E;&#x73B0;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x529F;&#x80FD;/1.png" alt="logo"><br>&#x5982;&#x679C;&#x5728;Android&#x4E2D;&#xFF0C;&#x4EE5;OKHttpUtils&#x4E3A;&#x4F8B;&#xFF0C;&#x5E94;&#x8BE5;&#x8FD9;&#x4E48;&#x5199;&#x8BF7;&#x6C42;<br> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">OkHttpUtils.post()<span class="comment">//</span></span><br><span class="line">.addFile(<span class="string">&quot;inputFile&quot;</span>, <span class="string">&quot;messenger_01.png&quot;</span>, uploadFile)<span class="comment">//</span></span><br><span class="line">.url(uploadUrl)</span><br><span class="line">.build()<span class="comment">//</span></span><br><span class="line">.execute(<span class="keyword">new</span> StringCallback() {</span><br><span class="line"> @Override</span><br><span class="line">public <span class="keyword">void</span> onError(Call call, Exception e, int id) {</span><br><span class="line">Log.e(<span class="string">&quot;exception&quot;</span>, e.getMessage());</span><br><span class="line">}</span><br><span class="line">@Override</span><br><span class="line">public <span class="keyword">void</span> onResponse(<span class="built_in">String</span> response, int id) {</span><br><span class="line">Log.e(<span class="string">&quot;response&quot;</span>, response);</span><br><span class="line">}</span><br><span class="line">});</span><br></pre></td></tr></table></figure></p>
<p>addFile&#x4E2D;&#x6709;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x5C31;&#x662F;&#x8981;&#x547D;&#x540D;&#x6210;&#x4E0E;&#x670D;&#x52A1;&#x7AEF;&#x4E00;&#x76F4;&#x7684;inputFile,&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x4E0A;&#x4F20;&#x5230;&#x670D;&#x52A1;&#x7AEF;&#x540E;&#x6587;&#x4EF6;&#x7684;&#x5B58;&#x50A8;&#x540D;&#xFF0C;&#x7B2C;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x6587;&#x4EF6;&#x7684;&#x4E3B;&#x4F53;&#x3002;</p>
<p>3.&#x5728;&#x8FD9;&#x4E2A;&#x670D;&#x52A1;&#x7AEF;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x8981;&#x8FD4;&#x56DE;&#x8BF7;&#x6C42;&#x7ED3;&#x679C;&#xFF0C;&#x53EA;&#x80FD;&#x7528;res.end&#x6216;&#x8005;res.wirte&#xFF0C;&#x5982;&#x679C;&#x7528;res.json&#x5C31;&#x4F1A;&#x62A5;&#x9519;Can\&#x2019;t set headers after they are sent&#x7684;&#x9519;&#x8BEF;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[SearchView配合RecyclerView实现分页搜索过滤关键字]]></title>
      <url>http://jasoncool.com/2016/09/12/SearchView%E9%85%8D%E5%90%88RecyclerView%E5%AE%9E%E7%8E%B0%E5%88%86%E9%A1%B5%E6%90%9C%E7%B4%A2%E8%BF%87%E6%BB%A4%E5%85%B3%E9%94%AE%E5%AD%97/</url>
      <content type="html"><![CDATA[<p>&#x5728;&#x65E5;&#x5E38;&#x5F00;&#x53D1;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4F1A;&#x9047;&#x5230;&#x4E00;&#x79CD;&#x9700;&#x6C42;&#xFF0C;&#x5C31;&#x662F;&#x901A;&#x8FC7;&#x8F93;&#x5165;&#x5173;&#x952E;&#x5B57;&#x5FEB;&#x901F;&#x7684;&#x67E5;&#x8BE2;&#x5F53;&#x524D;&#x5217;&#x8868;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x5E76;&#x8FDB;&#x884C;&#x8FC7;&#x6EE4;&#x663E;&#x793A;&#x3002;(&#x611F;&#x89C9;&#x597D;&#x96BE;&#x7528;&#x6587;&#x5B57;&#x63CF;&#x8FF0;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x554A;&#xB7;&#xB7;&#xB7;&#xB7;&#xB7;)&#xFF0C;&#x5728;&#x7F51;&#x4E0A;&#x627E;&#x4E86;&#x4E00;&#x4E9B;&#x8D44;&#x6599;&#x4E5F;&#x6CA1;&#x6709;&#x7C7B;&#x4F3C;&#x7684;&#x6587;&#x7AE0;&#xFF0C;&#x53EA;&#x597D;&#x81EA;&#x5DF1;&#x53D8;&#x5C1D;&#x8BD5;&#x53D8;&#x67E5;&#x8D44;&#x6599;&#xFF0C;&#x7528;&#x4E86;&#x51E0;&#x4E2A;&#x5C0F;&#x65F6;&#x7684;&#x65F6;&#x95F4;&#x7EC8;&#x4E8E;&#x641E;&#x51FA;&#x6765;&#x4E86;&#x3002;<br>OK,&#x770B;&#x56FE;&#xFF1A;<br><img src="/2016/09/12/SearchView&#x914D;&#x5408;RecyclerView&#x5B9E;&#x73B0;&#x5206;&#x9875;&#x641C;&#x7D22;&#x8FC7;&#x6EE4;&#x5173;&#x952E;&#x5B57;/1.gif" alt="logo"><br><a id="more"></a></p>
<h2 id="&#x7EC4;&#x4EF6;&#x51C6;&#x5907;">&#x7EC4;&#x4EF6;&#x51C6;&#x5907;</h2><p>  1.SearchView:SearchView&#x662F;Android&#x539F;&#x751F;&#x7684;&#x641C;&#x7D22;&#x6846;&#x63A7;&#x4EF6;&#xFF0C;&#x5B83;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x754C;&#x9762;&#xFF0C;&#x7528;&#x4E8E;&#x7528;&#x6237;&#x641C;&#x7D22;&#x67E5;&#x8BE2;&#x3002;<br>    SearchView&#x9ED8;&#x8BA4;&#x662F;&#x5C55;&#x793A;&#x4E00;&#x4E2A;search&#x7684;icon&#xFF0C;&#x70B9;&#x51FB;icon&#x5C55;&#x5F00;&#x641C;&#x7D22;&#x6846;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x8BA9;&#x641C;&#x7D22;&#x6846;&#x9ED8;&#x8BA4;&#x5C31;&#x5C55;&#x5F00;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;setIconifiedByDefault(false);&#x5B9E;&#x73B0;&#x3002;</p>
<p>  2.XRecyclerView: <a href="https://github.com/jianghejie/XRecyclerView" target="_blank" rel="external">github&#x5730;&#x5740;</a><br>    &#x8FD9;&#x4E2A;&#x7EC4;&#x4EF6;&#x4E3B;&#x8981;&#x662F;&#x5BF9;RecyclerView&#x7684;&#x5C01;&#x88C5;&#xFF0C;&#x4E3B;&#x8981;&#x5B8C;&#x6210;&#x4E86;&#x4E0B;&#x62C9;&#x5237;&#x65B0;&#x3001;&#x4E0A;&#x62C9;&#x52A0;&#x8F7D;&#x66F4;&#x591A;&#x3001;RecyclerView&#x5934;&#x90E8;&#x3002;<br>    &#x5173;&#x4E8E;&#x8FD9;&#x4E2A;&#x7EC4;&#x4EF6;&#x7684;&#x8BE6;&#x89E3;&#xFF0C;&#x8BF7;&#x53C2;&#x8003;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#xFF1A;<a href="http://blog.csdn.net/xsf50717/article/details/51366922" target="_blank" rel="external">&#x6587;&#x7AE0;&#x5730;&#x5740;</a></p>
<h2 id="&#x5F00;&#x59CB;&#x5E03;&#x5C40;">&#x5F00;&#x59CB;&#x5E03;&#x5C40;</h2><p>&#x73B0;&#x5728;&#x5148;&#x8FDB;&#x884C;&#x5E03;&#x5C40;&#xFF1A;</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">android.support.design.widget.CoordinatorLayout</span> </span><br><span class="line">    <span class="attribute">xmlns:android</span>=<span class="value">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line">    <span class="attribute">xmlns:app</span>=<span class="value">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span><br><span class="line">    <span class="attribute">android:id</span>=<span class="value">&quot;@+id/main_content&quot;</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">    <span class="attribute">android:background</span>=<span class="value">&quot;@color/window_background&quot;</span></span><br><span class="line">    <span class="attribute">android:fitsSystemWindows</span>=<span class="value">&quot;true&quot;</span></span><br><span class="line">    <span class="attribute">android:focusable</span>=<span class="value">&quot;true&quot;</span></span><br><span class="line">    <span class="attribute">android:focusableInTouchMode</span>=<span class="value">&quot;true&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">android.support.design.widget.AppBarLayout</span></span><br><span class="line">        <span class="attribute">android:id</span>=<span class="value">&quot;@+id/appbar&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">&quot;wrap_content&quot;</span></span><br><span class="line">        <span class="attribute">android:theme</span>=<span class="value">&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">android.support.v7.widget.Toolbar</span></span><br><span class="line">            <span class="attribute">android:id</span>=<span class="value">&quot;@+id/toolbar&quot;</span></span><br><span class="line">            <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">            <span class="attribute">android:layout_height</span>=<span class="value">&quot;wrap_content&quot;</span></span><br><span class="line">            <span class="attribute">android:background</span>=<span class="value">&quot;@color/app_main_color&quot;</span></span><br><span class="line">            <span class="attribute">android:minHeight</span>=<span class="value">&quot;?attr/actionBarSize&quot;</span></span><br><span class="line">            <span class="attribute">app:layout_scrollFlags</span>=<span class="value">&quot;scroll&quot;</span></span><br><span class="line">            <span class="attribute">app:popupTheme</span>=<span class="value">&quot;@style/ThemeOverlay.AppCompat.Light&quot;</span></span><br><span class="line">            <span class="attribute">app:theme</span>=<span class="value">&quot;@style/ThemeOverlay.AppCompat.ActionBar&quot;</span></span><br><span class="line">            <span class="attribute">app:title</span>=<span class="value">&quot;@string/location_detail&quot;</span></span><br><span class="line">            <span class="attribute">app:titleTextColor</span>=<span class="value">&quot;@color/white&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">SearchView</span></span><br><span class="line">            <span class="attribute">android:id</span>=<span class="value">&quot;@+id/searchView&quot;</span></span><br><span class="line">            <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">            <span class="attribute">android:layout_height</span>=<span class="value">&quot;wrap_content&quot;</span></span><br><span class="line">            <span class="attribute">android:layout_margin</span>=<span class="value">&quot;@dimen/spacing_small&quot;</span></span><br><span class="line">            <span class="attribute">android:iconifiedByDefault</span>=<span class="value">&quot;false&quot;</span></span><br><span class="line">            <span class="attribute">android:queryHint</span>=<span class="value">&quot;@string/search_hint&quot;</span></span><br><span class="line">            <span class="attribute">android:textColor</span>=<span class="value">&quot;@color/white&quot;</span></span><br><span class="line">           /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="title">android.support.design.widget.AppBarLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">com.jcodecraeer.xrecyclerview.XRecyclerView</span></span><br><span class="line">        <span class="attribute">android:id</span>=<span class="value">&quot;@+id/recyclerview&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">&quot;fill_parent&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">&quot;fill_parent&quot;</span></span><br><span class="line">        <span class="attribute">android:animateLayoutChanges</span>=<span class="value">&quot;false&quot;</span></span><br><span class="line">        <span class="attribute">app:layout_behavior</span>=<span class="value">&quot;@string/appbar_scrolling_view_behavior&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">TextView</span></span><br><span class="line">        <span class="attribute">android:id</span>=<span class="value">&quot;@+id/tv_emptyView&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">&quot;100dp&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">&quot;100dp&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_gravity</span>=<span class="value">&quot;center&quot;</span></span><br><span class="line">        <span class="attribute">android:background</span>=<span class="value">&quot;#dcdcdc&quot;</span></span><br><span class="line">        <span class="attribute">android:text</span>=<span class="value">&quot;&#x65E0;&#x6570;&#x636E;&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="title">android.support.design.widget.CoordinatorLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x4E2A;&#x5E03;&#x5C40;&#x662F;&#x6211;&#x9879;&#x76EE;&#x4E2D;&#x7684;&#x5E03;&#x5C40;&#x65B9;&#x5F0F;&#xFF0C;&#x6240;&#x4EE5;&#x4F60;&#x4E0D;&#x5FC5;&#x5B8C;&#x5168;&#x6309;&#x7167;&#x8FD9;&#x4E2A;&#x5199;&#x6CD5;&#x6765;&#xFF0C;&#x4E3B;&#x8981;&#x5173;&#x6CE8;SearchView&#x548C;XRecyclerView&#x7684;&#x5199;&#x6CD5;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF0C;OK&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x770B;SearchView&#xFF1A;</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:iconifiedByDefault=&quot;false&quot;</span><br></pre></td></tr></table></figure>
<p>&#x7531;&#x4E8E;SearchView&#x9ED8;&#x8BA4;&#x662F;&#x4E00;&#x4E2A;&#x641C;&#x7D22;&#x653E;&#x5927;&#x955C;&#x7684;&#x56FE;&#x6807;&#xFF0C;&#x5728;&#x70B9;&#x51FB;&#x540E;&#x624D;&#x4F1A;&#x5C55;&#x5F00;&#x8F93;&#x5165;&#x6846;&#x8F93;&#x5165;&#x641C;&#x7D22;&#x5173;&#x952E;&#x5B57;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x6211;&#x7684;&#x9879;&#x76EE;&#x4E2D;&#x662F;&#x9700;&#x8981;&#x641C;&#x7D22;&#x6846;&#x9ED8;&#x8BA4;&#x5C31;&#x5C55;&#x5F00;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x8BBE;&#x7F6E;&#x8FD9;&#x4E2A;&#x5C5E;&#x6027;&#xFF0C;&#x5F53;&#x5C5E;&#x6027;&#x8BBE;&#x7F6E;&#x4E3A;true&#x65F6;&#xFF0C;&#x641C;&#x7D22;&#x6846;&#x4E0D;&#x5C55;&#x5F00;&#xFF0C;&#x5F53;&#x5C5E;&#x6027;&#x8BBE;&#x7F6E;&#x4E3A;false&#x65F6;&#xFF0C;&#x641C;&#x7D22;&#x6846;&#x5C55;&#x5F00;&#x3002;</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:queryHint=&quot;@string/search_hint&quot;</span><br></pre></td></tr></table></figure>
<p> &#x8FD9;&#x4E2A;&#x662F;&#x641C;&#x7D22;&#x6846;&#x7684;&#x63D0;&#x793A;&#x5185;&#x5BB9;<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:textColor=&quot;@color/white&quot;</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x4E2A;&#x662F;&#x641C;&#x7D22;&#x6846;&#x7684;&#x8F93;&#x5165;&#x5B57;&#x4F53;&#x989C;&#x8272;</p>
<p>SearchVieW&#x57FA;&#x672C;&#x4E0A;&#x5C31;&#x662F;&#x8FD9;&#x4E9B;&#x8BBE;&#x7F6E;&#x4E86;&#xFF0C;&#x5F53;&#x7136;&#x5982;&#x679C;&#x4F60;&#x6253;&#x7B97;&#x53EA;&#x8BA9;&#x641C;&#x7D22;&#x6846;&#x5185;&#x8F93;&#x5165;&#x6570;&#x5B57;&#xFF0C;&#x53EF;&#x4EE5;&#x5229;&#x7528;SearcheView&#x7684;android:inputType&#x5C5E;&#x6027;&#x6765;&#x8BBE;&#x7F6E;&#x3002;</p>
<p>&#x518D;&#x6765;&#x770B;&#x770B;XRecyclerView:<br>&#x8FD9;&#x4E2A;&#x7EC4;&#x4EF6;&#x57FA;&#x672C;&#x4E0A;&#x4E0D;&#x9700;&#x8981;&#x4EC0;&#x4E48;&#x7279;&#x6B8A;&#x7684;&#x8BBE;&#x7F6E;&#xFF0C;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5C5E;&#x6027;<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app:layout_behavior=&quot;@string/appbar_scrolling_view_behavior&quot;</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x4E2A;&#x662F;&#x914D;&#x5408;AppBarLayout&#x548C;Toolbar&#x4F7F;&#x7528;&#x7684;&#x6EDA;&#x52A8;&#x76D1;&#x542C;&#xFF0C;&#x5F53;&#x5411;&#x4E0A;&#x6EDA;&#x52A8;&#x65F6;&#x53EF;&#x4EE5;&#x52A8;&#x6001;&#x7684;&#x9690;&#x85CF;Toolbar,&#x4E0D;&#x8FC7;&#x8FD9;&#x91CC;&#x548C;&#x672C;&#x6587;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x5173;&#x7CFB;&#xFF0C;&#x53EA;&#x662F;&#x987A;&#x5E26;&#x4E00;&#x63D0;&#x3002;</p>
<h2 id="&#x903B;&#x8F91;&#x5206;&#x6790;">&#x903B;&#x8F91;&#x5206;&#x6790;</h2><p>&#x5728;&#x5F00;&#x53D1;&#x4E4B;&#x524D;&#xFF0C;&#x6211;&#x4E60;&#x60EF;&#x5148;&#x8FDB;&#x884C;&#x4E00;&#x4E9B;&#x601D;&#x8003;&#xFF0C;&#x628A;&#x8981;&#x5B9E;&#x73B0;&#x7684;&#x529F;&#x80FD;&#x5728;&#x8111;&#x5B50;&#x91CC;&#x5B9E;&#x73B0;&#x4E00;&#x904D;&#xFF0C;&#x4E3B;&#x8981;&#x8003;&#x8651;&#x7684;&#x4E0D;&#x662F;&#x4EE3;&#x7801;&#x7EC6;&#x8282;&#x800C;&#x662F;&#x903B;&#x8F91;&#x5224;&#x65AD;&#x591A;&#x4E00;&#x4E9B;&#xFF0C;&#x5BF9;&#x4E8E;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#xFF0C;&#x4E3B;&#x8981;&#x8003;&#x8651;&#x51E0;&#x70B9;&#xFF1A;<br>1.SearchView&#x662F;&#x5426;&#x6709;&#x4E00;&#x4E2A;&#x76D1;&#x542C;&#xFF0C;&#x53EF;&#x4EE5;&#x76D1;&#x542C;&#x6211;&#x7684;&#x8F93;&#x5165;&#x5185;&#x5BB9;&#x3002;<br>2.&#x4E0B;&#x62C9;&#x5237;&#x65B0;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5E94;&#x5F53;&#x628A;SearchView&#x4E2D;&#x7684;&#x8F93;&#x5165;&#x5185;&#x5BB9;&#x5168;&#x90E8;&#x6E05;&#x7A7A;&#xFF0C;&#x5E76;&#x4E14;&#x8BA9;SearchView&#x4E0D;&#x518D;&#x83B7;&#x53D6;&#x7126;&#x70B9;&#xFF0C;&#x4ECE;&#x800C;&#x5173;&#x95ED;&#x8F93;&#x5165;&#x6CD5;&#xFF0C;&#x589E;&#x52A0;&#x7528;&#x6237;&#x4F53;&#x9A8C;&#x3002;<br>3.&#x5E94;&#x5F53;&#x5B9E;&#x65F6;&#x5224;&#x65AD;SearchView&#x4E2D;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x5982;&#x679C;SearchView&#x4E2D;&#x542B;&#x6709;&#x6570;&#x636E;&#x7684;&#x8BDD;&#xFF0C;&#x5219;&#x5173;&#x95ED;XRecyclerView&#x7684;&#x52A0;&#x8F7D;&#x66F4;&#x591A;&#x65B9;&#x6CD5;&#xFF0C; &#x4E0D;&#x5141;&#x8BB8;&#x7528;&#x6237;&#x5728;&#x8FD9;&#x4E2A;&#x754C;&#x9762;&#x4E0B;&#x52A0;&#x8F7D;&#x66F4;&#x591A;&#xFF0C;&#x76F4;&#x5230;SearchView&#x4E2D;&#x8F93;&#x5165;&#x7684;&#x6570;&#x636E;&#x4E3A;&#x7A7A;&#xFF0C;&#x5219;&#x518D;&#x6B21;&#x5F00;&#x542F;&#x4E0B;&#x62C9;&#x52A0;&#x8F7D;&#x66F4;&#x591A;&#x7684;&#x529F;&#x80FD;&#x3002;<br>4.&#x8981;&#x5728;Acitivity&#x4E2D;&#x5199;&#x4E00;&#x4E2A;&#x8FC7;&#x6EE4;&#x65B9;&#x6CD5;&#xFF0C;&#x76EE;&#x7684;&#x662F;&#x4E3A;&#x4E86;&#x5F97;&#x5230;&#x7B26;&#x5408;&#x6761;&#x4EF6;&#x7684;&#x6570;&#x636E;&#x6E90;(ArrayList)<br>5.Adapter&#x4E2D;&#x8981;&#x4E00;&#x4E2A;&#x8BBE;&#x7F6E;&#x8FC7;&#x6EE4;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x76EE;&#x7684;&#x662F;&#x4E3A;&#x4E86;&#x5C06;&#x8FC7;&#x6EE4;&#x540E;&#x7684;&#x6570;&#x636E;&#x4F20;&#x5165;Adapter&#x5E76;&#x5237;&#x65B0;&#x6570;&#x636E;&#x3002;<br>6.Adapter&#x4E2D;&#x8FD8;&#x8981;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x5173;&#x95ED;&#x8FC7;&#x6EE4;&#x7684;&#x65B9;&#x6CD5;&#xFF0C; &#x76EE;&#x7684;&#x662F;&#x5728;&#x4E0A;&#x62C9;&#x52A0;&#x8F7D;&#x66F4;&#x591A;&#x7684;&#x65F6;&#x5019;&#x5C06;&#x5F53;&#x524D;&#x6570;&#x636E;&#x6E90;&#x4F20;&#x9012;&#x7ED9;Adapter&#x5E76;&#x5237;&#x65B0;&#x6570;&#x636E;&#x3002;&#xFF08;&#x8FD9;&#x4E00;&#x6B65;&#x5F00;&#x59CB;&#x5E76;&#x6CA1;&#x6709;&#x8003;&#x8651;&#x5230;&#xFF0C;&#x76F4;&#x5230;&#x53D1;&#x73B0;&#x6BCF;&#x6B21;&#x641C;&#x7D22;&#x5B8C;&#x6BD5;&#x540E;&#xFF0C;&#x518D;&#x4E0A;&#x62C9;&#x52A0;&#x8F7D;&#x65F6;&#x660E;&#x660E;&#x80FD;&#x83B7;&#x53D6;&#x6570;&#x636E;&#x53EF;&#x662F;&#x518D;&#x754C;&#x9762;&#x4E2D;&#x5374;&#x65E0;&#x6CD5;&#x663E;&#x793A;&#x6570;&#x636E;&#x65F6;&#x624D;&#x60F3;&#x5230;&#x7684;&#x3002;&#xFF09;</p>
<h2 id="&#x4EE3;&#x7801;&#x5B9E;&#x73B0;">&#x4EE3;&#x7801;&#x5B9E;&#x73B0;</h2><p>&#x5728;&#x4EE3;&#x7801;&#x4E2D;&#x5DF2;&#x7ECF;&#x5C06;&#x4E4B;&#x524D;&#x7684;&#x903B;&#x8F91;&#x5206;&#x6790;&#x90FD;&#x6CE8;&#x91CA;&#x51FA;&#x6765;&#x4E86;&#x3002;</p>
<p>Activity:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * &#x521B;&#x5EFA;&#x4EBA;&#xFF1A;&#x8D3E;&#x771F;</span><br><span class="line"> * &#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2016/9/9 10:01</span><br><span class="line"> * &#x4FEE;&#x6539;&#x5907;&#x6CE8;&#xFF1A;</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CarLocationListActivity</span> <span class="keyword">extends</span> <span class="title">OBaseActivity</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = CarLocationListActivity.class.getSimpleName();</span><br><span class="line">    <span class="annotation">@BindView</span>(R.id.toolbar)</span><br><span class="line">    Toolbar toolbar;</span><br><span class="line">    <span class="annotation">@BindView</span>(R.id.recyclerview)</span><br><span class="line">    XRecyclerView mRecyclerView;</span><br><span class="line">    <span class="annotation">@BindView</span>(R.id.searchView)</span><br><span class="line">    SearchView searchView;</span><br><span class="line">    <span class="annotation">@BindView</span>(R.id.tv_emptyView)</span><br><span class="line">    TextView tvEmptyView;</span><br><span class="line">    <span class="keyword">private</span> CarLocationListAdapter mAdapter;</span><br><span class="line">    <span class="comment">//&#x6570;&#x636E;&#x5B58;&#x50A8;&#x5217;&#x8868;</span></span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;CarLocationListModel&gt; listData;</span><br><span class="line">    <span class="comment">//&#x5F53;&#x524D;&#x9875;&#x6570;</span></span><br><span class="line">    <span class="keyword">int</span> pageNo = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//&#x6BCF;&#x9875;&#x663E;&#x793A;&#x6570;</span></span><br><span class="line">    <span class="keyword">int</span> pageSize = <span class="number">15</span>;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</span><br><span class="line">        setContentView(R.layout.activity_locationcar_list);</span><br><span class="line">        ButterKnife.bind(<span class="keyword">this</span>);</span><br><span class="line">        setSupportActionBar(toolbar);</span><br><span class="line">        getSupportActionBar().setDisplayHomeAsUpEnabled(<span class="keyword">true</span>);</span><br><span class="line">        LinearLayoutManager layoutManager = <span class="keyword">new</span> LinearLayoutManager(<span class="keyword">this</span>);</span><br><span class="line">        layoutManager.setOrientation(LinearLayoutManager.VERTICAL);</span><br><span class="line">        mRecyclerView.setLayoutManager(layoutManager);</span><br><span class="line">        mRecyclerView.setRefreshProgressStyle(ProgressStyle.BallSpinFadeLoader);</span><br><span class="line">        mRecyclerView.setLoadingMoreProgressStyle(ProgressStyle.BallRotate);</span><br><span class="line">        mRecyclerView.setArrowImageView(R.drawable.iconfont_downgrey);</span><br><span class="line">        mRecyclerView.setLoadingMoreEnabled(<span class="keyword">true</span>);</span><br><span class="line">        mRecyclerView.setEmptyView(tvEmptyView);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">GetPageListData</span><span class="params">(<span class="keyword">int</span> pageNo, <span class="keyword">int</span> pageSize)</span> </span>{</span><br><span class="line"></span><br><span class="line">        appAction.GetCarLocationList(PublicDefault.USERID, pageNo, pageSize, <span class="keyword">new</span> onNetWorkListener&lt;ArrayList&lt;CarLocationListModel&gt;&gt;() {</span><br><span class="line"></span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(ArrayList&lt;CarLocationListModel&gt; model)</span> </span>{</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (mAdapter == <span class="keyword">null</span>) {</span><br><span class="line">                    listData = model;</span><br><span class="line">                    mAdapter = <span class="keyword">new</span> CarLocationListAdapter(listData);</span><br><span class="line">                    mRecyclerView.setAdapter(mAdapter);</span><br><span class="line">                    mRecyclerView.refreshComplete();</span><br><span class="line">                } <span class="keyword">else</span> {</span><br><span class="line">                    <span class="comment">//&#x5C06;&#x83B7;&#x53D6;&#x7684;&#x5143;&#x7D20;&#x5168;&#x90E8;&#x52A0;&#x5165;&#x5230;&#x5217;&#x8868;&#x7684;&#x5C3E;&#x90E8;</span></span><br><span class="line">                    listData.addAll(model);</span><br><span class="line">                    mAdapter.closeFilter(listData);</span><br><span class="line">                    mRecyclerView.loadMoreComplete();</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(<span class="keyword">int</span> errorEvent, String message)</span> </span>{</span><br><span class="line">                ToastUtil.ErrorImageToast(CarLocationListActivity.<span class="keyword">this</span>, getResources().getString(R.string.get_location_list_fail));</span><br><span class="line">                <span class="keyword">if</span> (mAdapter == <span class="keyword">null</span>) {</span><br><span class="line"></span><br><span class="line">                    mRecyclerView.refreshComplete();</span><br><span class="line">                } <span class="keyword">else</span> {</span><br><span class="line"></span><br><span class="line">                    mRecyclerView.loadMoreComplete();</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line">        });</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setListeners</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * &#x5217;&#x8868;&#x4E0B;&#x62C9;&#x5237;&#x65B0;&#x548C;&#x4E0A;&#x62C9;&#x52A0;&#x8F7D;&#x7684;&#x76D1;&#x542C;&#x65B9;&#x6CD5;</span><br><span class="line">         * &#x4E0B;&#x62C9;&#x5237;&#x65B0;&#x65F6;&#x8981;&#x5C06;&#x9875;&#x6570;&#x91CD;&#x65B0;&#x8BBE;&#x7F6E;&#x4E3A;1 &#x5E76;&#x4E14;&#x5C06;&#x6570;&#x636E;&#x6E05;&#x7A7A; &#x8FD8;&#x8981;&#x5C06;&#x9002;&#x914D;&#x5668;&#x6E05;&#x7406;&#x6389; &#x5E76;&#x4E14;&#x8981;&#x5C06;&#x641C;&#x7D22;&#x6587;&#x5B57;&#x6E05;&#x7406;&#x6389;</span><br><span class="line">         *</span><br><span class="line">         */</span></span><br><span class="line">        mRecyclerView.setLoadingListener(<span class="keyword">new</span> XRecyclerView.LoadingListener() {</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRefresh</span><span class="params">()</span> </span>{</span><br><span class="line">                <span class="comment">//&#x903B;&#x8F91;2:&#x4E0B;&#x62C9;&#x5237;&#x65B0;&#x65F6;&#xFF0C;&#x5C06;SearchView&#x4E2D;&#x7684;&#x6570;&#x636E;&#x6E05;&#x7A7A;&#xFF0C;&#x5E76;&#x8BA9;SearchView&#x5931;&#x53BB;&#x7126;&#x70B9;&#x3002;</span></span><br><span class="line">                searchView.setQuery(<span class="string">&quot;&quot;</span>, <span class="keyword">false</span>);</span><br><span class="line">                searchView.clearFocus();</span><br><span class="line"></span><br><span class="line">                pageNo = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (listData != <span class="keyword">null</span>)</span><br><span class="line">                    listData.clear();</span><br><span class="line">                mAdapter = <span class="keyword">null</span>;</span><br><span class="line">                GetPageListData(pageNo, pageSize);</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onLoadMore</span><span class="params">()</span> </span>{</span><br><span class="line">                pageNo++;</span><br><span class="line">                GetPageListData(pageNo, pageSize);</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line">        });</span><br><span class="line">        mRecyclerView.setRefreshing(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//&#x903B;&#x8F91;1:SearchView&#x7684;&#x76D1;&#x542C;&#x8F93;&#x5165;&#x5185;&#x5BB9;&#x4E8B;&#x4EF6;&#xFF1A;&#x76D1;&#x542C;&#x67E5;&#x8BE2;&#x5185;&#x5BB9;&#xFF0C;onQueryTextSubmit&#x662F;&#x63D0;&#x4EA4;&#x76D1;&#x542C;&#xFF0C;&#x4E0D;&#x7B26;&#x5408;&#x6211;&#x7684;&#x9700;&#x6C42; onQueryTextChange&#x662F;&#x5B9E;&#x65F6;&#x76D1;&#x542C;&#xFF0C;&#x7B26;&#x5408;&#x6211;&#x4EEC;&#x7684;&#x9700;&#x6C42;</span></span><br><span class="line">        searchView.setOnQueryTextListener(<span class="keyword">new</span> SearchView.OnQueryTextListener() {</span><br><span class="line">            <span class="comment">// &#x5F53;&#x70B9;&#x51FB;&#x641C;&#x7D22;&#x6309;&#x94AE;&#x65F6;&#x89E6;&#x53D1;&#x8BE5;&#x65B9;&#x6CD5;</span></span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onQueryTextSubmit</span><span class="params">(String s)</span> </span>{</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="comment">// &#x5F53;&#x641C;&#x7D22;&#x5185;&#x5BB9;&#x6539;&#x53D8;&#x65F6;&#x89E6;&#x53D1;&#x8BE5;&#x65B9;&#x6CD5;</span></span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onQueryTextChange</span><span class="params">(String searchText)</span> </span>{</span><br><span class="line">                <span class="comment">//&#x903B;&#x8F91;3:&#x5F53;&#x641C;&#x7D22;&#x6846;&#x4E2D;&#x5B58;&#x5728;&#x641C;&#x7D22;&#x6570;&#x636E;&#x5219;&#x5173;&#x95ED;&#x52A0;&#x8F7D;&#x66F4;&#x591A;</span></span><br><span class="line">                <span class="keyword">if</span> (!<span class="string">&quot;&quot;</span>.equals(searchView.getQuery().toString().trim())) {</span><br><span class="line">                    L.d(TAG, <span class="string">&quot;&#x5173;&#x95ED;&#x52A0;&#x8F7D;&#x66F4;&#x591A;&quot;</span>);</span><br><span class="line">                    mRecyclerView.setLoadingMoreEnabled(<span class="keyword">false</span>);</span><br><span class="line">                } <span class="keyword">else</span> {</span><br><span class="line">                    L.d(TAG, <span class="string">&quot;&#x5F00;&#x542F;&#x52A0;&#x8F7D;&#x66F4;&#x591A;&quot;</span>);</span><br><span class="line">                    mRecyclerView.setLoadingMoreEnabled(<span class="keyword">true</span>);</span><br><span class="line">                }</span><br><span class="line">                <span class="keyword">final</span> ArrayList&lt;CarLocationListModel&gt; filteredModelList = filter(listData, searchText);</span><br><span class="line">                mAdapter.setFilter(filteredModelList);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            }</span><br><span class="line">        });</span><br><span class="line"></span><br><span class="line">        searchView.setOnCloseListener(<span class="keyword">new</span> SearchView.OnCloseListener() {</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onClose</span><span class="params">()</span> </span>{</span><br><span class="line">                L.d(TAG, <span class="string">&quot;onClose&quot;</span>);</span><br><span class="line">                searchView.setQuery(<span class="string">&quot;&quot;</span>, <span class="keyword">false</span>);</span><br><span class="line">                searchView.clearFocus();</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            }</span><br><span class="line">        });</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>{</span><br><span class="line">        mRecyclerView = <span class="keyword">null</span>;</span><br><span class="line">        toolbar = <span class="keyword">null</span>;</span><br><span class="line">        mAdapter = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (listData != <span class="keyword">null</span>) {</span><br><span class="line">            listData.clear();</span><br><span class="line">            listData = <span class="keyword">null</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onOptionsItemSelected</span><span class="params">(MenuItem item)</span> </span>{</span><br><span class="line">        <span class="keyword">switch</span> (item.getItemId()) {</span><br><span class="line">            <span class="keyword">case</span> android.R.id.home:</span><br><span class="line">                onBackPressed();</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onOptionsItemSelected(item);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *</span><br><span class="line">     * &#x903B;&#x8F91;4&#xFF1A;&#x8FC7;&#x6EE4;&#x65B9;&#x6CD5;&#xFF0C;&#x76EE;&#x7684;&#x662F;&#x8FC7;&#x6EE4;&#x7B26;&#x5408;&#x5F53;&#x524D;&#x6570;&#x636E;&#x4E2D;&#x7B26;&#x5408;&#x6761;&#x4EF6;&#x7684;&#x6570;&#x636E;&#x6E90;</span><br><span class="line">     * <span class="doctag">@param</span> models</span><br><span class="line">     * <span class="doctag">@param</span> query</span><br><span class="line">     * <span class="doctag">@return</span></span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> ArrayList&lt;CarLocationListModel&gt; <span class="title">filter</span><span class="params">(ArrayList&lt;CarLocationListModel&gt; models, String query)</span> </span>{</span><br><span class="line"></span><br><span class="line">        query = query.toLowerCase();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> ArrayList&lt;CarLocationListModel&gt; filteredModelList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (CarLocationListModel model : models) {</span><br><span class="line"></span><br><span class="line">            <span class="keyword">final</span> String text = model.getChePaiHao().toLowerCase();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (text.contains(query)) {</span><br><span class="line"></span><br><span class="line">                filteredModelList.add(model);</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> filteredModelList;</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>Adapter:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CarLocationListAdapter</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">Adapter</span>&lt;<span class="title">LocationListViewHolder</span>&gt; </span>{</span><br><span class="line">    <span class="keyword">public</span> ArrayList&lt;CarLocationListModel&gt; datas = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CarLocationListAdapter</span><span class="params">(ArrayList&lt;CarLocationListModel&gt; datas)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.datas = datas;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x521B;&#x5EFA;&#x65B0;View&#xFF0C;&#x88AB;LayoutManager&#x6240;&#x8C03;&#x7528;</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LocationListViewHolder <span class="title">onCreateViewHolder</span><span class="params">(ViewGroup viewGroup, <span class="keyword">int</span> viewType)</span> </span>{</span><br><span class="line">        View view = LayoutInflater.from(viewGroup.getContext()).inflate(R.layout.adapter_locationcar_list, viewGroup, <span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> LocationListViewHolder(view);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onBindViewHolder</span><span class="params">(LocationListViewHolder viewHolder, <span class="keyword">int</span> position)</span> </span>{</span><br><span class="line">        viewHolder.tvCarNo.setText(String.valueOf(datas.get(position).getChePaiHao()));</span><br><span class="line">        viewHolder.tvSpeed.setText(datas.get(position).getCheSu()+<span class="string">&quot;km/h&quot;</span>);</span><br><span class="line">        viewHolder.tvCarAddress.setText(<span class="string">&quot;&#x4F4D;&#x7F6E;:&quot;</span>+ TextUtil.checkText(datas.get(position).getDangQianWeiZhi()));</span><br><span class="line">        viewHolder.tvJrlc.setText(<span class="string">&quot;&#x4ECA;&#x65E5;&#x91CC;&#x7A0B;:&quot;</span>+datas.get(position).getJinRiLiCheng()+<span class="string">&quot;Km&quot;</span>);</span><br><span class="line">        viewHolder.tvJryh.setText(<span class="string">&quot;&#x4ECA;&#x65E5;&#x6CB9;&#x8017;:&quot;</span>+datas.get(position).getJinRiYouHao()+<span class="string">&quot;L&quot;</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x83B7;&#x53D6;&#x6570;&#x636E;&#x7684;&#x6570;&#x91CF;</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getItemCount</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> datas.size();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * &#x903B;&#x8F91;5&#xFF1A;&#x5728;Adapter&#x4E2D;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x8FC7;&#x6EE4;&#x65B9;&#x6CD5;&#xFF0C;&#x76EE;&#x7684;&#x662F;&#x4E3A;&#x4E86;&#x5C06;&#x8FC7;&#x6EE4;&#x540E;&#x7684;&#x6570;&#x636E;&#x4F20;&#x5165;Adapter&#x4E2D;&#x5E76;&#x5237;&#x65B0;&#x6570;&#x636E;</span><br><span class="line">     * <span class="doctag">@param</span> locationListModels</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFilter</span><span class="params">(ArrayList&lt;CarLocationListModel&gt; locationListModels )</span> </span>{</span><br><span class="line"></span><br><span class="line">        datas = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        datas .addAll( locationListModels );</span><br><span class="line"></span><br><span class="line">        notifyDataSetChanged();</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *&#x903B;&#x8F91;6&#xFF1A;</span><br><span class="line">     * &#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x5173;&#x95ED;&#x8FC7;&#x6EE4;&#x7684;&#x65B9;&#x6CD5;&#xFF0C; &#x76EE;&#x7684;&#x662F;&#x5728;&#x4E0A;&#x62C9;&#x52A0;&#x8F7D;&#x66F4;&#x591A;&#x7684;&#x65F6;&#x5019;&#x5C06;&#x771F;&#x5B9E;&#x6570;&#x636E;&#x6E90;&#x4F20;&#x9012;&#x7ED9;Adapter&#x5E76;&#x5237;&#x65B0;&#x6570;&#x636E;</span><br><span class="line">     * <span class="doctag">@param</span> allList</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">closeFilter</span><span class="params">(ArrayList&lt;CarLocationListModel&gt; allList)</span></span>{</span><br><span class="line"></span><br><span class="line">        datas=allList;</span><br><span class="line">        notifyDataSetChanged();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x91CC;&#x5C31;&#x53EA;&#x8D34;&#x51FA;&#x6765;Activity&#x548C;Adapter&#x548C;&#x4E3B;Activity&#x7684;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#xFF0C;&#x5176;&#x4ED6;&#x7684;ViewHolder&#x548C;Adapter&#x7684;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#xFF0C;&#x5927;&#x5BB6;&#x5728;&#x5B9E;&#x73B0;&#x7684;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x5199;&#x7B80;&#x5355;&#x4E00;&#x70B9;&#x7684;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x8D34;&#x51FA;&#x6765;&#x4E86;&#x3002;<br>&#x53EA;&#x8981;&#x662F;&#x8DDF;&#x7740;&#x8FD9;&#x4E2A;&#x6559;&#x7A0B;&#x8D70;&#x7684;&#x8BDD;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x662F;&#x4E0D;&#x4F1A;&#x6709;&#x4EC0;&#x4E48;&#x592A;&#x5927;&#x7684;&#x95EE;&#x9898;&#x7684;&#xFF0C;&#x5269;&#x4E0B;&#x7684;&#x5C31;&#x662F;&#x6309;&#x90E8;&#x5C31;&#x73ED;&#x7684;&#x8FDB;&#x884C;&#x5F00;&#x53D1;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;</p>
<h2 id="&#x603B;&#x7ED3;">&#x603B;&#x7ED3;</h2><p>&#x5176;&#x5B9E;&#x8FD9;&#x4E2A;&#x6548;&#x679C;&#x5B9E;&#x73B0;&#x8D77;&#x6765;&#x5E76;&#x4E0D;&#x96BE;&#xFF0C;&#x5173;&#x952E;&#x662F;&#x8981;&#x5206;&#x6790;&#x6E05;&#x695A;&#x5404;&#x79CD;&#x903B;&#x8F91;&#x5173;&#x7CFB;&#xFF0C;&#x5982;&#x679C;&#x8BB0;&#x6027;&#x597D;&#x53EF;&#x4EE5;&#x7528;&#x8111;&#x5B50;&#x7406;&#x6E05;&#x8FD9;&#x4E9B;&#x903B;&#x8F91;&#x5173;&#x7CFB;&#xFF0C;&#x5982;&#x679C;&#x8BB0;&#x6027;&#x6CA1;&#x6709;&#x90A3;&#x4E48;&#x597D;&#xFF0C;&#x5C31;&#x81EA;&#x5DF1;&#x5199;&#x51FA;&#x8FD9;&#x4E9B;&#x903B;&#x8F91;&#x5173;&#x7CFB;&#x5427;&#xFF0C;&#x6BD5;&#x7ADF;&#x597D;&#x8BB0;&#x6027;&#x4E0D;&#x5982;&#x70C2;&#x7B14;&#x5934;&#x561B;&#xFF0C;&#x597D;&#x4E86; &#x629B;&#x7816;&#x81F3;&#x6B64;&#xFF0C;&#x591A;&#x8C22;&#x60A8;&#x770B;&#x5B8C;&#x3002;</p>
<h2 id="&#x5F15;&#x7528;">&#x5F15;&#x7528;</h2><p>1.<a href="http://blog.csdn.net/airsaid/article/details/51087226" target="_blank" rel="external">Android &#x641C;&#x7D22;&#x6846;&#xFF1A;SearchView &#x7684;&#x5C5E;&#x6027;&#x548C;&#x7528;&#x6CD5;&#x8BE6;&#x89E3;</a><br>2.<a href="http://www.tutorialsbuzz.com/2015/11/Android-Filter-RecyclerView-Using-SearchView-In-ToolBar.html?utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="external">Android Filter RecyclerView Using SearchView In ToolBar</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Android开发中实现点击Webview中的图片调用原生组件进行展示]]></title>
      <url>http://jasoncool.com/2016/08/29/Android%E5%BC%80%E5%8F%91%E4%B8%AD%E5%AE%9E%E7%8E%B0%E7%82%B9%E5%87%BBWebview%E4%B8%AD%E7%9A%84%E5%9B%BE%E7%89%87%E8%B0%83%E7%94%A8%E5%8E%9F%E7%94%9F%E7%BB%84%E4%BB%B6%E8%BF%9B%E8%A1%8C%E5%B1%95%E7%A4%BA/</url>
      <content type="html"><![CDATA[<p>&#x53BB;&#x5E74;&#x6709;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x5DE5;&#x4F5C;&#x4E0D;&#x5FD9;&#xFF0C;&#x95F2;&#x6687;&#x4E4B;&#x4F59;&#x5C31;&#x81EA;&#x5DF1;&#x505A;&#x4E86;&#x4E00;&#x4E2A;&#x9605;&#x8BFB;&#x7C7B;&#x7684;&#x5E94;&#x7528;&#x2014;&#x2014;&#x300A;&#x77E5;&#x8C46;&#x4E86;&#x300B;&#xFF0C;&#x8FD9;&#x4E2A;&#x5E94;&#x7528;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x5C31;&#x662F;&#x901A;&#x8FC7;fiddler&#x6293;&#x53D6;&#x8C46;&#x74E3;&#x4E00;&#x523B;&#xFF0C;&#x77E5;&#x4E4E;&#x65E5;&#x62A5;&#xFF0C;&#x4E00;&#x4E2A;&#xFF0C;&#x6BCF;&#x65E5;&#x4E00;&#x6587;&#x548C;&#x56FD;&#x5BB6;&#x5730;&#x7406;&#x7B49;&#x5E94;&#x7528;&#x7684;&#x7F51;&#x7EDC;APi&#xFF0C;&#x5E76;&#x5206;&#x6790;&#x4ED6;&#x4EEC;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x6570;&#x636E;&#x5E94;&#x7528;&#x5230;&#x81EA;&#x5DF1;&#x7684;&#x5E94;&#x7528;&#x4E2D;&#x53BB;&#x3002;<br>&#x5E94;&#x7528;&#x622A;&#x56FE;&#xFF1A;</p>
<p> <img src="/2016/08/29/Android&#x5F00;&#x53D1;&#x4E2D;&#x5B9E;&#x73B0;&#x70B9;&#x51FB;Webview&#x4E2D;&#x7684;&#x56FE;&#x7247;&#x8C03;&#x7528;&#x539F;&#x751F;&#x7EC4;&#x4EF6;&#x8FDB;&#x884C;&#x5C55;&#x793A;/1.png" alt="logo"><br> &#xFF08;&#x6587;&#x7AE0;&#x5217;&#x8868;&#xFF09;<br> <img src="/2016/08/29/Android&#x5F00;&#x53D1;&#x4E2D;&#x5B9E;&#x73B0;&#x70B9;&#x51FB;Webview&#x4E2D;&#x7684;&#x56FE;&#x7247;&#x8C03;&#x7528;&#x539F;&#x751F;&#x7EC4;&#x4EF6;&#x8FDB;&#x884C;&#x5C55;&#x793A;/2.png" alt="logo"><br> &#xFF08;&#x6587;&#x7AE0;&#x8BE6;&#x60C5;&#xFF09;<br> <img src="/2016/08/29/Android&#x5F00;&#x53D1;&#x4E2D;&#x5B9E;&#x73B0;&#x70B9;&#x51FB;Webview&#x4E2D;&#x7684;&#x56FE;&#x7247;&#x8C03;&#x7528;&#x539F;&#x751F;&#x7EC4;&#x4EF6;&#x8FDB;&#x884C;&#x5C55;&#x793A;/3.png" alt="logo"><br> &#xFF08;&#x56FE;&#x7247;&#x6D4F;&#x89C8;&#xFF09;<br>  <a id="more"></a></p>
<h2 id="&#x505A;&#x4EC0;&#x4E48;&#xFF1F;">&#x505A;&#x4EC0;&#x4E48;&#xFF1F;</h2><p>  &#x5176;&#x5B9E;&#x8981;&#x505A;&#x7684;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x56FE;1&#x662F;&#x6587;&#x7AE0;&#x5217;&#x8868;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;&#x6570;&#x636E;&#x662F;&#x8C46;&#x74E3;&#x4E00;&#x523B;&#x7684;Api&#x8FD4;&#x56DE;&#x7684;Json&#x6570;&#x636E;&#xFF0C;&#x901A;&#x8FC7;&#x89E3;&#x6790;&#x8BE5;&#x6570;&#x636E;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x56FE;&#x6587;&#x6DF7;&#x6392;&#x7684;&#x5217;&#x8868;&#x6570;&#x636E;&#x5185;&#x5BB9;&#xFF0C;&#x4E4B;&#x540E;&#x518D;&#x5229;&#x7528;ListView&#x7684;Adapter&#x7684;getItemViewType&#x65B9;&#x6CD5;&#x5B9E;&#x73B0;&#x4E09;&#x79CD;&#x4E0D;&#x540C;&#x7684;item&#x6DF7;&#x5408;&#x8C03;&#x7528;&#x5373;&#x53EF;&#x3002;<br>  &#x4E4B;&#x540E;&#xFF0C;&#x56FE;2&#x662F;&#x70B9;&#x51FB;&#x8FDB;&#x67D0;&#x4E2A;&#x6587;&#x7AE0;&#x540E;&#x770B;&#x5230;&#x7684;&#x6570;&#x636E;&#x5185;&#x5BB9;&#xFF0C;&#x8FD9;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#x662F;Html&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x4E2A;&#x6570;&#x636E;&#x6709;Html&#x4EE3;&#x7801;&#x4E5F;&#x6709;css&#x4EE3;&#x7801;&#xFF0C;&#x5229;&#x7528;&#x7684;&#x5C31;&#x662F;WebView&#x6765;&#x52A0;&#x8F7D;&#x7F51;&#x9875;&#x7684;&#x65B9;&#x5F0F;&#x8FBE;&#x5230;&#x5FEB;&#x901F;&#x7684;&#x5B9E;&#x73B0;&#x56FE;&#x6587;&#x6DF7;&#x6392;&#x7684;&#x76EE;&#x7684;&#xFF0C;&#x7528;&#x539F;&#x751F;&#x7684;Android&#x7EC4;&#x4EF6;&#x662F;&#x6CA1;&#x529E;&#x6CD5;&#x5F88;&#x5FEB;&#x901F;&#x5F88;&#x5B8C;&#x7F8E;&#x7684;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x6548;&#x679C;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x662F;&#x6700;&#x5FEB;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x65B9;&#x6848;&#x5C31;&#x5E26;&#x6765;&#x4E86;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x5982;&#x679C;&#x6211;&#x60F3;&#x6536;&#x85CF;&#x6216;&#x8005;&#x5355;&#x72EC;&#x6D4F;&#x89C8;&#x8FD9;&#x4E2A;&#x7F51;&#x9875;&#x4E2D;&#x7684;&#x67D0;&#x5F20;&#x56FE;&#x7247;&#x4FBF;&#x4F1A;&#x5F88;&#x56F0;&#x96BE;&#xFF0C;&#x56E0;&#x4E3A;&#x65E0;&#x6CD5;&#x5FEB;&#x901F;&#x7684;&#x5C06;&#x56FE;&#x7247;&#x6570;&#x636E;&#x52A0;&#x8F7D;&#x5230;&#x539F;&#x751F;&#x7684;Android&#x7EC4;&#x4EF6;&#x4E2D;&#x53BB;&#xFF0C;&#x4E8E;&#x662F;&#x4FBF;&#x8981;&#x60F3;&#x529E;&#x6CD5;&#xFF0C;&#x8BA9;Android&#x539F;&#x751F;&#x4E0E;Html&#x8FDB;&#x884C;&#x4EA4;&#x4E92;&#xFF0C;&#x4ECE;&#x800C;&#x8FBE;&#x5230;&#x6211;&#x4EEC;&#x7684;&#x76EE;&#x7684;&#x3002;<br>  &#x5176;&#x5B9E;&#x8BF4;&#x5230;&#x5E95;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x8981;&#x5728;&#x7528;&#x6237;&#x70B9;&#x51FB;&#x56FE;&#x7247;&#x7684;&#x65F6;&#x5019;&#x83B7;&#x5F97;&#x8FD9;&#x4E2A;&#x56FE;&#x7247;&#x7684;Url&#x7136;&#x540E;&#x5C06;Url&#x544A;&#x8BC9;&#x6211;&#x4EEC;&#x7684;&#x5B89;&#x5353;&#x56FE;&#x7247;&#x7EC4;&#x4EF6;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF0C;&#x524D;&#x4E00;&#x6B65;&#x6709;&#x8FC7;web&#x5F00;&#x53D1;&#x7ECF;&#x9A8C;&#x7684;&#x670B;&#x53CB;&#x5E94;&#x8BE5;&#x90FD;&#x5F88;&#x5BB9;&#x6613;&#x60F3;&#x5230;&#xFF0C;&#x53EA;&#x8981;&#x5229;&#x7528;JavaScript&#x7684;onClick&#x76D1;&#x542C;&#x5C31;&#x53EF;&#x4EE5;&#x8F7B;&#x677E;&#x5B9E;&#x73B0;&#x83B7;&#x53D6;&#x56FE;&#x7247;Url&#x7684;&#x6548;&#x679C;&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x4F55;&#x5C06;&#x83B7;&#x5F97;Url&#x544A;&#x8BC9;Android&#x7EC4;&#x4EF6;&#xFF0C;&#x5219;&#x9700;&#x8981;&#x7528;&#x5230;Android&#x4E0E;JavaScript&#x4EA4;&#x4E92;&#x7684;&#x76F8;&#x5173;&#x77E5;&#x8BC6;&#x4E86;&#x3002;</p>
<h2 id="&#x600E;&#x4E48;&#x505A;&#xFF1F;">&#x600E;&#x4E48;&#x505A;&#xFF1F;</h2><p>  &#x56E0;&#x4E3A;&#x7528;&#x5230;&#x4E86;WebView&#xFF0C;&#x90A3;&#x4E48;&#x8BDD;&#x4E0D;&#x591A;&#x8BF4;&#x4E86;&#xFF0C;&#x76F4;&#x63A5;&#x8981;&#x5728;Activity&#x4E2D;&#x521D;&#x59CB;&#x5316;WebView&#x7EC4;&#x4EF6;&#x624D;&#x662F;&#x6B63;&#x4E8B;&#xFF1A;</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mWebView=(WebView) <span class="keyword">this</span>.findViewById(R.id.news_detail_webView);</span><br></pre></td></tr></table></figure>
<p>  &#x4E4B;&#x540E;&#x518D;&#x5BF9;WebView&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#x8BBE;&#x7F6E;&#xFF1A;<br>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mWebView.getSettings().setLayoutAlgorithm(LayoutAlgorithm.NARROW_COLUMNS);</span><br><span class="line">     mWebView.getSettings().setJavaScriptEnabled(<span class="keyword">true</span>);  </span><br><span class="line">     mWebView.getSettings().setRenderPriority(RenderPriority.HIGH);  </span><br><span class="line">     mWebView.getSettings().setCacheMode(WebSettings.LOAD_CACHE_ELSE_NETWORK);  <span class="comment">//&#x8BBE;&#x7F6E; &#x7F13;&#x5B58;&#x6A21;&#x5F0F;  </span></span><br><span class="line">     <span class="comment">// &#x5F00;&#x542F; DOM storage API &#x529F;&#x80FD;  </span></span><br><span class="line">     mWebView.getSettings().setDomStorageEnabled(<span class="keyword">true</span>);  </span><br><span class="line">     <span class="comment">//&#x5F00;&#x542F; database storage API &#x529F;&#x80FD;  </span></span><br><span class="line">     mWebView.getSettings().setDatabaseEnabled(<span class="keyword">true</span>);   </span><br><span class="line">     <span class="comment">//&#x5F00;&#x542F; Application Caches &#x529F;&#x80FD;  </span></span><br><span class="line">     mWebView.getSettings().setAppCacheEnabled(<span class="keyword">true</span>);  </span><br><span class="line">     mWebView.getSettings().setBlockNetworkImage(<span class="keyword">false</span>);</span><br><span class="line">     mWebView.getSettings().setLoadsImagesAutomatically(<span class="keyword">true</span>); <span class="comment">//&#x81EA;&#x52A8;&#x52A0;&#x8F7D;&#x56FE;&#x7247; </span></span><br><span class="line">     mWebView.getSettings().setPluginState(PluginState.OFF);</span><br><span class="line">     </span><br><span class="line">     DisplayMetrics metrics = <span class="keyword">new</span> DisplayMetrics();</span><br><span class="line">     getWindowManager().getDefaultDisplay().getMetrics(metrics);</span><br></pre></td></tr></table></figure></p>
<p>  &#x8BBE;&#x7F6E;&#x7684;&#x5177;&#x4F53;&#x5185;&#x5BB9;&#x770B;&#x4EE3;&#x7801;&#x90FD;&#x80FD;&#x770B;&#x61C2;&#xFF0C;&#x6CE8;&#x610F;&#x4E00;&#x5B9A;&#x8981;&#x52A0;&#x4E0A;setJavaScriptEnabled(true);&#x8FD9;&#x4E2A;&#x8BBE;&#x7F6E;&#xFF0C;&#x4E0D;&#x7136;&#x7684;&#x8BDD;JavaScript&#x5728;WebView&#x4E2D;&#x90FD;&#x4E0D;&#x8D77;&#x4F5C;&#x7528;&#xFF0C;&#x8FD8;&#x8C08;&#x4EC0;&#x4E48;&#x4EA4;&#x4E92;&#x5462;&#xFF1F;<br>  &#x7136;&#x540E;&#x5728;Oncreate&#x65B9;&#x6CD5;&#x4E2D;&#x7EE7;&#x7EED;&#x52A0;&#x5165;&#x5982;&#x4E0B;&#x4E24;&#x884C;&#x4EE3;&#x7801;&#xFF1A;<br>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mWebView.addJavascriptInterface(<span class="keyword">new</span> JavascriptInterface(<span class="keyword">this</span>), <span class="string">&quot;imagelistner&quot;</span>);  </span><br><span class="line">mWebView.setWebViewClient(<span class="keyword">new</span> MyWebViewClient());</span><br></pre></td></tr></table></figure></p>
<p>  &#x6CE8;&#x610F;&#x4E86;&#xFF0C;&#x8FD9;&#x4E24;&#x884C;&#x4EE3;&#x7801;&#x5C31;&#x662F;Android&#x4E0E;JavaScript&#x4EA4;&#x4E92;&#x7684;&#x5173;&#x952E;&#x3002;<br>  &#x6211;&#x4EEC;&#x5148;&#x770B;&#x7B2C;&#x4E00;&#x884C;&#x4EE3;&#x7801;&#xFF1A;</p>
<blockquote>
<p>mWebView.addJavascriptInterface(new JavascriptInterface(this), &#x201C;imagelistner&#x201D;); </p>
</blockquote>
<p>  &#x8FD9;&#x884C;&#x4EE3;&#x7801;&#x7684;&#x610F;&#x601D;&#x5C31;&#x662F;&#xFF0C;&#x7ED9;WebView&#x7EC4;&#x4EF6;&#x52A0;&#x4E0A;javaScript&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x81F3;&#x4E8E;&#x63A5;&#x53E3;&#x7684;&#x5185;&#x5BB9;&#x662F;&#x4EC0;&#x4E48;&#xFF0C;&#x63A5;&#x53E3;&#x53EB;&#x4EC0;&#x4E48;&#x540D;&#x5B57;&#xFF0C;&#x65B9;&#x6CD5;&#x4E2D;&#x7684;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x5C31;&#x662F;&#x4E86;&#x3002;</p>
<p>  &#x5148;&#x770B;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x770B;&#x5230;&#x53EF;&#x4EE5;new&#x5C31;&#x5E94;&#x8BE5;&#x77E5;&#x9053;&#xFF0C;&#x8FD9;&#x4E2A;&#x5E94;&#x8BE5;&#x662F;&#x4E00;&#x4E2A;&#x7C7B;&#x4E86;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x628A;&#x8FD9;&#x4E2A;&#x7C7B;&#x5199;&#x6210;&#x4E00;&#x4E2A;&#x5185;&#x90E8;&#x7C7B;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x628A;&#x5B83;&#x63D0;&#x53D6;&#x6210;&#x4E00;&#x4E2A;&#x72EC;&#x7ACB;&#x7684;&#x7C7B;&#xFF0C;&#x73B0;&#x5728;&#x6765;&#x770B;&#x770B;&#x8FD9;&#x4E2A;&#x7C7B;&#x7684;&#x5185;&#x5BB9;&#xFF1A;</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// js&#x901A;&#x4FE1;&#x63A5;&#x53E3;</span></span><br><span class="line">		<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavascriptInterface</span> </span>{</span><br><span class="line"></span><br><span class="line">			<span class="keyword">private</span> Context context;</span><br><span class="line"></span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="title">JavascriptInterface</span><span class="params">(Context context)</span> </span>{</span><br><span class="line">				<span class="keyword">this</span>.context = context;</span><br><span class="line">			}</span><br><span class="line"></span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">openImage</span><span class="params">(String img)</span> </span>{</span><br><span class="line">				<span class="comment">//</span></span><br><span class="line">				Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line">				intent.putExtra(<span class="string">&quot;image&quot;</span>, img);</span><br><span class="line">				intent.setClass(context, ShowWebImageActivity.class);</span><br><span class="line">				context.startActivity(intent);</span><br><span class="line">			}</span><br><span class="line">		}</span><br></pre></td></tr></table></figure>
<p>  &#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x5C31;&#x662F;&#x7528;&#x6765;&#x5B9E;&#x73B0;&#x7A0B;&#x5E8F;&#x5728;&#x70B9;&#x51FB;&#x540E;&#x5E94;&#x8BE5;&#x6267;&#x884C;&#x4EC0;&#x4E48;&#x64CD;&#x4F5C;&#x7684;&#xFF0C;&#x770B;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x77E5;&#x9053;&#xFF0C;&#x6211;&#x662F;&#x5C06;&#x5F97;&#x5230;&#x7684;&#x56FE;&#x7247;&#x8DEF;&#x5F84;&#x5F53;&#x4F5C;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x7ED9;ShowWebImageActivity&#x7684;&#xFF0C;&#x8FD9;&#x4E2A;Activity&#x8D1F;&#x8D23;&#x7684;&#x5C31;&#x662F;&#x6839;&#x636E;&#x56FE;&#x7247;&#x7684;Url&#x5730;&#x5740;&#x52A0;&#x8F7D;&#x56FE;&#x7247;&#x3002;<br>  &#x4F60;&#x53EF;&#x80FD;&#x7740;&#x6025;&#x4E86;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;&#x4EE3;&#x7801;&#x4E5F;&#x53EA;&#x662F;&#x4EA4;&#x4E92;&#x5B8C;&#x6BD5;&#x540E;&#x7684;&#x5DE5;&#x4F5C;&#x5185;&#x5BB9;&#x554A;&#xFF0C;&#x5177;&#x4F53;&#x600E;&#x4E48;&#x4EA4;&#x4E92;&#x554A;&#xFF1F;<br>  &#x522B;&#x6025;&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x521A;&#x624D;OnCreate&#x65B9;&#x6CD5;&#x7684;&#x6700;&#x540E;&#x4E00;&#x884C;&#x4EE3;&#x7801;&#xFF1A;</p>
<blockquote>
<p>mWebView.setWebViewClient(new MyWebViewClient());</p>
</blockquote>
<p>  &#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x662F;&#x7528;&#x6765;&#x81EA;&#x5B9A;&#x4E49;WebView&#x52A0;&#x8F7D;&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x64CD;&#x4F5C;&#x7684;&#xFF0C;&#x5177;&#x4F53;&#x770B; MyWebViewClient &#x8FD9;&#x4E2A;&#x7C7B;&#xFF1A;</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &#x76D1;&#x542C;</span></span><br><span class="line">	<span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">MyWebViewClient</span> <span class="keyword">extends</span> <span class="title">WebViewClient</span> </span>{</span><br><span class="line">		<span class="annotation">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">shouldOverrideUrlLoading</span><span class="params">(WebView view, String url)</span> </span>{</span><br><span class="line"></span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">super</span>.shouldOverrideUrlLoading(view, url);</span><br><span class="line">		}</span><br><span class="line"></span><br><span class="line">		<span class="annotation">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageFinished</span><span class="params">(WebView view, String url)</span> </span>{</span><br><span class="line"></span><br><span class="line">			view.getSettings().setJavaScriptEnabled(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">super</span>.onPageFinished(view, url);</span><br><span class="line">			<span class="comment">// html&#x52A0;&#x8F7D;&#x5B8C;&#x6210;&#x4E4B;&#x540E;&#xFF0C;&#x6DFB;&#x52A0;&#x76D1;&#x542C;&#x56FE;&#x7247;&#x7684;&#x70B9;&#x51FB;js&#x51FD;&#x6570;</span></span><br><span class="line">			addImageClickListner();</span><br><span class="line"></span><br><span class="line">		}</span><br><span class="line"></span><br><span class="line">		<span class="annotation">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageStarted</span><span class="params">(WebView view, String url, Bitmap favicon)</span> </span>{</span><br><span class="line">			view.getSettings().setJavaScriptEnabled(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">super</span>.onPageStarted(view, url, favicon);</span><br><span class="line">		}</span><br><span class="line"></span><br><span class="line">		<span class="annotation">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceivedError</span><span class="params">(WebView view, <span class="keyword">int</span> errorCode, String description, String failingUrl)</span> </span>{</span><br><span class="line"></span><br><span class="line">			<span class="keyword">super</span>.onReceivedError(view, errorCode, description, failingUrl);</span><br><span class="line"></span><br><span class="line">		}</span><br><span class="line">	}</span><br></pre></td></tr></table></figure>
<p>  &#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x5927;&#x90E8;&#x5206;&#x90FD;&#x662F;&#x8C03;&#x7528;&#x7684;&#x7236;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x53EA;&#x662F;&#x5728;OnPageFinished&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x91CC;&#x52A0;&#x5165;&#x4E86;&#x4E00;&#x4E2A;&#x81EA;&#x5DF1;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;addImageClickListener()&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x91CC;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x4EA4;&#x4E92;&#x7684;&#x5173;&#x952E;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x7EE7;&#x7EED;&#x770B;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#xFF1A;<br>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &#x6CE8;&#x5165;js&#x51FD;&#x6570;&#x76D1;&#x542C;</span></span><br><span class="line">		<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addImageClickListner</span><span class="params">()</span> </span>{</span><br><span class="line">			<span class="comment">// &#x8FD9;&#x6BB5;js&#x51FD;&#x6570;&#x7684;&#x529F;&#x80FD;&#x5C31;&#x662F;&#xFF0C;&#x904D;&#x5386;&#x6240;&#x6709;&#x7684;img&#x51E0;&#x70B9;&#xFF0C;&#x5E76;&#x6DFB;&#x52A0;onclick&#x51FD;&#x6570;&#xFF0C;</span></span><br><span class="line">			<span class="comment">//&#x51FD;&#x6570;&#x7684;&#x529F;&#x80FD;&#x662F;&#x5728;&#x56FE;&#x7247;&#x70B9;&#x51FB;&#x7684;&#x65F6;&#x5019;&#x8C03;&#x7528;&#x672C;&#x5730;java&#x63A5;&#x53E3;&#x5E76;&#x4F20;&#x9012;url&#x8FC7;&#x53BB;</span></span><br><span class="line">			mWebView.loadUrl(<span class="string">&quot;javascript:(function(){&quot;</span> +</span><br><span class="line">			<span class="string">&quot;var objs = document.getElementsByTagName(\&quot;img\&quot;); &quot;</span> + </span><br><span class="line">					<span class="string">&quot;for(var i=0;i&lt;objs.length;i++)  &quot;</span> + </span><br><span class="line">			<span class="string">&quot;{&quot;</span></span><br><span class="line">					+ <span class="string">&quot;    objs[i].onclick=function()  &quot;</span> + </span><br><span class="line">			<span class="string">&quot;    {  &quot;</span> </span><br><span class="line">					+ <span class="string">&quot;        window.imagelistner.openImage(this.src);  &quot;</span> + </span><br><span class="line">			<span class="string">&quot;    }  &quot;</span> + </span><br><span class="line">			<span class="string">&quot;}&quot;</span> + </span><br><span class="line">			<span class="string">&quot;})()&quot;</span>);</span><br><span class="line">		}</span><br></pre></td></tr></table></figure></p>
<p>  &#x597D;&#x4E86;&#xFF0C;&#x8FD9;&#x4E2A;&#x5C31;&#x662F;&#x6CE8;&#x5165;&#x7684;&#x5173;&#x952E;&#x4E86;&#xFF0C;&#x9996;&#x5148;&#x5229;&#x7528;WebView&#x7684;&#x65B9;&#x6CD5;loadUrl(&#x201C;javascript:xxx&#x201D;)&#x6765;&#x5B9E;&#x73B0;&#x6CE8;&#x5165;&#xFF0C;&#x4E4B;&#x540E;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x6CE8;&#x5165;&#x7684;&#x65B9;&#x6CD5;&#x5185;&#x5BB9;&#x4E86;&#xFF0C;&#x5B66;&#x8FC7;JS&#x7684;&#x5E94;&#x8BE5;&#x5F88;&#x5BB9;&#x6613;&#x7406;&#x89E3;&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x904D;&#x5386;&#x5F53;&#x524D;&#x7684;Html,&#x7136;&#x540E;&#x5C06;Html&#x4E2D;&#x7684;Img&#x7EC4;&#x4EF6;&#x5168;&#x90E8;&#x83B7;&#x53D6;&#x5230;&#x540E;&#xFF0C;&#x518D;&#x7ED9;&#x6BCF;&#x4E2A;IMG&#x7EC4;&#x4EF6;&#x52A0;&#x5165;onClick&#x4E8B;&#x4EF6;&#xFF0C;&#x8BE5;&#x4E8B;&#x4EF6;&#x7684;&#x65B9;&#x6CD5;&#x4F53;&#x5C31;&#x662F;&#xFF1A;</p>
<blockquote>
<p>window.imagelistner.openImage(this.src); </p>
</blockquote>
<p>  &#x6CE8;&#x610F;&#x770B;&#x8FD9;&#x4E2A;imagelistenr&#x5176;&#x5B9E;&#x5C31;&#x662F; mWebView.addJavascriptInterface(new JavascriptInterface(this), &#x201C;imagelistner&#x201D;); &#x5B9A;&#x4E49;&#x7684;&#x65B9;&#x6CD5;&#x540D;&#xFF0C;&#x800C;openImage&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x81EA;&#x5B9A;&#x4E49;&#x7684;JavaScriptInterface&#x4E2D;&#x7684;openImage&#x65B9;&#x6CD5;&#x3002;</p>
<p>  &#x81F3;&#x6B64;&#xFF0C;Android&#x4E0E;JavaScript&#x7684;&#x4EA4;&#x4E92;&#x5C31;&#x5DF2;&#x7ECF;&#x5B8C;&#x6BD5;&#x4E86;&#xFF0C;&#x70B9;&#x51FB;WebView&#x4E2D;&#x7684;&#x56FE;&#x7247;&#x5C31;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#x6211;&#x4EEC;&#x539F;&#x751F;&#x7684;Android&#x7EC4;&#x4EF6;&#x6765;&#x52A0;&#x8F7D;&#x4E86;&#xFF0C;&#x60F3;&#x7F29;&#x653E;&#xFF0C;&#x60F3;&#x4E0B;&#x8F7D;&#x5C31;&#x968F;&#x4F60;&#x5566;&#xFF01;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[使用DrawerLayout和NavigationView以及Toolbar创建一个MD风格的应用框架]]></title>
      <url>http://jasoncool.com/2016/08/25/%E4%BD%BF%E7%94%A8DrawerLayout%E5%92%8CNavigationView%E4%BB%A5%E5%8F%8AToolbar%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAMD%E9%A3%8E%E6%A0%BC%E7%9A%84%E5%BA%94%E7%94%A8%E6%A1%86%E6%9E%B6/</url>
      <content type="html"><![CDATA[<p>   &#x65B0;&#x9879;&#x76EE;&#x5F00;&#x53D1;&#x5728;&#x5373;&#xFF0C;&#x901A;&#x8FC7;&#x4E4B;&#x524D;&#x7684;&#x539F;&#x578B;&#x8BBE;&#x8BA1;&#xFF0C;&#x6253;&#x7B97;&#x505A;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x4FA7;&#x6ED1;&#x8FB9;&#x680F;&#x7684;&#x5E94;&#x7528;&#xFF0C;&#x9274;&#x4E8E;&#x8C37;&#x6B4C;&#x5BF9;MaterialDesign&#x7684;&#x5927;&#x529B;&#x63A8;&#x5E7F;&#xFF0C;&#x4EE5;&#x53CA;&#x5B98;&#x65B9;&#x7684;&#x4E00;&#x4E9B;&#x5E94;&#x7528;&#x7684;&#x8BBE;&#x8BA1;&#x65B9;&#x5F0F;&#xFF0C;&#x6240;&#x4EE5;&#x6253;&#x7B97;&#x65B0;&#x7684;&#x5E94;&#x7528;&#x5C31;&#x4F7F;&#x7528;DrawerLayout+NavigationView+Toolbar&#x6765;&#x5B9E;&#x73B0;&#x4E86;&#x3002;<br>   &#x5148;&#x770B;&#x6548;&#x679C;&#x56FE;&#xFF1A;<br>   <img src="/2016/08/25/&#x4F7F;&#x7528;DrawerLayout&#x548C;NavigationView&#x4EE5;&#x53CA;Toolbar&#x521B;&#x5EFA;&#x4E00;&#x4E2A;MD&#x98CE;&#x683C;&#x7684;&#x5E94;&#x7528;&#x6846;&#x67B6;/1.png" alt="logo"><br>   <a id="more"></a></p>
<h2 id="&#x642D;&#x5EFA;&#x57FA;&#x7840;">&#x642D;&#x5EFA;&#x57FA;&#x7840;</h2><p>1.&#x5148;&#x5F15;&#x5165;&#x4F9D;&#x8D56;&#x7684;&#x5E93;&#xFF1A;</p>
<blockquote>
<p> compile &#x2018;com.android.support:design:23.4.0&#x2019;</p>
</blockquote>
<p>2.&#x7136;&#x540E;&#x628A;&#x4E3B;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x5199;&#x6210;&#x8FD9;&#x6837;&#xFF1A;<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">LinearLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line">    <span class="attribute">xmlns:app</span>=<span class="value">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">    <span class="attribute">android:orientation</span>=<span class="value">&quot;vertical&quot;</span></span><br><span class="line">    &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">include</span> <span class="attribute">layout</span>=<span class="value">&quot;@layout/nav_toolbar&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">android.support.v4.widget.DrawerLayout</span></span><br><span class="line">    <span class="attribute">android:id</span>=<span class="value">&quot;@+id/drawer_layout&quot;</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">FrameLayout</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">LinearLayout</span></span><br><span class="line">            <span class="attribute">android:id</span>=<span class="value">&quot;@+id/main&quot;</span></span><br><span class="line">            <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">            <span class="attribute">android:layout_height</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">            <span class="attribute">android:orientation</span>=<span class="value">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!-- &#x4E3B;&#x754C;&#x9762;&#x7684;&#x5185;&#x5BB9;&#x90FD;&#x5728;&#x8FD9;&#x91CC;&#x5199; --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">FrameLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">android.support.design.widget.NavigationView</span></span><br><span class="line">        <span class="attribute">android:id</span>=<span class="value">&quot;@+id/navigation&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">&quot;wrap_content&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_gravity</span>=<span class="value">&quot;start&quot;</span></span><br><span class="line">        <span class="attribute">app:headerLayout</span>=<span class="value">&quot;@layout/nav_header&quot;</span></span><br><span class="line">        <span class="attribute">app:menu</span>=<span class="value">&quot;@menu/drawer_menu&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">android.support.v4.widget.DrawerLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>3.&#x5728;&#x4E3B;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x6CE8;&#x610F;&#x5230;&#x4E86;&#xFF0C;Toolbar&#x662F;&#x7528;include&#x6807;&#x7B7E;&#x5F15;&#x5165;&#x7684;&#xFF0C;&#x800C;NavigationView&#x4E2D;&#x4E5F;&#x5F15;&#x5165;&#x4E86;&#x4E24;&#x4E2A;&#x5E03;&#x5C40;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;nav_header&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x662F;activity_main_drawer,&#x8FD9;&#x4E2A;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x662F;&#x4E00;&#x4E2A;menu&#x7684;&#x5E03;&#x5C40;&#xFF0C;&#x8981;&#x653E;&#x5728;res/menu&#x4E0B;&#x54E6;&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x5C31;&#x662F;NaigationView&#x7684;&#x4E3B;&#x8981;&#x7EC4;&#x6210;&#x90E8;&#x5206;&#x4E86;&#x3002;<br>&#x73B0;&#x5728;&#x8BA9;&#x6211;&#x4EEC;&#x770B;&#x770B;&#x8FD9;&#x4E09;&#x4E2A;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x7684;&#x5199;&#x6CD5;&#xFF1A;</p>
<p>toolbar:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">app:android.support.v7.widget.Toolbar</span> <span class="attribute">xmlns:android</span>=<span class="value">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line"><span class="attribute">xmlns:app</span>=<span class="value">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span><br><span class="line"><span class="attribute">android:id</span>=<span class="value">&quot;@+id/toolbar&quot;</span></span><br><span class="line"><span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line"><span class="attribute">android:layout_height</span>=<span class="value">&quot;wrap_content&quot;</span></span><br><span class="line"><span class="attribute">android:background</span>=<span class="value">&quot;@color/app_main_color&quot;</span></span><br><span class="line"><span class="attribute">android:minHeight</span>=<span class="value">&quot;?attr/actionBarSize&quot;</span></span><br><span class="line"><span class="attribute">app:popupTheme</span>=<span class="value">&quot;@style/ThemeOverlay.AppCompat.Light&quot;</span></span><br><span class="line"><span class="attribute">app:theme</span>=<span class="value">&quot;@style/ThemeOverlay.AppCompat.ActionBar&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>nav_hear:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">RelativeLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">&quot;match_parent&quot;</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">&quot;192dp&quot;</span></span><br><span class="line">    <span class="attribute">android:background</span>=<span class="value">&quot;@drawable/nav_header_bg&quot;</span></span><br><span class="line">    <span class="attribute">android:orientation</span>=<span class="value">&quot;vertical&quot;</span></span><br><span class="line">    <span class="attribute">android:padding</span>=<span class="value">&quot;@dimen/spacing_normal&quot;</span></span><br><span class="line">    <span class="attribute">android:theme</span>=<span class="value">&quot;@style/ThemeOverlay.AppCompat.Dark&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">TextView</span></span><br><span class="line">        <span class="attribute">android:id</span>=<span class="value">&quot;@+id/id_link&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">&quot;wrap_content&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">&quot;wrap_content&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_alignParentBottom</span>=<span class="value">&quot;true&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_marginBottom</span>=<span class="value">&quot;@dimen/spacing_normal&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_marginTop</span>=<span class="value">&quot;@dimen/spacing_tiny&quot;</span></span><br><span class="line">        <span class="attribute">android:text</span>=<span class="value">&quot;&#x7BA1;&#x7406;&#x90E8;&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">TextView</span></span><br><span class="line">        <span class="attribute">android:id</span>=<span class="value">&quot;@+id/id_username&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">&quot;wrap_content&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">&quot;wrap_content&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_above</span>=<span class="value">&quot;@id/id_link&quot;</span></span><br><span class="line">        <span class="attribute">android:text</span>=<span class="value">&quot;Admin&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">ImageView</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">&quot;72dp&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">&quot;72dp&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_above</span>=<span class="value">&quot;@id/id_username&quot;</span></span><br><span class="line">        <span class="attribute">android:layout_marginBottom</span>=<span class="value">&quot;@dimen/spacing_normal&quot;</span></span><br><span class="line">        <span class="attribute">android:src</span>=<span class="value">&quot;@drawable/ic_avatar&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="title">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>activity_main_drawer:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">menu</span> <span class="attribute">xmlns:android</span>=<span class="value">&quot;http://schemas.android.com/apk/res/android&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">group</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">item</span></span><br><span class="line">        <span class="attribute">android:id</span>=<span class="value">&quot;@+id/nav_driver_contact&quot;</span></span><br><span class="line">        <span class="attribute">android:icon</span>=<span class="value">&quot;@drawable/ic_favorite_black_24dp&quot;</span></span><br><span class="line">        <span class="attribute">android:checkable</span>=<span class="value">&quot;true&quot;</span></span><br><span class="line">        <span class="attribute">android:title</span>=<span class="value">&quot;&#x53F8;&#x673A;&#x901A;&#x8BAF;&#x5F55;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">item</span></span><br><span class="line">            <span class="attribute">android:id</span>=<span class="value">&quot;@+id/nav_car_detail_list&quot;</span></span><br><span class="line">            <span class="attribute">android:icon</span>=<span class="value">&quot;@drawable/ic_favorite_black_24dp&quot;</span></span><br><span class="line">            <span class="attribute">android:checkable</span>=<span class="value">&quot;true&quot;</span></span><br><span class="line">            <span class="attribute">android:title</span>=<span class="value">&quot;&#x8F66;&#x8F86;&#x4FE1;&#x606F;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">group</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">menu</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>4.&#x901A;&#x8FC7;&#x4EE5;&#x4E0A;&#x7684;&#x6B65;&#x9AA4;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x5C31;&#x5DF2;&#x7ECF;&#x628A;&#x4FA7;&#x6ED1;&#x8FB9;&#x680F;&#x7684;&#x4E3B;&#x4F53;&#x5DF2;&#x7ECF;&#x642D;&#x5EFA;&#x5B8C;&#x6BD5;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4F1A;&#x7684;&#x5E94;&#x7528;&#x867D;&#x7136;&#x5DF2;&#x7ECF;&#x53EF;&#x4EE5;&#x8FD0;&#x884C;&#xFF0C;&#x4F46;&#x662F;&#x8FD8;&#x662F;&#x8FDC;&#x8FDC;&#x8FBE;&#x4E0D;&#x5230;&#x6211;&#x4EEC;&#x7684;&#x8981;&#x6C42;&#x7684;&#xFF0C;&#x6BD4;&#x5982;toolbar&#x7A7A;&#x7A7A;&#x5982;&#x4E5F;&#x554A;&#xFF0C;&#x6BD4;&#x5982;toolbar&#x548C;statusbar&#x7684;&#x989C;&#x8272;&#x4E0D;&#x662F;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#x554A;&#x7B49;&#x7B49;&#xFF0C;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5C31;&#x6765;&#x4E00;&#x6B65;&#x6B65;&#x7684;&#x5B8C;&#x6210;&#x5269;&#x4E0B;&#x7684;&#x5DE5;&#x4F5C;&#x5427;&#x3002;<br>&#x7B2C;&#x4E00;&#x6B65;&#xFF0C;&#x5148;&#x5B8C;&#x5584;&#x4E3B;&#x9898;&#x6587;&#x4EF6;<br>styles.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">resources</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Base application theme. --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">style</span> <span class="attribute">name</span>=<span class="value">&quot;AppTheme&quot;</span> <span class="attribute">parent</span>=<span class="value">&quot;Theme.AppCompat.Light.NoActionBar&quot;</span>&gt;</span><span class="css"></span><br><span class="line">        &lt;!<span class="tag">--</span> <span class="tag">Customize</span> <span class="tag">your</span> <span class="tag">theme</span> <span class="tag">here</span>. <span class="tag">--</span>&gt;</span><br><span class="line">        &lt;<span class="tag">item</span> <span class="tag">name</span>=&quot;<span class="tag">colorAccent</span>&quot;&gt;<span class="at_rule">@<span class="keyword">color/colorAccent&lt;/item&gt;</span></span><br><span class="line">        &lt;item name=<span class="string">&quot;android:windowIsTranslucent&quot;</span>&gt;true&lt;/item&gt;</span><br><span class="line">        &lt;!-- toolbar&#xFF08;actionbar&#xFF09;&#x989C;&#x8272; --&gt;</span><br><span class="line">        &lt;item name=<span class="string">&quot;colorPrimary&quot;</span>&gt;@color/app_main_color&lt;/item&gt;</span><br><span class="line">        &lt;!-- &#x72B6;&#x6001;&#x680F;&#x989C;&#x8272; --&gt;</span><br><span class="line">        &lt;item name=<span class="string">&quot;colorPrimaryDark&quot;</span>&gt;@color/app_main_color&lt;/item&gt;</span><br><span class="line">        &lt;!-- &#x7A97;&#x53E3;&#x7684;&#x80CC;&#x666F;&#x989C;&#x8272; --&gt;</span><br><span class="line">        &lt;item name=<span class="string">&quot;android:windowBackground&quot;</span>&gt;@android:color/white&lt;/item&gt;</span><br><span class="line">        &lt;!--&#x6587;&#x5B57;&#x7684;&#x989C;&#x8272;--&gt;</span><br><span class="line">        &lt;item name=<span class="string">&quot;android:textColorPrimary&quot;</span>&gt;@color/black_white&lt;/item&gt;</span><br><span class="line">        &lt;!--&#x6309;&#x94AE;&#x7684;&#x989C;&#x8272;&#x6837;&#x5F0F;&#x8BBE;&#x7F6E;--&gt;</span><br><span class="line">        &lt;item name=<span class="string">&quot;drawerArrowStyle&quot;</span>&gt;@style/AppTheme.DrawerArrowToggle&lt;/item&gt;</span><br><span class="line">    </span></span><span class="tag">&lt;/<span class="title">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- &#x8BBE;&#x7F6E;&#x5DE6;&#x4E0A;&#x89D2;&#x83DC;&#x5355;&#x548C;&#x8FD4;&#x56DE;&#x6309;&#x94AE;&#x7684;&#x989C;&#x8272;&#x6837;&#x5F0F;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">style</span> <span class="attribute">name</span>=<span class="value">&quot;AppTheme.DrawerArrowToggle&quot;</span> <span class="attribute">parent</span>=<span class="value">&quot;Base.Widget.AppCompat.DrawerArrowToggle&quot;</span>&gt;</span><span class="css"><span class="at_rule"></span><br><span class="line">        &lt;item name=<span class="string">&quot;color&quot;</span>&gt;@android:color/white&lt;/item&gt;</span><br><span class="line">    </span></span><span class="tag">&lt;/<span class="title">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">resources</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x6587;&#x4EF6;&#x4E2D;&#x6709;&#x4E00;&#x4E9B;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x989C;&#x8272;&#xFF0C;&#x7528;&#x5230;&#x4E86;colors.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">resources</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Base application theme. --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">style</span> <span class="attribute">name</span>=<span class="value">&quot;AppTheme&quot;</span> <span class="attribute">parent</span>=<span class="value">&quot;Theme.AppCompat.Light.NoActionBar&quot;</span>&gt;</span><span class="css"></span><br><span class="line">        &lt;!<span class="tag">--</span> <span class="tag">Customize</span> <span class="tag">your</span> <span class="tag">theme</span> <span class="tag">here</span>. <span class="tag">--</span>&gt;</span><br><span class="line">        &lt;<span class="tag">item</span> <span class="tag">name</span>=&quot;<span class="tag">colorAccent</span>&quot;&gt;<span class="at_rule">@<span class="keyword">color/colorAccent&lt;/item&gt;</span></span><br><span class="line">        &lt;item name=<span class="string">&quot;android:windowIsTranslucent&quot;</span>&gt;true&lt;/item&gt;</span><br><span class="line">        &lt;!-- toolbar&#xFF08;actionbar&#xFF09;&#x989C;&#x8272; --&gt;</span><br><span class="line">        &lt;item name=<span class="string">&quot;colorPrimary&quot;</span>&gt;@color/app_main_color&lt;/item&gt;</span><br><span class="line">        &lt;!-- &#x72B6;&#x6001;&#x680F;&#x989C;&#x8272; --&gt;</span><br><span class="line">        &lt;item name=<span class="string">&quot;colorPrimaryDark&quot;</span>&gt;@color/app_main_color&lt;/item&gt;</span><br><span class="line">        &lt;!-- &#x7A97;&#x53E3;&#x7684;&#x80CC;&#x666F;&#x989C;&#x8272; --&gt;</span><br><span class="line">        &lt;item name=<span class="string">&quot;android:windowBackground&quot;</span>&gt;@android:color/white&lt;/item&gt;</span><br><span class="line">        &lt;!--&#x6587;&#x5B57;&#x7684;&#x989C;&#x8272;--&gt;</span><br><span class="line">        &lt;item name=<span class="string">&quot;android:textColorPrimary&quot;</span>&gt;@color/black_white&lt;/item&gt;</span><br><span class="line">        &lt;!--&#x6309;&#x94AE;&#x7684;&#x989C;&#x8272;&#x6837;&#x5F0F;&#x8BBE;&#x7F6E;--&gt;</span><br><span class="line">        &lt;item name=<span class="string">&quot;drawerArrowStyle&quot;</span>&gt;@style/AppTheme.DrawerArrowToggle&lt;/item&gt;</span><br><span class="line">    </span></span><span class="tag">&lt;/<span class="title">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- &#x8BBE;&#x7F6E;&#x5DE6;&#x4E0A;&#x89D2;&#x83DC;&#x5355;&#x548C;&#x8FD4;&#x56DE;&#x6309;&#x94AE;&#x7684;&#x989C;&#x8272;&#x6837;&#x5F0F;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">style</span> <span class="attribute">name</span>=<span class="value">&quot;AppTheme.DrawerArrowToggle&quot;</span> <span class="attribute">parent</span>=<span class="value">&quot;Base.Widget.AppCompat.DrawerArrowToggle&quot;</span>&gt;</span><span class="css"><span class="at_rule"></span><br><span class="line">        &lt;item name=<span class="string">&quot;color&quot;</span>&gt;@android:color/white&lt;/item&gt;</span><br><span class="line">    </span></span><span class="tag">&lt;/<span class="title">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">resources</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x597D;&#x7684;&#xFF0C;&#x73B0;&#x5728;&#x4E3B;&#x9898;&#x6587;&#x4EF6;&#x57FA;&#x672C;&#x4E0A;&#x5DF2;&#x7ECF;&#x8BBE;&#x7F6E;&#x5B8C;&#x6BD5;&#x4E86;&#xFF0C;&#x6574;&#x4E2A;&#x5E94;&#x7528;&#x7684;&#x98CE;&#x683C;&#x5DF2;&#x7ECF;&#x662F;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#x6837;&#x5B50;&#x4E86;&#x3002;</p>
<p>5.&#x73B0;&#x5728;&#x8FD8;&#x5DEE;&#x4E00;&#x4E2A;&#x5C31;&#x662F;&#x5728;toolbar&#x4E0A;&#x52A0;&#x4E00;&#x4E2A;&#x83DC;&#x5355;&#x6309;&#x94AE;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x7684;&#x5E94;&#x7528;&#x4E0D;&#x4EC5;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x624B;&#x52BF;&#x4FA7;&#x6ED1;&#x547C;&#x51FA;&#x83DC;&#x5355;&#x680F;&#x4E5F;&#x53EF;&#x4EE5;&#x70B9;&#x51FB;&#x5DE6;&#x4E0A;&#x89D2;&#x7684;menu&#x56FE;&#x6807;&#x663E;&#x793A;&#x83DC;&#x5355;&#x680F;&#xFF0C;&#x5982;&#x56FE;&#xFF1A;<br><img src="/2016/08/25/&#x4F7F;&#x7528;DrawerLayout&#x548C;NavigationView&#x4EE5;&#x53CA;Toolbar&#x521B;&#x5EFA;&#x4E00;&#x4E2A;MD&#x98CE;&#x683C;&#x7684;&#x5E94;&#x7528;&#x6846;&#x67B6;/2.png" alt="logo"><br>&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x90FD;&#x9700;&#x8981;&#x5728;Activity&#x4E2D;&#x8FDB;&#x884C;&#xFF0C;&#x4E0B;&#x9762;&#x662F;&#x8BBE;&#x7F6E;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x90FD;&#x6709;&#x6CE8;&#x91CA;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.support.design.widget.NavigationView;</span><br><span class="line"><span class="keyword">import</span> android.support.v4.content.ContextCompat;</span><br><span class="line"><span class="keyword">import</span> android.support.v4.widget.DrawerLayout;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.app.ActionBarDrawerToggle;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.widget.Toolbar;</span><br><span class="line"><span class="keyword">import</span> android.view.Menu;</span><br><span class="line"><span class="keyword">import</span> android.view.MenuItem;</span><br><span class="line"><span class="keyword">import</span> android.widget.LinearLayout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.dhcc.obd.R;</span><br><span class="line"><span class="keyword">import</span> com.dhcc.obdcore_library.Util.ToastUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> butterknife.BindView;</span><br><span class="line"><span class="keyword">import</span> butterknife.ButterKnife;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = MainActivity.class.getSimpleName();</span><br><span class="line">    <span class="annotation">@BindView</span>(R.id.main)</span><br><span class="line">    LinearLayout main;</span><br><span class="line">    <span class="annotation">@BindView</span>(R.id.navigation)</span><br><span class="line">    NavigationView navigation;</span><br><span class="line">    <span class="annotation">@BindView</span>(R.id.drawer_layout)</span><br><span class="line">    DrawerLayout drawerLayout;</span><br><span class="line">    <span class="annotation">@BindView</span>(R.id.toolbar)</span><br><span class="line">    Toolbar toolbar;</span><br><span class="line">    ActionBarDrawerToggle mDrawerToggle;</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        ButterKnife.bind(<span class="keyword">this</span>);</span><br><span class="line">        toolbar.setTitle(<span class="string">&quot;&#x4E1C;&#x534E;&#x8F66;&#x7BA1;&quot;</span>);</span><br><span class="line">        toolbar.setTitleTextColor(ContextCompat.getColor(<span class="keyword">this</span>,R.color.white));</span><br><span class="line">        <span class="comment">//&#x5C06;toolbar&#x4E0E;ActionBar&#x5173;&#x8054;</span></span><br><span class="line">        setSupportActionBar(toolbar);</span><br><span class="line">        <span class="comment">//&#x8BBE;&#x7F6E;&#x663E;&#x793A;&#x5DE6;&#x4E0A;&#x89D2;&#x7684;&#x8FD4;&#x56DE;&#x952E;</span></span><br><span class="line">        getSupportActionBar().setDisplayHomeAsUpEnabled(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">//&#x7ED9;&#x5DE6;&#x4E0A;&#x89D2;&#x7684;&#x56FE;&#x6807;&#x52A0;&#x4E0A;&#x5F00;&#x5173;&#x5C5E;&#x6027;&#xFF0C;&#x8FD9;&#x4E2A;&#x662F;&#x5957;&#x8DEF;&#xFF0C;&#x5C11;&#x4E00;&#x4E2A;&#x6B65;&#x9AA4;&#x90FD;&#x89E6;&#x53D1;&#x4E0D;&#x4E86;&#x5F00;&#x5173;&#x6548;&#x679C;&#x3002;</span></span><br><span class="line">       mDrawerToggle = <span class="keyword">new</span> ActionBarDrawerToggle(<span class="keyword">this</span>, drawerLayout, toolbar, R.string.drawer_open,</span><br><span class="line">                R.string.drawer_close);</span><br><span class="line">      <span class="comment">//&#x8BE5;&#x65B9;&#x6CD5;&#x4F1A;&#x81EA;&#x52A8;&#x548C;actionBar&#x5173;&#x8054;, &#x5C06;&#x5F00;&#x5173;&#x7684;&#x56FE;&#x7247;&#x663E;&#x793A;&#x5728;&#x4E86;action&#x4E0A;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x8BBE;&#x7F6E;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x6709;&#x62BD;&#x5C49;&#x7684;&#x6548;&#x679C;&#xFF0C;&#x4E0D;&#x8FC7;&#x662F;&#x9ED8;&#x8BA4;&#x7684;&#x56FE;&#x6807;</span></span><br><span class="line">        mDrawerToggle.syncState();</span><br><span class="line">        drawerLayout.addDrawerListener(mDrawerToggle);</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>6.&#x5199;&#x5B8C;&#x8FD9;&#x4E2A;&#x6B65;&#x9AA4;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x5DE6;&#x8FB9;&#x7684;&#x4FA7;&#x8FB9;&#x680F;&#x4E0D;&#x7BA1;&#x662F;&#x70B9;&#x51FB;&#x5DE6;&#x4E0A;&#x89D2;&#x7684;&#x56FE;&#x6807;&#x547C;&#x51FA;&#x8FD8;&#x662F;&#x624B;&#x52BF;&#x4FA7;&#x6ED1;&#x547C;&#x51FA;&#x5C31;&#x90FD;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x4E86;&#xFF0C;&#x73B0;&#x5728;&#x8981;&#x505A;&#x7684;&#x5C31;&#x662F;&#x4E3A;&#x4FA7;&#x6ED1;&#x8FB9;&#x680F;&#x4E2D;&#x7684;&#x83DC;&#x5355;&#x9879;&#x4EE5;&#x53CA;Toolbar&#x4E0A;&#x6700;&#x53F3;&#x8FB9;&#x52A0;&#x5165;&#x4E00;&#x4E2A;&#x94C3;&#x94DB;&#x7684;&#x56FE;&#x6807;&#x5E76;&#x52A0;&#x5165;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#x4E86;&#xFF0C;&#x9996;&#x5148;&#x5148;&#x5728;Toolbar&#x53F3;&#x4FA7;&#x52A0;&#x5165;&#x94C3;&#x94DB;&#x56FE;&#x6807;&#x5427;&#xFF0C;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x73B0;&#x5728;res/menu&#x6587;&#x4EF6;&#x5939;&#x4E2D;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;main.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">menu</span> <span class="attribute">xmlns:android</span>=<span class="value">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line">    <span class="attribute">xmlns:app</span>=<span class="value">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span><br><span class="line">    <span class="attribute">xmlns:tools</span>=<span class="value">&quot;http://schemas.android.com/tools&quot;</span></span><br><span class="line">    <span class="attribute">tools:context</span>=<span class="value">&quot;.MainActivity&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">item</span></span><br><span class="line">        <span class="attribute">android:id</span>=<span class="value">&quot;@+id/tool_car_alarm&quot;</span></span><br><span class="line">        <span class="attribute">android:icon</span>=<span class="value">&quot;@drawable/ic_notifications_white_24dp&quot;</span></span><br><span class="line">        <span class="attribute">android:orderInCategory</span>=<span class="value">&quot;90&quot;</span></span><br><span class="line">        <span class="attribute">android:title</span>=<span class="value">&quot;&#x8F66;&#x8F86;&#x62A5;&#x8B66;&quot;</span></span><br><span class="line">        <span class="attribute">app:showAsAction</span>=<span class="value">&quot;ifRoom&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">menu</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x4E4B;&#x540E;&#x5728;&#x4E3B;Activity&#x4E2D;&#x52A0;&#x5165;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateOptionsMenu</span><span class="params">(Menu menu)</span> </span>{</span><br><span class="line">        getMenuInflater().inflate(R.menu.main, menu);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onCreateOptionsMenu(menu);</span><br><span class="line">    }</span><br></pre></td></tr></table></figure></p>
<p>&#x9644;&#x52A0;&#x77E5;&#x8BC6;&#xFF1A;</p>
<blockquote>
<p>android&#x4E2D;&#x53EF;&#x4EE5;&#x91CD;&#x5199;activity&#x7684;&#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x521B;&#x5EFA;&#x83DC;&#x5355;&#xFF1A;onPrepareOptionsMenu&#xFF08;Menu menu&#xFF09;&#xFF0C;onCreateOptionsMenu&#x3002;<br>&#x4E24;&#x79CD;&#x65B9;&#x6CD5;&#x7684;&#x533A;&#x522B;&#x662F;&#xFF0C;&#x524D;&#x8005;&#x662F;&#x6BCF;&#x6B21;&#x70B9;&#x51FB;menu&#x952E;&#x90FD;&#x4F1A;&#x91CD;&#x65B0;&#x8C03;&#x7528;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x5982;&#x679C;&#x83DC;&#x5355;&#x9700;&#x8981;&#x66F4;&#x65B0;&#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x7528;&#x6B64;&#x65B9;&#x6CD5;&#x3002;&#x800C;&#x540E;&#x8005;&#x53EA;&#x662F;&#x5728;activity&#x521B;&#x5EFA;&#x7684;&#x65F6;&#x5019;&#x6267;&#x884C;&#x4E00;&#x6B21;&#x3002;</p>
</blockquote>
<p>&#x770B;&#x5230;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x5728;&#x7ED3;&#x5408;&#x6211;&#x4EEC;&#x7684;&#x4EE3;&#x7801;&#x5C31;&#x77E5;&#x9053;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x83DC;&#x5355;&#xFF0C;&#x83DC;&#x5355;&#x4E2D;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x6309;&#x94AE;&#xFF0C;&#x8FD9;&#x4E2A;&#x6309;&#x94AE;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x7684;&#x94C3;&#x94DB;&#x56FE;&#x6807;&#x3002;</p>
<p>7.&#x597D;&#x7684;&#xFF0C;&#x6700;&#x540E;&#x4E00;&#x6B65;&#xFF0C;&#x7ED9;&#x6211;&#x4EEC;&#x7684;&#x4FA7;&#x6ED1;&#x8FB9;&#x680F;&#x548C;&#x83DC;&#x5355;&#x6309;&#x94AE;&#x90FD;&#x52A0;&#x4E0A;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#x5427;&#x3002;<br>&#x5728;&#x4E3B;Activity&#x4E2D;&#x52A0;&#x5165;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//&#x4E3A;&#x5DE6;&#x4FA7;&#x7684;&#x83DC;&#x5355;&#x52A0;&#x5165;&#x70B9;&#x51FB;&#x6548;&#x679C;</span></span><br><span class="line">      navigation.setNavigationItemSelectedListener(<span class="keyword">new</span> NavigationView.OnNavigationItemSelectedListener() {</span><br><span class="line">          <span class="keyword">private</span> MenuItem mPreMenuItem;</span><br><span class="line">          <span class="annotation">@Override</span></span><br><span class="line">          <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onNavigationItemSelected</span><span class="params">(MenuItem menuItem)</span> </span>{</span><br><span class="line"></span><br><span class="line">              <span class="keyword">switch</span> (menuItem.getItemId()){</span><br><span class="line">                  <span class="keyword">case</span> R.id.nav_driver_contact:</span><br><span class="line">                      <span class="comment">// do something</span></span><br><span class="line">                      ToastUtil.RightImageToast(MainActivity.<span class="keyword">this</span>,<span class="string">&quot;&#x53F8;&#x673A;&#x901A;&#x8BAF;&#x5F55;&quot;</span>,<span class="string">&quot;short&quot;</span>);</span><br><span class="line">                      <span class="keyword">break</span>;</span><br><span class="line">                  <span class="keyword">case</span> R.id.nav_car_detail_list:</span><br><span class="line">                      <span class="comment">// do something</span></span><br><span class="line">                      ToastUtil.RightImageToast(MainActivity.<span class="keyword">this</span>,<span class="string">&quot;&#x8F66;&#x8F86;&#x4FE1;&#x606F;&quot;</span>,<span class="string">&quot;short&quot;</span>);</span><br><span class="line">                      <span class="keyword">break</span>;</span><br><span class="line">              }</span><br><span class="line"></span><br><span class="line">              <span class="keyword">if</span> (mPreMenuItem != <span class="keyword">null</span>) mPreMenuItem.setChecked(<span class="keyword">false</span>);</span><br><span class="line">              menuItem.setChecked(<span class="keyword">true</span>);</span><br><span class="line">              drawerLayout.closeDrawers();</span><br><span class="line">              mPreMenuItem = menuItem;</span><br><span class="line">              <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">          }</span><br><span class="line">      });</span><br><span class="line"></span><br><span class="line">      <span class="comment">/* &#x83DC;&#x5355;&#x7684;&#x76D1;&#x542C;&#x53EF;&#x4EE5;&#x5728;toolbar&#x91CC;&#x8BBE;&#x7F6E;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x50CF;ActionBar&#x90A3;&#x6837;&#xFF0C;&#x901A;&#x8FC7;Activity&#x7684;onOptionsItemSelected&#x56DE;&#x8C03;&#x65B9;&#x6CD5;&#x6765;&#x5904;&#x7406; */</span></span><br><span class="line">      toolbar.setOnMenuItemClickListener(<span class="keyword">new</span> Toolbar.OnMenuItemClickListener() {</span><br><span class="line">          <span class="annotation">@Override</span></span><br><span class="line">          <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onMenuItemClick</span><span class="params">(MenuItem item)</span> </span>{</span><br><span class="line">              <span class="keyword">switch</span> (item.getItemId()) {</span><br><span class="line">                  <span class="keyword">case</span> R.id.tool_car_alarm:</span><br><span class="line">                      ToastUtil.RightImageToast(MainActivity.<span class="keyword">this</span>,<span class="string">&quot;&#x8F66;&#x8F86;&#x62A5;&#x8B66;&quot;</span>,<span class="string">&quot;short&quot;</span>);</span><br><span class="line">                      <span class="keyword">break</span>;</span><br><span class="line">                  <span class="keyword">default</span>:</span><br><span class="line">                      <span class="keyword">break</span>;</span><br><span class="line">              }</span><br><span class="line">              <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">          }</span><br><span class="line">      });</span><br></pre></td></tr></table></figure></p>
<p>&#x5177;&#x4F53;&#x5185;&#x5BB9;&#x770B;&#x4EE3;&#x7801;&#x5373;&#x53EF;&#xFF0C;&#x5E94;&#x8BE5;&#x6CA1;&#x4EC0;&#x4E48;&#x96BE;&#x5EA6;&#xFF0C;&#x53EA;&#x662F;&#x8981;&#x660E;&#x767D;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x9009;&#x62E9;&#x5904;&#x7406;&#x8FD9;&#x4E2A;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#x5C31;&#x8981;&#x628A;&#x8BE5;&#x4E8B;&#x4EF6;&#x8FD4;&#x56DE;true,&#x4ECE;&#x800C;&#x62E6;&#x622A;&#x8BE5;&#x4E8B;&#x4EF6;&#x3002;</p>
<h2 id="&#x7ED3;&#x8BED;">&#x7ED3;&#x8BED;</h2><p>&#x968F;&#x7740;MaterialDesign&#x8D8A;&#x6765;&#x8D8A;&#x5E7F;&#x6CDB;&#x7684;&#x5E94;&#x7528;&#x5230;&#x5404;&#x4E2A;&#x5927;&#x578B;&#x6216;&#x8005;&#x5C0F;&#x578B;&#x7684;&#x5E94;&#x7528;&#x4E2D;&#x53BB;&#xFF0C;&#x5B66;&#x4F1A;&#x642D;&#x5EFA;&#x4E00;&#x5957;MD&#x98CE;&#x683C;&#x7684;&#x8F6F;&#x4EF6;&#x6846;&#x67B6;&#x5C31;&#x6210;&#x4E3A;&#x4E00;&#x4E2A;&#x5B89;&#x5353;&#x7A0B;&#x5E8F;&#x5458;&#x5FC5;&#x987B;&#x4F1A;&#x7684;&#x77E5;&#x8BC6;&#x4E86;&#xFF0C;&#x4ECA;&#x5929;&#x6211;&#x8FD9;&#x91CC;&#x53EA;&#x662F;&#x7C97;&#x6D45;&#x7684;&#x5E26;&#x9886;&#x5927;&#x5BB6;&#x642D;&#x5EFA;&#x4E00;&#x4E2A;MD&#x98CE;&#x683C;&#x7684;APP&#xFF0C;&#x5E0C;&#x671B;&#x670B;&#x53CB;&#x4EEC;&#x90FD;&#x53EF;&#x4EE5;&#x6DF1;&#x5165;&#x7684;&#x53BB;&#x5B66;&#x4E60;&#x8FD9;&#x5957;&#x6846;&#x67B6;&#xFF0C;&#x505A;&#x51FA;&#x5C5E;&#x4E8E;&#x81EA;&#x5DF1;&#x98CE;&#x683C;&#x7684;MD&#x5E94;&#x7528;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Express快速搭建移动端测试用Api服务端]]></title>
      <url>http://jasoncool.com/2016/08/24/Express%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%B5%8B%E8%AF%95%E7%94%A8Api%E6%9C%8D%E5%8A%A1%E7%AB%AF/</url>
      <content type="html"><![CDATA[<h2 id="Express&#x662F;&#x505A;&#x4EC0;&#x4E48;&#x7684;&#xFF1F;">Express&#x662F;&#x505A;&#x4EC0;&#x4E48;&#x7684;&#xFF1F;</h2><p>   &#x5B98;&#x7F51;&#x7ED9;&#x51FA;&#x7684;&#x89E3;&#x91CA;&#x662F;&#xFF1A;&#x57FA;&#x4E8E; Node.js &#x5E73;&#x53F0;&#xFF0C;&#x5FEB;&#x901F;&#x3001;&#x5F00;&#x653E;&#x3001;&#x6781;&#x7B80;&#x7684; web &#x5F00;&#x53D1;&#x6846;&#x67B6;&#x3002;<br>   &#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x95EE;&#x4E86;&#xFF0C;&#x79FB;&#x52A8;&#x7AEF;&#x8981;web&#x5F00;&#x53D1;&#x6846;&#x67B6;&#x505A;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;<br>   &#x5176;&#x5B9E;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x505A;&#x8FC7;&#x5B9E;&#x9645;&#x5F00;&#x53D1;&#x9879;&#x76EE;&#x7684;&#x540C;&#x5B66;&#x5E94;&#x8BE5;&#x77E5;&#x9053;&#xFF0C;&#x5728;&#x6211;&#x4EEC;&#x79FB;&#x52A8;&#x7AEF;&#x5F00;&#x53D1;&#x7684;&#x9879;&#x76EE;&#x4E2D;&#xFF0C;&#x7EDD;&#x5927;&#x90E8;&#x5206;&#x7684;&#x9879;&#x76EE;&#x90FD;&#x662F;&#x9700;&#x8981;&#x7F51;&#x7EDC;&#x6570;&#x636E;&#x7684;&#x3002;&#x800C;&#x516C;&#x53F8;&#x9879;&#x76EE;&#x7684;&#x8BDD;&#xFF0C;&#x7F51;&#x7EDC;&#x6570;&#x636E;&#x7684;&#x6765;&#x6E90;&#x4E00;&#x822C;&#x90FD;&#x662F;web&#x7AEF;&#x7684;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x6BD4;&#x5982;&#x5E38;&#x7528;&#x7684;&#x5C31;&#x6709;SSH2&#x6846;&#x67B6;&#x6216;&#x8005;SpringMVC&#x642D;&#x5EFA;&#x7684;web&#x6846;&#x67B6;&#xFF0C;&#x8FD9;&#x79CD;&#x6846;&#x67B6;&#x5728;&#x5B9E;&#x9645;&#x5F00;&#x53D1;&#x4E2D;&#x662F;&#x5F88;&#x5E38;&#x7528;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x5B9E;&#x9645;&#x9879;&#x76EE;&#x5F00;&#x53D1;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x670D;&#x52A1;&#x7AEF;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x4E0D;&#x53EF;&#x80FD;&#x5728;&#x5F88;&#x77ED;&#x7684;&#x65F6;&#x95F4;&#x5185;&#x5C31;&#x628A;&#x79FB;&#x52A8;&#x7AEF;&#x8981;&#x7528;&#x7684;API&#x5199;&#x597D;&#xFF0C;&#x800C;&#x79FB;&#x52A8;&#x7AEF;&#x7684;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x4E5F;&#x4E0D;&#x80FD;&#x4E00;&#x76F4;&#x7B49;&#x7740;&#x670D;&#x52A1;&#x7AEF;&#x7684;API&#x90FD;&#x5199;&#x5B8C;&#x4E86;&#x518D;&#x5F00;&#x53D1;&#xFF0C;&#x6240;&#x4EE5;Express&#x8FD9;&#x79CD;&#x8D85;&#x7EA7;&#x8F7B;&#x91CF;&#x7EA7;&#x7684;Web&#x6846;&#x67B6;&#x5C31;&#x6709;&#x7528;&#x6B66;&#x4E4B;&#x5730;&#x4E86;&#x3002;&#xFF08;&#x5F53;&#x7136;&#xFF0C;Express&#x8FD8;&#x53EF;&#x4EE5;&#x505A;&#x5F88;&#x591A;&#x54E6;&#xFF0C;&#x53EA;&#x662F;&#x4F5C;&#x4E3A;&#x79FB;&#x52A8;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#xFF0C;&#x7528;&#x5230;&#x7684;&#x529F;&#x80FD;&#x53EF;&#x80FD;&#x4E0D;&#x9700;&#x8981;&#x90A3;&#x4E48;&#x591A;&#x3002;&#xFF09;<br>     <a id="more"></a></p>
<h2 id="&#x8BE5;&#x600E;&#x4E48;&#x7528;Express?">&#x8BE5;&#x600E;&#x4E48;&#x7528;Express?</h2><p>   &#x4E4B;&#x524D;&#x6211;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x90FD;&#x662F;&#x5728;&#x5E94;&#x7528;&#x4E2D;&#x5199;&#x4E00;&#x4E2A;Json&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x7136;&#x540E;&#x5F53;&#x4F5C;&#x7F51;&#x7EDC;&#x6570;&#x636E;&#x6765;&#x7528;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x79CD;&#x505A;&#x6CD5;&#x6709;&#x4E00;&#x4E2A;&#x5F88;&#x5927;&#x7684;&#x5F0A;&#x7AEF;&#x5C31;&#x662F;&#x4F60;&#x4E0D;&#x80FD;&#x6A21;&#x62DF;&#x7F51;&#x7EDC;&#x4E0A;&#x7684;&#x5404;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x4E5F;&#x65E0;&#x6CD5;&#x6A21;&#x62DF;&#x5206;&#x9875;&#x6548;&#x679C;&#x548C;&#x63D0;&#x4EA4;&#x6548;&#x679C;&#xFF0C;&#x800C;Express&#x5C31;&#x53EF;&#x4EE5;&#x5F88;&#x8F7B;&#x677E;&#x7684;&#x505A;&#x5230;&#x6211;&#x4EEC;&#x8981;&#x7684;&#x5566;&#x3002;<br>   &#x73B0;&#x5728;&#x6765;&#x8BF4;&#x8BF4;&#x600E;&#x4E48;&#x7528;Express&#x5427;&#xFF1A;<br>   1.&#x9996;&#x5148;&#x5B89;&#x88C5;Node.js&#x548C;Npm,&#x81F3;&#x4E8E;&#x600E;&#x4E48;&#x88C5;&#x5C31;&#x767E;&#x5EA6;&#x5427;&#x3002;<br>   2.&#x6D4B;&#x8BD5;&#x4F60;&#x7684;Node.js&#x548C;Npm&#x662F;&#x5426;&#x5B89;&#x88C5;&#x6210;&#x529F;&#xFF0C;&#x6D4B;&#x8BD5;&#x65B9;&#x6CD5;&#x5C31;&#x662F;&#x5728;cmd&#x4E0B;&#x8F93;&#x5165;&#xFF1A;node -v &#x6216;&#x8005; npm -v &#xFF0C;&#x5982;&#x679C;&#x51FA;&#x73B0;&#x7248;&#x672C;&#x53F7;&#x5219;&#x8BF4;&#x660E;&#x5B89;&#x88C5;&#x6210;&#x529F;&#x3002;<br>   3.&#x521B;&#x5EFA;&#x4F60;&#x7684;Node.js&#x5DE5;&#x7A0B;&#xFF1A;&#x5148;&#x5728;&#x67D0;&#x4E2A;&#x76D8;&#x7B26;&#x4E0B;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7A7A;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x6211;&#x5C31;&#x662F;&#x5728;E&#x76D8;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;ExpressServerWorkSpace&#x7684;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7;cmd&#x547D;&#x4EE4;&#xFF0C;&#x8FDB;&#x5165;&#x5230;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x8BE5;&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x8F93;&#x5165;&#x547D;&#x4EE4;</p>
<blockquote>
<p>npm init</p>
</blockquote>
<p>   &#x4E4B;&#x540E;&#x547D;&#x4EE4;&#x884C;&#x4F1A;&#x6709;&#x4E00;&#x4E9B;&#x63D0;&#x793A;&#xFF0C;&#x6309;&#x7167;&#x82F1;&#x6587;&#x6307;&#x793A;&#x5199;&#x4E00;&#x4E9B;&#x57FA;&#x7840;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#x9664;&#x4E86;&#x7B2C;&#x4E00;&#x4E2A;&#x5FC5;&#x987B;&#x5199;&#x4EE5;&#x5916;&#x5176;&#x4ED6;&#x7684;&#x90FD;&#x53EF;&#x4EE5;&#x6309;&#x56DE;&#x8F66;&#x8DF3;&#x8FC7;&#xFF0C;&#x8FD9;&#x4E2A;&#x6B65;&#x9AA4;&#x4E3B;&#x8981;&#x662F;&#x4E3A;&#x4E86;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x53EB;&#x505A;Package.json&#x7684;Node.js&#x5DE5;&#x7A0B;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x5F53;&#x7136;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x9700;&#x8981;&#xFF0C;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x662F;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x7684;&#x3002;</p>
<p>   4.&#x5B89;&#x88C5;&#x9700;&#x8981;&#x7684;JS&#x5E93; &#x2014;&#x2014; body-parser<br>   body-parser&#x662F;&#x4E00;&#x4E2A;&#x7528;&#x6765;&#x89E3;&#x6790;Http&#x8BF7;&#x6C42;&#x4F53;&#x7684;&#x4E2D;&#x95F4;&#x4EF6;&#xFF0C;&#x5173;&#x4E8E;&#x4E2D;&#x95F4;&#x4EF6;&#xFF0C;&#x8BFB;&#x8005;&#x53EF;&#x4EE5;&#x53BB;Express&#x7684;&#x5B98;&#x7F51;&#x5B66;&#x4E60;&#x4E00;&#x4E0B;&#xFF1A;<a href="http://www.expressjs.com.cn/guide/using-middleware.html" target="_blank" rel="external">Express&#x4E2D;&#x95F4;&#x4EF6;</a><br>   &#x5B89;&#x88C5;&#x547D;&#x4EE4;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x4E00;&#x6837;&#x662F;&#x5728;Cmd&#x4E0B;&#x8F93;&#x5165;&#xFF1A;</p>
<blockquote>
<p>npm install &#x2013;save express body-parser</p>
</blockquote>
<p>   &#x7B49;&#x5F85;&#x5B89;&#x88C5;&#x5B8C;&#x6210;&#x5373;&#x53EF;&#x3002;<br>   &#x5230;&#x8FD9;&#x91CC;&#xFF0C;Express&#x5C31;&#x7B97;&#x662F;&#x5B89;&#x88C5;&#x5B8C;&#x6210;&#x4E86;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x4F60;&#x5728;&#x770B;&#x4F60;&#x521A;&#x624D;&#x5EFA;&#x7ACB;&#x7684;&#x6587;&#x4EF6;&#x5939;&#x662F;&#x4E0D;&#x662F;&#x591A;&#x4E86;&#x5F88;&#x591A;&#x6587;&#x4EF6;&#x5462;&#xFF1F;</p>
<h2 id="&#x5F00;&#x59CB;&#x7F16;&#x5199;App-js">&#x5F00;&#x59CB;&#x7F16;&#x5199;App.js</h2><p>   &#x4EC0;&#x4E48;&#x662F;App.js&#x5462;&#xFF1F;&#x5176;&#x5B9E;&#x5C31;&#x662F;Express&#x542F;&#x52A8;&#x7684;&#x6846;&#x67B6;&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x4E3B;&#x8981;&#x4F5C;&#x7528;&#x662F;&#x5B9A;&#x4E49;&#x4E00;&#x4E9B;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#xFF0C;&#x5E76;&#x4E14;&#x786E;&#x5B9A;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x7684;&#x8DEF;&#x5F84;&#x548C;&#x8BF7;&#x6C42;&#x7684;&#x5185;&#x5BB9;&#x7684;&#x3002;<br>   &#x8FD9;&#x4E2A;App.js&#x662F;&#x8981;&#x653E;&#x5230;&#x4F60;&#x521B;&#x5EFA;&#x7684;Node.js&#x5DE5;&#x7A0B;&#x6587;&#x4EF6;&#x5939;&#x7684;&#x6839;&#x76EE;&#x5F55;&#x4E0B;&#xFF1A;<br>   <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&apos;fs&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">&apos;path&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&apos;express&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> bodyParser = <span class="built_in">require</span>(<span class="string">&apos;body-parser&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"><span class="keyword">var</span> USERS_FILE = path.join(__dirname, <span class="string">&apos;api/users.json&apos;</span>); <span class="comment">// user.json&#x6587;&#x4EF6;&#x7684;&#x8DEF;&#x5F84;</span></span><br><span class="line"><span class="keyword">var</span> CARS_FILE = path.join(__dirname, <span class="string">&apos;api/cars.json&apos;</span>); <span class="comment">// user.json&#x6587;&#x4EF6;&#x7684;&#x8DEF;&#x5F84;</span></span><br><span class="line">app.set(<span class="string">&apos;port&apos;</span>, (process.env.PORT || <span class="number">9999</span>));</span><br><span class="line">app.use(<span class="string">&apos;/&apos;</span>, express.static(path.join(__dirname, <span class="string">&apos;public&apos;</span>)));</span><br><span class="line"><span class="comment">//&#x4F7F;&#x7528;body-parser&#x4E2D;&#x95F4;&#x4EF6;</span></span><br><span class="line">app.use(bodyParser.json());</span><br><span class="line">app.use(bodyParser.urlencoded({extended: <span class="literal">true</span>}));</span><br><span class="line"><span class="comment">// &#x4E2D;&#x95F4;&#x4EF6;&#xFF0C;&#x6BCF;&#x4E2A;&#x8BF7;&#x6C42;&#x90FD;&#x4F1A;&#x8FDB;&#x884C;&#x5904;&#x7406;.</span></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>{</span><br><span class="line">    <span class="comment">// Set permissive CORS header - this allows this server to be used only as</span></span><br><span class="line">    <span class="comment">// an API server in conjunction with something like webpack-dev-server.</span></span><br><span class="line">    res.setHeader(<span class="string">&apos;Access-Control-Allow-Origin&apos;</span>, <span class="string">&apos;*&apos;</span>);</span><br><span class="line">    <span class="comment">// Disable caching so we&apos;ll always get the latest comments.</span></span><br><span class="line">    res.setHeader(<span class="string">&apos;Cache-Control&apos;</span>, <span class="string">&apos;no-cache&apos;</span>);</span><br><span class="line">    next();</span><br><span class="line">});</span><br><span class="line"><span class="comment">// &#x5904;&#x7406;/api/users&#x7684;GET&#x8BF7;&#x6C42;</span></span><br><span class="line">app.get(<span class="string">&apos;/api/users&apos;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>{</span><br><span class="line">  fs.readFile(USERS_FILE, <span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>) </span>{</span><br><span class="line">    <span class="keyword">if</span> (err) {</span><br><span class="line">      <span class="built_in">console</span>.error(err);</span><br><span class="line">      process.exit(<span class="number">1</span>); <span class="comment">//&#x9000;&#x51FA;&#x5E94;&#x7528;</span></span><br><span class="line">    }</span><br><span class="line">    res.json(<span class="built_in">JSON</span>.parse(data));</span><br><span class="line">  });</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line"><span class="comment">// &#x5904;&#x7406;/api/carslist&#x7684;GET&#x8BF7;&#x6C42;</span></span><br><span class="line">app.get(<span class="string">&apos;/api/carslist&apos;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>{</span><br><span class="line">  fs.readFile(CARS_FILE, <span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>) </span>{</span><br><span class="line">    <span class="keyword">if</span> (err) {</span><br><span class="line">      <span class="built_in">console</span>.error(err);</span><br><span class="line">      process.exit(<span class="number">1</span>); <span class="comment">//&#x9000;&#x51FA;&#x5E94;&#x7528;</span></span><br><span class="line">    }</span><br><span class="line">    res.json(<span class="built_in">JSON</span>.parse(data));</span><br><span class="line">  });</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x5904;&#x7406;/api/users&#x7684;POST&#x8BF7;&#x6C42;</span></span><br><span class="line">app.post(<span class="string">&apos;/api/users&apos;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>{</span><br><span class="line">  fs.readFile(USERS_FILE, <span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>) </span>{</span><br><span class="line">    <span class="keyword">if</span> (err) {</span><br><span class="line">      <span class="built_in">console</span>.error(err);</span><br><span class="line">      process.exit(<span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">var</span> users = <span class="built_in">JSON</span>.parse(data);</span><br><span class="line">    <span class="comment">//&#x63A7;&#x5236;post&#x63D0;&#x4EA4;&#x7684;&#x53C2;&#x6570;&#x7C7B;&#x578B;</span></span><br><span class="line">    <span class="keyword">var</span> user = {</span><br><span class="line">      name: req.body.name,</span><br><span class="line">      email: req.body.email</span><br><span class="line">    };</span><br><span class="line">    <span class="comment">//&#x5C06;user&#x52A0;&#x5165;&#x5230;users&#x4E2D;&#x53BB;&#x3002;</span></span><br><span class="line">    users.push(user);</span><br><span class="line">    fs.writeFile(USERS_FILE, <span class="built_in">JSON</span>.stringify(users, <span class="literal">null</span>, <span class="number">4</span>), <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>{</span><br><span class="line">      <span class="keyword">if</span> (err) {</span><br><span class="line">        <span class="built_in">console</span>.error(err);</span><br><span class="line">        process.exit(<span class="number">1</span>);</span><br><span class="line">      }</span><br><span class="line">      <span class="comment">//&#x8BF7;&#x6C42;&#x6210;&#x529F;&#x540E;&#x8FD4;&#x56DE;&#x7684;&#x63D0;&#x793A;json</span></span><br><span class="line">      res.json(<span class="string">&quot;{code: 200, message: &apos;Add user successful.&apos;}&quot;</span>);</span><br><span class="line">    });</span><br><span class="line">  });</span><br><span class="line">});</span><br><span class="line">app.listen(app.get(<span class="string">&apos;port&apos;</span>), <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>{</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&apos;Server started: http://localhost:&apos;</span> + app.get(<span class="string">&apos;port&apos;</span>) + <span class="string">&apos;/&apos;</span>);</span><br><span class="line">});</span><br></pre></td></tr></table></figure></p>
<p>   &#x73B0;&#x5728;&#x5728;&#x4F60;&#x521B;&#x5EFA;&#x7684;Node.js&#x5DE5;&#x7A0B;&#x7684;&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#x540D;&#x4E3A;&#xFF1A;api,&#x7136;&#x540E;&#x628A;&#x9700;&#x8981;&#x7684;json&#x90FD;&#x653E;&#x5165;&#x5230;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x53BB;&#x3002;<br>   users.json:<br>   <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">   [</span><br><span class="line">    {</span><br><span class="line">        &quot;<span class="attribute">name</span>&quot;: <span class="value"><span class="string">&quot;jason&quot;</span></span>,</span><br><span class="line">        &quot;<span class="attribute">email</span>&quot;: <span class="value"><span class="string">&quot;jasoncool_521@qq.com&quot;</span></span><br><span class="line">    </span>},</span><br><span class="line">    {},</span><br><span class="line">    {},</span><br><span class="line">    {</span><br><span class="line">        &quot;<span class="attribute">name</span>&quot;: <span class="value"><span class="string">&quot;123&quot;</span></span>,</span><br><span class="line">        &quot;<span class="attribute">email</span>&quot;: <span class="value"><span class="string">&quot;123&quot;</span></span><br><span class="line">    </span>}</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<p>   cars.json:<br>   <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">  {</span><br><span class="line">   &quot;<span class="attribute">carList</span>&quot;: <span class="value">[</span><br><span class="line">       {</span><br><span class="line">           &quot;<span class="attribute">carid</span>&quot;: <span class="value"><span class="number">1</span></span><br><span class="line">       </span>},</span><br><span class="line">       {</span><br><span class="line">           &quot;<span class="attribute">carid</span>&quot;: <span class="value"><span class="number">2</span></span><br><span class="line">       </span>}</span><br><span class="line">   ]</span>,</span><br><span class="line">   &quot;<span class="attribute">code</span>&quot;: <span class="value"><span class="string">&quot;200&quot;</span></span><br><span class="line"></span>}</span><br></pre></td></tr></table></figure></p>
<h2 id="&#x8FD0;&#x884C;App-js">&#x8FD0;&#x884C;App.js</h2><pre><code>&#x5728;<span class="constant">Cmd</span>&#x4E0B;&#x8F93;&#x5165;&#xFF1A;

&gt; node app.js

&#x7136;&#x540E;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x6D4F;&#x89C8;&#x5668;&#x4E2D;&#x8F93;&#x5165;
<span class="symbol">http:</span>/<span class="regexp">/localhost:9999/api</span><span class="regexp">/users&#x6216;&#x8005;http:/</span><span class="regexp">/localhost:9999/api</span><span class="regexp">/carslist
&#x6765;&#x6D4B;&#x8BD5;&#x4E00;&#x4E0B;&#x6211;&#x4EEC;&#x7684;REST&#x670D;&#x52A1;&#x7AEF;&#x8FD4;&#x56DE;&#x7684;&#x6570;&#x636E;&#x4E86;&#x3002;</span>
</code></pre>]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Android定位开发之百度定位、高德定位、腾讯定位，三足鼎立一起为我所用！]]></title>
      <url>http://jasoncool.com/2016/07/22/Android%E5%AE%9A%E4%BD%8D%E5%BC%80%E5%8F%91%E4%B9%8B%E7%99%BE%E5%BA%A6%E5%AE%9A%E4%BD%8D%E3%80%81%E9%AB%98%E5%BE%B7%E5%AE%9A%E4%BD%8D%E3%80%81%E8%85%BE%E8%AE%AF%E5%AE%9A%E4%BD%8D%EF%BC%8C%E4%B8%89%E8%B6%B3%E9%BC%8E%E7%AB%8B%E4%B8%80%E8%B5%B7%E4%B8%BA%E6%88%91%E6%89%80%E7%94%A8%EF%BC%81/</url>
      <content type="html"><![CDATA[<p>&#x8FD9;&#x51E0;&#x5929;&#x7684;&#x9879;&#x76EE;&#x4E0D;&#x662F;&#x5F88;&#x7D27;&#xFF0C;&#x4E8E;&#x662F;&#x60F3;&#x4E3A;&#x672A;&#x6765;&#x53EF;&#x80FD;&#x8981;&#x505A;&#x7684;&#x9879;&#x76EE;&#x505A;&#x4E00;&#x4E9B;&#x6280;&#x672F;&#x50A8;&#x5907;&#x3002;<br>&#x4E0B;&#x4E00;&#x4E2A;&#x9879;&#x76EE;&#x5F88;&#x6709;&#x53EF;&#x80FD;&#x662F;&#x5B9A;&#x4F4D;&#x5F00;&#x53D1;&#xFF0C;&#x9700;&#x8981;&#x7528;&#x5230;&#x624B;&#x673A;&#x5B9A;&#x4F4D;&#x529F;&#x80FD;&#xFF0C;&#x4E8E;&#x662F;&#x67E5;&#x4E86;&#x67E5;&#x73B0;&#x5728;&#x6BD4;&#x8F83;&#x6D41;&#x884C;&#x7684;&#x7B2C;&#x4E09;&#x65B9;&#x5B9A;&#x4F4D;&#xFF0C;&#x6700;&#x706B;&#x7684;&#x57FA;&#x672C;&#x4E0A;&#x5C31;&#x662F;&#x767E;&#x5EA6;&#x5B9A;&#x4F4D;&gt;&#x9AD8;&#x5FB7;&#x5B9A;&#x4F4D;&gt;&#x817E;&#x8BAF;&#x5B9A;&#x4F4D;&#x4E86;&#x3002;<br>&#x60F3;&#x4E86;&#x60F3;&#x4E0D;&#x5982;&#x505A;&#x4E00;&#x4E2A;DEMO&#x628A;&#x4E09;&#x79CD;&#x5B9A;&#x4F4D;&#x65B9;&#x5F0F;&#x6DF7;&#x5408;&#x4E00;&#x4E0B;&#x8BD5;&#x8BD5;&#x3002;<br><a id="more"></a><br>BaiduLocTool.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dhcc.mixlocation;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> android.content.Context;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> com.baidu.location.BDLocation;  </span><br><span class="line"><span class="keyword">import</span> com.baidu.location.BDLocationListener;  </span><br><span class="line"><span class="keyword">import</span> com.baidu.location.LocationClient;  </span><br><span class="line"><span class="keyword">import</span> com.baidu.location.LocationClientOption;  </span><br><span class="line"><span class="keyword">import</span> com.baidu.location.LocationClientOption.LocationMode;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaiduLocTool</span> <span class="keyword">implements</span> <span class="title">BDLocationListener</span></span>{  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">public</span> LocationClient mLocationClient;  </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> LocationClient <span class="title">getmLocationClient</span><span class="params">()</span> </span>{  </span><br><span class="line">        <span class="keyword">return</span> mLocationClient;  </span><br><span class="line">    }  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">private</span> Context mContext;  </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BaiduLocTool</span><span class="params">(Context context)</span></span>{  </span><br><span class="line">          </span><br><span class="line">        mContext=context;  </span><br><span class="line">    }  </span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>{  </span><br><span class="line">          </span><br><span class="line">        mLocationClient = <span class="keyword">new</span> LocationClient(mContext);  </span><br><span class="line">          </span><br><span class="line">        InitLocation();  </span><br><span class="line">          </span><br><span class="line">        mLocationClient.registerLocationListener(<span class="keyword">this</span>);  </span><br><span class="line">          </span><br><span class="line">        mLocationClient.start();  </span><br><span class="line">    }  </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">InitLocation</span><span class="params">()</span></span>{  </span><br><span class="line">        LocationClientOption option = <span class="keyword">new</span> LocationClientOption();  </span><br><span class="line">        option.setLocationMode(LocationMode.Hight_Accuracy);<span class="comment">//&#x8BBE;&#x7F6E;&#x5B9A;&#x4F4D;&#x6A21;&#x5F0F;  </span></span><br><span class="line">        option.setScanSpan(<span class="number">1000</span>);<span class="comment">//&#x8BBE;&#x7F6E;&#x53D1;&#x8D77;&#x5B9A;&#x4F4D;&#x8BF7;&#x6C42;&#x7684;&#x95F4;&#x9694;&#x65F6;&#x95F4;&#x4E3A;5000ms  </span></span><br><span class="line">        option.setIsNeedAddress(<span class="keyword">true</span>);  </span><br><span class="line">        mLocationClient.setLocOption(option);  </span><br><span class="line">    }  </span><br><span class="line">  </span><br><span class="line">    <span class="annotation">@Override</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceiveLocation</span><span class="params">(BDLocation location)</span> </span>{  </span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub  </span></span><br><span class="line">        ((MainActivity)mContext).phoneCall(<span class="string">&quot;&#x767E;&#x5EA6;&#x5B9A;&#x4F4D;:&quot;</span>+<span class="string">&quot;&#x7EAC;&#x5EA6;:&quot;</span>+location.getLatitude()+<span class="string">&quot; | &quot;</span>+<span class="string">&quot;&#x7ECF;&#x5EA6;:&quot;</span>+location.getLongitude()+<span class="string">&quot; | &quot;</span>+<span class="string">&quot;&#x53CD;&#x5730;&#x7406;&#x7F16;&#x7801;:&quot;</span>+location.getAddrStr());  </span><br><span class="line">        mLocationClient.stop();  </span><br><span class="line">    }  </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroyLocManager</span><span class="params">()</span></span>{  </span><br><span class="line">        <span class="keyword">if</span>(mLocationClient!=<span class="keyword">null</span>)  </span><br><span class="line">        mLocationClient.stop();  </span><br><span class="line">        mLocationClient=<span class="keyword">null</span>;  </span><br><span class="line">    }  </span><br><span class="line">  </span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>GaodeLocTool.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.dhcc.mixlocation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.location.Location;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.amap.api.location.AMapLocation;</span><br><span class="line"><span class="keyword">import</span> com.amap.api.location.AMapLocationListener;</span><br><span class="line"><span class="keyword">import</span> com.amap.api.location.LocationManagerProxy;</span><br><span class="line"><span class="keyword">import</span> com.amap.api.location.LocationProviderProxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GaodeLocTool</span> <span class="keyword">implements</span> <span class="title">AMapLocationListener</span></span>{</span><br><span class="line">	</span><br><span class="line">	Context mContext;</span><br><span class="line">	<span class="keyword">private</span> LocationManagerProxy mLocationManagerProxy;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">GaodeLocTool</span><span class="params">(Context context)</span></span>{</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">this</span>.mContext=context;</span><br><span class="line">		</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>{</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		mLocationManagerProxy = LocationManagerProxy.getInstance(mContext);</span><br><span class="line">		</span><br><span class="line">		  mLocationManagerProxy.requestLocationData(</span><br><span class="line">	                LocationProviderProxy.AMapNetwork, <span class="number">1000</span>, <span class="number">15</span>, <span class="keyword">this</span>);</span><br><span class="line">	        mLocationManagerProxy.setGpsEnable(<span class="keyword">true</span>);</span><br><span class="line">		</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="annotation">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onLocationChanged</span><span class="params">(Location location)</span> </span>{</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		Log.e(<span class="string">&quot;onLocationChanged&quot;</span>, <span class="string">&quot;Location&quot;</span>);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="annotation">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onProviderDisabled</span><span class="params">(String arg0)</span> </span>{</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		Log.e(<span class="string">&quot;onProviderDisabled&quot;</span>, <span class="string">&quot;onProviderDisabled&quot;</span>);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="annotation">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onProviderEnabled</span><span class="params">(String arg0)</span> </span>{</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		Log.e(<span class="string">&quot;onProviderEnabled&quot;</span>, <span class="string">&quot;onProviderEnabled&quot;</span>);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="annotation">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStatusChanged</span><span class="params">(String arg0, <span class="keyword">int</span> arg1, Bundle arg2)</span> </span>{</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		Log.e(<span class="string">&quot;onStatusChanged&quot;</span>, <span class="string">&quot;onStatusChanged&quot;</span>);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="annotation">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onLocationChanged</span><span class="params">(AMapLocation location)</span> </span>{</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		Log.e(<span class="string">&quot;onLocationChanged&quot;</span>, <span class="string">&quot;AMapLocation&quot;</span>);</span><br><span class="line">		((MainActivity)mContext).phoneCall(<span class="string">&quot;&#x9AD8;&#x5FB7;&#x5B9A;&#x4F4D;:&quot;</span>+<span class="string">&quot;&#x6DF7;&#x5408;&#x5B9A;&#x4F4D;&#x65B9;&#x5F0F;:&quot;</span>+location.getProvider()+<span class="string">&quot; | &quot;</span>+<span class="string">&quot;&#x7EAC;&#x5EA6;:&quot;</span>+location.getLatitude()+<span class="string">&quot; | &quot;</span>+<span class="string">&quot;&#x7ECF;&#x5EA6;:&quot;</span>+location.getLongitude()+<span class="string">&quot; | &quot;</span>+<span class="string">&quot;&#x53CD;&#x5730;&#x7406;&#x7F16;&#x7801;:&quot;</span>+location.getAddress());	</span><br><span class="line">		mLocationManagerProxy.removeUpdates(<span class="keyword">this</span>);</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroyLocManager</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">	        <span class="keyword">if</span> (mLocationManagerProxy != <span class="keyword">null</span>) {</span><br><span class="line">	        	mLocationManagerProxy.removeUpdates(<span class="keyword">this</span>);</span><br><span class="line">	        	mLocationManagerProxy.destroy();</span><br><span class="line">	        }</span><br><span class="line">	        mLocationManagerProxy = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>TencentLocTool.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.dhcc.mixlocation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.tencent.map.geolocation.TencentLocation;</span><br><span class="line"><span class="keyword">import</span> com.tencent.map.geolocation.TencentLocationListener;</span><br><span class="line"><span class="keyword">import</span> com.tencent.map.geolocation.TencentLocationManager;</span><br><span class="line"><span class="keyword">import</span> com.tencent.map.geolocation.TencentLocationRequest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TecentLocTool</span> <span class="keyword">implements</span> <span class="title">TencentLocationListener</span> </span>{</span><br><span class="line"></span><br><span class="line">	String LocInfo;</span><br><span class="line">	String task;</span><br><span class="line">	Context main;</span><br><span class="line">	TencentLocationManager mLocationManager;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLocInfo</span><span class="params">()</span> </span>{</span><br><span class="line">		<span class="keyword">return</span> LocInfo;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLocInfo</span><span class="params">(String locInfo)</span> </span>{</span><br><span class="line">		LocInfo = locInfo;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">TecentLocTool</span><span class="params">(Context main)</span> </span>{</span><br><span class="line">		<span class="keyword">this</span>.main = main;</span><br><span class="line">		mLocationManager=TencentLocationManager.getInstance(main);</span><br><span class="line"></span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>{</span><br><span class="line">		<span class="keyword">int</span> error = TencentLocationManager.getInstance(main)</span><br><span class="line">				.requestLocationUpdates(</span><br><span class="line">						TencentLocationRequest</span><br><span class="line">								.create().setInterval(<span class="number">5000</span>)</span><br><span class="line">								.setRequestLevel(</span><br><span class="line">										TencentLocationRequest.REQUEST_LEVEL_NAME), <span class="keyword">this</span>);</span><br><span class="line">		<span class="keyword">if</span> (error == <span class="number">0</span>) {</span><br><span class="line"></span><br><span class="line">			Log.e(<span class="string">&quot;&#x76D1;&#x542C;&#x72B6;&#x6001;:&quot;</span>, <span class="string">&quot;&#x76D1;&#x542C;&#x6210;&#x529F;!&quot;</span>);</span><br><span class="line"></span><br><span class="line">		} <span class="keyword">else</span> <span class="keyword">if</span> (error == <span class="number">1</span>) {</span><br><span class="line"></span><br><span class="line">			Log.e(<span class="string">&quot;&#x76D1;&#x542C;&#x72B6;&#x6001;:&quot;</span>, <span class="string">&quot;&#x8BBE;&#x5907;&#x7F3A;&#x5C11;&#x4F7F;&#x7528;&#x817E;&#x8BAF;&#x5B9A;&#x4F4D;SDK&#x9700;&#x8981;&#x7684;&#x57FA;&#x672C;&#x6761;&#x4EF6;&quot;</span>);</span><br><span class="line"></span><br><span class="line">		} <span class="keyword">else</span> <span class="keyword">if</span> (error == <span class="number">2</span>) {</span><br><span class="line"></span><br><span class="line">			Log.e(<span class="string">&quot;&#x76D1;&#x542C;&#x72B6;&#x6001;:&quot;</span>, <span class="string">&quot;&#x914D;&#x7F6E;&#x7684; key &#x4E0D;&#x6B63;&#x786E;&quot;</span>);</span><br><span class="line"></span><br><span class="line">		}</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * <span class="doctag">@param</span> location</span><br><span class="line">	 *            &#x65B0;&#x7684;&#x4F4D;&#x7F6E;</span><br><span class="line">	 * <span class="doctag">@param</span> error</span><br><span class="line">	 *            &#x9519;&#x8BEF;&#x7801;</span><br><span class="line">	 * <span class="doctag">@param</span> reason</span><br><span class="line">	 *            &#x9519;&#x8BEF;&#x63CF;&#x8FF0;</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="annotation">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onLocationChanged</span><span class="params">(TencentLocation location, <span class="keyword">int</span> error,</span><br><span class="line">			String reason)</span> </span>{</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">if</span> (TencentLocation.ERROR_OK == error) {</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">double</span> lat = location.getLatitude();<span class="comment">// &#x7EAC;&#x5EA6;</span></span><br><span class="line">			<span class="keyword">double</span> lot = location.getLongitude();<span class="comment">// &#x7ECF;&#x5EA6;</span></span><br><span class="line">			<span class="keyword">double</span> altitude = location.getAltitude();<span class="comment">// &#x6D77;&#x62D4;</span></span><br><span class="line">			<span class="keyword">float</span> accuracy = location.getAccuracy();<span class="comment">// &#x7CBE;&#x5EA6;</span></span><br><span class="line">			String nation = location.getNation();<span class="comment">// &#x56FD;&#x5BB6;</span></span><br><span class="line">			String province = location.getProvince();<span class="comment">// &#x7701;&#x4EFD;</span></span><br><span class="line">			String city = location.getCity();<span class="comment">// &#x57CE;&#x5E02;</span></span><br><span class="line">			String district = location.getDistrict();<span class="comment">// &#x533A;</span></span><br><span class="line">			String town = location.getTown();<span class="comment">// &#x9547;</span></span><br><span class="line">			String village = location.getVillage();<span class="comment">// &#x6751;</span></span><br><span class="line">			String street = location.getStreet();<span class="comment">// &#x8857;&#x9053;</span></span><br><span class="line">			String streetNo = location.getStreetNo();<span class="comment">// &#x95E8;&#x53F7;</span></span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line"></span><br><span class="line">			Log.e(<span class="string">&quot;&#x5B9A;&#x4F4D;&#x4FE1;&#x606F;:&quot;</span>, lat + <span class="string">&quot; | &quot;</span> + lot + <span class="string">&quot; | &quot;</span> + altitude + <span class="string">&quot; | &quot;</span></span><br><span class="line">					+ accuracy + <span class="string">&quot; | &quot;</span> + nation + <span class="string">&quot; | &quot;</span> + province + <span class="string">&quot; | &quot;</span></span><br><span class="line">					+ city + <span class="string">&quot; | &quot;</span> + district + <span class="string">&quot; | &quot;</span> + town + <span class="string">&quot; | &quot;</span> + village</span><br><span class="line">					+ <span class="string">&quot; | &quot;</span> + street + <span class="string">&quot; | &quot;</span> + streetNo);</span><br><span class="line">			</span><br><span class="line">			task = lat + <span class="string">&quot; | &quot;</span> + lot + <span class="string">&quot; | &quot;</span> + altitude + <span class="string">&quot; | &quot;</span> + accuracy</span><br><span class="line">					+ <span class="string">&quot; | &quot;</span> + nation + <span class="string">&quot; | &quot;</span> + province + <span class="string">&quot; | &quot;</span> + city + <span class="string">&quot; | &quot;</span></span><br><span class="line">					+ district + <span class="string">&quot; | &quot;</span> + town + <span class="string">&quot; | &quot;</span> + village + <span class="string">&quot; | &quot;</span></span><br><span class="line">					+ street + <span class="string">&quot; | &quot;</span> + streetNo + <span class="string">&quot; | &quot;</span>;</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			String provider=location.getProvider();<span class="comment">//&#x5B9A;&#x4F4D;&#x65B9;&#x5F0F;</span></span><br><span class="line">			<span class="keyword">if</span> (TencentLocation.GPS_PROVIDER.equals(provider)) {</span><br><span class="line">			    <span class="comment">// location &#x662F;GPS&#x5B9A;&#x4F4D;&#x7ED3;&#x679C;</span></span><br><span class="line">				Log.e(<span class="string">&quot;&#x5B9A;&#x4F4D;&#x65B9;&#x5F0F;:&quot;</span>,<span class="string">&quot;GPS&quot;</span>);</span><br><span class="line">				((MainActivity)main).phoneCall(<span class="string">&quot;&#x817E;&#x8BAF;&#x5B9A;&#x4F4D;:&quot;</span>+task+<span class="string">&quot;GPS&quot;</span>);</span><br><span class="line">			} <span class="keyword">else</span> <span class="keyword">if</span> (TencentLocation.NETWORK_PROVIDER.equals(provider)) {</span><br><span class="line">			    <span class="comment">// location &#x662F;&#x7F51;&#x7EDC;&#x5B9A;&#x4F4D;&#x7ED3;&#x679C;</span></span><br><span class="line">				Log.e(<span class="string">&quot;&#x5B9A;&#x4F4D;&#x65B9;&#x5F0F;:&quot;</span>,<span class="string">&quot;NetWork&quot;</span>);</span><br><span class="line">				((MainActivity)main).phoneCall(<span class="string">&quot;&#x817E;&#x8BAF;&#x5B9A;&#x4F4D;:&quot;</span>+task+<span class="string">&quot;NetWork&quot;</span>+<span class="string">&quot; | &quot;</span>+location.getAddress());</span><br><span class="line">				Log.e(<span class="string">&quot;&#x5730;&#x5740;:&quot;</span>, location.getAddress());</span><br><span class="line">			}</span><br><span class="line">			mLocationManager.removeUpdates(<span class="keyword">this</span>);</span><br><span class="line">		} <span class="keyword">else</span> {</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">			Log.e(<span class="string">&quot;reason:&quot;</span>, reason);</span><br><span class="line">			Log.e(<span class="string">&quot;error:&quot;</span>, error + <span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">		}</span><br><span class="line">		</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * <span class="doctag">@param</span> name</span><br><span class="line">	 *            GPS&#xFF0C;Wi-Fi&#x7B49;</span><br><span class="line">	 * <span class="doctag">@param</span> status</span><br><span class="line">	 *            &#x65B0;&#x7684;&#x72B6;&#x6001;, &#x542F;&#x7528;&#x6216;&#x7981;&#x7528;</span><br><span class="line">	 * <span class="doctag">@param</span> desc</span><br><span class="line">	 *            &#x72B6;&#x6001;&#x63CF;&#x8FF0;</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="annotation">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStatusUpdate</span><span class="params">(String name, <span class="keyword">int</span> status, String desc)</span> </span>{</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		Log.e(<span class="string">&quot;name:&quot;</span>, name);</span><br><span class="line">		Log.e(<span class="string">&quot;status:&quot;</span>, <span class="string">&quot;&quot;</span>+status);</span><br><span class="line">		Log.e(<span class="string">&quot;desc:&quot;</span>, desc);</span><br><span class="line">		</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroyLocManager</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">		<span class="keyword">if</span>(mLocationManager!=<span class="keyword">null</span>)</span><br><span class="line">			mLocationManager.removeUpdates(<span class="keyword">this</span>);</span><br><span class="line">			mLocationManager=<span class="keyword">null</span>;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;&#x5F00;&#x53D1;&#x4E2D;&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;&#xFF1A;</p>
<p>&#x767E;&#x5EA6;&#x5730;&#x56FE;&#xFF1A;&#x6CA1;&#x4EC0;&#x4E48;&#x95EE;&#x9898;&#xFF0C;&#x7528;&#x8D77;&#x6765;&#x5F88;&#x65B9;&#x4FBF;&#x3002;<br>&#x9AD8;&#x5FB7;&#x5730;&#x56FE;&#xFF1A;LocationProviderProxy.AMapNetwork  &#x53EA;&#x652F;&#x6301;&#x7F51;&#x7EDC;&#x5B9A;&#x4F4D;&#xFF0C;&#x65E0;&#x6CD5;&#x7EAF;GPS&#x5B9A;&#x4F4D;&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x8981;&#x7EAF;GPS&#x5B9A;&#x4F4D;&#x5C31;&#x5FC5;&#x987B;&#x628A;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x6539;&#x6210;LocationManagerProxy.GPS_PROVIDER&#x3002;&#x5F88;&#x86CB;&#x75BC;&#xFF0C;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x6765;&#x903B;&#x8F91;&#x5224;&#x65AD;&#x4E00;&#x4E0B;&#x3002;<br>&#x817E;&#x8BAF;&#x5730;&#x56FE;&#xFF1A;&#x5982;&#x679C;&#x60F3;&#x8981;&#x7EAF;GPS&#x5B9A;&#x4F4D;&#x7684;&#x8BDD;&#xFF0C;&#x9700;&#x8981;&#x628A;&#x5B9A;&#x4F4D;&#x5750;&#x6807;&#x6539;&#x6210;&#x5730;&#x7403;&#x5750;&#x6807;&#xFF1A;mLocationManager.setCoordinateType(TencentLocationManager.COORDINATE_TYPE_WGS84);<br>&#x4F46;&#x662F;&#x9762;&#x4E34;&#x7684;&#x95EE;&#x9898;&#x662F;&#x8FD9;&#x4E2A;&#x5750;&#x6807;&#x6CA1;&#x6CD5;&#x53CD;&#x5730;&#x7406;&#x7F16;&#x7801;&#x3002;&#x5982;&#x679C;&#x60F3;&#x53CD;&#x5730;&#x7406;&#x7F16;&#x7801;&#xFF0C;&#x5C31;&#x5FC5;&#x987B;&#x628A;&#x5750;&#x6807;&#x6539;&#x6210;&#x706B;&#x661F;&#x5750;&#x6807;&#xFF0C;mLocationManager.setCoordinateType(TencentLocationManager.COORDINATE_TYPE_GCJ02);<br>&#x4F46;&#x662F;&#x8FD9;&#x6837;&#x53C8;&#x6CA1;&#x6CD5;&#x7EAF;GPS&#x5B9A;&#x4F4D;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4E2A;&#x4EBA;&#x89C9;&#x5F97;&#x817E;&#x8BAF;&#x5B9A;&#x4F4D;&#x53EA;&#x8981;&#x7528;&#x4ED6;&#x7684;&#x7F51;&#x7EDC;&#x5B9A;&#x4F4D;&#x5C31;&#x597D;&#x4E86;&#xFF0C;&#x4E0D;&#x8981;&#x7528;&#x4ED6;&#x7684;GPS&#x5B9A;&#x4F4D;&#x4E86; &#x597D;&#x9EBB;&#x70E6;&#x3002;</p>
<p>&#x5728;&#x6211;&#x6240;&#x5728;&#x7684;&#x4F4D;&#x7F6E;&#x6D4B;&#x8BD5;&#x7684;&#x8BDD;&#xFF0C;&#x4E09;&#x79CD;&#x5B9A;&#x4F4D;&#x7684;&#x7F51;&#x7EDC;&#x5B9A;&#x4F4D;&#xFF0C;&#x53CD;&#x5730;&#x7406;&#x7F16;&#x7801;&#x6700;&#x51C6;&#x786E;&#x7684;&#x662F;&#xFF1A;&#x817E;&#x8BAF;&#x5B9A;&#x4F4D;&#xFF0C;&#x5176;&#x6B21;&#x662F;&#x767E;&#x5EA6;&#x5B9A;&#x4F4D;&#xFF0C;&#x6700;&#x5DEE;&#x7684;&#x662F;&#x9AD8;&#x5FB7;&#x5B9A;&#x4F4D;&#x3002;</p>
<p>&#x9879;&#x76EE;&#x6E90;&#x7801;&#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;<br><a href="http://download.csdn.net/detail/jasoncol_521/8775663" target="_blank" rel="external">http://download.csdn.net/detail/jasoncol_521/8775663</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[在Kotlin的语言环境下使用ButterKnife框架]]></title>
      <url>http://jasoncool.com/2016/07/22/%E5%9C%A8Kotlin%E7%9A%84%E8%AF%AD%E8%A8%80%E7%8E%AF%E5%A2%83%E4%B8%8B%E4%BD%BF%E7%94%A8ButterKnife%E6%A1%86%E6%9E%B6/</url>
      <content type="html"><![CDATA[<p>&#x5728;&#x5B66;&#x4E60;Kotlin&#x5F00;&#x53D1;Android&#x5E94;&#x7528;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x52BF;&#x5FC5;&#x8981;&#x914D;&#x5408;&#x5F88;&#x591A;Android&#x7684;&#x5F00;&#x6E90;&#x6846;&#x67B6;&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#xFF0C;&#x800C;ButterKnife&#x662F;&#x5176;&#x4E2D;&#x53EF;&#x80FD;&#x4F1A;&#x7ECF;&#x5E38;&#x7528;&#x5230;&#x7684;&#x4E00;&#x4E2A;&#x6846;&#x67B6;&#x3002;<br>&#x4F46;&#x662F;&#x5982;&#x679C;&#x5728;Kotlin&#x4E2D;&#x76F4;&#x63A5;&#x4F7F;&#x7528;ButterKnife&#x7684;&#x6CE8;&#x89E3;&#x65B9;&#x5F0F;&#x7684;&#x8BDD;&#xFF0C;&#x4F1A;&#x51FA;&#x73B0;&#x7A7A;&#x6307;&#x9488;&#x7684;&#x5F02;&#x5E38;&#xFF0C;&#x5BFC;&#x81F4;&#x7ED1;&#x5B9A;&#x5931;&#x8D25;&#x3002;<br>&#x90A3;&#x4E48;&#x8981;&#x5982;&#x4F55;&#x624D;&#x80FD;&#x5728;Kotlin&#x7684;&#x73AF;&#x5883;&#x4E2D;&#x4F7F;&#x7528;ButterKinfe&#x5462;&#xFF1F;<br><a id="more"></a><br>&#x4E0D;&#x8981;&#x614C;&#xFF0C;ButterKnife&#x7684;&#x4F5C;&#x8005;&#x5DF2;&#x7ECF;&#x5E2E;&#x6211;&#x4EEC;&#x60F3;&#x597D;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x4E86;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x2014;&#x2014;KotterKnife&#xFF0C;&#x591A;&#x597D;&#xFF0C;&#x89C1;&#x540D;&#x77E5;&#x610F;&#x3002;<br>KotterKinife&#x7684;GitHub&#x5730;&#x5740;&#x662F;&#xFF1A;<a href="https://github.com/JakeWharton/kotterknife" target="_blank" rel="external">https://github.com/JakeWharton/kotterknife</a><br>&#x8FD9;&#x4E2A;&#x63D2;&#x4EF6;&#x662F;&#x5EFA;&#x7ACB;&#x5728;ButterKnife7&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x7684;<br>&#x4E5F;&#x5C31;&#x662F;&#x8BF4; &#x4F60;&#x5728;&#x4F7F;&#x7528;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5FC5;&#x987B;&#x5148;&#x5C06;<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile &apos;com.jakewharton:butterknife:7.0.1&apos;</span><br></pre></td></tr></table></figure></p>
<p>&#x5199;&#x5165;&#x9879;&#x76EE;Module&#x7684;gradle&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x3002;<br>&#x7136;&#x540E;&#x5728;&#x9879;&#x76EE;&#x7684;gradle&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x52A0;&#x5165;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">dependencies {</span><br><span class="line">    <span class="comment">// (&#x7565;)</span></span><br><span class="line">    compile <span class="string">&apos;com.jakewharton:kotterknife:0.1.0-SNAPSHOT&apos;</span></span><br><span class="line">}</span><br><span class="line">repositories {</span><br><span class="line">    <span class="comment">// (&#x7565;)</span></span><br><span class="line">    maven {</span><br><span class="line">        url <span class="string">&apos;https://oss.sonatype.org/content/repositories/snapshots/&apos;</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x7136;&#x540E;&#x6211;&#x4EEC;&#x770B;&#x770B;&#x4E0D;&#x52A0;KotterKnife&#x7684;&#x5199;&#x6CD5;&#x548C;&#x666E;&#x901A;&#x7684;Kottlin&#x7684;Android&#x5199;&#x6CD5;&#x7684;&#x533A;&#x522B;&#xFF1A;<br>&#x4F7F;&#x7528;&#x524D;<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="typename">Activity</span></span>() {</span><br><span class="line"> </span><br><span class="line">    <span class="variable"><span class="keyword">var</span> nameEditText</span>: EditText? = <span class="literal">null</span></span><br><span class="line"> </span><br><span class="line">    <span class="variable"><span class="keyword">var</span> submitButton</span>: TextView? = <span class="literal">null</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="typename">Bundle?</span>)</span> {</span></span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"> </span><br><span class="line">        nameEditText = findViewById(R.id.name_edit_text) <span class="keyword">as</span> EditText</span><br><span class="line">        submitButton = findViewById(R.id.submit_button) <span class="keyword">as</span> Button</span><br><span class="line">        submitButton!!.setOnClickListener {</span><br><span class="line">            <span class="variable"><span class="keyword">val</span> name</span> = nameEditText?.getText().toString()</span><br><span class="line">            Toast.makeText(this, name, Toast.LENGTH_SHORT).show()</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x4F7F;&#x7528;&#x540E;<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="typename">Activity</span></span>() {</span><br><span class="line"> </span><br><span class="line">    <span class="variable"><span class="keyword">val</span> nameEditText</span>: EditText by bindView(R.id.name_edit_text)</span><br><span class="line"> </span><br><span class="line">    <span class="variable"><span class="keyword">val</span> submitButton</span>: Button by bindView(R.id.submit_button)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="typename">Bundle?</span>)</span> {</span></span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"> </span><br><span class="line">        submitButton.setOnClickListener {</span><br><span class="line">            <span class="variable"><span class="keyword">val</span> name</span> = nameEditText.getText().toString()</span><br><span class="line">            Toast.makeText(this, name, Toast.LENGTH_SHORT).show()</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>OK&#xFF0C;&#x81F3;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7EE7;&#x7EED;&#x5728;Kotlin&#x4E2D;&#x4F7F;&#x7528;ButterKnife&#x6846;&#x67B6;&#x5566;&#xFF01;<br>&#x723D;&#x4E0D;&#xFF1F;<br><img src="/2016/07/22/&#x5728;Kotlin&#x7684;&#x8BED;&#x8A00;&#x73AF;&#x5883;&#x4E0B;&#x4F7F;&#x7528;ButterKnife&#x6846;&#x67B6;/GitHub-Mark.png" alt="logo"></p>
]]></content>
    </entry>
    
  
  
</search>
